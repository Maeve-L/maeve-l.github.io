{{$content := replaceRE `a href="\.\.\/(.+%20.+)+"` `$1` .Content}}

{{$content = replace $content "%20" "-"}}
{{$trimmed := strings.TrimSuffix ".md" (.Destination | safeURL)}}
{{$external := strings.HasPrefix $trimmed "http" }}
{{ if $external }}
<a href="{{ $trimmed }}" rel="noopener">{{ .Text | safeHTML }}</a>
{{else}}
<a href="{{ if (hasPrefix $trimmed "/") }}{{ $trimmed }}{{ else }}{{ print "/" $trimmed }}{{ end }}" rel="noopener">{{ .Text | safeHTML }}</a>
{{end}}