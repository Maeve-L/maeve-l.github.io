<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Evergreen Notes."><title>Grit and Stoic.</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=../icon.png><script>MathJax={tex:{inlineMath:[["$","$"]]},displayMath:[["$$","$$"],["[[","]]"]],svg:{fontCache:"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Source+Sans+Pro:wght@400;700&family=Fira+Code:wght@400;700&display=swap" rel=stylesheet><style>:root{--light:#faf8f8;--dark:#141021;--secondary:#284b63;--tertiary:#84a59d;--visited:#afbfc9;--primary:#f28482;--gray:#4e4e4e;--lightgray:#f0f0f0;--outlinegray:#dadada}[saved-theme=dark]{--light:#1e1e21 !important;--dark:#fbfffe !important;--secondary:#5b778a !important;--visited:#4a575e !important;--tertiary:#84a59d !important;--primary:#f58382 !important;--gray:#d4d4d4 !important;--lightgray:#292633 !important;--outlinegray:#343434 !important}</style><style>:root{--lt-colours-light:var(--light) !important;--lt-colours-lightgray:var(--lightgray) !important;--lt-colours-dark:var(--secondary) !important;--lt-colours-secondary:var(--tertiary) !important;--lt-colours-gray:var(--outlinegray) !important}h1,h2,h3,h4,ol,ul,thead{font-family:Inter;color:var(--dark)}p,ul,text{font-family:source sans pro,sans-serif;color:var(--gray);fill:var(--gray)}a{font-family:Inter;font-weight:700;font-size:1em;text-decoration:none;transition:all .2s ease;color:var(--secondary)}a:hover{color:var(--tertiary)!important}#TableOfContents>ol{counter-reset:section;margin-left:0;padding-left:1.5em}#TableOfContents>ol>li{counter-increment:section}#TableOfContents>ol>li>ol{counter-reset:subsection}#TableOfContents>ol>li>ol>li{counter-increment:subsection}#TableOfContents>ol>li>ol>li::marker{content:counter(section)"." counter(subsection)"  "}#TableOfContents>ol>li::marker{content:counter(section)"  "}#TableOfContents>ol>li::marker,#TableOfContents>ol>li>ol>li::marker{font-family:Source Sans Pro;font-weight:700}footer{margin-top:4em;text-align:center}table{width:100%}img{width:100%;border-radius:3px;margin:1em 0}p>img+em{display:block;transform:translateY(-1em)}sup{line-height:0}p,tbody,li{font-family:Source Sans Pro;color:var(--gray);line-height:1.5em}h2{opacity:.85}h3{opacity:.75}blockquote{margin-left:0;border-left:3px solid var(--secondary);padding-left:1em;transition:border-color .2s ease}blockquote:hover{border-color:var(--tertiary)}table{padding:1.5em}td,th{padding:.1em .5em}.footnotes p{margin:.5em 0}article a{font-family:Source Sans Pro;font-weight:600;text-decoration:underline;text-decoration-color:var(--tertiary);text-decoration-thickness:.15em}sup>a{text-decoration:none;padding:0 .1em 0 .2em}pre{font-family:fira code;padding:.75em;border-radius:3px;overflow-x:scroll}code{font-family:fira code;font-size:.85em;padding:.15em .3em;border-radius:5px;background:var(--lightgray)}html{scroll-behavior:smooth}body{margin:0;height:100vh;width:100vw;overflow-x:hidden;background-color:var(--light)}@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}footer{margin-top:4em}footer>a{font-size:1em;color:var(--secondary);padding:0 .5em 3em}hr{width:25%;margin:4em auto;height:2px;border-radius:1px;border-width:0;color:var(--dark);background-color:var(--dark)}a[href^="/"]{text-decoration:none;background-color:#afbfc922;padding:0 .2em;border-radius:3px}.singlePage{margin:4em 30vw}@media all and (max-width:1200px){.singlePage{margin:25px 5vw}}.page-end{display:flex;flex-direction:row}@media all and (max-width:780px){.page-end{flex-direction:column}}.page-end>*{flex:1 0}.page-end>.backlinks-container>ul{list-style:none;padding-left:0;margin-right:2em}.page-end>.backlinks-container>ul>li{margin:.5em 0;padding:.25em 1em;border:var(--outlinegray)1px solid;border-radius:5px}.page-end #graph-container{border:var(--outlinegray)1px solid;border-radius:5px}.centered{margin-top:30vh}header{display:flex;flex-direction:row;align-items:center}@media all and (max-width:600px){header>nav{display:none}}header>nav>a{margin-left:2em}header>.spacer{flex:auto}header>svg{cursor:pointer;width:18px;min-width:18px;margin:0 1em}header>svg:hover .search-path{stroke:var(--tertiary)}header>svg .search-path{stroke:var(--gray);stroke-width:2px;transition:stroke .5s ease}#search-container{position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;display:none;backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px)}#search-container>div{width:50%;margin-top:15vh;margin-left:auto;margin-right:auto}@media all and (max-width:1200px){#search-container>div{width:90%}}#search-container>div>*{width:100%;border-radius:4px;background:var(--light);box-shadow:0 14px 50px rgba(27,33,48,.12),0 10px 30px rgba(27,33,48,.16);margin-bottom:2em}#search-container>div>input{box-sizing:border-box;padding:.5em 1em;font-family:Inter,sans-serif;color:var(--dark);font-size:1.1em;border:1px solid var(--outlinegray)}#search-container>div>input:focus{outline:none}#search-container>div>#results-container>.result-card{padding:1em;cursor:pointer;transition:background .2s ease;border:1px solid var(--outlinegray);border-bottom:none}#search-container>div>#results-container>.result-card:hover{background:rgba(180,180,180,.15)}#search-container>div>#results-container>.result-card:first-of-type{border-top-left-radius:5px;border-top-right-radius:5px}#search-container>div>#results-container>.result-card:last-of-type{border-bottom-left-radius:5px;border-bottom-right-radius:5px;border-bottom:1px solid var(--outlinegray)}#search-container>div>#results-container>.result-card>h3,#search-container>div>#results-container>.result-card>p{margin:0}#search-container>div>#results-container>.result-card .search-highlight{background-color:#afbfc966;padding:.05em .2em;border-radius:3px}</style><style>.darkmode{float:right;padding:1em;min-width:30px;position:relative}@media all and (max-width:450px){.darkmode{padding:1em}}.darkmode>.toggle{display:none;box-sizing:border-box}.darkmode svg{opacity:0;position:absolute;width:20px;height:20px;top:calc(50% - 10px);margin:0 7px;fill:var(--gray);transition:opacity .1s ease}.toggle:checked~label>#dayIcon{opacity:0}.toggle:checked~label>#nightIcon{opacity:1}.toggle:not(:checked)~label>#dayIcon{opacity:1}.toggle:not(:checked)~label>#nightIcon{opacity:0}</style><style>.chroma{color:#f8f8f2;background-color:#282a36}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.chroma .hl{display:block;width:100%;background-color:#ffc}.chroma .lnt{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .k{color:#ff79c6}.chroma .kc{color:#ff79c6}.chroma .kd{color:#8be9fd;font-style:italic}.chroma .kn{color:#ff79c6}.chroma .kp{color:#ff79c6}.chroma .kr{color:#ff79c6}.chroma .kt{color:#8be9fd}.chroma .na{color:#50fa7b}.chroma .nb{color:#8be9fd;font-style:italic}.chroma .nc{color:#50fa7b}.chroma .nf{color:#50fa7b}.chroma .nl{color:#8be9fd;font-style:italic}.chroma .nt{color:#ff79c6}.chroma .nv{color:#8be9fd;font-style:italic}.chroma .vc{color:#8be9fd;font-style:italic}.chroma .vg{color:#8be9fd;font-style:italic}.chroma .vi{color:#8be9fd;font-style:italic}.chroma .s{color:#f1fa8c}.chroma .sa{color:#f1fa8c}.chroma .sb{color:#f1fa8c}.chroma .sc{color:#f1fa8c}.chroma .dl{color:#f1fa8c}.chroma .sd{color:#f1fa8c}.chroma .s2{color:#f1fa8c}.chroma .se{color:#f1fa8c}.chroma .sh{color:#f1fa8c}.chroma .si{color:#f1fa8c}.chroma .sx{color:#f1fa8c}.chroma .sr{color:#f1fa8c}.chroma .s1{color:#f1fa8c}.chroma .ss{color:#f1fa8c}.chroma .m{color:#bd93f9}.chroma .mb{color:#bd93f9}.chroma .mf{color:#bd93f9}.chroma .mh{color:#bd93f9}.chroma .mi{color:#bd93f9}.chroma .il{color:#bd93f9}.chroma .mo{color:#bd93f9}.chroma .o{color:#ff79c6}.chroma .ow{color:#ff79c6}.chroma .c{color:#6272a4}.chroma .ch{color:#6272a4}.chroma .cm{color:#6272a4}.chroma .c1{color:#6272a4}.chroma .cs{color:#6272a4}.chroma .cp{color:#ff79c6}.chroma .cpf{color:#ff79c6}.chroma .gd{color:#8b080b}.chroma .ge{text-decoration:underline}.chroma .gh{font-weight:700}.chroma .gi{font-weight:700}.chroma .go{color:#44475a}.chroma .gu{font-weight:700}.chroma .gl{text-decoration:underline}.lntd:first-of-type>.chroma{padding-right:0}.chroma code{font-family:fira code!important;font-size:.85em;line-height:1em;background:0 0;padding:0}.chroma{border-radius:3px;margin:0}</style><script>const userPref=window.matchMedia('(prefers-color-scheme: light)').matches?'light':'dark',currentTheme=localStorage.getItem('theme')??userPref;currentTheme&&document.documentElement.setAttribute('saved-theme',currentTheme);const switchTheme=a=>{a.target.checked?(document.documentElement.setAttribute('saved-theme','dark'),localStorage.setItem('theme','dark')):(document.documentElement.setAttribute('saved-theme','light'),localStorage.setItem('theme','light'))};window.addEventListener('DOMContentLoaded',()=>{const a=document.querySelector('#darkmode-toggle');a.addEventListener('change',switchTheme,!1),currentTheme==='dark'&&(a.checked=!0)})</script></head><body><div id=search-container><div><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/gh/nextapps-de/flexsearch@0.7.2/dist/flexsearch.bundle.js></script><script>const removeMarkdown=(c,b={listUnicodeChar:!1,stripListLeaders:!0,gfm:!0,useImgAltText:!1,preserveLinks:!1})=>{let a=c||"";a=a.replace(/^(-\s*?|\*\s*?|_\s*?){3,}\s*$/gm,"");try{b.stripListLeaders&&(b.listUnicodeChar?a=a.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,b.listUnicodeChar+" $1"):a=a.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,"$1")),b.gfm&&(a=a.replace(/\n={2,}/g,"\n").replace(/~{3}.*\n/g,"").replace(/~~/g,"").replace(/`{3}.*\n/g,"")),b.preserveLinks&&(a=a.replace(/\[(.*?)\][\[\(](.*?)[\]\)]/g,"$1 ($2)")),a=a.replace(/<[^>]*>/g,"").replace(/^[=\-]{2,}\s*$/g,"").replace(/\[\^.+?\](\: .*?$)?/g,"").replace(/\s{0,2}\[.*?\]: .*?$/g,"").replace(/\!\[(.*?)\][\[\(].*?[\]\)]/g,b.useImgAltText?"$1":"").replace(/\[(.*?)\][\[\(].*?[\]\)]/g,"$1").replace(/^\s{0,3}>\s?/g,"").replace(/(^|\n)\s{0,3}>\s?/g,"\n\n").replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,"").replace(/^(\n)?\s{0,}#{1,6}\s+| {0,}(\n)?\s{0,}#{0,} {0,}(\n)?\s{0,}$/gm,"$1$2$3").replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/(`{3,})(.*?)\1/gm,"$2").replace(/`(.+?)`/g,"$1").replace(/\n{2,}/g,"\n\n")}catch(a){return console.error(a),c}return a}</script><script>const contentIndex=new FlexSearch.Worker({tokenize:"strict",charset:"latin:advanced",context:!0,depth:3,cache:10,suggest:!0}),scrapedContent={"/":{content:"Do not go gentle into that good night,\n\nOld age should burn and rave at close of day;\n\nRage, rage against the dying of the light.\n\nThough wise men at their end know dark is right,\n\nBecause their words had forked no lightning they\n\nDo not go gentle into that good night.\n\nGood men, the last wave by, crying how bright\n\nTheir frail deeds might have danced in a green bay,\n\nRage, rage against the dying of the light.\n\nWild men who caught and sang the sun in flight,\n\nAnd learn, too late, they grieved it on its way,\n\nDo not go gentle into that good night.\n\nGrave men, near death, who see with blinding sight\n\nBlind eyes could blaze like meteors and be gay,\n\nRage, rage against the dying of the light.\n\nAnd you, my father, there on the sad height,\n\nCurse, bless me now with your fierce tears, I pray.\n\nDo not go gentle into that good night.\n\nRage, rage against the dying of the light. \n\n\n[MOC](Published/MOC.md)\n\n---\n\n\n\n\n\n",title:"Untitled Page"},"/Data Preprocessing and EDA":{content:"---\nArea: Coding\nSource: Website\nStatus: Ongoing\nType: Notes\n---\n\n## Rows and Columns\n\nSlice with labels for row and single label for column. As mentioned above, note that both the start and stop of the slice are included.\n\n```python\ndf.loc['cobra':'viper', 'max_speed']\n```\n\nBoolean list with the same length as the row axis\n\n```python\ndf.loc[[False, False, True]]\n```\n\nConditional that returns a boolean Series\n\n```python\ndf.loc[df['shield'] \u003e 6] \ndf.loc[df['shield'] \u003e 6, ['max_speed']] \ndf.loc[**lambda** df: df['shield'] == 8]\n```\n\nFor Series, the row labels are prefixed. For DataFrame, the column labels are prefixed.\n\n```python\ndf.add_prefix('col_')\ndf.add_suffix('_col')\n```\n\nPossible values or ranges\n\nList the theoretical limits on the values and validate against the data.\n\n## Types and Formats\n\n### Data Types\n\nCreate a series:\n\n```python\nser = pd.Series([1, 2], dtype='int32')\nser.astype('int64')\n```\n\nConvert to categorical type:\n\n```python\nser.astype('category')\n```\n\nConvert to ordered categorical type with custom ordering:\n\n```python\ncat_dtype = pd.api.types.CategoricalDtype(categories=[2, 1], ordered=**True**)\nser.astype(cat_dtype)\n```\n\n### Data Formats\n\n```python\npd.to_datetime(data_311['created_date'], format='%m/%d/%Y %I:%M:%S %p')\n\npd.to_datetime([1, 2, 3], unit='D',origin=pd.Timestamp('1960-01-01'))\n#DatetimeIndex(['1960-01-02', '1960-01-03', '1960-01-04'], dtype='datetime64[ns]', freq=None)\n\nfrom datetime import date\nwater_quality[\"Week\"] = water_quality['created_date_time'].apply(lambda x: x.strftime(\"%w\"))\nwater_quality[\"Day\"] = water_quality['created_date_time'].apply(lambda x: x.strftime(\"%x\"))\nwater_quality[\"Year\"] = water_quality['created_date_time'].apply(lambda x: x.year)\nwater_quality[\"Month\"] = water_quality['created_date_time'].apply(lambda x: x.strftime(\"%b\"))\n\nwater_quality[\"year_month\"] = water_quality['created_date_time'].apply(\n    lambda x: date(year=x.year, month=x.month, day=1)\n)\n\n#change month name to string num\nd={'July':'07', 'August':'08', 'September':'09', 'October':'10', 'November':'11', 'December':'12',\\\\\n   'January':'01', 'February':'02', 'March':'03', 'April':'04', 'May':'05', 'June':'06'}\nresort_hotel.loc[:,'month_num']=resort_hotel['arrival_date_month'].map(d)\n\n#change year to str\nresort_hotel.loc[:,'arrival_date_year']=resort_hotel['arrival_date_year'].apply(\n    lambda x :str(x))\n#change 1 to 01 day\nresort_hotel.loc[:,'arrival_date_day_of_month']=resort_hotel['arrival_date_day_of_month'].apply(\n    lambda x:(len(str(x)) ==1 and '0'+str(x)) or str(x))\n```\n\n## Missing Values\n\n### Drop NAs\n\n```python\ndf.dropna(self, axis=0, how='any', thresh=None, subset=None, inplace=False)\n# how=‘any’ : If any NA values are present, drop that row or column.\n# how=‘all’ : If all values are NA, drop that row or column.\ndf.dropna(how='all') \n# Keep only the rows with at least 2 non-NA values.\ndf.dropna(thresh=2) \n# Define in which columns to look for missing values.\ndf.dropna(subset=['name', 'born'])\n\n```\n\n### Fill NAs\n\n```python\ndf.fillna(self, value=None, method=None, axis=None, inplace=False, limit=None, downcast=None)\n```\n\n### Percentage of missing values and visualizations\n\n## Duplications\n\n```python\ndf.drop_duplicates(['k'])\n# keep{‘first’, ‘last’, False}, default ‘first’:\n# Determines which duplicates (if any) to keep.\n# - first: Drop duplicates except for the first occurrence. \n# - last: Drop duplicates except for the last occurrence. \n# - False: Drop all duplicates.\n```\n\n## Numerical Summarization\n\nUse summary statistics to find out the moments.\n\n-   [ ] Locations\n    \n    Mean, median, quartiles, mode...\n    \n-   [ ] Spreads\n    \n    range, variance, standard deviation, IQR\n    \n-   [ ] Skewness\n    \n    asymmetries\n    \n-   [ ] Kurtosis\n    \n\n## Distributions\n\nVisualize the distributions of the values\n\n### Value count bar plot\n\n```python\ndf.groupby(\"descriptor\").size().plot(kind=\"barh\", title=\"Requests by Descriptor\")\n```\n\n### Stack bar plot\n\n```python\norder_ratio=resort_hotel.pivot_table(\n    index='Year-Month', columns='reservation_status', \n    values='is_canceled', aggfunc=len\n)\n\np1 = plt.bar(order_ratio.index,'Check-Out', width=10,data=order_ratio)\np2 = plt.bar(order_ratio.index,'Canceled',bottom='Check-Out',width=10,data=order_ratio)\np3=plt.bar(order_ratio.index,'No-Show',bottom='Check-Out',width=10,data=order_ratio)\n#plt.ylabel('Scores')\nplt.title('Reservation Status of Booking Orders Per Month ')\n#plt.xticks(ind, ('G1', 'G2', 'G3', 'G4', 'G5'))\n#plt.yticks(np.arange(0, 81, 10))\nplt.legend((p1[0], p2[0],p3[0]), ('Check-Out', 'Canceled','No-Show'))\n\nplt.show()\n```\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2dfbdcaa-5d48-488b-947b-35035413d0ea/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2dfbdcaa-5d48-488b-947b-35035413d0ea/Untitled.png)\n\n### Histogram\n\n```python\nplt.hist(water_quality['solving_time_num'],bins=100)\n```\n\n### KDE\n\n```python\nimport seaborn as sns\n\nsns.distplot(quick_solve['solving_time_num'], hist=True, kde=True, \n             bins=int(180/5), \n             hist_kws={'edgecolor':'red'},\n             kde_kws={'linewidth': 4})\n```\n\n### Box plot\n\n```python\ndf.boxplot(column='solving_time_num',by='borough')\n```\n\n### Point plot\n\n```python\nimport seaborn as sns\nfig1=plt.figure()\nax1 = fig1.add_subplot(211)\nax1=sns.pointplot(y=\"meal\", x=\"is_canceled\",data=resort_hotel,join=False,capsize=.05)\nax1.set(xlim=(0,1))\nax2 = fig1.add_subplot(212)\nax2=sns.pointplot(y=\"customer_type\", x=\"is_canceled\",data=resort_hotel,join=False,capsize=.05)\nax2.set(xlim=(0,1))\n\nfig2=plt.figure()\nax4 = fig2.add_subplot(211)\nax4=sns.pointplot(y=\"reserved_room_type\", x=\"is_canceled\",data=resort_hotel,join=False,capsize=.1)\nax4.set(xlim=(0,1))\nax5 = fig2.add_subplot(212)\nax5=sns.pointplot(y=\"market_segment\", x=\"is_canceled\",data=resort_hotel,join=False,capsize=.1)\nax5.set(xlim=(0,1))\n```\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/92410985-9ea9-43f6-8261-104d82c6df2d/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/92410985-9ea9-43f6-8261-104d82c6df2d/Untitled.png)\n\n### Pivot table plot\n\n```python\nwater_quality.pivot_table(\n    index='year_month', columns='borough', \n    values='solving_time_num', aggfunc=len\n).plot().legend(loc='center right', bbox_to_anchor=(1.2, 0.5))\n```\n\n### Geography\n\n```python\nplt.scatter(water_quality['longitude'],water_quality['latitude'],alpha=1,s=20)\nplt.xlabel('Longitude')\nplt.ylabel('Latitude')\nplt.show()\n\n# 3 dims\nplt.scatter(water_quality['longitude'],water_quality['latitude'],c=water_quality['solving_time_num'])\nplt.clim(0,100)\nplt.colorbar()\n```\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a870cb5b-ac78-496e-ab5d-1eccc137395c/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a870cb5b-ac78-496e-ab5d-1eccc137395c/Untitled.png)\n\n```python\n# Categories of geography\nfig1=plt.figure()\ndescriptor=list(water_quality['descriptor'].unique())\nc=['#c41832','#ef342a','#a84d18','#f68f26','#faca07','#07594a',\n   '#4ba946','#5fc0a7','#0376c2','#6dade2','#4dc7ec','#a8b7d8','#b8a1a9','#f8c9cb','#f2f1f6']\nfor index in range(14):\n    longi = water_quality.loc[water_quality['descriptor'] == descriptor[index]]['longitude']\n    lati = water_quality.loc[water_quality['descriptor'] == descriptor[index]]['latitude']\n    plt.scatter(longi, lati,c=c[index],cmap='brg',alpha=1,s=20)  \n\nax = fig1.gca()\nplt.xlabel('Longitude')\nplt.ylabel('Latitude')\n#added this to get the legend to work\nhandles,labels = ax.get_legend_handles_labels()\nax.legend(handles, labels = descriptor, loc='center right', bbox_to_anchor=(1.5, 0.5))\n\nplt.show()\n```\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be4182d1-b8ea-4432-b8ca-4ce67a4c6311/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be4182d1-b8ea-4432-b8ca-4ce67a4c6311/Untitled.png)\n\n### Contour plot\n\n## Bin values into discrete intervals\n\n```python\npd.cut([0, 1, 1, 2], bins=4, labels=False)\n# Quantile-based discretization function.\npd.qcut(range(5), 3, labels=[\"good\", \"medium\", \"bad\"])\n\nresort_hotel['stays_in_weekend_nights'].apply(lambda x :(x\u003e4 and '\u003e4') or str(x))\n```\n\n## Dummy variables\n\n```python\npd.get_dummies(water_quality['descriptor'],prefix='descriptor')\npd.get_dummies(pd.cut(values,bins)\n```\n\n## Dispersion of the target value\n\nIs the dispersion of the target value small enough for the algorithm to perform a good prediction?\n\n## Correlations and Similarities\n\n### Pairplot\n\n### Correlations\n\nPearson, Kendall Tau Correlation\n\n```python\nfig, ax = plt.subplots()\nim = ax.imshow(resort_hotel_le[categoricals].corr())\n\n# We want to show all ticks...\nax.set_xticks(np.arange(len(categoricals)))\nax.set_yticks(np.arange(len(categoricals)))\n# ... and label them with the respective list entries\nax.set_xticklabels(categoricals)\nax.set_yticklabels(categoricals)\n\n# Rotate the tick labels and set their alignment.\nplt.setp(ax.get_xticklabels(), rotation=45, ha=\"right\",\n         rotation_mode=\"anchor\")\n\nax.set_title(\"Correlation between Each Feature\")\nfig.tight_layout()\nplt.show()\n```\n\n### Distances\n\nCalculate the distance between features or rows to understand the relations between them; Euclidean distance, Mahalanobis distance, Minkowski distance, Jaccard distance\n\n## Combining Data Files\n\n### Merge\n\n```python\npd.merge(left, right, how= 'inner', on=None, left_on=None, right_on=None)\n# how: inner, outer, left, right\n```\n\n### Concat\n\n```python\npd.concat([s1,s2],axis=1)# if with same index\n```\n\n## Reshape\n\n### Stack and unstack\n\n```python\n#Single level columns\ndf_single_level_cols = pd.DataFrame([[0, 1], [2, 3]],\n                                    index=['cat', 'dog'],\n                                    columns=['weight', 'height'])\n#Stacking a dataframe with a single level column axis returns a Series:\ndf_single_level_cols\n#     weight height\n#cat       0      1\n#dog       2      3\ndf_single_level_cols.stack()\n#cat  weight    0\n#     height    1\n#dog  weight    2\n#     height    3\n\n#Multi level columns: simple case\n\nmulticol1 = pd.MultiIndex.from_tuples([('weight', 'kg'),\n                                       ('weight', 'pounds')])\ndf_multi_level_cols1 = pd.DataFrame([[1, 2], [2, 4]],\n                                    index=['cat', 'dog'],\n                                    columns=multicol1)\n#Stacking a dataframe with a multi-level column axis:\n\ndf_multi_level_cols1\n#     weight\n#         kg    pounds\n#cat       1        2\n#dog       2        4\ndf_multi_level_cols1.stack()\n#            weight\n#cat kg           1\n#    pounds       2\n#dog kg           2\n#    pounds       4\n```\n\n### Pivot table and melt\n\n```python\ntable = pd.pivot_table(df, values=['D', 'E'], index=['A', 'C'],\n                    aggfunc={'D': np.mean,\n                             'E': [min, max, np.mean]})\n\ndf = pd.DataFrame({'A': {0: 'a', 1: 'b', 2: 'c'},\n                   'B': {0: 1, 1: 3, 2: 5},\n                   'C': {0: 2, 1: 4, 2: 6}})\n#df\n#   A  B  C\n#0  a  1  2\n#1  b  3  4\n#2  c  5  6\n\ndf.melt(id_vars=['A'], value_vars=['B'],\n        var_name='myVarname', value_name='myValname')\n#   A myVarname  myValname\n#0  a         B          1\n#1  b         B          3\n#2  c         B          5\n```\n\n### Crosstab\n\n```python\npd.crosstab(data.Nationality,data.Handedness,margin=True)\n```\n\n## Group by and Agg\n\n```python\nprices['Return']=prices.groupby('Code')['Close'].apply(lambda x:x/x.shift(1)-1)\n\ntips.groupby(['day','smoker'],as_index=False).mean()\n\nframe=pd.DataFrame({'data1':np.random.randn(1000),\n'data2':np.random.randn(1000)})\nquartiles=pd.cut(frame.data1,4)\ndef get_stats(group):\n	return {'min':group.min(),'max':group.max(),'count':group.count(),'mean':group.mean()}\ngrouped=frame.data2.groupby(quartiles)\ngrouped.apply(get_stats).unstack()\n\n# fill NA by group\ndata.groupby(group_key).apply(lambda g:g.fillna(g.mean()))\n\n# regression\nimport statsmodels.api as sm\ndef regress(data,yvar,xvars):\n	Y=data[yvar]\n	X=data[xvars]\n	X['intercept']=1.\n	result=sm.OLS(Y,X).fit()\n	return result.params\nby_year.apply(regress,'AAPL',['SPX'])\n```\n\n## Objectives of EDA\n\n### Polish the Questions\n\nCheck if the questions to be answered are valid or well stated; If not, modify them or come up with new ones\n\n### Validate Data I/O Methods\n\nCheck and validate the methods to load and save the datasets\n\n### Retrieve Domain Knowledge and Anomalies\n\nDetermine the ranges, outliers of the dataset; Talk to domain experts and validate with domain experts.\n\n### Does the result make sense?",title:"Untitled Page"},"/Futures":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n## 期货市场的运作机制\n\n### 背景知识\n\nCME集团：芝加哥交易所、芝加哥商业交易所、纽约商品交易所\n\n期货合约的平仓：\n\n大多数期货交易不会导致实物交割，原因是大多数投资人在合约规定的交割期到来之前会选择平仓。对一个合约平仓就是进入一个与初始交易头寸相反的头寸。\n\n### 期货合约的规格\n\n- 合约规模(contract size)定义了在每一份合约中交割资产的数量。\n    - 合约规模太大，希望对冲较小头寸的投资者或希望持有较小头寸的投机者就不可能通过交易所交易\n    - 由于交易成本的存在，合约规模太小时会使交易成本太高\n- 农产品期货合约中交割资产的价值从10000美元到20000美元不等，金融期货合约的规模要大得多。\n- 小型合约可以吸引小额度投资者。(Mini Nasdaq 100)\n\n### 交割安排\n\n- 交割地点必须是交易所指定的地点。\n- 选择其他交割地点时，期货的空头方所收入的价格会随着交割地点的不同而被调整。\n- 具体交割时间由期货的空头方来决定\n- 通常的规则是交易所将交割产品意向书转给持有多头时间最久的投资者，而持有多头的一方必须接受交割通知。但是如果通知是可转让的，多头方投资方会有很短一段时间（半小时）来找到另一个持有多头的投资者来接受交割通知\n- 有些金融期货采用现金形式结算，所有未平仓的合约都在某个预先指定的日子平仓，最后的结算价格等于标的资产在这一天开盘时或收盘时的即期价格\n\n### 交割月份\n\n- 期货合约通常以交割月份命名，交易所必须明确指出在交割月份内的哪一段时间内可以交割。\n- 三个重要日期：第一交割通知日、最后交割通知日、最后交易日\n\n### 交易所\n\n- 是为其会员服务的、非盈利的会员制组织\n- 目标：提供一个公平、公正、公开的期货交易市场\n- 主要业务活动：制定、修改期货交易规则，维护市场的有效运转\n- 收入来源：主要是会员缴纳的会费与交易服务费（含交易费）\n\n#### 会员\n\n- 投资银行、经纪公司、自营商\n- 只有会员才能进场交易，交易所必须对会员的资信负责，非会员的客户必须通过会员代理进行交易\n- 会员是代理交易的主体，对其所代理的交易负全部责任。会员必须控制好所有客户的资金风险，如果因客户违约造成损失而不能履行赔偿责任时，会员必须代为履行赔偿责任并保留追偿的权利\n\n#### 客户\n\n- 普通客户在期货经纪公司建立交易账户以后，下单委托经纪公司进行交易\n- 在接到客户的委托单并确认以后，经纪公司利用在交易所的席位进行交易\n- 管理客户的账户，接受客户的交易委托，有的还提供咨询服务\n\n#### 结算公司\n\n- 非营利机构，通常来说，结算公司的会员集合是交易所会员集合的子集\n- 与期货市场相对应，结算管理体系也是分层次的\n    - 首先是交易所结算机构对会员公司的结算，这是第一级结算\n    - 其次是会员公司对其代理的客户进行结算，称为第二级结算\n    - 最终，将逐笔交易风险分级对应到每个市场参与者身上\n\n### 交易制度\n\n#### 价格波动限制与头寸限制\n\n- 许多交易所都限制期货价格每天的波动幅度与投机商持有的头寸\n- 如果交易所不对投机商的头寸进行限制，那么期货市场有可能演变成为多、空双方比拼资金实力的搏杀，变成一个大赌场，从而严重背离建立期货市场的初衷\n- 交易所限制期货价格每天的波动幅度的出发点是为了控制价格过度波动。但是，对是否能够抑制期货价格的长期波动，理论界与实务界都存在争议。此外，控制价格会扭曲期货的价格发现功能，阻碍信息的传递与扩散\n\n#### 交割\n\n- 对冲平仓、实物交割（1%-3%）、现金交割\n\n### 保证金制度\n\n- 每日交易盈亏计算，计算的结果作为收取交易保证金或追加保证金的依据。每个交易日结束时，保证金账户的金额数量都会得到调整。(daily settlement/marking to market)\n- 投资者的损失会从保证金账户里扣除；当保证金账户余额低于维持保证金水平时，投资人会收到保证金催缴，要追加保证金。\n- 当投资人不提供追加保证金时，经纪人将对合约平仓。\n- 远期合约只有在最后到期时才会进行结算，而期货合约每天都需要结算。相当于期货合约每天都要进行一次平仓，然后又以新价格开仓。\n- 对保证金的要求可能取决于交易员的交易目的：\n    - 对对冲者的保证金要求（2%-4%）可能低于对投机者的保证金要求（5%-7%）\n    - 对短线交易（在同一天平仓，day trade）和差价交易的保证金要求可能低于对冲交易的保证金。\n\n优点和问题\n\n- 优点：\n    - 标准化，提高流动性\n    - 结算程序，避免违约风险\n    - 杠杆效应，以小搏大\n- 问题：\n    - 距离交割日较远的期货合约流动性比较差\n    - 保证金账户的管理带来交易成本\n\n### 场外市场\n\n中央交易对手\n\n- 中央交易对手为标准的场外交易进行结算\n\n双边结算\n\n- 不能通过CCP结算的产品都要双边结算\n- 公司双方要签署主协议，提供抵押品，抵押品的功能类似于交易所清算中心或CCP对其会员要求的保证金\n\n### 结算价格\n\n- 用于计算每天合约的盈亏以及所需要的保证金数量\n\n### 交易量和未平仓合约数量\n\n- 交易数量是在一天内交易的合约总份数。\n- 未结权益(open interest)是尚未平仓合约份数的总量，是所有多头的总和，也是所有空头的总和。\n\n## 远期和期货价格\n\n### 投资资产与消费资产\n\n- 投资资产：投资者为了投资目的而持有的资产\n- 消费资产：持有消费资产的主要目的是消费而不是投资（猪肉、油、铜）\n- 对于投资资产，我们可以从无套利假设出发由即期价格与其他市场变量得出远期和期货价格，但对于消费资产做不到这一点。\n\n### 假设与符号\n\n- 假设：\n    - 市场参与者进行交易时没有手续费\n    - 市场参与者对所有交易净利润都使用同一税率\n    - 市场参与者能够以同样的无风险利率借入和借出资金\n    - 当套利机会出现时，市场参与者会马上利用套利机会\n- 符号：\n    - $T$: 远期或期货合约的期限（年）\n    - $S_0$: 远期或期货合约标的资产的当前价格\n    - $F_0$: 远期或期货的当前价格\n    - $r$: 按连续复利的无风险零息利率，期限对应于合约的交割日\n\n### 远期价值与远期价格\n\n#### 在交割前没有现金流\n\n远期价值：远期合约本身的**价值**。\n\n远期价格：使得远期价值为零的合理\u003cu\u003e交割\u003c/u\u003e价格\n\n远期合约的价值（对于多头方）：\n$$\nf=(F_0-K)e^{-r(T-t)}\n$$\n\n- $K$是以前成交的合约的交割价格，合约的交割日期是在从今日起$T-t$年之后，$F_0$表示目前的远期价格，即假如在今天成交的话，合约的\u003cu\u003e交割\u003c/u\u003e价格。\n- 如果今天恰好是合约的最初成交日，那么交割价格$K$等于远期价格$F_0$，$f$等于0.\n- 随着时间的推移，$K$不变，$F_0$不断变动。\n\n\u003e 证明：构造组合：  \n组合A ：今天花$f$以进入这份交割价格为$K$的旧远期合约的多头  \n组合B ：以无风险利率借入一笔数额为$𝐾𝑒^{−𝑟(𝑇−𝑡)}$ 的现金（在期末还款），同时花了$S_0$购买一单位标的资产  \n期末时两种组合的现金流都等于付出合约设定的价格$K$拥有一单位标的资产，因此今天的现金流也必须相等：\n\u003e$$f=S_0-Ke^{-r(T-t)}$$  \n\n\u003e 构造组合：  \n组合A：今天花$f$以进入这份交割价格为$K$的旧远期合约的多头  \n组合B：今天在市场上进入一个新远期合约的多头（意味着交割价格为$F_0$），同时以无风险利率投资$(F_0-K)e^{r(T-t)}$元  \n期末时两种组合的现金流都等于付出合约设定的价格$K$拥有一单位标的资产，因此今天的现金流也必须相等：\n\u003e$$f=(F_0-K)e^{-r(T-t)}$$\n\n\n### 分派红利的情况\n\n#### 确定时点分派的红利\n\n假设标的资产在合约到期之前产生的收入的\u003cu\u003e现值\u003c/u\u003e为$I$：\n$$\nF_0=(S_0-I)e^{rT}\n$$\n\n#### 连续复利\n\n连续复利（红利再投资），标的资产的数量在增长。假设红利率为$q$：\n$$\nF_0=S_0e^{(r-q)T}\n$$\n\n\u003e 证明：  \n组合A：进入一个远期合约的多头  \n组合B：以无风险利率借入$S_0$，全部用来买一单位标的资产  \n期初时两组合的现金流都是0，所以期末时两组合的价值必须相等。\n\u003e $$\\begin{aligned}\nS_T-F_0\u0026=S_T+Ie^{rT}-S_oe^{rT}\\\\\nF_0\u0026=(S_0-I)e^{rT}\n\\end{aligned}$$  \n\n\u003e 组合A：进入一个远期合约的多头  \n组合B：以无风险利率借入$S_0e^{-qT}$，全部用来买$e^{-qT}$单位的标的资产  \n期初时两组合的现金流都是0，所以期末时两组合的价值必须相等。\n\u003e $$\\begin{aligned}\nS_T-F_0\u0026=S_T-S_0e^{（r-q)T}\\\\\nF_0\u0026=S_0e^{(r-q)T}\n\\end{aligned}$$\n\n\n### 外汇远期合约\n\n- 指交易双方约定在未来某一特定日期，双方按照合约签订时约定的汇率和金额，以一种货币交换对方另一种货币的合同\n\n利率平价关系\n$$\n{F}_0=S_0 e^{\\left(r_{1}-r_{2}\\right){T}}\n$$\n其中，$r_1$与$r_2$分别表示报价货币与基本货币的连续复合无风险利率；$F_0$与$S_0$表示远期汇率与即期汇率，它们都是用报价货币来表示基本货币，即1单位的基本货币相当于多少单位的报价货币。\n\n\u003e 证明：两种方式将基本货币转化为报价货币：  \n方式1：现在将一单位的基本货币换成报价货币，再以无风险利率投资一期  \n方式2：先将一单位的基本货币以无风险利率投资一期，再将其换为报价货币\n\u003e $$S_0e^{r_1T}=F_0e^{r_2T},F_0=S_0e^{(r_1-r_2)T}$$\n\n一份远期汇率合约多头头寸的价值等于：\n$$\nf=S_0e^{-r_2T}-Ke^{-r_1T}\n$$\n\n外汇可以看作提供已知收益率的资产。这里的收益率为外汇的无风险利率。\n\n### 商品期货存在收入和贮存费用时\n\n假定U为期货期限之间所有去掉收入后贮存费用的贴现值，有：\n$$\nF_0=(S_0+U)e^{rT}\n$$\n$$\nF_0=S_0e^{(r+u)T}\n$$\n\n#### 消费商品\n\n用于消费而不是投资的商品往往不提供中间收入，但这些商品可能需要很高的贮存费用。\n\n当持有商品的主要目的不是投资时，个人不愿意在即期市场出售商品并买入期货合约，因为远期和期货合约不能用于消费。\n$$\nF_0\\le (S_0+U)e^{rT}\n$$\n$$\nF_0\\le S_0e^{(r+u)T}\n$$\n\n### 便利收益率\n\n便利收益率（convenience yield）：由于持有商品而带来的好处。\n\n持有商品库存可以确保工厂的正常运作，但持有期货显然不能，或许可从暂时的商品短缺中盈利。\n\n便利收益率反映了市场对将来能够购买商品的可能性的期望。商品短缺的可能性越大，便利收益率越高。\n\n$$\nF_0e^{yT}=(S_0+u)e^{rT}\n$$\n$$\nF_0e^{yT}=S_0e^{(r+u)T}\n$$\n$$\nF_0=S_0e^{(r+u-y)T}\n$$\n\n### 持有成本\n\n持有成本：包括贮存成本加上资产的融资利息减去资产的收益。\n\n### 期货价格与预期未来即期价格\n\n|  标的资产  | 资产收益率期望$k$与无风险利率$r$之间的关系 | 期货价格$F_0$与预期未来即期价格$E(S_T)$之间的关系 |\n| :--------: | :----------------------------------------: | :-----------------------------------------------: |\n| 无系统风险 |                   $k=r$                    |                   $F_0=E(S_T)$                    |\n| 正系统风险 |                   $k\u003er$                    |                   $F_0 \u003c E(S_T)$                    |\n| 负系统风险 |                   $k \u003c r$                    |                   $F_0\u003eE(S_T)$                    |\n\n\n\n\n\n### 正常期货溢价和期货倒价\n\n- 现货溢价（normal backwardation）：期货价格低于将来即期价格期望值\n- 期货溢价（contango）：期货价格高于将来即期价格期望值\n\n## 利用期货的对冲策略\n\n### 空头对冲与多头对冲\n\n- 空头对冲（short hedge）：对冲者已经拥有某种资产并期望在将来某时刻卖出资产，或者当前不知道拥有资产但预计未来会拥有资产。\n- 多头对冲（long hedge）：已知在将来需要买入一定资产并想在今天将价格锁定。\n- 在某些行业里，如果对冲不是常规做法，公司选择与别人都不相同的做法也许没有太大意义。\n- 对冲可能会使结果更糟\n\n### 基差风险\n\n实际中的对冲问题：\n\n- 需要对冲价格风险的资产与期货合约的标的资产可能并不完全一样\n- 对冲者可能无法确定买入或卖出资产的准确时间\n- 对冲者可能需要在期货到期月之前将期货平仓\n\n基差\n\n- 基差（basis）=被对冲资产的即期价格-用于对冲的期货合约价格\n- 基差变大时称为基差增强（strengthening of the basis），基差变小时称为基差减弱（weakening of the basis）\n- 基差增强空头获利，基差减弱多头获利\n\n### 对合约的选择\n\n- 对期货合约标的资产的选择\n- 对交割月份的选择：经常选择在稍后月份交割的期货合约，防止实物交割的风险和花费。\n\n### 交叉对冲\n\n- 交叉对冲（cross hedging）：对冲时所用期货的标的资产和被对冲的资产是不一样的。\n- 对冲比率（hedging ratio）：持有期货合约的头寸数量与资产风险敞口数量的比率。\n\n#### 计算最小方差对冲比率\n\n定义：\n\n$\\triangle S$：在对冲期限内，即期价格$S$的变化；\n\n$\\triangle F$：在对冲期限内，期货价格$F$的变化；\n\n$h^*$：最小方差对冲比率。\n\n最小方差对冲比率是$\\triangle S$对$\\triangle F$进行线性回归时所产生的最优拟合直线的斜率。\n$$\nh^*=\\rho \\frac{\\sigma_S}{\\sigma_F}\n$$\n$\\sigma_S, \\sigma_F$是$\\triangle S, \\triangle F$的标准差，$\\rho$是两者之间相关系数。（通过线性回归公式和相关系数公式可推理得到。）\n\n#### 最优合约数量\n\n定义：\n\n$Q_A$：被对冲头寸的数量\n\n$Q_F$：一份期货合约的规模\n\n$N^*$：用于对冲的最优期货合约数量\n$$\nN^*=\\frac{h^*Q_A}{Q_F}\n$$\n\n#### 尾随对冲\n\n- 期货合约每天结算，考虑每一天百分比变化的标准差\n- 期限为一天的比例为：\n\n$$\\hat{\\rho} \\frac{S \\hat{\\sigma}_{s}}{F \\hat{\\sigma}_{F}}$$\n\n- 为下一天所需持有的最优合约数量：\n\n$$N^{*}=\\hat{\\rho} \\frac{S \\hat{\\sigma}_{s} Q_{A}}{F \\hat{\\sigma}_{F} Q_{F}}$$\n\n### 向前滚动对冲\n\n- 对冲的期限要比所有能够利用的期货期限更长，这时对冲者必须对到期的期货进行平仓，同时再进入具有较晚期限的合约。这种做法被称为向前滚动对冲（stack and roll）。\n- 考虑流动性的潜在问题\n\n## 股指期货\n\n- 是指由交易双方签订的，约定在将来某一特定时间和地点交收“一定点数的股票价格指数”的标准化期货合约，亦即是以股票价格指数 （投资组合）为交易标的物的一种期货合约。\n\n### 合约规格\n\n- 合约价格：\u003cu\u003e指数期货价格\u003c/u\u003e乘以一个指数点的价值\n- 指数期货的面值：\u003cu\u003e股票指数\u003c/u\u003e乘以一个指数点的价值\n\n### 最优合约数量\n\n定义：\n\n$V_A$：股票组合的当前价值。\n\n$V_F$：一份期货的当前价值（定义为期货价格乘以期货规模）。\n$$\nN^*=\\beta\\frac{V_A}{V_F}\n$$\n\n### 对冲股权组合的理由\n\n- 传统的股票市场风险管理只是通过调整股票构成和头寸改变投资组合的系统风险\n    - 缺点：\n        - 交易成本高、调整速度慢、可能不得不降低$\\alpha$\n        - 投资者对市场的整体风险很不确定，但确信组合中的股票收益会高于市场的收益。\n- 对冲者计划在很长一段时间内持有股票组合，但需要在短时间内对市场的不确定性进行保护。\n\n### 改变组合的beta\n\n当将组合的beta从$\\beta$变为$\\beta^*$时，\n\n如果$\\beta\u003e\\beta^*$，所持期货空头的数量应当为：\n$$\n(\\beta-\\beta^*)\\frac{V_A}{V_F}\n$$\n如果$\\beta\u003c\\beta^*$，所持期货多头的数量应当为：\n$$\n(\\beta^*-\\beta)\\frac{V_A}{V_F}\n$$\n\n### 锁定挑选股票的优势\n\n投资者确认自己持有的股票将比市场表现要好，持有的股指期货合约空头数量为：\n$$\n\\beta\\frac{V_A}{V_F}\n$$\n其中$\\beta$为持有的股票的beta值，$V_A$为持有的股票价值，$V_F$为一份股指期货合约的价值。\n\n\n",title:"Untitled Page"},"/MBS Duration":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n\n## 久期和凸性的定义\n\n![久期和修正久期](利率及利率衍生品#久期和修正久期)\n\n![久期和修正久期](利率及利率衍生品#凸性)\n\n\n## 有效久期 (Effective Duration)\n\n根据之前提到的[OAS](OAS.md)定义，有效久期的计算方法如下：\n\n- 根据市场价格P计算OAS.\n- 将收益率曲线平行向上移动$\\Delta y$，再加上用市场价格计算出的 OAS重新定价$P^{+}$.\n- 将收益率曲线平行向下移动$\\Delta y$，再加上用市场价格计算出的 OAS重新定价$P^{-}$.\n\n\n有效久期为：\n\n$$\nD=\\frac{P^{-}-P^{+}}{2P\\Delta y} \\times 100\n$$\n\n\n### 有效久期没有考虑的风险因素\n\n#### 国债曲线的变化\n\n在使用上述公式用有效久期预测价格变化时，我们认为整条利率曲线是**平行移动**的，并用10年期国债利率的变化代表整条利率曲线的变化。如果国债曲线的形状变得更陡峭或者更平缓，继续使用久期与利率变化的乘积来预测价格变化就会不够准确。\n\n#### 当前票息价差 (Current Coupon Spread)\n\nCurrent Coupon指的是目前市场价格恰好为面值 (par value) 的MBS的coupon（考虑了servicing fee之后），一般由线性插值得出，可以看做是par value MBS pass-through的yield. 大多数新发起的抵押贷款都以接近面值的票面利率证券化，因此current coupon yield可以被认为是新贷款的二级市场利率 (mortgage rate)。\n\nCurrent Coupon Spread是指current coupon和treasury rate之间的差值，相当于par value MBS pass-through的treasury OAS，也相当于mortgage rate和treasury rate之间的差值。\n\n有效久期的计算假设current coupon spread和国债利率之间是线性关系。但实际并非如此。如果current coupon spread增加，则说明相对于国债利率，贷款利率更高了，借款人的再融资动机减弱，所以提前还款的风险降低，久期增加，价格有可能上升。Current coupon spread的partial duration也因此是负的。利率曲线的形状、波动率、提前还款风险都会影响current coupon spread.\n\n\n#### 凸性或不对称价格变动\n\n由于 MBS 存在[提前偿还风险](MBS%20Modelling.md#早偿情况的分析)，所以利率下降时，再融资比例可能上升，借款人会选择提前偿还手中的贷款。因此对投资者来讲，**这相当于原本很长的久期突然变小了**。所以利率下降时，MBS的久期也有可能变小，其凸性是负的。这意味着，在其他条件相同的情况下，使用有效久期预测价格，将在利率下降时高估价格，而在利率上升时低估价格。\n\n投资于RMBS的机构持有者一般会在多RMBS的同时空国债作为对冲。由于MBS的负凸性性质，**利率上行，MBS久期增加，持有者就要卖空更多的国债以对冲久期，国债利率继续上行**。反之亦然。因此，MBS的负凸性可能是市场利率大幅变动的一个原因。\n\n\n\n#### 利率波动率\n\n利率的波动率可能会随着期限变化而改变，也有可能存在波动率聚集的现象。但使用有效久期预测价格时，认为利率曲线是平行移动的，没有考虑波动率的情况，可能会造成对价格的高估或低估。\n\n## 实际久期 (Empirical Duration)\n\n实际久期是指从市场数据中用回归分析的方式来估计久期。\n\n理论上有\n$$\n\\frac{\\Delta B}{B}=-D\\Delta y\n$$\n\n所以用$\\frac{\\Delta B}{B}$作为因变量，国债利率的变化作为自变量，采用过去一段时间的数据进行回归，回归的斜率估计量$\\beta$就是实际久期。\n\n## 有效久期和实际久期之间的关系\n\n如果其他的风险因素和国债利率变化之间存在相关性，则有效久期和实际久期之间就会有所不同。由线性回归的估计量性质，忽略价格变化的高阶项，有：\n\n$$\nD_{\\text{Empirical Estimate}} = D_{\\text{Current Effective}}+\\mu+D_{s} \\rho_{\\Delta s \\Delta y} \\frac{\\sigma_{\\Delta s}}{\\sigma_{\\Delta y}}+D_{v} \\rho_{\\Delta v \\Delta y} \\frac{\\sigma_{\\Delta v}}{\\sigma_{\\Delta y}}+\\ldots+\\varepsilon\n$$\n\n其中$\\mu$是当前有效久期和实际久期之差的平均值；$\\rho_{\\Delta s \\Delta y}$是相关系数；$\\sigma_{\\Delta s}$是标准差。\n\n如果风险因素的变化（如每日OAS）和国债收益率变化之间呈负相关，那么**实际久期将短于有效久期**。\n\n## 另一种实际久期的计算\n\n实际久期计算中的一个隐含假设是**国债收益率变化会立刻影响到同一天的MBS价格**。然而，流动性不够活跃的MBS不一定满足这个假设。例如，高溢价MBS的流通量很小，大部分交易都在SP进行，而不是TBA市场。因此，高溢价TBA的价格变化通常会滞后于国债收益率的变化，如果用同一天的价格变化进行回归，会导致对实际久期的估计偏低。\n\n为了解决这个问题，可以选用一段时间的MBS价格对国债收益率进行回归 ($ln\\ P =\\alpha + \\beta y+\\varepsilon, \\frac{dP/dy}{P} =−Duration = \\beta$)，斜率就是实际久期的估计量。它描述了**一段时间内**MBS价格和国债收益率水平之间的关系，因此这样计算出的久期可能不利于对冲每天的收益率曲线波动。\n\n## 久期和对冲\n\n有效久期可以对冲收益率曲线平行移动时发生的价格变化。使用有效久期意味着认为其他风险因素不变。\n\n实际久期假设过去的国债收益率变化与其他风险因素变化之间的关系将继续存在且相同。因此，如果风险因素和国债收益率之间的相关性发生了改变，使用实际久期可能会出现错误。\n\n\n\n\n\n\n\n## 参考文献\n\n\nHayre, L. (Ed.). (2001). _Salomon Smith Barney guide to mortgage-backed and asset-backed securities_. John Wiley.\n\n[RMBS随谈录4：RMBS对冲—美国固收市场大幅变动时的尾大摇身现象](https://mp.weixin.qq.com/s/QPGKf8RZiQNxkkNQoj3Rlg)\n\n[Managing Against MBS Indexes: A Duration Perspective](https://www.msci.com/www/blog-posts/managing-against-mbs-indexes-a/02667007821)\n\n[Measuring MBS curve risk with Implied Mortgage Rate Sensitivity (“IMS”) approach](https://research-doc.credit-suisse.com/docView?language=ENG\u0026format=PDF\u0026source_id=csplusresearchcp\u0026document_id=1041260871\u0026serialid=0MH9veO3E0x5Z%2B76qli7rYOAyJDVt7fLdbi2VSkop%2FA%3D\u0026cspId=null)\n\n[Can MBS Duration Turn Negative?](https://www.msci.com/www/blog-posts/can-mbs-duration-turn-negative/02108224451)",title:"Untitled Page"},"/MBS Modelling":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n\n# 抵押贷款支持证券\n\n资产证券化是指将能够产生可预见的稳定现金流的资产，通过一定的结构安排，对资产中风险与收益要素进行分离与重组，进而转换成为在金融市场上可出售、可流通的证券的过程。\n \n设法剥离主体带来的不确定性，以“物的信用”替代“主体信用”，以基础资产“自动变现”产生现金流为偿付支持发行标准化债务证券，通过引入第三方机构、架设结构化交易安排来拆解、控制道德风险，就是“资产支持证券”的核心理念。\n \n最早出现的资产支持证券是20世纪70年代诞生的以住宅抵押贷款为基础资产的RMBS，之后又陆续诞生了以其他信贷资产为支持的证券。\n\n传统的MBS交易结构中没有分层设计，所发行的证券之间不存在偿付次序、风险等级的区别，这种结构被称为“过手型” (pass-through) 结构。相对而言，将现金流进行分层、增信之后再按先后次序支付给不同等级证券投资人的交易结构叫作“转付型” (pay-through) 结构。\n\n和其他固定收益类产品一样，MBS的价值可以用现金流折现进行评估：\n\n$$\nV=\\sum_{i=1}^N\\frac{CF_i}{(1+d)^i}\n$$\n\n其中$d$为折现率 (discount rate). \n\n折现率和当前抵押贷款挂钩的利率种类的远期利率有关，可以采用随机过程模型对远期利率进行建模。如：\nVasicek Model\n$$\ndR_t=a(b-R_t)dt+\\sigma dW_t\n$$\nCIR Model\n$$\ndR_t=a(b-R_t)dt+\\sigma \\sqrt R_t dW_t\n$$\nHull-White Model\n$$\ndR_t=a(b_t-R_t)dt+\\sigma dW_t\n$$\n\n但不同的是，由于借款人可以选择提前偿还贷款，所以每一期的现金流是不确定的，会受到利率的影响。即：\n$$\nCF_i=f(r)\n$$\n\n市场利率上升会导致抵押贷款支持证券出现延长风险 (extension risk)。收益率上行时，预期中的提前还款速度放缓，导致抵押贷款支持证券投资者收回本金的时机延后。投资人将因为延后收回本金而错过在收益率较高时进行再投资的机会。如果利率继续上升，低票息抵押贷款支持证券的价格下跌，高票息抵押贷款支持证券的表现要好于低票息抵押贷款支持证券。\n\n\n市场利率下降将出现抵押贷款者提前清偿的风险 (prepayment risk)，使抵押贷款支持证券投资人被迫降低仓位，存续期限缩短。\n\n因此，在对MBS进行建模时，既要对每一期的折现情况进行建模，也要估计每一期现金流的情况。\n\n\n## 抵押贷款的现金流\n假设某支抵押贷款的年息票利率为$\\hat C$，到期日为$N$个月。令：\n$$\nc=\\frac{\\hat C}{12}, d=\\frac{1}{1+c}\n$$\n假设名义本金为单位1，每月还款额 (Scheduled monthly payment)为$m$，则应该有\n$$\n1=\\sum_{i=1}^N \\frac{m}{(1+c)^i}\n$$\n解得\n$$\nm=\\frac{c}{1-d^N}\n$$\n\n第$j$个月底，设尚未还款的余额为$B_j$，有\n$$\n\\sum_{i=1}^{j}\\frac{m}{(1+c)^i}+B=(1+c)^j\n$$\n得\n$$\nB_j=\\frac{1-d^{N-j}}{1-d^N}\n$$\n第$j$个月的利息偿还额为\n$$\nI_j = cB_{j−1}=\\frac{c\\left(1-d^{N-j+1}\\right)}{1-d^{N}}\n$$\n第$j$个月的本金偿还额为\n$$\nP_j = m-I_j=m-cB_{j−1}=\\frac{cd^{N-j+1}}{1-d^{N}}\n$$\n\n\n## 早偿情况的分析\n\n利率走低时，借款人更倾向于提前还贷，用更低利率的贷款置换现有贷款；利率走高时，借款人则倾向于放慢还贷速度，更多的享受低息好处。\n\n每月早偿率 (single monthly mortality rate, SMM) 衡量了贷款池中在当月提前偿还的比率：\n\n$$\nSMM=\\frac{Scheduled\\ balance − Ending\\ balance}{Scheduled\\ balance}\n$$\n\n条件早偿率 (Conditional Prepayment Rate, CPR) 是SMM的年化结果：\n$$\nCPR=1-(1-SMM)^{12}\n$$\n\n### PSA模型\n\nPSA模型 (Public Securities Association Model) 是估计早偿率的一种经验方法：第一个月的CPR设为0.2%，此后每个月增加0.2%的CPR，直到第30个月后，始终维持CPR为6%不变。150PSA的假设意味着要将PSA模型乘以150%。\n\n该模型的基本假设是，成立时间越久的抵押贷款，提前还贷的可能性越大，越是新贷款，提前还贷的可能性越小；但是，在贷款成立30个月之后，提前还贷比率将稳定在一个恒定的值而不再变化。\n\n\n### 影响早偿率的因素\n\n#### 主要因素\n\n**借款人再融资的动力 (Incentive to Refinance)**\n- 如果市场抵押贷款利率下降，抵押贷款者将有动力提前偿还贷款然后以较低的利率进行再融资，因此提高了早偿率。\n- 一般用现行市场利率和抵押贷款者的利率的差值来衡量借款人再融资的动力。\n\n**贷款持有时间 (Age of a Mortgage)**\n- 抵押贷款人可能因为工作调动、家庭因素、房屋价格影响而选择置换房屋，为此需要清偿抵押贷款，因此房屋换手情况对早偿率有影响。\n- 类似于PSA模型，将房屋换手率和抵押贷款人的贷款持有时间相关联，一般贷款账龄在30个月时CPR将达到顶峰。\n\n\n**季节因素**\n- 不同的月份和季度，还款人提前偿还的概率不同，主要和家庭因素相关（如为孩子上学而搬家），房屋的销售也有季节性。\n\n**贷款人的倦怠 (Borrower Burnout)**\n- 虽然一般情况下，利率下降会导致借款人有动力进行再融资，但有些时候会发现，即使利率下降，借款人也没有提前偿还。这可能是因为借款人此前已经提前还款过了，或者是这个池中的借款人对利率不敏感，不会进行再融资。\n- Burnout是用来捕捉某个特定的MBS中不同贷款的异质性，关注这个池中借款人之前的提前偿还记录，通过之前的行为来推测之后是否会有提前偿还的动力。\n	- 再融资速度：通过借款人从利率下降到进行再融资的反应时间判断这是一个快速还款人还是一个慢速还款人\n	- 逆向选择：信用条件较好的借款人会比信用条件更差的还款人更快进行再融资   \n$$\n\\text{burnout} = \\text{exp}^{\\beta_1\\times \\text{Loan\\ Age}+\\beta_2\\times \\text{Incentive}}\n$$\n$$\n\\text{where Incentive = Max[(Note rate − Mtg. rate), Start value]}\n$$\n- 其中$\\beta_1,\\beta_2$可以根据经验确定Burnout衡量了某个借款人是否会是快速还款人的先验概率。\n\n#### 其他因素\n\n**房价 (House Price Index, HPI)**\n**信用评分 (FICO)**\n**债务收入比 (Debt-to-Income Ratio, DTI)**\n**贷款价值比 (Loan-to-Value Ratio, LTV)**\n**贷款余额**\n- 由于再融资存在固定费用，对贷款余额较低的借款人来说，固定费用的占比会上升，所以余额较低的借款人需要更高的市场利率和原贷款利率差值才有提前还款再融资的动机。\n\n**贷款期限**\n- 通常，具有更强信用和更大财务灵活性的借款人会选择更短的摊销期限，这意味着 15 年的借款人可能比 30 年的借款人表现出更大的再融资倾向。\n\n**贷款利率类型**\n- 与标准固定利率抵押贷款相比，借款人可以选择可调整利率或混合抵押贷款（初始固定利率随后是可调整利率的抵押贷款），以获得较低的相对起始付款。不断浮动的贷款利率可能会激励借款人再融资。\n\n\n### 生存分析建模\n\nSchwartz和Torous利用1978-1987的美国30年期GNMA MBS数据，建立生存分析(survival analysis)模型，用Cox Proportional-hazards Model来对早偿率进行建模。\n\n设某个抵押贷款从开始到提前偿还的时间为连续随机变量$T$，$t$是其实现。设$\\underline{v}=\\left(v_{1}, v_{1}, \\cdots, v_{s}\\right)$为由影响早偿率的各种变量组成的向量，$\\underline{\\theta}=\\left(\\theta_{1}, \\theta_{2}, \\cdots, \\theta_{k}\\right)$是需要估计的系数值。早偿率函数$\\lambda(t ; \\underline{v}, \\underline{\\theta})$可以写为：\n$$\n\\begin{aligned}\n\\lambda(t ; \\underline{v}, \\underline{\\theta}) \u0026=\\lim _{\\Delta t \\rightarrow 0^{+}} \\frac{P(t \\leq T\u003ct+\\Delta t \\mid T \\geq t)}{\\Delta t} \\\\\n\u0026=\\frac{f(t ; \\underline{v}, \\underline{\\theta})}{F(t ; \\underline{v}, \\underline{\\theta})}\n\\end{aligned}\n$$\n其中$f(t)$是$T$的概率密度函数，$F(t)$是$T$的分布函数。\n$$ \nF(t ; \\underline{v}, \\underline{\\theta})=P(T \\geq t \\mid \\underline{v}, \\underline{\\theta}) \n$$\n\n$$ \nf(t ; \\underline{v}, \\underline{\\theta})=\\lim _{\\Delta t \\rightarrow 0^{+}} \\frac{P(t \\leq T\u003ct+\\Delta t)}{\\Delta t}=-\\frac{dF(t)}{dt}\n$$\n\n使用Cox Proportional-hazards Model对早偿率进行建模：\n\n$$\n\\lambda(t ; \\underline{v}, \\underline{\\theta})=\\lambda_{0}(t ; \\gamma, p) \\exp (\\underline{\\beta} \\underline{v})\n$$\n其中基准风险函数 (base-line hazard function) $\\lambda_{0}(t ; \\gamma, p)$由对数逻辑斯谛函数(log-logistic hazard function)的形式给出\n\n$$\n\\lambda_{0}(t ; \\gamma, p)=\\frac{\\gamma p(\\gamma t)^{p-1}}{1+(\\gamma t)^{p}}\n$$\nBase-line hazard function衡量的是没有考虑其它解释变量时提前偿还的风险： $\\underline{v}=\\underline{0}$. Log-logistic hazard function考虑了早偿率和贷款年龄之间的关系。如果$p\u003e1$, 提前偿还的风险从0逐渐上升到最大值：\n$$\nt^{*}=(p-1)^{1 / p} / \\gamma\n$$\n\n$\\underline{v}$中还包括影响MBS价格的其他因素，包括借款人的还款激励、此前提前还款的情况、季节因素等。\n\n\n## 违约情况的分析\n\n### 影响违约率的因素\n\n**房价 (House Price Index, HPI)**\n**信用评分 (FICO)**\n**债务收入比 (Debt-to-Income Ratio, DTI)**\n**贷款价值比 (Loan-to-Value Ratio, LTV)**\n**贷款金额 (Loan Size) 及其对数**\n**贷款种类**\n	- 固定利率、浮动利率等\n**物业类型**\n	- 独栋、3-4人合并住宅等\n**占有人类型 (Occupancy Type)**\n	- 原所有人占有（owner-occupied）、第二住宅（second home）、非所有人占有（non-owner-occupied）等\n**借款目的 (Loan Purpose)**\n	- 购买住宅 (Purchase)\n	- 再融资 (Refinance)\n	- 将住宅再融资以取得现金 (Cashout)\n\n### 对违约过程建模\n\nMBS的违约过程是一个多状态的过程，可以看作一个连续时间的马尔科夫链：\n$$\nS=\\left[\\begin{array}{l}\nS_{1} \\\\\nS_{2} \\\\\nS_{3} \\\\\nS_{4} \\\\\nS_{5}\n\\end{array}\\right]=\\left[\\begin{array}{c}\n\\text { Current } \\\\\n60+\\text { Days Delinquent } \\\\\n\\text { In Foreclosure } \\\\\n\\text { REO } \\\\\n\\text { Liquidated }\n\\end{array}\\right]\n$$\n\n$$\nD(t)=\\left[\\begin{array}{ccccccc}\n-\\lambda_{1}(t) \u0026 \\lambda_{1}(t) \u0026 0 \u0026 0 \u0026 \\ldots \u0026 0 \u0026 0 \\\\\n0 \u0026 \\lambda_{2}(t) \u0026 -\\lambda_{2}(t) \u0026 0 \u0026 \\cdots \u0026 0 \u0026 0 \\\\\n\\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \\\\\n0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\ldots \u0026 -\\lambda_{n-1}(t) \u0026 \\lambda_{n-1}(t) \\\\\n0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\ldots \u0026 0 \u0026 0\n\\end{array}\\right]\n$$\n其中 $\\lambda_{j}(t)$ 是transitions $S_{j} \\rightarrow S_{j+1}$过程的风险函数。\n\n因此可以将MBS的违约步骤分拆成几个生存分析过程，然后再对每个过程进行建模。\n\n## 房价指数分析\n\n房屋价格水平会影响早偿率和违约率。如果房价下跌，借款人违约的可能性升高。对HPI/HPA的建模是一个比较复杂的过程，可以考虑将HPI看作一个随机过程：\n$$\nd HPI =a dt +\\sigma_w dz\n$$\n$\\sigma_w$是波动率，$a$是漂移，$z$是布朗运动。\n\nHPA（房价指数增长率）是HPI的年回报率。白噪声+扩散模型可以用来对HPA进行建模：有：\n$$\nHPA=\\frac{d HPI}{dt} = a+\\sigma_w w\n$$\n\n\n设$\\sigma_d$是HPA扩散的波动率，一阶扩散模型的理论统计量的函数是\n\n$$\n\\begin{gathered}\n\\operatorname{stdev}[H P A(t)]=\\left[\\sigma_{d}^{2} \\frac{1-e^{-2 a t}}{2 a}+\\sigma_{w}^{2}\\right]^{\\frac{1}{2}} \\\\\n\\operatorname{Corr}[\\operatorname{HPA}(T), H P A(t+T)] \\underset{T \\rightarrow \\infty}{\\rightarrow e^{-a t} \\frac{1}{1+2 a \\sigma_{w}^{2} / \\sigma_{d}^{2}}}\n\\end{gathered}\n$$\n\n\n## Reference\n\n[Andrew Lesniewski, Interest Rate and Credit Models: 13. Mortgage Backed Securities](https://mfe.baruch.cuny.edu/wp-content/uploads/2019/12/IRC_Lecture13_2019.pdf)\n\nSchwartz, E. S., and W. N. Torous, 1989, “Prepayment and the Valuation of Mortgage-Backed Securities,” Journal of Finance, 44, 375–392.\n\nDavidson, A., and Levin, A.: Mortgage Valuation Models: Embedded Options, Risk, and Uncertainty, Oxford University Press (2014).\n\nGlenn M. Schultz: Investing in Mortgage-Backed and Asset-Backed Securities, Wiley Finance, 2015\n\n[李力，雕刻现金流：从证券化到项目融资，中信出版集团股份有限公司，2017](https://weread.qq.com/web/reader/78c32f805e10dc78c9981c5kc81322c012c81e728d9d180)\n\n[林华，中国资产证券化产品投资手册，中信出版集团股份有限公司，2017](https://weread.qq.com/web/reader/cab3224071ae93c6cabb193kc81322c012c81e728d9d180)\n\n\n",title:"Untitled Page"},"/MOC":{content:"## Stats\n\n[Probability and Random Process](Probability%20and%20Random%20Process.md)\n\n[Statistical Inference](Statistical%20Inference.md)\n\n[Regression Analysis](Regression%20Analysis.md)\n\n[Econometrics](计量经济学.md)\n\n\n\n## Finance\n\n\n\n\n[Options](Options.md)\n\n[Futures](Futures.md)\n\n[Swaps](Swap.md)\n\n[Rates](利率及利率衍生品.md)\n\n[MBS Modelling](MBS%20Modelling.md)\n\n[OAS](OAS.md)\n\n[MBS Duration](MBS%20Duration.md)\n\n[Financial Market](金融市场与金融机构.md)\n\n[Money and Banking](货币金融学.md)\n\n[Dollar Roll](TBA%20Market%20and%20Dollar%20Roll.md)\n\n\n## Coding\n\n\n\n[Data Preprocessing and EDA](Data%20Preprocessing%20and%20EDA.md)\n\n",title:"Untitled Page"},"/OAS":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n## MBS的内嵌期权\n\n当贷款发放之后，借款人存在[提前偿还的权利](MBS%20Modelling.md#早偿情况的分析)，可以灵活地根据利率水平选择是否提前偿还。\n\n如果利率变低，借款人可以选择再融资，以更低的价格获得同样的贷款。拥有看涨期权 (call option) 意味着可以通过较低的价格来获得标的资产，所以抵押贷款的借款人相当于拥有一个看涨期权；类似地，MBS的投资者则相当于卖出一个看涨期权 (short a call option). 同样，借款人也有选择违约并将抵押物（住房）还给银行的权利，相当于拥有一个看跌期权（房价跌到比贷款的价值还低）；类似地，MBS的投资者则相当于卖出一个看跌期权 (short a put option). \n\n因此，MBS可以看做**内嵌期权**的固定收益产品，可以用**Option-Adjusted Spread**来衡量期权因素对价格的影响。\n\n## OAS的计算方法\n\nOAS是基于不同状态下的利率$r_{t}$使得MBS预期现金流的现值等于该MBS的市场价格所需收益率价差。可以按以下方法倒解出OAS：\n\n设$r_{t}, t=1, \\cdots, T$是利率曲线，给定$r_{j t}, t=1, \\cdots, T$是状态 $j=1, \\cdots, N$下的利率，每个状态下MBS的现金流可以由$C_{j t}, t=1, \\cdots, T$确定，OAS被定义为：\n$$\nV_{M B S}=\\sum_{j=1}^{N} p_{j}\\left[\\sum_{t=1}^{T} \\frac{C_{j t}}{\\left(1+r_{j 1}+O A S\\right) \\times \\cdots\\left(1+r_{j t}+O A S\\right)}\\right]\n$$\n其中 $p_{j}$ 是状态 $j$的概率。\n\n常见的利率模型有以下几种：\n\n**Vasicek Model**\n$$\ndR_t=a(b-R_t)dt+\\sigma dW_t\n$$\n**CIR Model**\n$$\ndR_t=a(b-R_t)dt+\\sigma \\sqrt R_t dW_t\n$$\n**Hull-White Model**\n$$\ndR_t=a(b_t-R_t)dt+\\sigma dW_t\n$$\n\n通过**蒙特卡洛**模拟不同的利率曲线随机变化的情况，可以计算出OAS.\n\n\n## OAS与Z-Spread\n\nZ-Spread是基于目前的即期利率曲线 (spot curve) 计算出的使现金流的现值等于市场价格的价差。\n\n$$\nP=\\sum_{t=1}^{T} \\frac{C_{t}}{\\left(1+r_{t}+Z\\right) ^t}\n$$\n\n其中$r_t$是目前$t$年期的即期利率。\n\n例如，某三年期债券目前的价格为104.90，coupon rate为5%，每年付息一次。相应的一年、两年和三年期零息国债利率（每半年复利一次）分别为2.5%、2.7%和3%。计算Z-Spread的方法为：\n\n$$\n104.9 = \\frac{5}{(1+\\frac{0.025+Z}{2})^2}+\\frac{5}{(1+\\frac{0.027+Z}{2})^4}+\\frac{105}{(1+\\frac{0.03+Z}{2})^6}\n$$\n\n\nZ-Spread和OAS的差值可以衡量投资者由于short an option导致的收益率变化：\n\n$$\nZ-Spread = OAS+Option\\ Cost\n$$\n\n例如，如果现在以下两个MBS的Z-Spread和OAS如下所示：\n\n| | MBS 4.00% | MBS 5.50%|\n|---|---|---|\n|Zero Volatility Spread |1.22% |2.09%|\n|Option-Adjusted Spread |0.49%| 0.19%|\n\n则MBS 4.00%的short option value为0.73%，MBS 5.50%的short option value为1.90%. OAS说明了投资者卖出期权的价值，在这个例子中MBS 5.50%的short option value更高，所以MBS 5.50%的YTM更高。\n\n与静态现金流分析相比，OAS可以更清晰地让投资者理解MBS的模型价格。通过选取不同的利率模型，投资者可以观察不同收益率曲线形状的影响，并对**未来的利率进行了模拟**，研究利率对MBS收益率的影响。但OAS分析受限于利率模型和提前还款模型的选取，不同的模型构建方法会影响OAS的分析结果。\n\n## Reference\n\nGlenn M. Schultz: Investing in Mortgage-Backed and Asset-Backed Securities, Wiley Finance, 2015",title:"Untitled Page"},"/Options":{content:"## Properties of Options\n\n### Factors affecting option prices\n![](Pasted%20image%2020220220232341.png)\n\n### Call-Put Parity\n\nPortfolio A : one European call option plus a zero-coupon bond that provides a payoff of $K$ at time $T$ Portfolio B : one European put option plus one share of the stock.\n\n$$c+Ke^{-rT}=p+S_0$$\n\n### American Options\n\n-   It is **never optimal to exercise an American call option** on a non-dividend-paying stock before the expiration date.\n-   A call option, when held instead of the stock itself, in effect insures the holder against the stock price falling below the strike price. Once the option has been exercised and the strike price has been exchanged for the stock price, this insurance vanishes.\n-   The time value of money. From the perspective of the option holder, the later the strike price is paid out the better.\n-   _What if the investor thinks the stock is currently overpriced and is wondering whether to exercise the option and sell the stock? In this case, the investor is better off selling the option than exercising it._\n\n$$C\\geq c\\geq S_0-Ke^{-rT}\u003eS_0-K$$\n\n-   It can be optimal to exercise an American put option on a non-dividend-paying stock early. Indeed, at any given time during its life, the put option should always be exercised early if it is sufficiently deep in the money.\n\n## Trading Strategies\n\n### Principal-protected notes\n\n-   A 3-year zero-coupon bond with a principal of $1,000\n-   A 3-year at-the-money European call option on the stock portfolio.\n\n### Option and Underlying Asset\n\n-   writing a covered call: the portfolio consists of **a long position in a stock** plus **a short position in a European call option.**\n-   protective put strategy: the investment strategy involves **buying a European put option** on a stock and **the stock itself.**\n\n### Bull Spreads\n\n-   **buying** a European **call** option on a stock with a certain strike price and **selling** a European **call** option on the same stock **with a higher strike price**. Both options have the same expiration date.\n-   The strategy can be described by saying that the investor has a call option with a strike price equal to $K_1$ and has chosen to give up some upside potential by selling a call option with strike price $K_2 (K2 \u003e K1)$.\n\n### Bear Spreads\n\n-   Bear spreads can be created by **buying** a European **put** with one strike price and **selling** a European **put** with another strike price. The strike price of the option purchased is greater than the strike price of the option sold.\n-   The investor has bought a put with a certain strike price and chosen to give up some of the profit potential by selling a put with a lower strike price\n\n### Box Spreads\n\n-   A box spread is a combination of a bull call spread with strike prices $K_1$ and $K_2$ and a bear put spread with the same two strike prices.\n-   The payoff from a box spread is always $K_2-K_1$. The value of a box spread is therefore always the present value of this payoff or $(K_2-K_1)e^{-rT}$ .\n\n### Butterfly Spreads\n\n-   A butterfly spread involves positions in options with three different strike prices.\n-   It can be created by\n    -   buying a European call option with a relatively low strike price $K_1$,\n    -   buying a European call option with a relatively high strike price $K_3$,\n    -   and selling two European call options with a strike price $K_2$ that is halfway between $K_1$ and $K_3$.\n-   Generally, $K_2$ is close to the current stock price.\n\n### Calendar Spreads\n\n-   A calendar spread can be created by **selling a European call option with a certain strike price** and **buying a longer-maturity Eurpean call option with the same strike price.**\n-   The longer the maturity of an option, the more expensive it usually is.\n\n### Straddle\n\n-   buying a European call and put with the same strike price and expiration date.\n\n### Strips\n\n-   A strip consists of a long position in **one European call and two European puts** with the same strike price and expiration date.\n-   In a strip the investor is betting that there will be a big stock price move and considers a decrease in the stock price to be more likely than an increase.\n\n### Straps\n\n-   A strap consists of a long position in **two European calls and one European put** with the same strike price and expiration date.\n-   In a strap the investor is also betting that there will be a big stock price move. However, in this case, an increase in the stock price is considered to be more likely than a decrease.\n\n### Strangles\n\n-   In a strangle, an investor **buys a European put and a European call with the same expiration date and different strike prices**.\n\n## Binomial Tree\n\n### Riskless\n\nWe imagine a portfolio consisting of a long position in $H$ shares and a short position in one option. At the beginning, the value is\n\n$$HS_0+C_0$$\n\nIf there is an up movement in the stock price, the value of the portfolio at the end of the life of the option is\n\n$$HS_u+C_u$$\n\nIf there is a down movement in the stock price, the value becomes\n\n$$HS_d+C_d$$\n\nRiskless:\n\n$$HS_u+C_u=HS_d+C_d=e^{r}(HS_0+C_0)$$\n\nCalculate $C_0$.\n\n### Replicate Portfolios\n\nWe imagine a portfolio consisting of a long position in $H$ shares and $B$ bonds.\n\n$$HS_u+e^{r}B=C_u,\\ HS_d+e^{r}B=C_d$$\n\n$$C_0=HS_0+B$$\n\n### Risk Neutral\n\nThe option pricing formula in equation does not involve the probabilities of the stock price moving up or down.\n\nThe probabilities of future up or down movements are already incorporated into the stock price: we do not need to take them into account again when valuing the option in terms of the stock price.\n\nA risk-neutral world has two features that simplify the pricing of derivatives:\n\n-   The expected return on a stock (or any other investment) is the risk-free rate.\n-   The discount rate used for the expected payoff on an option (or any other instrument) is the risk-free rate.\n\n$$S_0=e^{-r}[qS_u+(1-q)S_d]$$\n\nsolve $q$, and plug in:\n\n$$C_0=e^{-r}[qC_u+(1-q)C_d]$$\n\n### Derivation the BSM Formula from a Binomial Tree\n\n**See John Hull OFD C13 Appendix**\n\n## Continuous Time Finance\n\n### Brownian Motion\n\nA continuous stochastic process $W(t), t \\geq 0,$ is a Brownian motion if\n\n-   $W(0)=0$\n-   The increments of the process $W\\left(t_{1}\\right)-W(0), W\\left(t_{2}\\right)-W\\left(t_{1}\\right), \\cdots, W\\left(t_{n}\\right)-W\\left(t_{n-1}\\right),$$\\forall 0 \\leq t_{1} \\leq t_{2} \\leq \\cdots \\leq t_{n}$ are independent\n-   Each of these increments is normally distributed with distribution $W\\left(t_{i+1}\\right)-W\\left(t_{i}\\right) \\sim N\\left(0, t_{i+1}-t_{i}\\right)$\n\n### Ito Formula\n\n$$d f=\\left(\\frac{\\partial f}{\\partial t}+\\beta(t, X) \\frac{\\partial f}{\\partial x}+\\frac{1}{2} \\gamma^{2}(t, X) \\frac{\\partial^{2} f}{\\partial x^{2}}\\right) d t+\\gamma(t, X) \\frac{\\partial f}{\\partial x} d W(t)$$\n\nfrom Taylor's formula as quadratic variation = $dWdW=dt$\n\n### BSM Formula\n\nAssumptions\n\n1.  The stock price follows $dS_t=\\mu S_t dt+\\sigma S_t dW_t$ with $\\mu$ and $\\sigma$ constant.\n2.  The short selling of securities with full use of proceeds is permitted.\n3.  There are no transaction costs or taxes. All securities are perfectly divisible.\n4.  There are no dividends during the life of the derivative.\n5.  There are no riskless arbitrage opportunities.\n6.  Security trading is continuous.\n7.  The risk-free rate of interest is constant and the same for all maturities.\n\n#### Lognormal Property of Stock Prices\n\nStock Price\n\n$$dS_t=\\mu S_t dt+\\sigma S_t dW_t$$\n\nReturn\n\n$$dR_t=\\mu dt+\\sigma dW_t$$\n\n#### Reallocate the wealth\n\nA self-financing strategy to reallocate the wealth $X_t$:\n\n-   long or short $\\Delta_t$ shares of stocks;\n-   borrow or lend the $X_t-\\Delta_tS_t$ amount of money\n\n$$\\begin{aligned}dX_t\u0026=\\Delta_tdS_t+r(X_t-\\Delta_tS_t)dt\\\\\u0026=\\Delta_t[\\mu S_tdt+\\sigma S_tdW_t]+r(X_t-\\Delta_tS_t)dt\\\\\u0026=[rX_t+\\Delta_t(\\mu-r)S_t]dt+\\Delta_t\\sigma S_tdW_t\\end{aligned}$$\n\n#### Calculate call option's value\n\nSuppose that $c$ is the price of a call option on the stock. The variable $c$ must be some function of $S$ and $t$, i.e. $c(S_t,t)$. Hence, by using Ito formula,\n\n$$\\begin{aligned}\u0026 d c(t, S_t) \\\\=\u0026 c_{t}(t, S_t) d t+c_{x}(t, S_t) d S_t+\\frac{1}{2} c_{x x}(t, S_t) d[S, S](t) \\\\=\u0026\\left[c_{t}(t, S_t)+\\mu S(t) c_{x}(t, S_t)+\\frac{1}{2} \\sigma^{2} S^{2}_t c_{x x}(t, S_t)\\right] d t \\\\\u0026+\\sigma S_t c_{x}(t, S_t) d W_t\\end{aligned}$$\n\n#### $dX_t=dc(t,S_t)$\n\nWe have\n\n$$c_t(t,S_t)+rS_tc_x(t,S_t)+\\frac{1}{2}\\sigma^2S^2_tc_{xx}(t,S_t)-rc(t,S_t)=0$$\n\nthe terminal condition\n\n$$c(T,S_t)=(S_t-K)^{+}$$\n\n#### BSM Formulas\n\n$$\\begin{array}{c} c=S_{0} N\\left(d_{1}\\right)-K e^{-r T} N\\left(d_{2}\\right) \\\\ p=K e^{-r T} N\\left(-d_{2}\\right)-S_{0} N\\left(-d_{1}\\right) \\end{array}$$\n\n$$\\begin{array}{l} d_{1}=\\frac{\\ln \\left(S_{0} / K\\right)+\\left(r+\\sigma^{2} / 2\\right) T}{\\sigma \\sqrt{T}} \\\\ d_{2}=\\frac{\\ln \\left(S_{0} / K\\right)+\\left(r-\\sigma^{2} / 2\\right) T}{\\sigma \\sqrt{T}}=d_{1}-\\sigma \\sqrt{T} \\end{array}$$\n\nThe term $N(d_2)$ is the probability that a call option will be exercised in a risk-neutral world.\n\nThe expression $S_0N(d_1)e^{rT}$ is the expected stock price at time $T$ in a risk-neutral world when stock prices less than the strike price are counted as zero.\n\nSolve the PDE, or connect between stochastic processes and PDEs with **Feynman-Kac Theorem.**\n\n### Martingale Method\n\nLet\n\n$$d \\tilde{W}_{t}=\\frac{\\mu-r}{\\sigma} d t+d W_{t}$$\n\nWe have\n\n$$\\begin{aligned}d S_{t} \u0026=\\mu r S_{t} d t+\\sigma S_{t}\\left(d W_{t}^{Q}-\\frac{\\mu-r}{\\sigma} d t\\right) \\\\\u0026=r S_{t} d t+\\sigma S_{t} d W_{t}^{Q}\\end{aligned}$$\n\nUnder $Q$, we have the following martingales:\n\n-   the discounted underlying asset price $e^{-rt}S_t$\n-   the discounted replicating portfolio value $e^{-rt}X_t$\n-   the discounted option price $e^{-rt}V_t$\n\nThe Q-martingale property leads to\n\n$$\\begin{aligned}c(t,S_t)=V_{t} \u0026=e^{-r(T-t)} E^{Q}\\left[\\left(S_{T}-K\\right) \\cdot \\mathbf{1}_{\\left\\{S_{T} \\geq K\\right\\}} \\mid \\mathcal{F}_{t}\\right] \\\\\u0026=S_{t} Q\\left\\{x \\geq-d_{2}-\\sigma \\sqrt{T-t}\\right\\}-K e^{-r(T-t)} Q\\left\\{x \\geq-d_{2}\\right\\} \\\\\u0026=S_{t} N\\left(d_{1}\\right)-K e^{-r(T-t)} N\\left(d_{2}\\right)\\end{aligned}$$\n\n## Greeks\n\n$$\\text { Delta: } \\Delta=\\frac{\\partial f}{\\partial S} ; \\text { Gamma: } \\Gamma=\\frac{\\partial^{2} f}{\\partial S^{2}} ; \\text { Theta: } \\Theta=\\frac{\\partial f}{\\partial t} ; \\text { Vega: } v=\\frac{\\partial f}{\\partial \\sigma} ; \\text { Rho: } \\rho=\\frac{\\partial f}{\\partial r}$$\n\n### Naked and covered positions\n\n#### naked position\n\n-   One strategy open to the financial institution is to do nothing.\n\n#### covered position\n\n-   This involves buying 100,000 shares as soon as the option has been sold. If the option is exercised, this strategy works well, but in other circumstances it could lead to a significant loss.\n\n### A stop-loss strategy\n\n-   an institution that has written a call option with strike price $K$ to buy one unit of a stock. The hedging procedure involves buying one unit of the stock as soon as its price rises above $K$ and selling it as soon as its price falls below $K$.\n\nProblem\n\n-   The first is that the cash flows to the hedger occur at different times and must be discounted. The second is that purchases and sales cannot be made at exactly the same price K.\n\n### Delta hedging\n\n-   Delta is defined as the rate of change of the option price with respect to the price of the underlying asset.\n\n$$\\Delta(call)=N(d_1),\\ \\Delta(put)=N(d_1)-1$$\n\n#### Dynamic Aspects of Delta Hedging\n\n-   Derivatives dealers usually rebalance their positions once a day to maintain delta neutrality.\n\n### Theta\n\n-   The theta of a portfolio of options is the rate of change of the value of the portfolio with respect to the passage of time with all else remaining the same.\n-   **time decay**\n-   As time passes with all else remaining the same, the option tends to become less valuable.\n-   When the stock price is very low, theta is close to zero.\n-   For an at-the-money call option, theta is large and negative.\n\n### Gamma\n\nThe gamma of a portfolio of options on an underlying asset is the rate of change of the portfolio’s delta with respect to the price of the underlying asset.\n\n$$\\Delta \\Pi=\\Theta \\Delta t+\\frac{1}{2} \\Gamma \\Delta S^{2}$$\n\n#### Making a Portfolio Gamma Neutral\n\n-   Delta neutrality provides protection against relatively small stock price moves between rebalancing.\n-   Gamma neutrality provides protection against larger movements in this stock price between hedge rebalancing.\n\n$$w_{T}=-\\Gamma/\\Gamma_T$$\n\n### Relationship between Delta, Theta, and Gamma\n\n$$\\Theta+rS\\Delta+\\frac{1}{2}\\sigma^2 S^2\\Gamma=r\\Pi$$\n\n-   theta can to some extent be regarded as a proxy for gamma in a delta-neutral portfolio.\n\n### Vega\n\n-   the rate of change of the value of the portfolio with respect to the volatility of the underlying asset.\n-   If a hedger requires a portfolio to be both gamma and vega neutral, **at least two traded derivatives** dependent on the underlying asset must usually be used.\n-   When volatilities change, the implied volatilities of short-dated options tend to change by more than the implied volatilities of long-dated options. The vega of a portfolio is therefore often calculated by changing the volatilities of long-dated options by less than that of short-dated options.\n\n### Rho\n\n-   The rho of a portfolio of options is the rate of change of the value of the portfolio with respect to the interest rate.\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1c65c777-465e-42c5-9d70-53f782174b16/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1c65c777-465e-42c5-9d70-53f782174b16/Untitled.png)\n\n## Volatility Smile\n\n-   The volatility smile defines the relationship between the implied volatility of an option and its strike price.\n-   For equity options, the volatility smile tends to be downward sloping.\n    -   This means that **out of-the-money puts** and **in-the-money calls** tend to have high implied volatilities whereas **out-of-the-money calls** and **in-the-money puts** tend to have low implied volatilities.\n-   For foreign currency options, the volatility smile is U-shaped.\n    -   Both out-of-the-money and in-the-money options have higher implied volatilities than at-the-money options.\n-   A refinement of this is to calculate the volatility smile as the relationship between the implied volatility and $K/S_0$ or $K/F_0$, where $F_0$ is the forward price of the asset for a contract maturing at the same time as the options that are considered.\n-   Yet another approach to defining the volatility smile is as the relationship between the implied volatility and the delta of the option.\n\n## Exotic Options\n\n### Perpetual American Options\n\nA perpetual derivative has $T=\\infty$.\n\nRecall Black-Scholes equation:\n\n$$c_t(t,S_t)+rS_tc_x(t,S_t)+\\frac{1}{2}\\sigma^2S^2_tc_{xx}(t,S_t)-rc(t,S_t)=0$$\n\nThe term $c_t(t,S_t)$ disappears from the equation due to time-homogeneity, and we get an **ODE instead of a PDE.**\n\n### Bermudan Options\n\nEarly exercise may be restricted to **certain dates**.\n\n### Gap Options\n\nA gap call option is a European call options that pays off $S_T-K_1$ when $S_T \u003e K_2$.\n\nThe difference between a gap call option and a regular call option with a strike price of $K_2$ is that the payoff when $S_T \u003e K_2$ is increased by $K_2-K_1$.\n\n### Forward Start Options\n\nForward start options are options that will **start at some time in the future**. Sometimes employee stock options can be viewed as forward start options.\n\n### Compound Options\n\nCompound options are options on options. Compound options have two strike prices and two exercise dates.\n\nConsider, for example, a call on a call. On the first exercise date, $T_1$, the holder of the compound option is entitled to pay the first strike price, $K_1$, and receive a call option.\n\nThe call option gives the holder the right to buy the underlying asset for the second strike price, $K_2$, on the second exercise date, $T_2$. The compound option will be exercised on the first exercise date only if the value of the option on that date is greater than the first strike price.\n\n### Barrier Options\n\nBarrier options are options where the payoff depends on whether the underlying asset’s price reaches a certain level during a certain period of time.\n\nA **knock-out option** ceases to exist when the underlying asset price reaches a certain barrier; **a knock-in option** comes into existence only when the underlying asset price reaches a barrier.\n\n### Binary Options\n\nBinary options are options with discontinuous payoffs.\n\nA simple example of a binary option is a **cash-or-nothing call**. This pays off nothing if the asset price ends up below the strike price at time $T$ and pays a fixed amount, $Q$, if it ends up above the strike price.\n\n### Lookback Options\n\nThe payoffs from lookback options depend on the maximum or minimum asset price reached during the life of the option.\n\nThe payoff from a floating lookback call is the amount that the final asset price exceeds the minimum asset price achieved during the life of the option.\n\nThe payoff from a floating lookback put is the amount by which the maximum asset price achieved during the life of the option exceeds the final asset price.\n\n### Shout Options\n\nA shout option is a European option where the holder can ‘‘shout’’ to the writer at one time during its life.\n\nAt the end of the life of the option, the option holder receives **either the usual payoff from a European option or the intrinsic value at the time of the shout, whichever is greater**.\n\n### Asian Options\n\nAsian options are options where the payoff depends on the **arithmetic average** of the price of the underlying asset during the life of the option.\n\n### Exchange Options\n\nAn option to buy yen with Australian dollars is, from the point of view of a US investor, an option to exchange one foreign currency asset for another foreign currency asset.\n\nA stock tender offer is an option to exchange shares in one stock for shares in another stock.\n\n### Options Involving Several Options\n\nRainbow options. European basket option.\n\n### Volatility Swap\n\nA volatility swap is an agreement to exchange the realized volatility of an asset between time $0$ and time $T$ for a prespecifed fixed volatility.\n\n## Real Options\n\n### Extension of the Risk Neutral Valuation Method\n\nthe market price of risk for a variable $\\theta$ was defined as\n\n$$\\lambda=\\frac{\\mu-r}{\\sigma}$$\n\nwhere $r$ is the risk-free rate, $\\mu$ is the return on a traded security dependent only on $\\theta$, and $\\sigma$ is its volatility. Suppose that a real asset depends on several variables $\\theta_i$. Let $m_i$ and $s_i$ be the expected growth rate and volatility of $\\theta_i$\n\n$$d\\theta_i/\\theta=m_idt+s_idW_t$$\n\nwhere $W_t$ is a Brownian Motion.\n\nDefine $\\lambda_i$ as the market price of risk of $\\theta_i$. Risk-neutral valuation can be extended to show that any asset dependent on the i can be valued by\n\n-   Reducing the expected growth rate of each $\\theta_i$ from $m_i$ to $m_i-\\lambda_is_i$ (because $(m_i-r)/s_i=\\lambda_i$.)\n-   Discounting cash flows at the risk-free rate.\n\n### Estimating the Market Price of Risk\n\n$\\rho$: Instantaneous correlation between the percentage changes in the variable and returns on a broad index of stock market prices\n\n$\\mu_m$: Expected return on broad index of stock market prices\n\n$\\sigma_m$: Volatility of return on the broad index of stock market prices\n\nFrom a continuous-time version of the capital asset pricing model\n\n$$\\mu-r=\\frac{\\rho\\sigma}{\\sigma_m}(\\mu_m-r)$$\n\nAnother expression\n\n$$\\mu-r=\\lambda\\sigma$$\n\nThus\n\n$$\\lambda=\\frac{\\rho}{\\sigma_m}(\\mu_m-r)$$\n\n### Examples of Options Embedded in Projects\n\n-   **Abandonment options**: It is an American put option on the project’s value.\n-   **Expansion options**: It is an American call option on the value of additional capacity. The strike price of the call option is the cost of creating this additional capacity discounted to the time of option exercise.\n-   **Contraction options**: It is an American put option on the value of the lost capacity. The strike price is the present value of the future expenditures saved as seen at the time of exercise of the option.\n-   **Options to defer**: This is an American call option on the value of the project.\n-   **Options to extend life**: This is a European call option on the asset’s future value.\n\n## Reference\n\nOFD / John Hull\n\n《金融经济学二十五讲》/ 徐高\n\n《金融经济学十讲》/ 史树中\n\nFinancial Calculus: An Introduction to Derivative Pricing / Martin Baxter\n\n[布朗运动、伊藤引理、BS公式（前篇）](https://mp.weixin.qq.com/s?__biz=MzIyMDEwNDk1Mg==\u0026mid=2650876491\u0026idx=1\u0026sn=2ccfdfbaf250228974e984c5e7168366\u0026chksm=8c249bdcbb5312ca46b0261df16109ad8e19d559ab919dd95f8097b46b36eaf81e85b4eef76c\u0026scene=126\u0026sessionid=1605256784\u0026key=409586cdc8db5733d89744fef149cbd55e0825fce39bb62d733d518ddf15b3e1ecd31bb2ba4e18d5c4853db53d9fb1cba066bb33110f8740f658772187889b75c666cbb2a0fd6f016e9b0079f7403eadcb884f6a5bd1c6e957edbebba629f17c26a5c2f9489f0820c2cabc44aa656224da99bcf28ba4bf2f4170c17b3f255ca9\u0026ascene=1\u0026uin=MjU1NDk5MDUwOA%3D%3D\u0026devicetype=Windows+10+x64\u0026version=6300002f\u0026lang=zh_CN\u0026exportkey=A0Tn4xOWv3Nl%2BjMxJtPWumI%3D\u0026pass_ticket=ok4tnaFWS7zPPSCRKPSyUIzrRRcpn0LMaKl%2FkngUWsaWK0ChENo%2FKgwaJH5CCexq\u0026wx_header=0)\n\n[布朗运动、伊藤引理、BS公式（后篇）](https://mp.weixin.qq.com/s?__biz=MzIyMDEwNDk1Mg==\u0026mid=2650876561\u0026idx=1\u0026sn=ee4ecb91b0c95e7d539375ef35efdf4a\u0026chksm=8c249b06bb53121043a58a2163779774ef0f054659bee3033ff2cb3b7af7996bd75a3a862e31\u0026scene=126\u0026sessionid=1605256784\u0026key=cc7cc2a0b445493e06dbff52441567153cc0ac0f70486c51768cc951d0871d265c6e19ab75a980bbef7f1864f8f6bd16dcf347cfa2628abb7b13727fcbdf5188cc98f354b29144935c3aecd91ad2f0011ef56f23448f8df115987ca174fac91babc728e21455cb515b27820ee01203a772cb23c4a69a797b16820bb2213c58c5\u0026ascene=1\u0026uin=MjU1NDk5MDUwOA%3D%3D\u0026devicetype=Windows+10+x64\u0026version=6300002f\u0026lang=zh_CN\u0026exportkey=A7l3K9ytHaVtOJYXPnoJ8Sw%3D\u0026pass_ticket=ok4tnaFWS7zPPSCRKPSyUIzrRRcpn0LMaKl%2FkngUWsaWK0ChENo%2FKgwaJH5CCexq\u0026wx_header=0)\n\n[《期权交易随笔》题记](https://mp.weixin.qq.com/s?__biz=MzIyMTE5OTE5Mg==\u0026mid=409677815\u0026idx=2\u0026sn=491afd3a6f32dea8d3282ea1fb5aa02b\u0026chksm=0a5fe1c03d2868d60ed449598bbe5d72e6281f8a038a0e4a52876768d50edc248a8c49210cb1\u0026scene=126\u0026sessionid=1605759166\u0026key=e17ad8edb8d975168ae4132b815fac2689bbcfcb92f93d58076345765d5cd2a91167cdafb664797fcd8a9b664459656a6ac0dde4490e389de04932454612f3f59527447cbbe69dc1483225420a515553eb0e30f7b9fd915c34f1346e29564da1e2ef8a0053d40ee27f65c3c3c790be526070ec2cfbc98e942b7d9fca74a663fd\u0026ascene=1\u0026uin=MjU1NDk5MDUwOA%3D%3D\u0026devicetype=Windows+10+x64\u0026version=6300002f\u0026lang=zh_CN\u0026exportkey=A1eyaqvaIFoWdFTokV4gWNI%3D\u0026pass_ticket=6X9rN0ahWibDlXeT0QKsoq3d9UL3kop49HI7%2F%2Ba%2B30zMh6TprHofEq9FsxXicYqb\u0026wx_header=0)\n\n[BS公式--鞅定价推导法](https://zhuanlan.zhihu.com/p/95538708)\n\n[American Options](https://people.kth.se/~armerin/FinInsMathRwanda/Lecture18.pdf)",title:"Untitled Page"},"/Probability":{content:"---\nArea: Statistics\nSource: Book\nStatus: Todo\nType: Notes\n---\n\n\n[probability_cheatsheet.pdf](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/646bd1d9-a58f-469a-b20b-fc2e2ff9efc9/probability_cheatsheet.pdf)\n\n## Counting\n\n### Sampling Table\n\nThe sampling table gives the number of possible samples of size $k$ out of a population of size $n$, under various assumptions about how the sample is collected\n\n$$ \\begin{array}{r|cc} \u0026 \\textbf{Order Matters} \u0026 \\textbf{Not Matter} \\\\ \\hline \\textbf{With Replacement} \u0026 \\displaystyle n^k \u0026 \\displaystyle{n+k-1 \\choose k} \\\\ \\textbf{Without Replacement} \u0026 \\displaystyle\\frac{n!}{(n - k)!} \u0026 \\displaystyle{n \\choose k} \\end{array}$$\n\n-   Experiments/Outcomes - An experiment generates an outcome from a pre-determined list. For example, a dice roll generates outcomes in the set $\\{1, 2, 3, 4, 5, 6\\}$\n-   Sample Space - The sample space, denoted $\\Omega$, is the set of possible outcomes. Note that the probability of this event is 1, since something in the sample space will always occur.\n-   Event - An event is a subset of the sample space, or a collection of possible outcomes of an experiment. We say that the event has occurred if any of the outcomes in the event have happened.\n\n## Conditional\n\n### Law of Total Probability (LOTP)\n\nLet ${ B}_1, { B}_2, { B}_3, ... { B}_n$ be a _partition_ of the sample space (i.e., they are disjoint and their union is the entire sample space).\n\n$$ \\begin{aligned} P({ A}) \u0026= P({ A} | { B}_1)P({ B}_1) + P({ A} | { B}_2)P({ B}_2) + \\dots + P({ A} | { B}_n)P({ B}_n)\\\\ P({ A}) \u0026= P({ A} \\cap { B}_1)+ P({ A} \\cap { B}_2)+ \\dots + P({ A} \\cap { B}_n) \\end{aligned} $$\n\n$$ \\begin{aligned} P({ A}| { C}) \u0026= P({ A} | { B}_1, { C})P({ B}_1 | { C}) + \\dots + P({ A} | { B}_n, { C})P({ B}_n | { C})\\\\ P({ A}| { C}) \u0026= P({ A} \\cap { B}_1 | { C})+ P({ A} \\cap { B}_2 | { C})+ \\dots + P({ A} \\cap { B}_n | { C})\\end{aligned} $$\n\nSpecial case of LOTP with ${ B}$ and ${ B^c}$ as partition:\n\n$$ \\begin{aligned} P({ A}) \u0026= P({ A} | { B})P({ B}) + P({ A} | { B^c})P({ B^c}) \\\\ P({ A}) \u0026= P({ A} \\cap { B})+ P({ A} \\cap { B^c}) \\\\ \\end{aligned} $$\n\n### Bayes' Rule\n\n$$ P({ A}|{ B}) = \\frac{P({ B}|{ A})P({ A})}{P({ B})}, P({ A}|{ B}, { C}) = \\frac{P({ B}|{ A}, { C})P({ A} | { C})}{P({ B} | { C})} $$\n\nWe can also write\n\n$$ P(A|B,C) = \\frac{P(A,B,C)}{P(B,C)} = \\frac{P(B,C|A)P(A)}{P(B,C)} $$\n\n**Odds Form of Bayes' Rule**\n\n$$ \\frac{P({ A}| { B})}{P({ A^c}| { B})} = \\frac{P({ B}|{ A})}{P({ B}| { A^c})}\\frac{P({ A})}{P({ A^c})}$$\n\nThe _posterior odds_ of $A$ are the _likelihood ratio_ times the _prior odds_.\n\n## Expected Value and Variance\n\nExpected Value\n\n$$E(X) = \\sum\\limits_{i}x_iP(X=x_i)$$\n\nFor any r.v.s $X$ and $Y$, and constants $a,b,c,$\n\n$$E(aX + bY + c) = aE(X) + bE(Y) + c$$\n\nSame distribution implies same mean - If $X$ and $Y$ have the same distribution, then $E(X)=E(Y)$ and, more generally,\n\n$$E(g(X)) = E(g(Y))$$\n\nConditional Expected Value is defined like expectation, only conditioned on any event $A$.\n\n$$ E(X | A) = \\sum\\limits_{x}xP(X=x | A)$$\n\nVariance and Standard Deviation\n\n$${Var}(X) = E \\left(X - E(X)\\right)^2 = E(X^2) - (E(X))^2$$\n\n## Continuous RVs\n\n### Continuous Random Variables (CRVs)\n\nA continuous random variable can take on any possible value within a certain interval (for example, [0, 1]), whereas a discrete random variable can only take on variables in a list of countable values.\n\nThe probability that a continuous random variable takes on any specific value is 0.\n\n$$F'(x) = f(x)$$\n\n$$E(X) = \\int^\\infty_{-\\infty}xf(x)dx $$\n\n### LOTUS\n\n-   The expected value of $X$ is defined this way:\n\n$$E(X) = \\sum_x xP(X=x) \\textnormal{ (for discrete $X$)}$$\n\n$$E(X) = \\int^\\infty_{-\\infty}xf(x)dx \\textnormal{ (for continuous $X$)}$$\n\n-   The Law of the Unconscious Statistician (LOTUS) states that you can find the expected value of a function of a random variable, $g(X)$, in a similar way, by replacing the $x$ in front of the PMF/PDF by $g(x)$ but still working with the PMF/PDF of $X$:\n\n$$ E(g(X)) = \\sum_x g(x)P(X=x) \\textnormal{ (for discrete $X$)} $$\n\n$$E(g(X)) = \\int^\\infty_{-\\infty}g(x)f(x)dx \\textnormal{ (for continuous $X$)}$$\n\n-   _What's a function of a random variable? A function of a random variable is also a random variable. For example, if $X$ is the number of bikes you see in an hour, then $g(X) = 2X$ is the number of bike wheels you see in that hour and $h(X) = {X \\choose 2} = \\frac{X(X-1)}{2}$ is the number of pairs of bikes such that you see both of those bikes in that hour._\n\n### Universality of Uniform (UoU)\n\nWhen you plug any CRV into its own CDF, you get a Uniform(0,1) random variable. When you plug a Uniform(0,1) r.v.~into an inverse CDF, you get an r.v.~with that CDF. For example, let's say that a random variable $X$ has CDF\n\n$$F(x) = 1 - e^{-x}, \\textrm{ for $x\u003e0$} $$\n\nBy UoU, if we plug $X$ into this function then we get a uniformly distributed random variable.\n\n$$F(X) = 1 - e^{-X} \\sim \\textrm{Unif}(0,1)$$\n\nSimilarly, if $U \\sim \\textrm{Unif}(0,1)$ then $F^{-1}(U)$ has CDF $F$. The key point is that for any continuous random variable, we can transform it into a Uniform random variable and back by using its CDF.\n\n## Moments\n\nMoments describe the shape of a distribution.\n\nLet $X$ have mean $\\mu$ and standard deviation $\\sigma$, and $Z=(X-\\mu)/\\sigma$ be the _standardized_ version of $X$. The $k$th moment of $X$ is $\\mu_k = E(X^k)$ and the $k$th standardized moment of $X$ is $m_k =E (Z^k)$.\n\nThe mean, variance, skewness, and kurtosis are important summaries of the shape of a distribution.\n\n### Moment Generating Functions\n\nFor any random variable $X$, the function\n\n$$ M_X(t) = E(e^{tX}) $$\n\nis the **moment generating function (MGF)** of $X$, if it exists for all $t$ in some open interval containing $0$.\n\nMGF of linear functions: If we have $Y = aX + b$, then\n\n$$M_Y(t) = E(e^{t(aX + b)}) = e^{bt}E(e^{(at)X}) = e^{bt}M_X(at)$$\n\nUniqueness: If it exists, the MGF uniquely determines the distribution. This means that for any two random variables $X$ and $Y$, they are distributed the same (their PMFs/PDFs are equal) if and only if their MGFs are equal.\n\nSumming Independent RVs by Multiplying MGFs: If $X$ and $Y$ are independent, then\n\n$$M_{X+Y}(t) = E(e^{t(X + Y)}) = E(e^{tX})E(e^{tY}) = M_X(t) \\cdot M_Y(t) $$\n\nThe MGF of the sum of two random variables is the product of the MGFs of those two random variables.\n\n## Joint PDFs and CDFs\n\n### Joint Distributions\n\nThe joint CDF of $X$ and $Y$\n\n$$F(x,y)=P(X \\leq x, Y \\leq y) $$\n\nIn the discrete case, $X$ and $Y$ have a **joint PMF**\n\n$$p_{X,Y}(x,y) = P(X=x,Y=y)$$\n\nIn the continuous case, they have a **joint PDF**\n\n$$f_{X,Y}(x,y) = \\frac{\\partial^2}{\\partial x \\partial y} F_{X,Y}(x,y).$$\n\nThe joint PMF/PDF must be nonnegative and sum/integrate to 1.\n\n### Conditional Distributions\n\nConditioning and Bayes' rule for discrete r.v.s\n\n$$ P(Y=y|X=x) = \\frac{P(X=x, Y=y)}{P(X=x)} = \\frac{P(X=x|Y=y)P(Y=y)}{P(X=x)}$$\n\nConditioning and Bayes' rule for continuous r.v.s\n\n$$f_{Y|X}(y|x) = \\frac{f_{X,Y}(x, y)}{f_X(x)} = \\frac{f_{X|Y}(x|y)f_Y(y)}{f_X(x)}$$\n\nHybrid Bayes' rule\n\n$$f_X(x|A) = \\frac{P(A | X = x)f_X(x)}{P(A)}$$\n\n### Marginal Distributions\n\nTo find the distribution of one (or more) random variables from a joint PMF/PDF, sum/integrate over the unwanted random variables.\n\nMarginal PMF from joint PMF\n\n$$P(X = x) = \\sum_y P(X=x, Y=y)$$\n\nMarginal PDF from joint PDF\n\n$$f_X(x) = \\int_{-\\infty}^\\infty f_{X, Y}(x, y) dy$$",title:"Untitled Page"},"/Probability and Random Process":{content:"[probability_cheatsheet.pdf](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/646bd1d9-a58f-469a-b20b-fc2e2ff9efc9/probability_cheatsheet.pdf)\n\n## Counting\n\n### Sampling Table\n\nThe sampling table gives the number of possible samples of size $k$ out of a population of size $n$, under various assumptions about how the sample is collected\n\n$$ \\begin{array}{r|cc} \u0026 \\textbf{Order Matters} \u0026 \\textbf{Not Matter} \\\\ \\hline \\textbf{With Replacement} \u0026 \\displaystyle n^k \u0026 \\displaystyle{n+k-1 \\choose k} \\\\ \\textbf{Without Replacement} \u0026 \\displaystyle\\frac{n!}{(n - k)!} \u0026 \\displaystyle{n \\choose k} \\end{array}$$\n\n-   Experiments/Outcomes - An experiment generates an outcome from a pre-determined list. For example, a dice roll generates outcomes in the set $\\{1, 2, 3, 4, 5, 6\\}$\n-   Sample Space - The sample space, denoted $\\Omega$, is the set of possible outcomes. Note that the probability of this event is 1, since something in the sample space will always occur.\n-   Event - An event is a subset of the sample space, or a collection of possible outcomes of an experiment. We say that the event has occurred if any of the outcomes in the event have happened.\n\n## Conditional\n\n### Law of Total Probability (LOTP)\n\nLet ${ B}_1, { B}_2, { B}_3, ... { B}_n$ be a _partition_ of the sample space (i.e., they are disjoint and their union is the entire sample space).\n\n$$ \\begin{aligned} P({ A}) \u0026= P({ A} | { B}_1)P({ B}_1) + P({ A} | { B}_2)P({ B}_2) + \\dots + P({ A} | { B}_n)P({ B}_n)\\\\ P({ A}) \u0026= P({ A} \\cap { B}_1)+ P({ A} \\cap { B}_2)+ \\dots + P({ A} \\cap { B}_n) \\end{aligned} $$\n\n$$ \\begin{aligned} P({ A}| { C}) \u0026= P({ A} | { B}_1, { C})P({ B}_1 | { C}) + \\dots + P({ A} | { B}_n, { C})P({ B}_n | { C})\\\\ P({ A}| { C}) \u0026= P({ A} \\cap { B}_1 | { C})+ P({ A} \\cap { B}_2 | { C})+ \\dots + P({ A} \\cap { B}_n | { C})\\end{aligned} $$\n\nSpecial case of LOTP with ${ B}$ and ${ B^c}$ as partition:\n\n$$ \\begin{aligned} P({ A}) \u0026= P({ A} | { B})P({ B}) + P({ A} | { B^c})P({ B^c}) \\\\ P({ A}) \u0026= P({ A} \\cap { B})+ P({ A} \\cap { B^c}) \\\\ \\end{aligned} $$\n\n### Bayes' Rule\n\n$$ P({ A}|{ B}) = \\frac{P({ B}|{ A})P({ A})}{P({ B})}, P({ A}|{ B}, { C}) = \\frac{P({ B}|{ A}, { C})P({ A} | { C})}{P({ B} | { C})} $$\n\nWe can also write\n\n$$ P(A|B,C) = \\frac{P(A,B,C)}{P(B,C)} = \\frac{P(B,C|A)P(A)}{P(B,C)} $$\n\n**Odds Form of Bayes' Rule**\n\n$$ \\frac{P({ A}| { B})}{P({ A^c}| { B})} = \\frac{P({ B}|{ A})}{P({ B}| { A^c})}\\frac{P({ A})}{P({ A^c})}$$\n\nThe _posterior odds_ of $A$ are the _likelihood ratio_ times the _prior odds_.\n\n## Expected Value and Variance\n\nExpected Value\n\n$$E(X) = \\sum\\limits_{i}x_iP(X=x_i)$$\n\nFor any r.v.s $X$ and $Y$, and constants $a,b,c,$\n\n$$E(aX + bY + c) = aE(X) + bE(Y) + c$$\n\nSame distribution implies same mean - If $X$ and $Y$ have the same distribution, then $E(X)=E(Y)$ and, more generally,\n\n$$E(g(X)) = E(g(Y))$$\n\nConditional Expected Value is defined like expectation, only conditioned on any event $A$.\n\n$$ E(X | A) = \\sum\\limits_{x}xP(X=x | A)$$\n\nVariance and Standard Deviation\n\n$${Var}(X) = E \\left(X - E(X)\\right)^2 = E(X^2) - (E(X))^2$$\n\n## Continuous RVs\n\n### Continuous Random Variables (CRVs)\n\nA continuous random variable can take on any possible value within a certain interval (for example, [0, 1]), whereas a discrete random variable can only take on variables in a list of countable values.\n\nThe probability that a continuous random variable takes on any specific value is 0.\n\n$$F'(x) = f(x)$$\n\n$$E(X) = \\int^\\infty_{-\\infty}xf(x)dx $$\n\n### LOTUS\n\n-   The expected value of $X$ is defined this way:\n\n$$E(X) = \\sum_x xP(X=x) \\textnormal{ (for discrete $X$)}$$\n\n$$E(X) = \\int^\\infty_{-\\infty}xf(x)dx \\textnormal{ (for continuous $X$)}$$\n\n-   The Law of the Unconscious Statistician (LOTUS) states that you can find the expected value of a function of a random variable, $g(X)$, in a similar way, by replacing the $x$ in front of the PMF/PDF by $g(x)$ but still working with the PMF/PDF of $X$:\n\n$$ E(g(X)) = \\sum_x g(x)P(X=x) \\textnormal{ (for discrete $X$)} $$\n\n$$E(g(X)) = \\int^\\infty_{-\\infty}g(x)f(x)dx \\textnormal{ (for continuous $X$)}$$\n\n-   _What's a function of a random variable? A function of a random variable is also a random variable. For example, if $X$ is the number of bikes you see in an hour, then $g(X) = 2X$ is the number of bike wheels you see in that hour and $h(X) = {X \\choose 2} = \\frac{X(X-1)}{2}$ is the number of pairs of bikes such that you see both of those bikes in that hour._\n\n### Universality of Uniform (UoU)\n\nWhen you plug any CRV into its own CDF, you get a Uniform(0,1) random variable. When you plug a Uniform(0,1) r.v.~into an inverse CDF, you get an r.v.~with that CDF. For example, let's say that a random variable $X$ has CDF\n\n$$F(x) = 1 - e^{-x}, \\textrm{ for $x\u003e0$} $$\n\nBy UoU, if we plug $X$ into this function then we get a uniformly distributed random variable.\n\n$$F(X) = 1 - e^{-X} \\sim \\textrm{Unif}(0,1)$$\n\nSimilarly, if $U \\sim \\textrm{Unif}(0,1)$ then $F^{-1}(U)$ has CDF $F$. The key point is that for any continuous random variable, we can transform it into a Uniform random variable and back by using its CDF.\n\n## Moments\n\nMoments describe the shape of a distribution.\n\nLet $X$ have mean $\\mu$ and standard deviation $\\sigma$, and $Z=(X-\\mu)/\\sigma$ be the _standardized_ version of $X$. The $k$th moment of $X$ is $\\mu_k = E(X^k)$ and the $k$th standardized moment of $X$ is $m_k =E (Z^k)$.\n\nThe mean, variance, skewness, and kurtosis are important summaries of the shape of a distribution.\n\n### Moment Generating Functions\n\nFor any random variable $X$, the function\n\n$$ M_X(t) = E(e^{tX}) $$\n\nis the **moment generating function (MGF)** of $X$, if it exists for all $t$ in some open interval containing $0$.\n\nMGF of linear functions: If we have $Y = aX + b$, then\n\n$$M_Y(t) = E(e^{t(aX + b)}) = e^{bt}E(e^{(at)X}) = e^{bt}M_X(at)$$\n\nUniqueness: If it exists, the MGF uniquely determines the distribution. This means that for any two random variables $X$ and $Y$, they are distributed the same (their PMFs/PDFs are equal) if and only if their MGFs are equal.\n\nSumming Independent RVs by Multiplying MGFs: If $X$ and $Y$ are independent, then\n\n$$M_{X+Y}(t) = E(e^{t(X + Y)}) = E(e^{tX})E(e^{tY}) = M_X(t) \\cdot M_Y(t) $$\n\nThe MGF of the sum of two random variables is the product of the MGFs of those two random variables.\n\n## Joint PDFs and CDFs\n\n### Joint Distributions\n\nThe joint CDF of $X$ and $Y$\n\n$$F(x,y)=P(X \\leq x, Y \\leq y) $$\n\nIn the discrete case, $X$ and $Y$ have a **joint PMF**\n\n$$p_{X,Y}(x,y) = P(X=x,Y=y)$$\n\nIn the continuous case, they have a **joint PDF**\n\n$$f_{X,Y}(x,y) = \\frac{\\partial^2}{\\partial x \\partial y} F_{X,Y}(x,y).$$\n\nThe joint PMF/PDF must be nonnegative and sum/integrate to 1.\n\n### Conditional Distributions\n\nConditioning and Bayes' rule for discrete r.v.s\n\n$$ P(Y=y|X=x) = \\frac{P(X=x, Y=y)}{P(X=x)} = \\frac{P(X=x|Y=y)P(Y=y)}{P(X=x)}$$\n\nConditioning and Bayes' rule for continuous r.v.s\n\n$$f_{Y|X}(y|x) = \\frac{f_{X,Y}(x, y)}{f_X(x)} = \\frac{f_{X|Y}(x|y)f_Y(y)}{f_X(x)}$$\n\nHybrid Bayes' rule\n\n$$f_X(x|A) = \\frac{P(A | X = x)f_X(x)}{P(A)}$$\n\n### Marginal Distributions\n\nTo find the distribution of one (or more) random variables from a joint PMF/PDF, sum/integrate over the unwanted random variables.\n\nMarginal PMF from joint PMF\n\n$$P(X = x) = \\sum_y P(X=x, Y=y)$$\n\nMarginal PDF from joint PDF\n\n$$f_X(x) = \\int_{-\\infty}^\\infty f_{X, Y}(x, y) dy$$",title:"Untitled Page"},"/Published/Data Preprocessing and EDA":{content:"---\nArea: Coding\nSource: Website\nStatus: Ongoing\nType: Notes\n---\n\n## Rows and Columns\n\nSlice with labels for row and single label for column. As mentioned above, note that both the start and stop of the slice are included.\n\n```python\ndf.loc['cobra':'viper', 'max_speed']\n```\n\nBoolean list with the same length as the row axis\n\n```python\ndf.loc[[False, False, True]]\n```\n\nConditional that returns a boolean Series\n\n```python\ndf.loc[df['shield'] \u003e 6] \ndf.loc[df['shield'] \u003e 6, ['max_speed']] \ndf.loc[**lambda** df: df['shield'] == 8]\n```\n\nFor Series, the row labels are prefixed. For DataFrame, the column labels are prefixed.\n\n```python\ndf.add_prefix('col_')\ndf.add_suffix('_col')\n```\n\nPossible values or ranges\n\nList the theoretical limits on the values and validate against the data.\n\n## Types and Formats\n\n### Data Types\n\nCreate a series:\n\n```python\nser = pd.Series([1, 2], dtype='int32')\nser.astype('int64')\n```\n\nConvert to categorical type:\n\n```python\nser.astype('category')\n```\n\nConvert to ordered categorical type with custom ordering:\n\n```python\ncat_dtype = pd.api.types.CategoricalDtype(categories=[2, 1], ordered=**True**)\nser.astype(cat_dtype)\n```\n\n### Data Formats\n\n```python\npd.to_datetime(data_311['created_date'], format='%m/%d/%Y %I:%M:%S %p')\n\npd.to_datetime([1, 2, 3], unit='D',origin=pd.Timestamp('1960-01-01'))\n#DatetimeIndex(['1960-01-02', '1960-01-03', '1960-01-04'], dtype='datetime64[ns]', freq=None)\n\nfrom datetime import date\nwater_quality[\"Week\"] = water_quality['created_date_time'].apply(lambda x: x.strftime(\"%w\"))\nwater_quality[\"Day\"] = water_quality['created_date_time'].apply(lambda x: x.strftime(\"%x\"))\nwater_quality[\"Year\"] = water_quality['created_date_time'].apply(lambda x: x.year)\nwater_quality[\"Month\"] = water_quality['created_date_time'].apply(lambda x: x.strftime(\"%b\"))\n\nwater_quality[\"year_month\"] = water_quality['created_date_time'].apply(\n    lambda x: date(year=x.year, month=x.month, day=1)\n)\n\n#change month name to string num\nd={'July':'07', 'August':'08', 'September':'09', 'October':'10', 'November':'11', 'December':'12',\\\\\n   'January':'01', 'February':'02', 'March':'03', 'April':'04', 'May':'05', 'June':'06'}\nresort_hotel.loc[:,'month_num']=resort_hotel['arrival_date_month'].map(d)\n\n#change year to str\nresort_hotel.loc[:,'arrival_date_year']=resort_hotel['arrival_date_year'].apply(\n    lambda x :str(x))\n#change 1 to 01 day\nresort_hotel.loc[:,'arrival_date_day_of_month']=resort_hotel['arrival_date_day_of_month'].apply(\n    lambda x:(len(str(x)) ==1 and '0'+str(x)) or str(x))\n```\n\n## Missing Values\n\n### Drop NAs\n\n```python\ndf.dropna(self, axis=0, how='any', thresh=None, subset=None, inplace=False)\n# how=‘any’ : If any NA values are present, drop that row or column.\n# how=‘all’ : If all values are NA, drop that row or column.\ndf.dropna(how='all') \n# Keep only the rows with at least 2 non-NA values.\ndf.dropna(thresh=2) \n# Define in which columns to look for missing values.\ndf.dropna(subset=['name', 'born'])\n\n```\n\n### Fill NAs\n\n```python\ndf.fillna(self, value=None, method=None, axis=None, inplace=False, limit=None, downcast=None)\n```\n\n### Percentage of missing values and visualizations\n\n## Duplications\n\n```python\ndf.drop_duplicates(['k'])\n# keep{‘first’, ‘last’, False}, default ‘first’:\n# Determines which duplicates (if any) to keep.\n# - first: Drop duplicates except for the first occurrence. \n# - last: Drop duplicates except for the last occurrence. \n# - False: Drop all duplicates.\n```\n\n## Numerical Summarization\n\nUse summary statistics to find out the moments.\n\n-   [ ] Locations\n    \n    Mean, median, quartiles, mode...\n    \n-   [ ] Spreads\n    \n    range, variance, standard deviation, IQR\n    \n-   [ ] Skewness\n    \n    asymmetries\n    \n-   [ ] Kurtosis\n    \n\n## Distributions\n\nVisualize the distributions of the values\n\n### Value count bar plot\n\n```python\ndf.groupby(\"descriptor\").size().plot(kind=\"barh\", title=\"Requests by Descriptor\")\n```\n\n### Stack bar plot\n\n```python\norder_ratio=resort_hotel.pivot_table(\n    index='Year-Month', columns='reservation_status', \n    values='is_canceled', aggfunc=len\n)\n\np1 = plt.bar(order_ratio.index,'Check-Out', width=10,data=order_ratio)\np2 = plt.bar(order_ratio.index,'Canceled',bottom='Check-Out',width=10,data=order_ratio)\np3=plt.bar(order_ratio.index,'No-Show',bottom='Check-Out',width=10,data=order_ratio)\n#plt.ylabel('Scores')\nplt.title('Reservation Status of Booking Orders Per Month ')\n#plt.xticks(ind, ('G1', 'G2', 'G3', 'G4', 'G5'))\n#plt.yticks(np.arange(0, 81, 10))\nplt.legend((p1[0], p2[0],p3[0]), ('Check-Out', 'Canceled','No-Show'))\n\nplt.show()\n```\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2dfbdcaa-5d48-488b-947b-35035413d0ea/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2dfbdcaa-5d48-488b-947b-35035413d0ea/Untitled.png)\n\n### Histogram\n\n```python\nplt.hist(water_quality['solving_time_num'],bins=100)\n```\n\n### KDE\n\n```python\nimport seaborn as sns\n\nsns.distplot(quick_solve['solving_time_num'], hist=True, kde=True, \n             bins=int(180/5), \n             hist_kws={'edgecolor':'red'},\n             kde_kws={'linewidth': 4})\n```\n\n### Box plot\n\n```python\ndf.boxplot(column='solving_time_num',by='borough')\n```\n\n### Point plot\n\n```python\nimport seaborn as sns\nfig1=plt.figure()\nax1 = fig1.add_subplot(211)\nax1=sns.pointplot(y=\"meal\", x=\"is_canceled\",data=resort_hotel,join=False,capsize=.05)\nax1.set(xlim=(0,1))\nax2 = fig1.add_subplot(212)\nax2=sns.pointplot(y=\"customer_type\", x=\"is_canceled\",data=resort_hotel,join=False,capsize=.05)\nax2.set(xlim=(0,1))\n\nfig2=plt.figure()\nax4 = fig2.add_subplot(211)\nax4=sns.pointplot(y=\"reserved_room_type\", x=\"is_canceled\",data=resort_hotel,join=False,capsize=.1)\nax4.set(xlim=(0,1))\nax5 = fig2.add_subplot(212)\nax5=sns.pointplot(y=\"market_segment\", x=\"is_canceled\",data=resort_hotel,join=False,capsize=.1)\nax5.set(xlim=(0,1))\n```\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/92410985-9ea9-43f6-8261-104d82c6df2d/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/92410985-9ea9-43f6-8261-104d82c6df2d/Untitled.png)\n\n### Pivot table plot\n\n```python\nwater_quality.pivot_table(\n    index='year_month', columns='borough', \n    values='solving_time_num', aggfunc=len\n).plot().legend(loc='center right', bbox_to_anchor=(1.2, 0.5))\n```\n\n### Geography\n\n```python\nplt.scatter(water_quality['longitude'],water_quality['latitude'],alpha=1,s=20)\nplt.xlabel('Longitude')\nplt.ylabel('Latitude')\nplt.show()\n\n# 3 dims\nplt.scatter(water_quality['longitude'],water_quality['latitude'],c=water_quality['solving_time_num'])\nplt.clim(0,100)\nplt.colorbar()\n```\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a870cb5b-ac78-496e-ab5d-1eccc137395c/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a870cb5b-ac78-496e-ab5d-1eccc137395c/Untitled.png)\n\n```python\n# Categories of geography\nfig1=plt.figure()\ndescriptor=list(water_quality['descriptor'].unique())\nc=['#c41832','#ef342a','#a84d18','#f68f26','#faca07','#07594a',\n   '#4ba946','#5fc0a7','#0376c2','#6dade2','#4dc7ec','#a8b7d8','#b8a1a9','#f8c9cb','#f2f1f6']\nfor index in range(14):\n    longi = water_quality.loc[water_quality['descriptor'] == descriptor[index]]['longitude']\n    lati = water_quality.loc[water_quality['descriptor'] == descriptor[index]]['latitude']\n    plt.scatter(longi, lati,c=c[index],cmap='brg',alpha=1,s=20)  \n\nax = fig1.gca()\nplt.xlabel('Longitude')\nplt.ylabel('Latitude')\n#added this to get the legend to work\nhandles,labels = ax.get_legend_handles_labels()\nax.legend(handles, labels = descriptor, loc='center right', bbox_to_anchor=(1.5, 0.5))\n\nplt.show()\n```\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be4182d1-b8ea-4432-b8ca-4ce67a4c6311/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be4182d1-b8ea-4432-b8ca-4ce67a4c6311/Untitled.png)\n\n### Contour plot\n\n## Bin values into discrete intervals\n\n```python\npd.cut([0, 1, 1, 2], bins=4, labels=False)\n# Quantile-based discretization function.\npd.qcut(range(5), 3, labels=[\"good\", \"medium\", \"bad\"])\n\nresort_hotel['stays_in_weekend_nights'].apply(lambda x :(x\u003e4 and '\u003e4') or str(x))\n```\n\n## Dummy variables\n\n```python\npd.get_dummies(water_quality['descriptor'],prefix='descriptor')\npd.get_dummies(pd.cut(values,bins)\n```\n\n## Dispersion of the target value\n\nIs the dispersion of the target value small enough for the algorithm to perform a good prediction?\n\n## Correlations and Similarities\n\n### Pairplot\n\n### Correlations\n\nPearson, Kendall Tau Correlation\n\n```python\nfig, ax = plt.subplots()\nim = ax.imshow(resort_hotel_le[categoricals].corr())\n\n# We want to show all ticks...\nax.set_xticks(np.arange(len(categoricals)))\nax.set_yticks(np.arange(len(categoricals)))\n# ... and label them with the respective list entries\nax.set_xticklabels(categoricals)\nax.set_yticklabels(categoricals)\n\n# Rotate the tick labels and set their alignment.\nplt.setp(ax.get_xticklabels(), rotation=45, ha=\"right\",\n         rotation_mode=\"anchor\")\n\nax.set_title(\"Correlation between Each Feature\")\nfig.tight_layout()\nplt.show()\n```\n\n### Distances\n\nCalculate the distance between features or rows to understand the relations between them; Euclidean distance, Mahalanobis distance, Minkowski distance, Jaccard distance\n\n## Combining Data Files\n\n### Merge\n\n```python\npd.merge(left, right, how= 'inner', on=None, left_on=None, right_on=None)\n# how: inner, outer, left, right\n```\n\n### Concat\n\n```python\npd.concat([s1,s2],axis=1)# if with same index\n```\n\n## Reshape\n\n### Stack and unstack\n\n```python\n#Single level columns\ndf_single_level_cols = pd.DataFrame([[0, 1], [2, 3]],\n                                    index=['cat', 'dog'],\n                                    columns=['weight', 'height'])\n#Stacking a dataframe with a single level column axis returns a Series:\ndf_single_level_cols\n#     weight height\n#cat       0      1\n#dog       2      3\ndf_single_level_cols.stack()\n#cat  weight    0\n#     height    1\n#dog  weight    2\n#     height    3\n\n#Multi level columns: simple case\n\nmulticol1 = pd.MultiIndex.from_tuples([('weight', 'kg'),\n                                       ('weight', 'pounds')])\ndf_multi_level_cols1 = pd.DataFrame([[1, 2], [2, 4]],\n                                    index=['cat', 'dog'],\n                                    columns=multicol1)\n#Stacking a dataframe with a multi-level column axis:\n\ndf_multi_level_cols1\n#     weight\n#         kg    pounds\n#cat       1        2\n#dog       2        4\ndf_multi_level_cols1.stack()\n#            weight\n#cat kg           1\n#    pounds       2\n#dog kg           2\n#    pounds       4\n```\n\n### Pivot table and melt\n\n```python\ntable = pd.pivot_table(df, values=['D', 'E'], index=['A', 'C'],\n                    aggfunc={'D': np.mean,\n                             'E': [min, max, np.mean]})\n\ndf = pd.DataFrame({'A': {0: 'a', 1: 'b', 2: 'c'},\n                   'B': {0: 1, 1: 3, 2: 5},\n                   'C': {0: 2, 1: 4, 2: 6}})\n#df\n#   A  B  C\n#0  a  1  2\n#1  b  3  4\n#2  c  5  6\n\ndf.melt(id_vars=['A'], value_vars=['B'],\n        var_name='myVarname', value_name='myValname')\n#   A myVarname  myValname\n#0  a         B          1\n#1  b         B          3\n#2  c         B          5\n```\n\n### Crosstab\n\n```python\npd.crosstab(data.Nationality,data.Handedness,margin=True)\n```\n\n## Group by and Agg\n\n```python\nprices['Return']=prices.groupby('Code')['Close'].apply(lambda x:x/x.shift(1)-1)\n\ntips.groupby(['day','smoker'],as_index=False).mean()\n\nframe=pd.DataFrame({'data1':np.random.randn(1000),\n'data2':np.random.randn(1000)})\nquartiles=pd.cut(frame.data1,4)\ndef get_stats(group):\n	return {'min':group.min(),'max':group.max(),'count':group.count(),'mean':group.mean()}\ngrouped=frame.data2.groupby(quartiles)\ngrouped.apply(get_stats).unstack()\n\n# fill NA by group\ndata.groupby(group_key).apply(lambda g:g.fillna(g.mean()))\n\n# regression\nimport statsmodels.api as sm\ndef regress(data,yvar,xvars):\n	Y=data[yvar]\n	X=data[xvars]\n	X['intercept']=1.\n	result=sm.OLS(Y,X).fit()\n	return result.params\nby_year.apply(regress,'AAPL',['SPX'])\n```\n\n## Objectives of EDA\n\n### Polish the Questions\n\nCheck if the questions to be answered are valid or well stated; If not, modify them or come up with new ones\n\n### Validate Data I/O Methods\n\nCheck and validate the methods to load and save the datasets\n\n### Retrieve Domain Knowledge and Anomalies\n\nDetermine the ranges, outliers of the dataset; Talk to domain experts and validate with domain experts.\n\n### Does the result make sense?",title:"Untitled Page"},"/Published/Dispersion Trading":{content:"---\nArea: Finance\nSource: Website\nStatus: Todo\nType: Notes\n---\n\n## Introduction\n\n- Dispersion trading refers to trades in which one\n	- sells index options and buys options on the index components: selling index volatility and buying volatility of the index components\n	- buys index options and sells options on the index components: buying index volatility and selling volatility on the index components\n- All trades are delta-neutral (hedged with stock)\n\n\n### Motivation and Opportunities\n- toprofit from price differences in volatility marketsusing index options and options on individual stocks\n- Market segmentation, temporary shifts in correlations between assets, idiosyncratic news on individual stocks\n\n### Strategies\n\n#### Volatility Swaps\n- Correlation trades using volatility swaps aim to capture the correlation premium embedded in the volatility smile of equity indices.\n- These trades are particularly popular with hedge funds as they have a reduced cost of carry and are long vega whilst negating the theta bleed of other long vol strategies such as dual digitals or vanilla straddles.\n#### Call Options on Spot Dispersion (Palladiums)\n- [Palladium Options](Palladium%20Options.md) were introduced to trade correlation where there was not yet a liquid volatility swap market (EM, tech stocks and low volume stocks).\n- Their payoff is the average outperformance (upside or downside) of the assets versus the basket average. Simply a call on a basket of options versus a call on the basket.\n- Essentially palladiums are the average outperformance of a portfolio of straddles on all of the index components versus a straddle on the index itself. Historically, palladiums perform well in flat to rising markets where idiosyncratic risks provide outperformance versus the index as a whole.\n- Palladiums are more suited to the current pricing environment of low volatility as they are relatively high vega similar to outperformance options...\n\n\n## Reference\n\n[Dispersion Trading](https://www.math.nyu.edu/~avellane/Lecture10Quant.pdf)\n[Blog Page | Catley Lakeman Securities](https://www.catleylakeman.co.uk/blogPage.php?blogId=16)\n",title:"Untitled Page"},"/Published/Futures":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n## 期货市场的运作机制\n\n### 背景知识\n\nCME集团：芝加哥交易所、芝加哥商业交易所、纽约商品交易所\n\n期货合约的平仓：\n\n大多数期货交易不会导致实物交割，原因是大多数投资人在合约规定的交割期到来之前会选择平仓。对一个合约平仓就是进入一个与初始交易头寸相反的头寸。\n\n### 期货合约的规格\n\n- 合约规模(contract size)定义了在每一份合约中交割资产的数量。\n    - 合约规模太大，希望对冲较小头寸的投资者或希望持有较小头寸的投机者就不可能通过交易所交易\n    - 由于交易成本的存在，合约规模太小时会使交易成本太高\n- 农产品期货合约中交割资产的价值从10000美元到20000美元不等，金融期货合约的规模要大得多。\n- 小型合约可以吸引小额度投资者。(Mini Nasdaq 100)\n\n### 交割安排\n\n- 交割地点必须是交易所指定的地点。\n- 选择其他交割地点时，期货的空头方所收入的价格会随着交割地点的不同而被调整。\n- 具体交割时间由期货的空头方来决定\n- 通常的规则是交易所将交割产品意向书转给持有多头时间最久的投资者，而持有多头的一方必须接受交割通知。但是如果通知是可转让的，多头方投资方会有很短一段时间（半小时）来找到另一个持有多头的投资者来接受交割通知\n- 有些金融期货采用现金形式结算，所有未平仓的合约都在某个预先指定的日子平仓，最后的结算价格等于标的资产在这一天开盘时或收盘时的即期价格\n\n### 交割月份\n\n- 期货合约通常以交割月份命名，交易所必须明确指出在交割月份内的哪一段时间内可以交割。\n- 三个重要日期：第一交割通知日、最后交割通知日、最后交易日\n\n### 交易所\n\n- 是为其会员服务的、非盈利的会员制组织\n- 目标：提供一个公平、公正、公开的期货交易市场\n- 主要业务活动：制定、修改期货交易规则，维护市场的有效运转\n- 收入来源：主要是会员缴纳的会费与交易服务费（含交易费）\n\n#### 会员\n\n- 投资银行、经纪公司、自营商\n- 只有会员才能进场交易，交易所必须对会员的资信负责，非会员的客户必须通过会员代理进行交易\n- 会员是代理交易的主体，对其所代理的交易负全部责任。会员必须控制好所有客户的资金风险，如果因客户违约造成损失而不能履行赔偿责任时，会员必须代为履行赔偿责任并保留追偿的权利\n\n#### 客户\n\n- 普通客户在期货经纪公司建立交易账户以后，下单委托经纪公司进行交易\n- 在接到客户的委托单并确认以后，经纪公司利用在交易所的席位进行交易\n- 管理客户的账户，接受客户的交易委托，有的还提供咨询服务\n\n#### 结算公司\n\n- 非营利机构，通常来说，结算公司的会员集合是交易所会员集合的子集\n- 与期货市场相对应，结算管理体系也是分层次的\n    - 首先是交易所结算机构对会员公司的结算，这是第一级结算\n    - 其次是会员公司对其代理的客户进行结算，称为第二级结算\n    - 最终，将逐笔交易风险分级对应到每个市场参与者身上\n\n### 交易制度\n\n#### 价格波动限制与头寸限制\n\n- 许多交易所都限制期货价格每天的波动幅度与投机商持有的头寸\n- 如果交易所不对投机商的头寸进行限制，那么期货市场有可能演变成为多、空双方比拼资金实力的搏杀，变成一个大赌场，从而严重背离建立期货市场的初衷\n- 交易所限制期货价格每天的波动幅度的出发点是为了控制价格过度波动。但是，对是否能够抑制期货价格的长期波动，理论界与实务界都存在争议。此外，控制价格会扭曲期货的价格发现功能，阻碍信息的传递与扩散\n\n#### 交割\n\n- 对冲平仓、实物交割（1%-3%）、现金交割\n\n### 保证金制度\n\n- 每日交易盈亏计算，计算的结果作为收取交易保证金或追加保证金的依据。每个交易日结束时，保证金账户的金额数量都会得到调整。(daily settlement/marking to market)\n- 投资者的损失会从保证金账户里扣除；当保证金账户余额低于维持保证金水平时，投资人会收到保证金催缴，要追加保证金。\n- 当投资人不提供追加保证金时，经纪人将对合约平仓。\n- 远期合约只有在最后到期时才会进行结算，而期货合约每天都需要结算。相当于期货合约每天都要进行一次平仓，然后又以新价格开仓。\n- 对保证金的要求可能取决于交易员的交易目的：\n    - 对对冲者的保证金要求（2%-4%）可能低于对投机者的保证金要求（5%-7%）\n    - 对短线交易（在同一天平仓，day trade）和差价交易的保证金要求可能低于对冲交易的保证金。\n\n优点和问题\n\n- 优点：\n    - 标准化，提高流动性\n    - 结算程序，避免违约风险\n    - 杠杆效应，以小搏大\n- 问题：\n    - 距离交割日较远的期货合约流动性比较差\n    - 保证金账户的管理带来交易成本\n\n### 场外市场\n\n中央交易对手\n\n- 中央交易对手为标准的场外交易进行结算\n\n双边结算\n\n- 不能通过CCP结算的产品都要双边结算\n- 公司双方要签署主协议，提供抵押品，抵押品的功能类似于交易所清算中心或CCP对其会员要求的保证金\n\n### 结算价格\n\n- 用于计算每天合约的盈亏以及所需要的保证金数量\n\n### 交易量和未平仓合约数量\n\n- 交易数量是在一天内交易的合约总份数。\n- 未结权益(open interest)是尚未平仓合约份数的总量，是所有多头的总和，也是所有空头的总和。\n\n## 远期和期货价格\n\n### 投资资产与消费资产\n\n- 投资资产：投资者为了投资目的而持有的资产\n- 消费资产：持有消费资产的主要目的是消费而不是投资（猪肉、油、铜）\n- 对于投资资产，我们可以从无套利假设出发由即期价格与其他市场变量得出远期和期货价格，但对于消费资产做不到这一点。\n\n### 假设与符号\n\n- 假设：\n    - 市场参与者进行交易时没有手续费\n    - 市场参与者对所有交易净利润都使用同一税率\n    - 市场参与者能够以同样的无风险利率借入和借出资金\n    - 当套利机会出现时，市场参与者会马上利用套利机会\n- 符号：\n    - $T$: 远期或期货合约的期限（年）\n    - $S_0$: 远期或期货合约标的资产的当前价格\n    - $F_0$: 远期或期货的当前价格\n    - $r$: 按连续复利的无风险零息利率，期限对应于合约的交割日\n\n### 远期价值与远期价格\n\n#### 在交割前没有现金流\n\n远期价值：远期合约本身的**价值**。\n\n远期价格：使得远期价值为零的合理\u003cu\u003e交割\u003c/u\u003e价格\n\n远期合约的价值（对于多头方）：\n$$\nf=(F_0-K)e^{-r(T-t)}\n$$\n\n- $K$是以前成交的合约的交割价格，合约的交割日期是在从今日起$T-t$年之后，$F_0$表示目前的远期价格，即假如在今天成交的话，合约的\u003cu\u003e交割\u003c/u\u003e价格。\n- 如果今天恰好是合约的最初成交日，那么交割价格$K$等于远期价格$F_0$，$f$等于0.\n- 随着时间的推移，$K$不变，$F_0$不断变动。\n\n\u003e 证明：构造组合：  \n组合A ：今天花$f$以进入这份交割价格为$K$的旧远期合约的多头  \n组合B ：以无风险利率借入一笔数额为$𝐾𝑒^{−𝑟(𝑇−𝑡)}$ 的现金（在期末还款），同时花了$S_0$购买一单位标的资产  \n期末时两种组合的现金流都等于付出合约设定的价格$K$拥有一单位标的资产，因此今天的现金流也必须相等：\n\u003e$$f=S_0-Ke^{-r(T-t)}$$  \n\n\u003e 构造组合：  \n组合A：今天花$f$以进入这份交割价格为$K$的旧远期合约的多头  \n组合B：今天在市场上进入一个新远期合约的多头（意味着交割价格为$F_0$），同时以无风险利率投资$(F_0-K)e^{r(T-t)}$元  \n期末时两种组合的现金流都等于付出合约设定的价格$K$拥有一单位标的资产，因此今天的现金流也必须相等：\n\u003e$$f=(F_0-K)e^{-r(T-t)}$$\n\n\n### 分派红利的情况\n\n#### 确定时点分派的红利\n\n假设标的资产在合约到期之前产生的收入的\u003cu\u003e现值\u003c/u\u003e为$I$：\n$$\nF_0=(S_0-I)e^{rT}\n$$\n\n#### 连续复利\n\n连续复利（红利再投资），标的资产的数量在增长。假设红利率为$q$：\n$$\nF_0=S_0e^{(r-q)T}\n$$\n\n\u003e 证明：  \n组合A：进入一个远期合约的多头  \n组合B：以无风险利率借入$S_0$，全部用来买一单位标的资产  \n期初时两组合的现金流都是0，所以期末时两组合的价值必须相等。\n\u003e $$\\begin{aligned}\nS_T-F_0\u0026=S_T+Ie^{rT}-S_oe^{rT}\\\\\nF_0\u0026=(S_0-I)e^{rT}\n\\end{aligned}$$  \n\n\u003e 组合A：进入一个远期合约的多头  \n组合B：以无风险利率借入$S_0e^{-qT}$，全部用来买$e^{-qT}$单位的标的资产  \n期初时两组合的现金流都是0，所以期末时两组合的价值必须相等。\n\u003e $$\\begin{aligned}\nS_T-F_0\u0026=S_T-S_0e^{（r-q)T}\\\\\nF_0\u0026=S_0e^{(r-q)T}\n\\end{aligned}$$\n\n\n### 外汇远期合约\n\n- 指交易双方约定在未来某一特定日期，双方按照合约签订时约定的汇率和金额，以一种货币交换对方另一种货币的合同\n\n利率平价关系\n$$\n{F}_0=S_0 e^{\\left(r_{1}-r_{2}\\right){T}}\n$$\n其中，$r_1$与$r_2$分别表示报价货币与基本货币的连续复合无风险利率；$F_0$与$S_0$表示远期汇率与即期汇率，它们都是用报价货币来表示基本货币，即1单位的基本货币相当于多少单位的报价货币。\n\n\u003e 证明：两种方式将基本货币转化为报价货币：  \n方式1：现在将一单位的基本货币换成报价货币，再以无风险利率投资一期  \n方式2：先将一单位的基本货币以无风险利率投资一期，再将其换为报价货币\n\u003e $$S_0e^{r_1T}=F_0e^{r_2T},F_0=S_0e^{(r_1-r_2)T}$$\n\n一份远期汇率合约多头头寸的价值等于：\n$$\nf=S_0e^{-r_2T}-Ke^{-r_1T}\n$$\n\n外汇可以看作提供已知收益率的资产。这里的收益率为外汇的无风险利率。\n\n### 商品期货存在收入和贮存费用时\n\n假定U为期货期限之间所有去掉收入后贮存费用的贴现值，有：\n$$\nF_0=(S_0+U)e^{rT}\n$$\n$$\nF_0=S_0e^{(r+u)T}\n$$\n\n#### 消费商品\n\n用于消费而不是投资的商品往往不提供中间收入，但这些商品可能需要很高的贮存费用。\n\n当持有商品的主要目的不是投资时，个人不愿意在即期市场出售商品并买入期货合约，因为远期和期货合约不能用于消费。\n$$\nF_0\\le (S_0+U)e^{rT}\n$$\n$$\nF_0\\le S_0e^{(r+u)T}\n$$\n\n### 便利收益率\n\n便利收益率（convenience yield）：由于持有商品而带来的好处。\n\n持有商品库存可以确保工厂的正常运作，但持有期货显然不能，或许可从暂时的商品短缺中盈利。\n\n便利收益率反映了市场对将来能够购买商品的可能性的期望。商品短缺的可能性越大，便利收益率越高。\n\n$$\nF_0e^{yT}=(S_0+u)e^{rT}\n$$\n$$\nF_0e^{yT}=S_0e^{(r+u)T}\n$$\n$$\nF_0=S_0e^{(r+u-y)T}\n$$\n\n### 持有成本\n\n持有成本：包括贮存成本加上资产的融资利息减去资产的收益。\n\n### 期货价格与预期未来即期价格\n\n|  标的资产  | 资产收益率期望$k$与无风险利率$r$之间的关系 | 期货价格$F_0$与预期未来即期价格$E(S_T)$之间的关系 |\n| :--------: | :----------------------------------------: | :-----------------------------------------------: |\n| 无系统风险 |                   $k=r$                    |                   $F_0=E(S_T)$                    |\n| 正系统风险 |                   $k\u003er$                    |                   $F_0 \u003c E(S_T)$                    |\n| 负系统风险 |                   $k \u003c r$                    |                   $F_0\u003eE(S_T)$                    |\n\n\n\n\n\n### 正常期货溢价和期货倒价\n\n- 现货溢价（normal backwardation）：期货价格低于将来即期价格期望值\n- 期货溢价（contango）：期货价格高于将来即期价格期望值\n\n## 利用期货的对冲策略\n\n### 空头对冲与多头对冲\n\n- 空头对冲（short hedge）：对冲者已经拥有某种资产并期望在将来某时刻卖出资产，或者当前不知道拥有资产但预计未来会拥有资产。\n- 多头对冲（long hedge）：已知在将来需要买入一定资产并想在今天将价格锁定。\n- 在某些行业里，如果对冲不是常规做法，公司选择与别人都不相同的做法也许没有太大意义。\n- 对冲可能会使结果更糟\n\n### 基差风险\n\n实际中的对冲问题：\n\n- 需要对冲价格风险的资产与期货合约的标的资产可能并不完全一样\n- 对冲者可能无法确定买入或卖出资产的准确时间\n- 对冲者可能需要在期货到期月之前将期货平仓\n\n基差\n\n- 基差（basis）=被对冲资产的即期价格-用于对冲的期货合约价格\n- 基差变大时称为基差增强（strengthening of the basis），基差变小时称为基差减弱（weakening of the basis）\n- 基差增强空头获利，基差减弱多头获利\n\n### 对合约的选择\n\n- 对期货合约标的资产的选择\n- 对交割月份的选择：经常选择在稍后月份交割的期货合约，防止实物交割的风险和花费。\n\n### 交叉对冲\n\n- 交叉对冲（cross hedging）：对冲时所用期货的标的资产和被对冲的资产是不一样的。\n- 对冲比率（hedging ratio）：持有期货合约的头寸数量与资产风险敞口数量的比率。\n\n#### 计算最小方差对冲比率\n\n定义：\n\n$\\triangle S$：在对冲期限内，即期价格$S$的变化；\n\n$\\triangle F$：在对冲期限内，期货价格$F$的变化；\n\n$h^*$：最小方差对冲比率。\n\n最小方差对冲比率是$\\triangle S$对$\\triangle F$进行线性回归时所产生的最优拟合直线的斜率。\n$$\nh^*=\\rho \\frac{\\sigma_S}{\\sigma_F}\n$$\n$\\sigma_S, \\sigma_F$是$\\triangle S, \\triangle F$的标准差，$\\rho$是两者之间相关系数。（通过线性回归公式和相关系数公式可推理得到。）\n\n#### 最优合约数量\n\n定义：\n\n$Q_A$：被对冲头寸的数量\n\n$Q_F$：一份期货合约的规模\n\n$N^*$：用于对冲的最优期货合约数量\n$$\nN^*=\\frac{h^*Q_A}{Q_F}\n$$\n\n#### 尾随对冲\n\n- 期货合约每天结算，考虑每一天百分比变化的标准差\n- 期限为一天的比例为：\n\n$$\\hat{\\rho} \\frac{S \\hat{\\sigma}_{s}}{F \\hat{\\sigma}_{F}}$$\n\n- 为下一天所需持有的最优合约数量：\n\n$$N^{*}=\\hat{\\rho} \\frac{S \\hat{\\sigma}_{s} Q_{A}}{F \\hat{\\sigma}_{F} Q_{F}}$$\n\n### 向前滚动对冲\n\n- 对冲的期限要比所有能够利用的期货期限更长，这时对冲者必须对到期的期货进行平仓，同时再进入具有较晚期限的合约。这种做法被称为向前滚动对冲（stack and roll）。\n- 考虑流动性的潜在问题\n\n## 股指期货\n\n- 是指由交易双方签订的，约定在将来某一特定时间和地点交收“一定点数的股票价格指数”的标准化期货合约，亦即是以股票价格指数 （投资组合）为交易标的物的一种期货合约。\n\n### 合约规格\n\n- 合约价格：\u003cu\u003e指数期货价格\u003c/u\u003e乘以一个指数点的价值\n- 指数期货的面值：\u003cu\u003e股票指数\u003c/u\u003e乘以一个指数点的价值\n\n### 最优合约数量\n\n定义：\n\n$V_A$：股票组合的当前价值。\n\n$V_F$：一份期货的当前价值（定义为期货价格乘以期货规模）。\n$$\nN^*=\\beta\\frac{V_A}{V_F}\n$$\n\n### 对冲股权组合的理由\n\n- 传统的股票市场风险管理只是通过调整股票构成和头寸改变投资组合的系统风险\n    - 缺点：\n        - 交易成本高、调整速度慢、可能不得不降低$\\alpha$\n        - 投资者对市场的整体风险很不确定，但确信组合中的股票收益会高于市场的收益。\n- 对冲者计划在很长一段时间内持有股票组合，但需要在短时间内对市场的不确定性进行保护。\n\n### 改变组合的beta\n\n当将组合的beta从$\\beta$变为$\\beta^*$时，\n\n如果$\\beta\u003e\\beta^*$，所持期货空头的数量应当为：\n$$\n(\\beta-\\beta^*)\\frac{V_A}{V_F}\n$$\n如果$\\beta\u003c\\beta^*$，所持期货多头的数量应当为：\n$$\n(\\beta^*-\\beta)\\frac{V_A}{V_F}\n$$\n\n### 锁定挑选股票的优势\n\n投资者确认自己持有的股票将比市场表现要好，持有的股指期货合约空头数量为：\n$$\n\\beta\\frac{V_A}{V_F}\n$$\n其中$\\beta$为持有的股票的beta值，$V_A$为持有的股票价值，$V_F$为一份股指期货合约的价值。\n\n\n",title:"Untitled Page"},"/Published/MBS Duration":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n\n## 久期和凸性的定义\n\n![久期和修正久期](利率及利率衍生品#久期和修正久期)\n\n![久期和修正久期](利率及利率衍生品#凸性)\n\n\n## 有效久期 (Effective Duration)\n\n根据之前提到的[OAS](OAS.md)定义，有效久期的计算方法如下：\n\n- 根据市场价格P计算OAS.\n- 将收益率曲线平行向上移动$\\Delta y$，再加上用市场价格计算出的 OAS重新定价$P^{+}$.\n- 将收益率曲线平行向下移动$\\Delta y$，再加上用市场价格计算出的 OAS重新定价$P^{-}$.\n\n\n有效久期为：\n\n$$\nD=\\frac{P^{-}-P^{+}}{2P\\Delta y} \\times 100\n$$\n\n\n### 有效久期没有考虑的风险因素\n\n#### 国债曲线的变化\n\n在使用上述公式用有效久期预测价格变化时，我们认为整条利率曲线是**平行移动**的，并用10年期国债利率的变化代表整条利率曲线的变化。如果国债曲线的形状变得更陡峭或者更平缓，继续使用久期与利率变化的乘积来预测价格变化就会不够准确。\n\n#### 当前票息价差 (Current Coupon Spread)\n\nCurrent Coupon指的是目前市场价格恰好为面值 (par value) 的MBS的coupon（考虑了servicing fee之后），一般由线性插值得出，可以看做是par value MBS pass-through的yield. 大多数新发起的抵押贷款都以接近面值的票面利率证券化，因此current coupon yield可以被认为是新贷款的二级市场利率 (mortgage rate)。\n\nCurrent Coupon Spread是指current coupon和treasury rate之间的差值，相当于par value MBS pass-through的treasury OAS，也相当于mortgage rate和treasury rate之间的差值。\n\n有效久期的计算假设current coupon spread和国债利率之间是线性关系。但实际并非如此。如果current coupon spread增加，则说明相对于国债利率，贷款利率更高了，借款人的再融资动机减弱，所以提前还款的风险降低，久期增加，价格有可能上升。Current coupon spread的partial duration也因此是负的。利率曲线的形状、波动率、提前还款风险都会影响current coupon spread.\n\n\n#### 凸性或不对称价格变动\n\n由于 MBS 存在[提前偿还风险](MBS%20Modelling.md#早偿情况的分析)，所以利率下降时，再融资比例可能上升，借款人会选择提前偿还手中的贷款。因此对投资者来讲，**这相当于原本很长的久期突然变小了**。所以利率下降时，MBS的久期也有可能变小，其凸性是负的。这意味着，在其他条件相同的情况下，使用有效久期预测价格，将在利率下降时高估价格，而在利率上升时低估价格。\n\n投资于RMBS的机构持有者一般会在多RMBS的同时空国债作为对冲。由于MBS的负凸性性质，**利率上行，MBS久期增加，持有者就要卖空更多的国债以对冲久期，国债利率继续上行**。反之亦然。因此，MBS的负凸性可能是市场利率大幅变动的一个原因。\n\n\n\n#### 利率波动率\n\n利率的波动率可能会随着期限变化而改变，也有可能存在波动率聚集的现象。但使用有效久期预测价格时，认为利率曲线是平行移动的，没有考虑波动率的情况，可能会造成对价格的高估或低估。\n\n## 实际久期 (Empirical Duration)\n\n实际久期是指从市场数据中用回归分析的方式来估计久期。\n\n理论上有\n$$\n\\frac{\\Delta B}{B}=-D\\Delta y\n$$\n\n所以用$\\frac{\\Delta B}{B}$作为因变量，国债利率的变化作为自变量，采用过去一段时间的数据进行回归，回归的斜率估计量$\\beta$就是实际久期。\n\n## 有效久期和实际久期之间的关系\n\n如果其他的风险因素和国债利率变化之间存在相关性，则有效久期和实际久期之间就会有所不同。由线性回归的估计量性质，忽略价格变化的高阶项，有：\n\n$$\nD_{\\text{Empirical Estimate}} = D_{\\text{Current Effective}}+\\mu+D_{s} \\rho_{\\Delta s \\Delta y} \\frac{\\sigma_{\\Delta s}}{\\sigma_{\\Delta y}}+D_{v} \\rho_{\\Delta v \\Delta y} \\frac{\\sigma_{\\Delta v}}{\\sigma_{\\Delta y}}+\\ldots+\\varepsilon\n$$\n\n其中$\\mu$是当前有效久期和实际久期之差的平均值；$\\rho_{\\Delta s \\Delta y}$是相关系数；$\\sigma_{\\Delta s}$是标准差。\n\n如果风险因素的变化（如每日OAS）和国债收益率变化之间呈负相关，那么**实际久期将短于有效久期**。\n\n## 另一种实际久期的计算\n\n实际久期计算中的一个隐含假设是**国债收益率变化会立刻影响到同一天的MBS价格**。然而，流动性不够活跃的MBS不一定满足这个假设。例如，高溢价MBS的流通量很小，大部分交易都在SP进行，而不是TBA市场。因此，高溢价TBA的价格变化通常会滞后于国债收益率的变化，如果用同一天的价格变化进行回归，会导致对实际久期的估计偏低。\n\n为了解决这个问题，可以选用一段时间的MBS价格对国债收益率进行回归 ($ln\\ P =\\alpha + \\beta y+\\varepsilon, \\frac{dP/dy}{P} =−Duration = \\beta$)，斜率就是实际久期的估计量。它描述了**一段时间内**MBS价格和国债收益率水平之间的关系，因此这样计算出的久期可能不利于对冲每天的收益率曲线波动。\n\n## 久期和对冲\n\n有效久期可以对冲收益率曲线平行移动时发生的价格变化。使用有效久期意味着认为其他风险因素不变。\n\n实际久期假设过去的国债收益率变化与其他风险因素变化之间的关系将继续存在且相同。因此，如果风险因素和国债收益率之间的相关性发生了改变，使用实际久期可能会出现错误。\n\n\n\n\n\n\n\n## 参考文献\n\n\nHayre, L. (Ed.). (2001). _Salomon Smith Barney guide to mortgage-backed and asset-backed securities_. John Wiley.\n\n[RMBS随谈录4：RMBS对冲—美国固收市场大幅变动时的尾大摇身现象](https://mp.weixin.qq.com/s/QPGKf8RZiQNxkkNQoj3Rlg)\n\n[Managing Against MBS Indexes: A Duration Perspective](https://www.msci.com/www/blog-posts/managing-against-mbs-indexes-a/02667007821)\n\n[Measuring MBS curve risk with Implied Mortgage Rate Sensitivity (“IMS”) approach](https://research-doc.credit-suisse.com/docView?language=ENG\u0026format=PDF\u0026source_id=csplusresearchcp\u0026document_id=1041260871\u0026serialid=0MH9veO3E0x5Z%2B76qli7rYOAyJDVt7fLdbi2VSkop%2FA%3D\u0026cspId=null)\n\n[Can MBS Duration Turn Negative?](https://www.msci.com/www/blog-posts/can-mbs-duration-turn-negative/02108224451)",title:"Untitled Page"},"/Published/MBS Modelling":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n\n# 抵押贷款支持证券\n\n资产证券化是指将能够产生可预见的稳定现金流的资产，通过一定的结构安排，对资产中风险与收益要素进行分离与重组，进而转换成为在金融市场上可出售、可流通的证券的过程。\n \n设法剥离主体带来的不确定性，以“物的信用”替代“主体信用”，以基础资产“自动变现”产生现金流为偿付支持发行标准化债务证券，通过引入第三方机构、架设结构化交易安排来拆解、控制道德风险，就是“资产支持证券”的核心理念。\n \n最早出现的资产支持证券是20世纪70年代诞生的以住宅抵押贷款为基础资产的RMBS，之后又陆续诞生了以其他信贷资产为支持的证券。\n\n传统的MBS交易结构中没有分层设计，所发行的证券之间不存在偿付次序、风险等级的区别，这种结构被称为“过手型” (pass-through) 结构。相对而言，将现金流进行分层、增信之后再按先后次序支付给不同等级证券投资人的交易结构叫作“转付型” (pay-through) 结构。\n\n和其他固定收益类产品一样，MBS的价值可以用现金流折现进行评估：\n\n$$\nV=\\sum_{i=1}^N\\frac{CF_i}{(1+d)^i}\n$$\n\n其中$d$为折现率 (discount rate). \n\n折现率和当前抵押贷款挂钩的利率种类的远期利率有关，可以采用随机过程模型对远期利率进行建模。如：\nVasicek Model\n$$\ndR_t=a(b-R_t)dt+\\sigma dW_t\n$$\nCIR Model\n$$\ndR_t=a(b-R_t)dt+\\sigma \\sqrt R_t dW_t\n$$\nHull-White Model\n$$\ndR_t=a(b_t-R_t)dt+\\sigma dW_t\n$$\n\n但不同的是，由于借款人可以选择提前偿还贷款，所以每一期的现金流是不确定的，会受到利率的影响。即：\n$$\nCF_i=f(r)\n$$\n\n市场利率上升会导致抵押贷款支持证券出现延长风险 (extension risk)。收益率上行时，预期中的提前还款速度放缓，导致抵押贷款支持证券投资者收回本金的时机延后。投资人将因为延后收回本金而错过在收益率较高时进行再投资的机会。如果利率继续上升，低票息抵押贷款支持证券的价格下跌，高票息抵押贷款支持证券的表现要好于低票息抵押贷款支持证券。\n\n\n市场利率下降将出现抵押贷款者提前清偿的风险 (prepayment risk)，使抵押贷款支持证券投资人被迫降低仓位，存续期限缩短。\n\n因此，在对MBS进行建模时，既要对每一期的折现情况进行建模，也要估计每一期现金流的情况。\n\n\n## 抵押贷款的现金流\n假设某支抵押贷款的年息票利率为$\\hat C$，到期日为$N$个月。令：\n$$\nc=\\frac{\\hat C}{12}, d=\\frac{1}{1+c}\n$$\n假设名义本金为单位1，每月还款额 (Scheduled monthly payment)为$m$，则应该有\n$$\n1=\\sum_{i=1}^N \\frac{m}{(1+c)^i}\n$$\n解得\n$$\nm=\\frac{c}{1-d^N}\n$$\n\n第$j$个月底，设尚未还款的余额为$B_j$，有\n$$\n\\sum_{i=1}^{j}\\frac{m}{(1+c)^i}+B=(1+c)^j\n$$\n得\n$$\nB_j=\\frac{1-d^{N-j}}{1-d^N}\n$$\n第$j$个月的利息偿还额为\n$$\nI_j = cB_{j−1}=\\frac{c\\left(1-d^{N-j+1}\\right)}{1-d^{N}}\n$$\n第$j$个月的本金偿还额为\n$$\nP_j = m-I_j=m-cB_{j−1}=\\frac{cd^{N-j+1}}{1-d^{N}}\n$$\n\n\n## 早偿情况的分析\n\n利率走低时，借款人更倾向于提前还贷，用更低利率的贷款置换现有贷款；利率走高时，借款人则倾向于放慢还贷速度，更多的享受低息好处。\n\n每月早偿率 (single monthly mortality rate, SMM) 衡量了贷款池中在当月提前偿还的比率：\n\n$$\nSMM=\\frac{Scheduled\\ balance − Ending\\ balance}{Scheduled\\ balance}\n$$\n\n条件早偿率 (Conditional Prepayment Rate, CPR) 是SMM的年化结果：\n$$\nCPR=1-(1-SMM)^{12}\n$$\n\n### PSA模型\n\nPSA模型 (Public Securities Association Model) 是估计早偿率的一种经验方法：第一个月的CPR设为0.2%，此后每个月增加0.2%的CPR，直到第30个月后，始终维持CPR为6%不变。150PSA的假设意味着要将PSA模型乘以150%。\n\n该模型的基本假设是，成立时间越久的抵押贷款，提前还贷的可能性越大，越是新贷款，提前还贷的可能性越小；但是，在贷款成立30个月之后，提前还贷比率将稳定在一个恒定的值而不再变化。\n\n\n### 影响早偿率的因素\n\n#### 主要因素\n\n**借款人再融资的动力 (Incentive to Refinance)**\n- 如果市场抵押贷款利率下降，抵押贷款者将有动力提前偿还贷款然后以较低的利率进行再融资，因此提高了早偿率。\n- 一般用现行市场利率和抵押贷款者的利率的差值来衡量借款人再融资的动力。\n\n**贷款持有时间 (Age of a Mortgage)**\n- 抵押贷款人可能因为工作调动、家庭因素、房屋价格影响而选择置换房屋，为此需要清偿抵押贷款，因此房屋换手情况对早偿率有影响。\n- 类似于PSA模型，将房屋换手率和抵押贷款人的贷款持有时间相关联，一般贷款账龄在30个月时CPR将达到顶峰。\n\n\n**季节因素**\n- 不同的月份和季度，还款人提前偿还的概率不同，主要和家庭因素相关（如为孩子上学而搬家），房屋的销售也有季节性。\n\n**贷款人的倦怠 (Borrower Burnout)**\n- 虽然一般情况下，利率下降会导致借款人有动力进行再融资，但有些时候会发现，即使利率下降，借款人也没有提前偿还。这可能是因为借款人此前已经提前还款过了，或者是这个池中的借款人对利率不敏感，不会进行再融资。\n- Burnout是用来捕捉某个特定的MBS中不同贷款的异质性，关注这个池中借款人之前的提前偿还记录，通过之前的行为来推测之后是否会有提前偿还的动力。\n	- 再融资速度：通过借款人从利率下降到进行再融资的反应时间判断这是一个快速还款人还是一个慢速还款人\n	- 逆向选择：信用条件较好的借款人会比信用条件更差的还款人更快进行再融资   \n$$\n\\text{burnout} = \\text{exp}^{\\beta_1\\times \\text{Loan\\ Age}+\\beta_2\\times \\text{Incentive}}\n$$\n$$\n\\text{where Incentive = Max[(Note rate − Mtg. rate), Start value]}\n$$\n- 其中$\\beta_1,\\beta_2$可以根据经验确定Burnout衡量了某个借款人是否会是快速还款人的先验概率。\n\n#### 其他因素\n\n**房价 (House Price Index, HPI)**\n**信用评分 (FICO)**\n**债务收入比 (Debt-to-Income Ratio, DTI)**\n**贷款价值比 (Loan-to-Value Ratio, LTV)**\n**贷款余额**\n- 由于再融资存在固定费用，对贷款余额较低的借款人来说，固定费用的占比会上升，所以余额较低的借款人需要更高的市场利率和原贷款利率差值才有提前还款再融资的动机。\n\n**贷款期限**\n- 通常，具有更强信用和更大财务灵活性的借款人会选择更短的摊销期限，这意味着 15 年的借款人可能比 30 年的借款人表现出更大的再融资倾向。\n\n**贷款利率类型**\n- 与标准固定利率抵押贷款相比，借款人可以选择可调整利率或混合抵押贷款（初始固定利率随后是可调整利率的抵押贷款），以获得较低的相对起始付款。不断浮动的贷款利率可能会激励借款人再融资。\n\n\n### 生存分析建模\n\nSchwartz和Torous利用1978-1987的美国30年期GNMA MBS数据，建立生存分析(survival analysis)模型，用Cox Proportional-hazards Model来对早偿率进行建模。\n\n设某个抵押贷款从开始到提前偿还的时间为连续随机变量$T$，$t$是其实现。设$\\underline{v}=\\left(v_{1}, v_{1}, \\cdots, v_{s}\\right)$为由影响早偿率的各种变量组成的向量，$\\underline{\\theta}=\\left(\\theta_{1}, \\theta_{2}, \\cdots, \\theta_{k}\\right)$是需要估计的系数值。早偿率函数$\\lambda(t ; \\underline{v}, \\underline{\\theta})$可以写为：\n$$\n\\begin{aligned}\n\\lambda(t ; \\underline{v}, \\underline{\\theta}) \u0026=\\lim _{\\Delta t \\rightarrow 0^{+}} \\frac{P(t \\leq T\u003ct+\\Delta t \\mid T \\geq t)}{\\Delta t} \\\\\n\u0026=\\frac{f(t ; \\underline{v}, \\underline{\\theta})}{F(t ; \\underline{v}, \\underline{\\theta})}\n\\end{aligned}\n$$\n其中$f(t)$是$T$的概率密度函数，$F(t)$是$T$的分布函数。\n$$ \nF(t ; \\underline{v}, \\underline{\\theta})=P(T \\geq t \\mid \\underline{v}, \\underline{\\theta}) \n$$\n\n$$ \nf(t ; \\underline{v}, \\underline{\\theta})=\\lim _{\\Delta t \\rightarrow 0^{+}} \\frac{P(t \\leq T\u003ct+\\Delta t)}{\\Delta t}=-\\frac{dF(t)}{dt}\n$$\n\n使用Cox Proportional-hazards Model对早偿率进行建模：\n\n$$\n\\lambda(t ; \\underline{v}, \\underline{\\theta})=\\lambda_{0}(t ; \\gamma, p) \\exp (\\underline{\\beta} \\underline{v})\n$$\n其中基准风险函数 (base-line hazard function) $\\lambda_{0}(t ; \\gamma, p)$由对数逻辑斯谛函数(log-logistic hazard function)的形式给出\n\n$$\n\\lambda_{0}(t ; \\gamma, p)=\\frac{\\gamma p(\\gamma t)^{p-1}}{1+(\\gamma t)^{p}}\n$$\nBase-line hazard function衡量的是没有考虑其它解释变量时提前偿还的风险： $\\underline{v}=\\underline{0}$. Log-logistic hazard function考虑了早偿率和贷款年龄之间的关系。如果$p\u003e1$, 提前偿还的风险从0逐渐上升到最大值：\n$$\nt^{*}=(p-1)^{1 / p} / \\gamma\n$$\n\n$\\underline{v}$中还包括影响MBS价格的其他因素，包括借款人的还款激励、此前提前还款的情况、季节因素等。\n\n\n## 违约情况的分析\n\n### 影响违约率的因素\n\n**房价 (House Price Index, HPI)**\n**信用评分 (FICO)**\n**债务收入比 (Debt-to-Income Ratio, DTI)**\n**贷款价值比 (Loan-to-Value Ratio, LTV)**\n**贷款金额 (Loan Size) 及其对数**\n**贷款种类**\n	- 固定利率、浮动利率等\n**物业类型**\n	- 独栋、3-4人合并住宅等\n**占有人类型 (Occupancy Type)**\n	- 原所有人占有（owner-occupied）、第二住宅（second home）、非所有人占有（non-owner-occupied）等\n**借款目的 (Loan Purpose)**\n	- 购买住宅 (Purchase)\n	- 再融资 (Refinance)\n	- 将住宅再融资以取得现金 (Cashout)\n\n### 对违约过程建模\n\nMBS的违约过程是一个多状态的过程，可以看作一个连续时间的马尔科夫链：\n$$\nS=\\left[\\begin{array}{l}\nS_{1} \\\\\nS_{2} \\\\\nS_{3} \\\\\nS_{4} \\\\\nS_{5}\n\\end{array}\\right]=\\left[\\begin{array}{c}\n\\text { Current } \\\\\n60+\\text { Days Delinquent } \\\\\n\\text { In Foreclosure } \\\\\n\\text { REO } \\\\\n\\text { Liquidated }\n\\end{array}\\right]\n$$\n\n$$\nD(t)=\\left[\\begin{array}{ccccccc}\n-\\lambda_{1}(t) \u0026 \\lambda_{1}(t) \u0026 0 \u0026 0 \u0026 \\ldots \u0026 0 \u0026 0 \\\\\n0 \u0026 \\lambda_{2}(t) \u0026 -\\lambda_{2}(t) \u0026 0 \u0026 \\cdots \u0026 0 \u0026 0 \\\\\n\\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \\\\\n0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\ldots \u0026 -\\lambda_{n-1}(t) \u0026 \\lambda_{n-1}(t) \\\\\n0 \u0026 0 \u0026 0 \u0026 0 \u0026 \\ldots \u0026 0 \u0026 0\n\\end{array}\\right]\n$$\n其中 $\\lambda_{j}(t)$ 是transitions $S_{j} \\rightarrow S_{j+1}$过程的风险函数。\n\n因此可以将MBS的违约步骤分拆成几个生存分析过程，然后再对每个过程进行建模。\n\n## 房价指数分析\n\n房屋价格水平会影响早偿率和违约率。如果房价下跌，借款人违约的可能性升高。对HPI/HPA的建模是一个比较复杂的过程，可以考虑将HPI看作一个随机过程：\n$$\nd HPI =a dt +\\sigma_w dz\n$$\n$\\sigma_w$是波动率，$a$是漂移，$z$是布朗运动。\n\nHPA（房价指数增长率）是HPI的年回报率。白噪声+扩散模型可以用来对HPA进行建模：有：\n$$\nHPA=\\frac{d HPI}{dt} = a+\\sigma_w w\n$$\n\n\n设$\\sigma_d$是HPA扩散的波动率，一阶扩散模型的理论统计量的函数是\n\n$$\n\\begin{gathered}\n\\operatorname{stdev}[H P A(t)]=\\left[\\sigma_{d}^{2} \\frac{1-e^{-2 a t}}{2 a}+\\sigma_{w}^{2}\\right]^{\\frac{1}{2}} \\\\\n\\operatorname{Corr}[\\operatorname{HPA}(T), H P A(t+T)] \\underset{T \\rightarrow \\infty}{\\rightarrow e^{-a t} \\frac{1}{1+2 a \\sigma_{w}^{2} / \\sigma_{d}^{2}}}\n\\end{gathered}\n$$\n\n\n## Reference\n\n[Andrew Lesniewski, Interest Rate and Credit Models: 13. Mortgage Backed Securities](https://mfe.baruch.cuny.edu/wp-content/uploads/2019/12/IRC_Lecture13_2019.pdf)\n\nSchwartz, E. S., and W. N. Torous, 1989, “Prepayment and the Valuation of Mortgage-Backed Securities,” Journal of Finance, 44, 375–392.\n\nDavidson, A., and Levin, A.: Mortgage Valuation Models: Embedded Options, Risk, and Uncertainty, Oxford University Press (2014).\n\nGlenn M. Schultz: Investing in Mortgage-Backed and Asset-Backed Securities, Wiley Finance, 2015\n\n[李力，雕刻现金流：从证券化到项目融资，中信出版集团股份有限公司，2017](https://weread.qq.com/web/reader/78c32f805e10dc78c9981c5kc81322c012c81e728d9d180)\n\n[林华，中国资产证券化产品投资手册，中信出版集团股份有限公司，2017](https://weread.qq.com/web/reader/cab3224071ae93c6cabb193kc81322c012c81e728d9d180)\n\n\n",title:"Untitled Page"},"/Published/MOC":{content:"## Stats\n\n[Probability and Random Process](Published/Probability%20and%20Random%20Process.md)\n\n[Statistical Inference](Published/Statistical%20Inference.md)\n\n[Regression Analysis](Published/Regression%20Analysis.md)\n\n[Econometrics](Published/计量经济学.md)\n\n\n\n## Finance\n\n\n\n\n[Options](Published/Options.md)\n\n[Futures](Published/Futures.md)\n\n[Swaps](Published/Swap.md)\n\n[Rates](Published/利率及利率衍生品.md)\n\n[MBS Modelling](Published/MBS%20Modelling.md)\n\n[OAS](Published/OAS.md)\n\n[MBS Duration](Published/MBS%20Duration.md)\n\n[Financial Market](Published/金融市场与金融机构.md)\n\n[Money and Banking](Published/货币金融学.md)\n\n[Dollar Roll](Published/TBA%20Market%20and%20Dollar%20Roll.md)\n\n\n## Coding\n\n\n\n[Data Preprocessing and EDA](Published/Notes/Data%20Preprocessing%20and%20EDA.md)\n\n",title:"Untitled Page"},"/Published/OAS":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n## MBS的内嵌期权\n\n当贷款发放之后，借款人存在[提前偿还的权利](MBS%20Modelling.md#早偿情况的分析)，可以灵活地根据利率水平选择是否提前偿还。\n\n如果利率变低，借款人可以选择再融资，以更低的价格获得同样的贷款。拥有看涨期权 (call option) 意味着可以通过较低的价格来获得标的资产，所以抵押贷款的借款人相当于拥有一个看涨期权；类似地，MBS的投资者则相当于卖出一个看涨期权 (short a call option). 同样，借款人也有选择违约并将抵押物（住房）还给银行的权利，相当于拥有一个看跌期权（房价跌到比贷款的价值还低）；类似地，MBS的投资者则相当于卖出一个看跌期权 (short a put option). \n\n因此，MBS可以看做**内嵌期权**的固定收益产品，可以用**Option-Adjusted Spread**来衡量期权因素对价格的影响。\n\n## OAS的计算方法\n\nOAS是基于不同状态下的利率$r_{t}$使得MBS预期现金流的现值等于该MBS的市场价格所需收益率价差。可以按以下方法倒解出OAS：\n\n设$r_{t}, t=1, \\cdots, T$是利率曲线，给定$r_{j t}, t=1, \\cdots, T$是状态 $j=1, \\cdots, N$下的利率，每个状态下MBS的现金流可以由$C_{j t}, t=1, \\cdots, T$确定，OAS被定义为：\n$$\nV_{M B S}=\\sum_{j=1}^{N} p_{j}\\left[\\sum_{t=1}^{T} \\frac{C_{j t}}{\\left(1+r_{j 1}+O A S\\right) \\times \\cdots\\left(1+r_{j t}+O A S\\right)}\\right]\n$$\n其中 $p_{j}$ 是状态 $j$的概率。\n\n常见的利率模型有以下几种：\n\n**Vasicek Model**\n$$\ndR_t=a(b-R_t)dt+\\sigma dW_t\n$$\n**CIR Model**\n$$\ndR_t=a(b-R_t)dt+\\sigma \\sqrt R_t dW_t\n$$\n**Hull-White Model**\n$$\ndR_t=a(b_t-R_t)dt+\\sigma dW_t\n$$\n\n通过**蒙特卡洛**模拟不同的利率曲线随机变化的情况，可以计算出OAS.\n\n\n## OAS与Z-Spread\n\nZ-Spread是基于目前的即期利率曲线 (spot curve) 计算出的使现金流的现值等于市场价格的价差。\n\n$$\nP=\\sum_{t=1}^{T} \\frac{C_{t}}{\\left(1+r_{t}+Z\\right) ^t}\n$$\n\n其中$r_t$是目前$t$年期的即期利率。\n\n例如，某三年期债券目前的价格为104.90，coupon rate为5%，每年付息一次。相应的一年、两年和三年期零息国债利率（每半年复利一次）分别为2.5%、2.7%和3%。计算Z-Spread的方法为：\n\n$$\n104.9 = \\frac{5}{(1+\\frac{0.025+Z}{2})^2}+\\frac{5}{(1+\\frac{0.027+Z}{2})^4}+\\frac{105}{(1+\\frac{0.03+Z}{2})^6}\n$$\n\n\nZ-Spread和OAS的差值可以衡量投资者由于short an option导致的收益率变化：\n\n$$\nZ-Spread = OAS+Option\\ Cost\n$$\n\n例如，如果现在以下两个MBS的Z-Spread和OAS如下所示：\n\n| | MBS 4.00% | MBS 5.50%|\n|---|---|---|\n|Zero Volatility Spread |1.22% |2.09%|\n|Option-Adjusted Spread |0.49%| 0.19%|\n\n则MBS 4.00%的short option value为0.73%，MBS 5.50%的short option value为1.90%. OAS说明了投资者卖出期权的价值，在这个例子中MBS 5.50%的short option value更高，所以MBS 5.50%的YTM更高。\n\n与静态现金流分析相比，OAS可以更清晰地让投资者理解MBS的模型价格。通过选取不同的利率模型，投资者可以观察不同收益率曲线形状的影响，并对**未来的利率进行了模拟**，研究利率对MBS收益率的影响。但OAS分析受限于利率模型和提前还款模型的选取，不同的模型构建方法会影响OAS的分析结果。\n\n## Reference\n\nGlenn M. Schultz: Investing in Mortgage-Backed and Asset-Backed Securities, Wiley Finance, 2015",title:"Untitled Page"},"/Published/Options":{content:"## Properties of Options\n\n### Factors affecting option prices\n![](Pasted%20image%2020220220232341.png)\n\n### Call-Put Parity\n\nPortfolio A : one European call option plus a zero-coupon bond that provides a payoff of $K$ at time $T$ Portfolio B : one European put option plus one share of the stock.\n\n$$c+Ke^{-rT}=p+S_0$$\n\n### American Options\n\n-   It is **never optimal to exercise an American call option** on a non-dividend-paying stock before the expiration date.\n-   A call option, when held instead of the stock itself, in effect insures the holder against the stock price falling below the strike price. Once the option has been exercised and the strike price has been exchanged for the stock price, this insurance vanishes.\n-   The time value of money. From the perspective of the option holder, the later the strike price is paid out the better.\n-   _What if the investor thinks the stock is currently overpriced and is wondering whether to exercise the option and sell the stock? In this case, the investor is better off selling the option than exercising it._\n\n$$C\\geq c\\geq S_0-Ke^{-rT}\u003eS_0-K$$\n\n-   It can be optimal to exercise an American put option on a non-dividend-paying stock early. Indeed, at any given time during its life, the put option should always be exercised early if it is sufficiently deep in the money.\n\n## Trading Strategies\n\n### Principal-protected notes\n\n-   A 3-year zero-coupon bond with a principal of $1,000\n-   A 3-year at-the-money European call option on the stock portfolio.\n\n### Option and Underlying Asset\n\n-   writing a covered call: the portfolio consists of **a long position in a stock** plus **a short position in a European call option.**\n-   protective put strategy: the investment strategy involves **buying a European put option** on a stock and **the stock itself.**\n\n### Bull Spreads\n\n-   **buying** a European **call** option on a stock with a certain strike price and **selling** a European **call** option on the same stock **with a higher strike price**. Both options have the same expiration date.\n-   The strategy can be described by saying that the investor has a call option with a strike price equal to $K_1$ and has chosen to give up some upside potential by selling a call option with strike price $K_2 (K2 \u003e K1)$.\n\n### Bear Spreads\n\n-   Bear spreads can be created by **buying** a European **put** with one strike price and **selling** a European **put** with another strike price. The strike price of the option purchased is greater than the strike price of the option sold.\n-   The investor has bought a put with a certain strike price and chosen to give up some of the profit potential by selling a put with a lower strike price\n\n### Box Spreads\n\n-   A box spread is a combination of a bull call spread with strike prices $K_1$ and $K_2$ and a bear put spread with the same two strike prices.\n-   The payoff from a box spread is always $K_2-K_1$. The value of a box spread is therefore always the present value of this payoff or $(K_2-K_1)e^{-rT}$ .\n\n### Butterfly Spreads\n\n-   A butterfly spread involves positions in options with three different strike prices.\n-   It can be created by\n    -   buying a European call option with a relatively low strike price $K_1$,\n    -   buying a European call option with a relatively high strike price $K_3$,\n    -   and selling two European call options with a strike price $K_2$ that is halfway between $K_1$ and $K_3$.\n-   Generally, $K_2$ is close to the current stock price.\n\n### Calendar Spreads\n\n-   A calendar spread can be created by **selling a European call option with a certain strike price** and **buying a longer-maturity Eurpean call option with the same strike price.**\n-   The longer the maturity of an option, the more expensive it usually is.\n\n### Straddle\n\n-   buying a European call and put with the same strike price and expiration date.\n\n### Strips\n\n-   A strip consists of a long position in **one European call and two European puts** with the same strike price and expiration date.\n-   In a strip the investor is betting that there will be a big stock price move and considers a decrease in the stock price to be more likely than an increase.\n\n### Straps\n\n-   A strap consists of a long position in **two European calls and one European put** with the same strike price and expiration date.\n-   In a strap the investor is also betting that there will be a big stock price move. However, in this case, an increase in the stock price is considered to be more likely than a decrease.\n\n### Strangles\n\n-   In a strangle, an investor **buys a European put and a European call with the same expiration date and different strike prices**.\n\n## Binomial Tree\n\n### Riskless\n\nWe imagine a portfolio consisting of a long position in $H$ shares and a short position in one option. At the beginning, the value is\n\n$$HS_0+C_0$$\n\nIf there is an up movement in the stock price, the value of the portfolio at the end of the life of the option is\n\n$$HS_u+C_u$$\n\nIf there is a down movement in the stock price, the value becomes\n\n$$HS_d+C_d$$\n\nRiskless:\n\n$$HS_u+C_u=HS_d+C_d=e^{r}(HS_0+C_0)$$\n\nCalculate $C_0$.\n\n### Replicate Portfolios\n\nWe imagine a portfolio consisting of a long position in $H$ shares and $B$ bonds.\n\n$$HS_u+e^{r}B=C_u,\\ HS_d+e^{r}B=C_d$$\n\n$$C_0=HS_0+B$$\n\n### Risk Neutral\n\nThe option pricing formula in equation does not involve the probabilities of the stock price moving up or down.\n\nThe probabilities of future up or down movements are already incorporated into the stock price: we do not need to take them into account again when valuing the option in terms of the stock price.\n\nA risk-neutral world has two features that simplify the pricing of derivatives:\n\n-   The expected return on a stock (or any other investment) is the risk-free rate.\n-   The discount rate used for the expected payoff on an option (or any other instrument) is the risk-free rate.\n\n$$S_0=e^{-r}[qS_u+(1-q)S_d]$$\n\nsolve $q$, and plug in:\n\n$$C_0=e^{-r}[qC_u+(1-q)C_d]$$\n\n### Derivation the BSM Formula from a Binomial Tree\n\n**See John Hull OFD C13 Appendix**\n\n## Continuous Time Finance\n\n### Brownian Motion\n\nA continuous stochastic process $W(t), t \\geq 0,$ is a Brownian motion if\n\n-   $W(0)=0$\n-   The increments of the process $W\\left(t_{1}\\right)-W(0), W\\left(t_{2}\\right)-W\\left(t_{1}\\right), \\cdots, W\\left(t_{n}\\right)-W\\left(t_{n-1}\\right),$$\\forall 0 \\leq t_{1} \\leq t_{2} \\leq \\cdots \\leq t_{n}$ are independent\n-   Each of these increments is normally distributed with distribution $W\\left(t_{i+1}\\right)-W\\left(t_{i}\\right) \\sim N\\left(0, t_{i+1}-t_{i}\\right)$\n\n### Ito Formula\n\n$$d f=\\left(\\frac{\\partial f}{\\partial t}+\\beta(t, X) \\frac{\\partial f}{\\partial x}+\\frac{1}{2} \\gamma^{2}(t, X) \\frac{\\partial^{2} f}{\\partial x^{2}}\\right) d t+\\gamma(t, X) \\frac{\\partial f}{\\partial x} d W(t)$$\n\nfrom Taylor's formula as quadratic variation = $dWdW=dt$\n\n### BSM Formula\n\nAssumptions\n\n1.  The stock price follows $dS_t=\\mu S_t dt+\\sigma S_t dW_t$ with $\\mu$ and $\\sigma$ constant.\n2.  The short selling of securities with full use of proceeds is permitted.\n3.  There are no transaction costs or taxes. All securities are perfectly divisible.\n4.  There are no dividends during the life of the derivative.\n5.  There are no riskless arbitrage opportunities.\n6.  Security trading is continuous.\n7.  The risk-free rate of interest is constant and the same for all maturities.\n\n#### Lognormal Property of Stock Prices\n\nStock Price\n\n$$dS_t=\\mu S_t dt+\\sigma S_t dW_t$$\n\nReturn\n\n$$dR_t=\\mu dt+\\sigma dW_t$$\n\n#### Reallocate the wealth\n\nA self-financing strategy to reallocate the wealth $X_t$:\n\n-   long or short $\\Delta_t$ shares of stocks;\n-   borrow or lend the $X_t-\\Delta_tS_t$ amount of money\n\n$$\\begin{aligned}dX_t\u0026=\\Delta_tdS_t+r(X_t-\\Delta_tS_t)dt\\\\\u0026=\\Delta_t[\\mu S_tdt+\\sigma S_tdW_t]+r(X_t-\\Delta_tS_t)dt\\\\\u0026=[rX_t+\\Delta_t(\\mu-r)S_t]dt+\\Delta_t\\sigma S_tdW_t\\end{aligned}$$\n\n#### Calculate call option's value\n\nSuppose that $c$ is the price of a call option on the stock. The variable $c$ must be some function of $S$ and $t$, i.e. $c(S_t,t)$. Hence, by using Ito formula,\n\n$$\\begin{aligned}\u0026 d c(t, S_t) \\\\=\u0026 c_{t}(t, S_t) d t+c_{x}(t, S_t) d S_t+\\frac{1}{2} c_{x x}(t, S_t) d[S, S](t) \\\\=\u0026\\left[c_{t}(t, S_t)+\\mu S(t) c_{x}(t, S_t)+\\frac{1}{2} \\sigma^{2} S^{2}_t c_{x x}(t, S_t)\\right] d t \\\\\u0026+\\sigma S_t c_{x}(t, S_t) d W_t\\end{aligned}$$\n\n#### $dX_t=dc(t,S_t)$\n\nWe have\n\n$$c_t(t,S_t)+rS_tc_x(t,S_t)+\\frac{1}{2}\\sigma^2S^2_tc_{xx}(t,S_t)-rc(t,S_t)=0$$\n\nthe terminal condition\n\n$$c(T,S_t)=(S_t-K)^{+}$$\n\n#### BSM Formulas\n\n$$\\begin{array}{c} c=S_{0} N\\left(d_{1}\\right)-K e^{-r T} N\\left(d_{2}\\right) \\\\ p=K e^{-r T} N\\left(-d_{2}\\right)-S_{0} N\\left(-d_{1}\\right) \\end{array}$$\n\n$$\\begin{array}{l} d_{1}=\\frac{\\ln \\left(S_{0} / K\\right)+\\left(r+\\sigma^{2} / 2\\right) T}{\\sigma \\sqrt{T}} \\\\ d_{2}=\\frac{\\ln \\left(S_{0} / K\\right)+\\left(r-\\sigma^{2} / 2\\right) T}{\\sigma \\sqrt{T}}=d_{1}-\\sigma \\sqrt{T} \\end{array}$$\n\nThe term $N(d_2)$ is the probability that a call option will be exercised in a risk-neutral world.\n\nThe expression $S_0N(d_1)e^{rT}$ is the expected stock price at time $T$ in a risk-neutral world when stock prices less than the strike price are counted as zero.\n\nSolve the PDE, or connect between stochastic processes and PDEs with **Feynman-Kac Theorem.**\n\n### Martingale Method\n\nLet\n\n$$d \\tilde{W}_{t}=\\frac{\\mu-r}{\\sigma} d t+d W_{t}$$\n\nWe have\n\n$$\\begin{aligned}d S_{t} \u0026=\\mu r S_{t} d t+\\sigma S_{t}\\left(d W_{t}^{Q}-\\frac{\\mu-r}{\\sigma} d t\\right) \\\\\u0026=r S_{t} d t+\\sigma S_{t} d W_{t}^{Q}\\end{aligned}$$\n\nUnder $Q$, we have the following martingales:\n\n-   the discounted underlying asset price $e^{-rt}S_t$\n-   the discounted replicating portfolio value $e^{-rt}X_t$\n-   the discounted option price $e^{-rt}V_t$\n\nThe Q-martingale property leads to\n\n$$\\begin{aligned}c(t,S_t)=V_{t} \u0026=e^{-r(T-t)} E^{Q}\\left[\\left(S_{T}-K\\right) \\cdot \\mathbf{1}_{\\left\\{S_{T} \\geq K\\right\\}} \\mid \\mathcal{F}_{t}\\right] \\\\\u0026=S_{t} Q\\left\\{x \\geq-d_{2}-\\sigma \\sqrt{T-t}\\right\\}-K e^{-r(T-t)} Q\\left\\{x \\geq-d_{2}\\right\\} \\\\\u0026=S_{t} N\\left(d_{1}\\right)-K e^{-r(T-t)} N\\left(d_{2}\\right)\\end{aligned}$$\n\n## Greeks\n\n$$\\text { Delta: } \\Delta=\\frac{\\partial f}{\\partial S} ; \\text { Gamma: } \\Gamma=\\frac{\\partial^{2} f}{\\partial S^{2}} ; \\text { Theta: } \\Theta=\\frac{\\partial f}{\\partial t} ; \\text { Vega: } v=\\frac{\\partial f}{\\partial \\sigma} ; \\text { Rho: } \\rho=\\frac{\\partial f}{\\partial r}$$\n\n### Naked and covered positions\n\n#### naked position\n\n-   One strategy open to the financial institution is to do nothing.\n\n#### covered position\n\n-   This involves buying 100,000 shares as soon as the option has been sold. If the option is exercised, this strategy works well, but in other circumstances it could lead to a significant loss.\n\n### A stop-loss strategy\n\n-   an institution that has written a call option with strike price $K$ to buy one unit of a stock. The hedging procedure involves buying one unit of the stock as soon as its price rises above $K$ and selling it as soon as its price falls below $K$.\n\nProblem\n\n-   The first is that the cash flows to the hedger occur at different times and must be discounted. The second is that purchases and sales cannot be made at exactly the same price K.\n\n### Delta hedging\n\n-   Delta is defined as the rate of change of the option price with respect to the price of the underlying asset.\n\n$$\\Delta(call)=N(d_1),\\ \\Delta(put)=N(d_1)-1$$\n\n#### Dynamic Aspects of Delta Hedging\n\n-   Derivatives dealers usually rebalance their positions once a day to maintain delta neutrality.\n\n### Theta\n\n-   The theta of a portfolio of options is the rate of change of the value of the portfolio with respect to the passage of time with all else remaining the same.\n-   **time decay**\n-   As time passes with all else remaining the same, the option tends to become less valuable.\n-   When the stock price is very low, theta is close to zero.\n-   For an at-the-money call option, theta is large and negative.\n\n### Gamma\n\nThe gamma of a portfolio of options on an underlying asset is the rate of change of the portfolio’s delta with respect to the price of the underlying asset.\n\n$$\\Delta \\Pi=\\Theta \\Delta t+\\frac{1}{2} \\Gamma \\Delta S^{2}$$\n\n#### Making a Portfolio Gamma Neutral\n\n-   Delta neutrality provides protection against relatively small stock price moves between rebalancing.\n-   Gamma neutrality provides protection against larger movements in this stock price between hedge rebalancing.\n\n$$w_{T}=-\\Gamma/\\Gamma_T$$\n\n### Relationship between Delta, Theta, and Gamma\n\n$$\\Theta+rS\\Delta+\\frac{1}{2}\\sigma^2 S^2\\Gamma=r\\Pi$$\n\n-   theta can to some extent be regarded as a proxy for gamma in a delta-neutral portfolio.\n\n### Vega\n\n-   the rate of change of the value of the portfolio with respect to the volatility of the underlying asset.\n-   If a hedger requires a portfolio to be both gamma and vega neutral, **at least two traded derivatives** dependent on the underlying asset must usually be used.\n-   When volatilities change, the implied volatilities of short-dated options tend to change by more than the implied volatilities of long-dated options. The vega of a portfolio is therefore often calculated by changing the volatilities of long-dated options by less than that of short-dated options.\n\n### Rho\n\n-   The rho of a portfolio of options is the rate of change of the value of the portfolio with respect to the interest rate.\n\n![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1c65c777-465e-42c5-9d70-53f782174b16/Untitled.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1c65c777-465e-42c5-9d70-53f782174b16/Untitled.png)\n\n## Volatility Smile\n\n-   The volatility smile defines the relationship between the implied volatility of an option and its strike price.\n-   For equity options, the volatility smile tends to be downward sloping.\n    -   This means that **out of-the-money puts** and **in-the-money calls** tend to have high implied volatilities whereas **out-of-the-money calls** and **in-the-money puts** tend to have low implied volatilities.\n-   For foreign currency options, the volatility smile is U-shaped.\n    -   Both out-of-the-money and in-the-money options have higher implied volatilities than at-the-money options.\n-   A refinement of this is to calculate the volatility smile as the relationship between the implied volatility and $K/S_0$ or $K/F_0$, where $F_0$ is the forward price of the asset for a contract maturing at the same time as the options that are considered.\n-   Yet another approach to defining the volatility smile is as the relationship between the implied volatility and the delta of the option.\n\n## Exotic Options\n\n### Perpetual American Options\n\nA perpetual derivative has $T=\\infty$.\n\nRecall Black-Scholes equation:\n\n$$c_t(t,S_t)+rS_tc_x(t,S_t)+\\frac{1}{2}\\sigma^2S^2_tc_{xx}(t,S_t)-rc(t,S_t)=0$$\n\nThe term $c_t(t,S_t)$ disappears from the equation due to time-homogeneity, and we get an **ODE instead of a PDE.**\n\n### Bermudan Options\n\nEarly exercise may be restricted to **certain dates**.\n\n### Gap Options\n\nA gap call option is a European call options that pays off $S_T-K_1$ when $S_T \u003e K_2$.\n\nThe difference between a gap call option and a regular call option with a strike price of $K_2$ is that the payoff when $S_T \u003e K_2$ is increased by $K_2-K_1$.\n\n### Forward Start Options\n\nForward start options are options that will **start at some time in the future**. Sometimes employee stock options can be viewed as forward start options.\n\n### Compound Options\n\nCompound options are options on options. Compound options have two strike prices and two exercise dates.\n\nConsider, for example, a call on a call. On the first exercise date, $T_1$, the holder of the compound option is entitled to pay the first strike price, $K_1$, and receive a call option.\n\nThe call option gives the holder the right to buy the underlying asset for the second strike price, $K_2$, on the second exercise date, $T_2$. The compound option will be exercised on the first exercise date only if the value of the option on that date is greater than the first strike price.\n\n### Barrier Options\n\nBarrier options are options where the payoff depends on whether the underlying asset’s price reaches a certain level during a certain period of time.\n\nA **knock-out option** ceases to exist when the underlying asset price reaches a certain barrier; **a knock-in option** comes into existence only when the underlying asset price reaches a barrier.\n\n### Binary Options\n\nBinary options are options with discontinuous payoffs.\n\nA simple example of a binary option is a **cash-or-nothing call**. This pays off nothing if the asset price ends up below the strike price at time $T$ and pays a fixed amount, $Q$, if it ends up above the strike price.\n\n### Lookback Options\n\nThe payoffs from lookback options depend on the maximum or minimum asset price reached during the life of the option.\n\nThe payoff from a floating lookback call is the amount that the final asset price exceeds the minimum asset price achieved during the life of the option.\n\nThe payoff from a floating lookback put is the amount by which the maximum asset price achieved during the life of the option exceeds the final asset price.\n\n### Shout Options\n\nA shout option is a European option where the holder can ‘‘shout’’ to the writer at one time during its life.\n\nAt the end of the life of the option, the option holder receives **either the usual payoff from a European option or the intrinsic value at the time of the shout, whichever is greater**.\n\n### Asian Options\n\nAsian options are options where the payoff depends on the **arithmetic average** of the price of the underlying asset during the life of the option.\n\n### Exchange Options\n\nAn option to buy yen with Australian dollars is, from the point of view of a US investor, an option to exchange one foreign currency asset for another foreign currency asset.\n\nA stock tender offer is an option to exchange shares in one stock for shares in another stock.\n\n### Options Involving Several Options\n\nRainbow options. European basket option.\n\n### Volatility Swap\n\nA volatility swap is an agreement to exchange the realized volatility of an asset between time $0$ and time $T$ for a prespecifed fixed volatility.\n\n## Real Options\n\n### Extension of the Risk Neutral Valuation Method\n\nthe market price of risk for a variable $\\theta$ was defined as\n\n$$\\lambda=\\frac{\\mu-r}{\\sigma}$$\n\nwhere $r$ is the risk-free rate, $\\mu$ is the return on a traded security dependent only on $\\theta$, and $\\sigma$ is its volatility. Suppose that a real asset depends on several variables $\\theta_i$. Let $m_i$ and $s_i$ be the expected growth rate and volatility of $\\theta_i$\n\n$$d\\theta_i/\\theta=m_idt+s_idW_t$$\n\nwhere $W_t$ is a Brownian Motion.\n\nDefine $\\lambda_i$ as the market price of risk of $\\theta_i$. Risk-neutral valuation can be extended to show that any asset dependent on the i can be valued by\n\n-   Reducing the expected growth rate of each $\\theta_i$ from $m_i$ to $m_i-\\lambda_is_i$ (because $(m_i-r)/s_i=\\lambda_i$.)\n-   Discounting cash flows at the risk-free rate.\n\n### Estimating the Market Price of Risk\n\n$\\rho$: Instantaneous correlation between the percentage changes in the variable and returns on a broad index of stock market prices\n\n$\\mu_m$: Expected return on broad index of stock market prices\n\n$\\sigma_m$: Volatility of return on the broad index of stock market prices\n\nFrom a continuous-time version of the capital asset pricing model\n\n$$\\mu-r=\\frac{\\rho\\sigma}{\\sigma_m}(\\mu_m-r)$$\n\nAnother expression\n\n$$\\mu-r=\\lambda\\sigma$$\n\nThus\n\n$$\\lambda=\\frac{\\rho}{\\sigma_m}(\\mu_m-r)$$\n\n### Examples of Options Embedded in Projects\n\n-   **Abandonment options**: It is an American put option on the project’s value.\n-   **Expansion options**: It is an American call option on the value of additional capacity. The strike price of the call option is the cost of creating this additional capacity discounted to the time of option exercise.\n-   **Contraction options**: It is an American put option on the value of the lost capacity. The strike price is the present value of the future expenditures saved as seen at the time of exercise of the option.\n-   **Options to defer**: This is an American call option on the value of the project.\n-   **Options to extend life**: This is a European call option on the asset’s future value.\n\n## Reference\n\nOFD / John Hull\n\n《金融经济学二十五讲》/ 徐高\n\n《金融经济学十讲》/ 史树中\n\nFinancial Calculus: An Introduction to Derivative Pricing / Martin Baxter\n\n[布朗运动、伊藤引理、BS公式（前篇）](https://mp.weixin.qq.com/s?__biz=MzIyMDEwNDk1Mg==\u0026mid=2650876491\u0026idx=1\u0026sn=2ccfdfbaf250228974e984c5e7168366\u0026chksm=8c249bdcbb5312ca46b0261df16109ad8e19d559ab919dd95f8097b46b36eaf81e85b4eef76c\u0026scene=126\u0026sessionid=1605256784\u0026key=409586cdc8db5733d89744fef149cbd55e0825fce39bb62d733d518ddf15b3e1ecd31bb2ba4e18d5c4853db53d9fb1cba066bb33110f8740f658772187889b75c666cbb2a0fd6f016e9b0079f7403eadcb884f6a5bd1c6e957edbebba629f17c26a5c2f9489f0820c2cabc44aa656224da99bcf28ba4bf2f4170c17b3f255ca9\u0026ascene=1\u0026uin=MjU1NDk5MDUwOA%3D%3D\u0026devicetype=Windows+10+x64\u0026version=6300002f\u0026lang=zh_CN\u0026exportkey=A0Tn4xOWv3Nl%2BjMxJtPWumI%3D\u0026pass_ticket=ok4tnaFWS7zPPSCRKPSyUIzrRRcpn0LMaKl%2FkngUWsaWK0ChENo%2FKgwaJH5CCexq\u0026wx_header=0)\n\n[布朗运动、伊藤引理、BS公式（后篇）](https://mp.weixin.qq.com/s?__biz=MzIyMDEwNDk1Mg==\u0026mid=2650876561\u0026idx=1\u0026sn=ee4ecb91b0c95e7d539375ef35efdf4a\u0026chksm=8c249b06bb53121043a58a2163779774ef0f054659bee3033ff2cb3b7af7996bd75a3a862e31\u0026scene=126\u0026sessionid=1605256784\u0026key=cc7cc2a0b445493e06dbff52441567153cc0ac0f70486c51768cc951d0871d265c6e19ab75a980bbef7f1864f8f6bd16dcf347cfa2628abb7b13727fcbdf5188cc98f354b29144935c3aecd91ad2f0011ef56f23448f8df115987ca174fac91babc728e21455cb515b27820ee01203a772cb23c4a69a797b16820bb2213c58c5\u0026ascene=1\u0026uin=MjU1NDk5MDUwOA%3D%3D\u0026devicetype=Windows+10+x64\u0026version=6300002f\u0026lang=zh_CN\u0026exportkey=A7l3K9ytHaVtOJYXPnoJ8Sw%3D\u0026pass_ticket=ok4tnaFWS7zPPSCRKPSyUIzrRRcpn0LMaKl%2FkngUWsaWK0ChENo%2FKgwaJH5CCexq\u0026wx_header=0)\n\n[《期权交易随笔》题记](https://mp.weixin.qq.com/s?__biz=MzIyMTE5OTE5Mg==\u0026mid=409677815\u0026idx=2\u0026sn=491afd3a6f32dea8d3282ea1fb5aa02b\u0026chksm=0a5fe1c03d2868d60ed449598bbe5d72e6281f8a038a0e4a52876768d50edc248a8c49210cb1\u0026scene=126\u0026sessionid=1605759166\u0026key=e17ad8edb8d975168ae4132b815fac2689bbcfcb92f93d58076345765d5cd2a91167cdafb664797fcd8a9b664459656a6ac0dde4490e389de04932454612f3f59527447cbbe69dc1483225420a515553eb0e30f7b9fd915c34f1346e29564da1e2ef8a0053d40ee27f65c3c3c790be526070ec2cfbc98e942b7d9fca74a663fd\u0026ascene=1\u0026uin=MjU1NDk5MDUwOA%3D%3D\u0026devicetype=Windows+10+x64\u0026version=6300002f\u0026lang=zh_CN\u0026exportkey=A1eyaqvaIFoWdFTokV4gWNI%3D\u0026pass_ticket=6X9rN0ahWibDlXeT0QKsoq3d9UL3kop49HI7%2F%2Ba%2B30zMh6TprHofEq9FsxXicYqb\u0026wx_header=0)\n\n[BS公式--鞅定价推导法](https://zhuanlan.zhihu.com/p/95538708)\n\n[American Options](https://people.kth.se/~armerin/FinInsMathRwanda/Lecture18.pdf)",title:"Untitled Page"},"/Published/Probability":{content:"---\nArea: Statistics\nSource: Book\nStatus: Todo\nType: Notes\n---\n\n\n[probability_cheatsheet.pdf](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/646bd1d9-a58f-469a-b20b-fc2e2ff9efc9/probability_cheatsheet.pdf)\n\n## Counting\n\n### Sampling Table\n\nThe sampling table gives the number of possible samples of size $k$ out of a population of size $n$, under various assumptions about how the sample is collected\n\n$$ \\begin{array}{r|cc} \u0026 \\textbf{Order Matters} \u0026 \\textbf{Not Matter} \\\\ \\hline \\textbf{With Replacement} \u0026 \\displaystyle n^k \u0026 \\displaystyle{n+k-1 \\choose k} \\\\ \\textbf{Without Replacement} \u0026 \\displaystyle\\frac{n!}{(n - k)!} \u0026 \\displaystyle{n \\choose k} \\end{array}$$\n\n-   Experiments/Outcomes - An experiment generates an outcome from a pre-determined list. For example, a dice roll generates outcomes in the set $\\{1, 2, 3, 4, 5, 6\\}$\n-   Sample Space - The sample space, denoted $\\Omega$, is the set of possible outcomes. Note that the probability of this event is 1, since something in the sample space will always occur.\n-   Event - An event is a subset of the sample space, or a collection of possible outcomes of an experiment. We say that the event has occurred if any of the outcomes in the event have happened.\n\n## Conditional\n\n### Law of Total Probability (LOTP)\n\nLet ${ B}_1, { B}_2, { B}_3, ... { B}_n$ be a _partition_ of the sample space (i.e., they are disjoint and their union is the entire sample space).\n\n$$ \\begin{aligned} P({ A}) \u0026= P({ A} | { B}_1)P({ B}_1) + P({ A} | { B}_2)P({ B}_2) + \\dots + P({ A} | { B}_n)P({ B}_n)\\\\ P({ A}) \u0026= P({ A} \\cap { B}_1)+ P({ A} \\cap { B}_2)+ \\dots + P({ A} \\cap { B}_n) \\end{aligned} $$\n\n$$ \\begin{aligned} P({ A}| { C}) \u0026= P({ A} | { B}_1, { C})P({ B}_1 | { C}) + \\dots + P({ A} | { B}_n, { C})P({ B}_n | { C})\\\\ P({ A}| { C}) \u0026= P({ A} \\cap { B}_1 | { C})+ P({ A} \\cap { B}_2 | { C})+ \\dots + P({ A} \\cap { B}_n | { C})\\end{aligned} $$\n\nSpecial case of LOTP with ${ B}$ and ${ B^c}$ as partition:\n\n$$ \\begin{aligned} P({ A}) \u0026= P({ A} | { B})P({ B}) + P({ A} | { B^c})P({ B^c}) \\\\ P({ A}) \u0026= P({ A} \\cap { B})+ P({ A} \\cap { B^c}) \\\\ \\end{aligned} $$\n\n### Bayes' Rule\n\n$$ P({ A}|{ B}) = \\frac{P({ B}|{ A})P({ A})}{P({ B})}, P({ A}|{ B}, { C}) = \\frac{P({ B}|{ A}, { C})P({ A} | { C})}{P({ B} | { C})} $$\n\nWe can also write\n\n$$ P(A|B,C) = \\frac{P(A,B,C)}{P(B,C)} = \\frac{P(B,C|A)P(A)}{P(B,C)} $$\n\n**Odds Form of Bayes' Rule**\n\n$$ \\frac{P({ A}| { B})}{P({ A^c}| { B})} = \\frac{P({ B}|{ A})}{P({ B}| { A^c})}\\frac{P({ A})}{P({ A^c})}$$\n\nThe _posterior odds_ of $A$ are the _likelihood ratio_ times the _prior odds_.\n\n## Expected Value and Variance\n\nExpected Value\n\n$$E(X) = \\sum\\limits_{i}x_iP(X=x_i)$$\n\nFor any r.v.s $X$ and $Y$, and constants $a,b,c,$\n\n$$E(aX + bY + c) = aE(X) + bE(Y) + c$$\n\nSame distribution implies same mean - If $X$ and $Y$ have the same distribution, then $E(X)=E(Y)$ and, more generally,\n\n$$E(g(X)) = E(g(Y))$$\n\nConditional Expected Value is defined like expectation, only conditioned on any event $A$.\n\n$$ E(X | A) = \\sum\\limits_{x}xP(X=x | A)$$\n\nVariance and Standard Deviation\n\n$${Var}(X) = E \\left(X - E(X)\\right)^2 = E(X^2) - (E(X))^2$$\n\n## Continuous RVs\n\n### Continuous Random Variables (CRVs)\n\nA continuous random variable can take on any possible value within a certain interval (for example, [0, 1]), whereas a discrete random variable can only take on variables in a list of countable values.\n\nThe probability that a continuous random variable takes on any specific value is 0.\n\n$$F'(x) = f(x)$$\n\n$$E(X) = \\int^\\infty_{-\\infty}xf(x)dx $$\n\n### LOTUS\n\n-   The expected value of $X$ is defined this way:\n\n$$E(X) = \\sum_x xP(X=x) \\textnormal{ (for discrete $X$)}$$\n\n$$E(X) = \\int^\\infty_{-\\infty}xf(x)dx \\textnormal{ (for continuous $X$)}$$\n\n-   The Law of the Unconscious Statistician (LOTUS) states that you can find the expected value of a function of a random variable, $g(X)$, in a similar way, by replacing the $x$ in front of the PMF/PDF by $g(x)$ but still working with the PMF/PDF of $X$:\n\n$$ E(g(X)) = \\sum_x g(x)P(X=x) \\textnormal{ (for discrete $X$)} $$\n\n$$E(g(X)) = \\int^\\infty_{-\\infty}g(x)f(x)dx \\textnormal{ (for continuous $X$)}$$\n\n-   _What's a function of a random variable? A function of a random variable is also a random variable. For example, if $X$ is the number of bikes you see in an hour, then $g(X) = 2X$ is the number of bike wheels you see in that hour and $h(X) = {X \\choose 2} = \\frac{X(X-1)}{2}$ is the number of pairs of bikes such that you see both of those bikes in that hour._\n\n### Universality of Uniform (UoU)\n\nWhen you plug any CRV into its own CDF, you get a Uniform(0,1) random variable. When you plug a Uniform(0,1) r.v.~into an inverse CDF, you get an r.v.~with that CDF. For example, let's say that a random variable $X$ has CDF\n\n$$F(x) = 1 - e^{-x}, \\textrm{ for $x\u003e0$} $$\n\nBy UoU, if we plug $X$ into this function then we get a uniformly distributed random variable.\n\n$$F(X) = 1 - e^{-X} \\sim \\textrm{Unif}(0,1)$$\n\nSimilarly, if $U \\sim \\textrm{Unif}(0,1)$ then $F^{-1}(U)$ has CDF $F$. The key point is that for any continuous random variable, we can transform it into a Uniform random variable and back by using its CDF.\n\n## Moments\n\nMoments describe the shape of a distribution.\n\nLet $X$ have mean $\\mu$ and standard deviation $\\sigma$, and $Z=(X-\\mu)/\\sigma$ be the _standardized_ version of $X$. The $k$th moment of $X$ is $\\mu_k = E(X^k)$ and the $k$th standardized moment of $X$ is $m_k =E (Z^k)$.\n\nThe mean, variance, skewness, and kurtosis are important summaries of the shape of a distribution.\n\n### Moment Generating Functions\n\nFor any random variable $X$, the function\n\n$$ M_X(t) = E(e^{tX}) $$\n\nis the **moment generating function (MGF)** of $X$, if it exists for all $t$ in some open interval containing $0$.\n\nMGF of linear functions: If we have $Y = aX + b$, then\n\n$$M_Y(t) = E(e^{t(aX + b)}) = e^{bt}E(e^{(at)X}) = e^{bt}M_X(at)$$\n\nUniqueness: If it exists, the MGF uniquely determines the distribution. This means that for any two random variables $X$ and $Y$, they are distributed the same (their PMFs/PDFs are equal) if and only if their MGFs are equal.\n\nSumming Independent RVs by Multiplying MGFs: If $X$ and $Y$ are independent, then\n\n$$M_{X+Y}(t) = E(e^{t(X + Y)}) = E(e^{tX})E(e^{tY}) = M_X(t) \\cdot M_Y(t) $$\n\nThe MGF of the sum of two random variables is the product of the MGFs of those two random variables.\n\n## Joint PDFs and CDFs\n\n### Joint Distributions\n\nThe joint CDF of $X$ and $Y$\n\n$$F(x,y)=P(X \\leq x, Y \\leq y) $$\n\nIn the discrete case, $X$ and $Y$ have a **joint PMF**\n\n$$p_{X,Y}(x,y) = P(X=x,Y=y)$$\n\nIn the continuous case, they have a **joint PDF**\n\n$$f_{X,Y}(x,y) = \\frac{\\partial^2}{\\partial x \\partial y} F_{X,Y}(x,y).$$\n\nThe joint PMF/PDF must be nonnegative and sum/integrate to 1.\n\n### Conditional Distributions\n\nConditioning and Bayes' rule for discrete r.v.s\n\n$$ P(Y=y|X=x) = \\frac{P(X=x, Y=y)}{P(X=x)} = \\frac{P(X=x|Y=y)P(Y=y)}{P(X=x)}$$\n\nConditioning and Bayes' rule for continuous r.v.s\n\n$$f_{Y|X}(y|x) = \\frac{f_{X,Y}(x, y)}{f_X(x)} = \\frac{f_{X|Y}(x|y)f_Y(y)}{f_X(x)}$$\n\nHybrid Bayes' rule\n\n$$f_X(x|A) = \\frac{P(A | X = x)f_X(x)}{P(A)}$$\n\n### Marginal Distributions\n\nTo find the distribution of one (or more) random variables from a joint PMF/PDF, sum/integrate over the unwanted random variables.\n\nMarginal PMF from joint PMF\n\n$$P(X = x) = \\sum_y P(X=x, Y=y)$$\n\nMarginal PDF from joint PDF\n\n$$f_X(x) = \\int_{-\\infty}^\\infty f_{X, Y}(x, y) dy$$",title:"Untitled Page"},"/Published/Probability and Random Process":{content:"[probability_cheatsheet.pdf](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/646bd1d9-a58f-469a-b20b-fc2e2ff9efc9/probability_cheatsheet.pdf)\n\n## Counting\n\n### Sampling Table\n\nThe sampling table gives the number of possible samples of size $k$ out of a population of size $n$, under various assumptions about how the sample is collected\n\n$$ \\begin{array}{r|cc} \u0026 \\textbf{Order Matters} \u0026 \\textbf{Not Matter} \\\\ \\hline \\textbf{With Replacement} \u0026 \\displaystyle n^k \u0026 \\displaystyle{n+k-1 \\choose k} \\\\ \\textbf{Without Replacement} \u0026 \\displaystyle\\frac{n!}{(n - k)!} \u0026 \\displaystyle{n \\choose k} \\end{array}$$\n\n-   Experiments/Outcomes - An experiment generates an outcome from a pre-determined list. For example, a dice roll generates outcomes in the set $\\{1, 2, 3, 4, 5, 6\\}$\n-   Sample Space - The sample space, denoted $\\Omega$, is the set of possible outcomes. Note that the probability of this event is 1, since something in the sample space will always occur.\n-   Event - An event is a subset of the sample space, or a collection of possible outcomes of an experiment. We say that the event has occurred if any of the outcomes in the event have happened.\n\n## Conditional\n\n### Law of Total Probability (LOTP)\n\nLet ${ B}_1, { B}_2, { B}_3, ... { B}_n$ be a _partition_ of the sample space (i.e., they are disjoint and their union is the entire sample space).\n\n$$ \\begin{aligned} P({ A}) \u0026= P({ A} | { B}_1)P({ B}_1) + P({ A} | { B}_2)P({ B}_2) + \\dots + P({ A} | { B}_n)P({ B}_n)\\\\ P({ A}) \u0026= P({ A} \\cap { B}_1)+ P({ A} \\cap { B}_2)+ \\dots + P({ A} \\cap { B}_n) \\end{aligned} $$\n\n$$ \\begin{aligned} P({ A}| { C}) \u0026= P({ A} | { B}_1, { C})P({ B}_1 | { C}) + \\dots + P({ A} | { B}_n, { C})P({ B}_n | { C})\\\\ P({ A}| { C}) \u0026= P({ A} \\cap { B}_1 | { C})+ P({ A} \\cap { B}_2 | { C})+ \\dots + P({ A} \\cap { B}_n | { C})\\end{aligned} $$\n\nSpecial case of LOTP with ${ B}$ and ${ B^c}$ as partition:\n\n$$ \\begin{aligned} P({ A}) \u0026= P({ A} | { B})P({ B}) + P({ A} | { B^c})P({ B^c}) \\\\ P({ A}) \u0026= P({ A} \\cap { B})+ P({ A} \\cap { B^c}) \\\\ \\end{aligned} $$\n\n### Bayes' Rule\n\n$$ P({ A}|{ B}) = \\frac{P({ B}|{ A})P({ A})}{P({ B})}, P({ A}|{ B}, { C}) = \\frac{P({ B}|{ A}, { C})P({ A} | { C})}{P({ B} | { C})} $$\n\nWe can also write\n\n$$ P(A|B,C) = \\frac{P(A,B,C)}{P(B,C)} = \\frac{P(B,C|A)P(A)}{P(B,C)} $$\n\n**Odds Form of Bayes' Rule**\n\n$$ \\frac{P({ A}| { B})}{P({ A^c}| { B})} = \\frac{P({ B}|{ A})}{P({ B}| { A^c})}\\frac{P({ A})}{P({ A^c})}$$\n\nThe _posterior odds_ of $A$ are the _likelihood ratio_ times the _prior odds_.\n\n## Expected Value and Variance\n\nExpected Value\n\n$$E(X) = \\sum\\limits_{i}x_iP(X=x_i)$$\n\nFor any r.v.s $X$ and $Y$, and constants $a,b,c,$\n\n$$E(aX + bY + c) = aE(X) + bE(Y) + c$$\n\nSame distribution implies same mean - If $X$ and $Y$ have the same distribution, then $E(X)=E(Y)$ and, more generally,\n\n$$E(g(X)) = E(g(Y))$$\n\nConditional Expected Value is defined like expectation, only conditioned on any event $A$.\n\n$$ E(X | A) = \\sum\\limits_{x}xP(X=x | A)$$\n\nVariance and Standard Deviation\n\n$${Var}(X) = E \\left(X - E(X)\\right)^2 = E(X^2) - (E(X))^2$$\n\n## Continuous RVs\n\n### Continuous Random Variables (CRVs)\n\nA continuous random variable can take on any possible value within a certain interval (for example, [0, 1]), whereas a discrete random variable can only take on variables in a list of countable values.\n\nThe probability that a continuous random variable takes on any specific value is 0.\n\n$$F'(x) = f(x)$$\n\n$$E(X) = \\int^\\infty_{-\\infty}xf(x)dx $$\n\n### LOTUS\n\n-   The expected value of $X$ is defined this way:\n\n$$E(X) = \\sum_x xP(X=x) \\textnormal{ (for discrete $X$)}$$\n\n$$E(X) = \\int^\\infty_{-\\infty}xf(x)dx \\textnormal{ (for continuous $X$)}$$\n\n-   The Law of the Unconscious Statistician (LOTUS) states that you can find the expected value of a function of a random variable, $g(X)$, in a similar way, by replacing the $x$ in front of the PMF/PDF by $g(x)$ but still working with the PMF/PDF of $X$:\n\n$$ E(g(X)) = \\sum_x g(x)P(X=x) \\textnormal{ (for discrete $X$)} $$\n\n$$E(g(X)) = \\int^\\infty_{-\\infty}g(x)f(x)dx \\textnormal{ (for continuous $X$)}$$\n\n-   _What's a function of a random variable? A function of a random variable is also a random variable. For example, if $X$ is the number of bikes you see in an hour, then $g(X) = 2X$ is the number of bike wheels you see in that hour and $h(X) = {X \\choose 2} = \\frac{X(X-1)}{2}$ is the number of pairs of bikes such that you see both of those bikes in that hour._\n\n### Universality of Uniform (UoU)\n\nWhen you plug any CRV into its own CDF, you get a Uniform(0,1) random variable. When you plug a Uniform(0,1) r.v.~into an inverse CDF, you get an r.v.~with that CDF. For example, let's say that a random variable $X$ has CDF\n\n$$F(x) = 1 - e^{-x}, \\textrm{ for $x\u003e0$} $$\n\nBy UoU, if we plug $X$ into this function then we get a uniformly distributed random variable.\n\n$$F(X) = 1 - e^{-X} \\sim \\textrm{Unif}(0,1)$$\n\nSimilarly, if $U \\sim \\textrm{Unif}(0,1)$ then $F^{-1}(U)$ has CDF $F$. The key point is that for any continuous random variable, we can transform it into a Uniform random variable and back by using its CDF.\n\n## Moments\n\nMoments describe the shape of a distribution.\n\nLet $X$ have mean $\\mu$ and standard deviation $\\sigma$, and $Z=(X-\\mu)/\\sigma$ be the _standardized_ version of $X$. The $k$th moment of $X$ is $\\mu_k = E(X^k)$ and the $k$th standardized moment of $X$ is $m_k =E (Z^k)$.\n\nThe mean, variance, skewness, and kurtosis are important summaries of the shape of a distribution.\n\n### Moment Generating Functions\n\nFor any random variable $X$, the function\n\n$$ M_X(t) = E(e^{tX}) $$\n\nis the **moment generating function (MGF)** of $X$, if it exists for all $t$ in some open interval containing $0$.\n\nMGF of linear functions: If we have $Y = aX + b$, then\n\n$$M_Y(t) = E(e^{t(aX + b)}) = e^{bt}E(e^{(at)X}) = e^{bt}M_X(at)$$\n\nUniqueness: If it exists, the MGF uniquely determines the distribution. This means that for any two random variables $X$ and $Y$, they are distributed the same (their PMFs/PDFs are equal) if and only if their MGFs are equal.\n\nSumming Independent RVs by Multiplying MGFs: If $X$ and $Y$ are independent, then\n\n$$M_{X+Y}(t) = E(e^{t(X + Y)}) = E(e^{tX})E(e^{tY}) = M_X(t) \\cdot M_Y(t) $$\n\nThe MGF of the sum of two random variables is the product of the MGFs of those two random variables.\n\n## Joint PDFs and CDFs\n\n### Joint Distributions\n\nThe joint CDF of $X$ and $Y$\n\n$$F(x,y)=P(X \\leq x, Y \\leq y) $$\n\nIn the discrete case, $X$ and $Y$ have a **joint PMF**\n\n$$p_{X,Y}(x,y) = P(X=x,Y=y)$$\n\nIn the continuous case, they have a **joint PDF**\n\n$$f_{X,Y}(x,y) = \\frac{\\partial^2}{\\partial x \\partial y} F_{X,Y}(x,y).$$\n\nThe joint PMF/PDF must be nonnegative and sum/integrate to 1.\n\n### Conditional Distributions\n\nConditioning and Bayes' rule for discrete r.v.s\n\n$$ P(Y=y|X=x) = \\frac{P(X=x, Y=y)}{P(X=x)} = \\frac{P(X=x|Y=y)P(Y=y)}{P(X=x)}$$\n\nConditioning and Bayes' rule for continuous r.v.s\n\n$$f_{Y|X}(y|x) = \\frac{f_{X,Y}(x, y)}{f_X(x)} = \\frac{f_{X|Y}(x|y)f_Y(y)}{f_X(x)}$$\n\nHybrid Bayes' rule\n\n$$f_X(x|A) = \\frac{P(A | X = x)f_X(x)}{P(A)}$$\n\n### Marginal Distributions\n\nTo find the distribution of one (or more) random variables from a joint PMF/PDF, sum/integrate over the unwanted random variables.\n\nMarginal PMF from joint PMF\n\n$$P(X = x) = \\sum_y P(X=x, Y=y)$$\n\nMarginal PDF from joint PDF\n\n$$f_X(x) = \\int_{-\\infty}^\\infty f_{X, Y}(x, y) dy$$",title:"Untitled Page"},"/Published/Regression Analysis":{content:"## Linear Statistical Models\n\n### OLS\n\nWe shall minimize $Q$ with respect to $\\beta_0$ and $\\beta_1$ by taking the partial derivatives and setting them to 0. We have\n\n$$\\frac{\\partial Q}{\\partial \\beta_{0}}=-2 \\sum_{i=1}^{n}\\left(y_{i}-\\beta_{0}-\\beta_{1} x_{i}\\right) =0 $$\n\n$$ \\frac{\\partial Q}{\\partial \\beta_{1}}=-2\\sum_{i=1}^{n}\\left(y_{i}-\\beta_{0}-\\beta_{1} x_{i}\\right) x_{i}=0$$\n\nNormal Equation\n\n$$\\begin{aligned}\\beta_{0} n+\\beta_{1} \\sum_{i=1}^{n} x_{i} \u0026=\\sum_{i=1}^{n} y_{i} \\\\\\beta_{0} \\sum_{i=1}^{n} x_{i}+\\beta_{1} \\sum_{i=1}^{n} x_{i}^{2} \u0026=\\sum_{i=1}^{n} x_{i} y_{i} .\\end{aligned}$$\n\n### Simple Linear Regression\n\n$$E(Y |x_1, . . . , x_k) = \\beta_0 + \\beta_1x_1 + . . . + \\beta_kx_k. $$\n\n$$Y=\\beta_0+\\beta_1x+\\varepsilon,\\varepsilon\\sim N(0,\\sigma^2)$$\n\nAssumptions:\n\n-   Normality. For $i = 1, . . . , n,$ the conditional distribution of $Y_i$ given the values $x_1, . . . , x_n$ is a normal distribution.\n\n-   Linear Mean. There are parameters $\\beta_0$ and $\\beta_1$ such that the conditional mean of $Y_i$\n\ngiven the values $x_1, . . . , x_n$ has the form $\\beta_0 + \\beta_1x_i$ for $i = 1, . . . , n$.\n\n-   Common Variance. There is a parameter $\\sigma^2$ such that the conditional variance of $Y_i$ given the values $x_1, . . . , x_n$ is $\\sigma^2$ for $i = 1, . . . , n.$ This assumption is often called **homoscedasticity**. Random variables with different variances are called **heteroscedastic**.\n    -   The error term is homoskedastic if the variance of the conditional distribution of $\\varepsilon_i$ given $X_i$ is constant for $i = 1,\\cdots, n$ and in particular does not depend on $X_i$. Otherwise, the error term is heteroskedastic.\n-   Independence. The random variables $Y_1, . . . , Y_n$ are independent given the observed $x_1, . . . , x_n$.\n-   Predictor is known.\n\nWe can now find the M.L.E.\n\n#### M.L.E. of Estimators\n\n$$\\hat{\\beta}_{1}=\\frac{\\sum_{i=1}^{n} x_{i} Y_{i}-n \\bar{x}_{n} \\bar{Y}_{n}}{\\sum_{i=1}^{n} x_{i}^{2}-n \\bar{x}_{n}^{2}}=\\frac{\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}_{n}\\right)\\left(Y_{i}-\\bar{Y}_{n}\\right)}{\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}_{n}\\right)^{2}}$$\n\n$$\n\n\\hat{\\beta}_{0}=\\bar{Y}_{n}-\\hat{\\beta}_{1} \\bar{x}_{n}$$\n\nLet us introduce the symbol\n\n$$\n\ns_{x}=\\left(\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}\\right)^{2}\\right)^{1 / 2}$$\n\nThus\n\n$$\n\\operatorname{E}[\\hat\\beta_1]=\\beta_1,\\operatorname{E}[\\hat\\beta_0]=\\beta_0\n$$\n\n$$\n\\operatorname{Var}\\left(\\hat{\\beta}_{1}\\right)=\\frac{\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}\\right)^{2} \\operatorname{Var}\\left(Y_{i}\\right)}{s_{x}^{4}}=\\frac{\\sigma^{2}}{s_{x}^{2}}\n$$\n\n$$\n  \n\\begin{aligned} \\operatorname{Var}(\\hat{\\beta_{0}})\u0026=\\operatorname{Var}(\\bar{Y}-\\hat{\\beta_{1}} \\bar{x})\\\\\u0026=\\operatorname{Var}(\\bar{Y})+\\bar{x}^{2}-2 \\bar{x} \\operatorname{Cov}(\\bar{Y}, \\hat{\\beta_{1}})\\\\\u0026=\\frac{\\sigma^{2}}{n}+\\frac{\\sigma^{2}}{s_{x}^{2}} \\bar{{x}}^{2}-0 \\\\\u0026=\\left(\\frac{1}{n}+\\frac{\\bar{x}^{2}}{s_{x}^{2}}\\right) \\sigma^{2} \\end{aligned}\n$$\n\n\n$$\n\\begin{aligned} \\operatorname{Cov}(\\hat{\\beta_{0}},\\hat{\\beta_{1}})\u0026=\\operatorname{Cov}(\\bar{Y}-\\hat{\\beta_{1}} \\bar{x},\\hat{\\beta_{1}})\\\\\u0026=\\operatorname{Cov}(\\bar{Y}, \\hat{\\beta_{1}})-\\bar{x} \\operatorname{Cov}(\\hat{\\beta_{1}}, \\hat{\\beta_{1}})\\\\\u0026=-\\bar{x} \\operatorname{Var}(\\bar{\\beta_{1}}) \\\\\u0026=-\\frac{\\bar{x} \\sigma^{2}}{s_{x}^{2}}\\end{aligned}\n$$\n\nSo we can calculate the expectations and variances of the linear combinations of $\\beta_0$ and $\\beta_1$.\n\n#### M.S.E. of Prediction\n\n$$\n\\begin{aligned}E\\left[(\\hat{Y}-Y)^{2}\\right] \u0026=E\\left\\{[(\\hat{Y}-\\mu)-(Y-\\mu)]^{2}\\right\\} \\\\\u0026=\\operatorname{Var}(\\hat{Y})+\\operatorname{Var}(Y)-2 \\operatorname{Cov}(\\hat{Y}, Y)\\\\\u0026=\\sigma^{2}\\left[1+\\frac{1}{n}+\\frac{(x-\\bar{x})^{2}}{s_{x}^{2}}\\right]\\end{aligned}\n$$\n\n#### M.L.E. for $\\sigma^2$\n\n$$\n\\hat \\sigma^2=\\frac{1}{n}\\sum_{i=1}^n\\left[Y_i-(\\hat\\beta_0+\\hat\\beta_1x_i)\\right]^2\n$$\n\nThe distribution of $n\\hat\\sigma^2/\\sigma^2$ is the $\\chi^2$ distribution with $n-2$ degrees of freedom.\n\n### Statistical Inference in Simple Linear Regression\n\n#### Unbiased Estimator of $\\sigma^2$\n\n$$ \n\\sigma^{\\prime}=\\left(\\frac{S^{2}}{n-2}\\right)^{1 / 2}, \\text{where}\\ \\ S^{2}=\\sum_{i=1}^{n}\\left(Y_{i}-\\hat{\\beta}_{0}-\\hat{\\beta}_{1} x_{i}\\right)^{2}\n$$\n\nNote that it is different from the M.L.E.\n\n#### Linear Combination of $\\beta_0$ and $\\beta_1$\n\n$$\n\\left[\\frac{c_{0}^{2}}{n}+\\frac{\\left(c_{0} \\bar{x}-c_{1}\\right)^{2}}{s_{x}^{2}}\\right]^{-1 / 2} \\frac{c_{0} \\hat{\\beta}_{0}+c_{1} \\hat{\\beta}_{1}-\\left(c_{0} \\beta_{0}+c_{1} \\beta_{1}\\right)}{\\sigma^{\\prime}}\n$$\n\nhas the $t$ distribution with $n-2$ degrees of freedom under the assumptions of simple linear regression.\n\nWe can use this random variable to test hypotheses about or to construct confidence intervals.\n\nPlug $\\sigma^{\\prime}$ into $\\operatorname{Var}\\left(\\hat{\\beta}{1}\\right)=\\frac{\\sigma^{2}}{s_{x}^{2}}$ and get the equation.\n\n#### Confidence Intervals\n\nThe open interval is a coefficient $1-\\alpha_0$ confidence interval for $c_0\\beta_0+c_1\\beta_1$.\n\n$$c_{0} \\hat{\\beta}_{0}+c_{1} \\hat{\\beta}_{1} \\pm \\sigma^{\\prime}\\left[\\frac{c_{0}^{2}}{n}+\\frac{\\left(c_{0} \\bar{x}-c_{1}\\right)^{2}}{s_{x}^{2}}\\right]^{1 / 2} T_{n-2}^{-1}\\left(1-\\frac{\\alpha_{0}}{2}\\right)$$\n\n#### Prediction Interval\n\n$$\\hat{Y} \\pm T_{n-2}^{-1}\\left(1-\\frac{\\alpha_{0}}{2}\\right) \\sigma^{\\prime}\\left[1+\\frac{1}{n}+\\frac{(x-\\bar{x})^{2}}{s_{x}^{2}}\\right]^{1 / 2}$$\n\n#### Coefficient of Determination\n\n$$R^2=1-\\frac{SSE}{SST}=1-\\frac{\\sum_{i=1}^{n}\\left(y_{i}-\\hat{y}_{i}\\right)^{2}}{\\sum\\left(y_{i}-\\bar{y}_{n}\\right)^{2}}$$\n\n## Multiple Linear Regression\n\nDesign Matrix $\\mathbf{X}$\n\n$$\\mathbf{X}=\\left[\\begin{array}{ccc}x_{10} \u0026 \\cdots \u0026 x_{1 p-1} \\\\x_{20} \u0026 \\cdots \u0026 x_{2 p-1} \\\\\\vdots \u0026 \\ddots \u0026 \\vdots \\\\x_{n} 0 \u0026 \\cdots \u0026 x_{n p-1}\\end{array}\\right]$$\n\n$$ \\mathbf{Y}_{n \\times 1}=\\mathbf{X}_{n \\times r} \\boldsymbol{\\beta}_{(k+1) \\times 1}+\\varepsilon_{n \\times 1}$$\n\n### Mean Vector and Covariance Matrix\n\n$$\n\n\\varepsilon_{i} \\sim N\\left(0, \\sigma_{i}^{2}\\right), \\quad E(\\varepsilon)=\\mathbf{0}, \\quad \\operatorname{Cov}(\\mathbf{Y})=\\operatorname{Cov}(\\varepsilon)=\\sigma^{2} \\mathbf{I}$$\n\nThe coordinates $Y_1, . . . , Y_n$ of $\\mathbf{Y}$ are independent.\n\n### The Joint Distribution of the Estimators\n\n$$\n\n\\widehat{\\boldsymbol{\\beta}}=\\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{Y},\\quad\\widehat{\\boldsymbol{\\beta}} \\sim N_{r}\\left(\\boldsymbol{\\beta}, \\sigma^{2}\\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1}\\right)$$\n\n$$\n\n\\operatorname{Var}(\\widehat{\\boldsymbol{\\beta}})=\\sigma^{2}\\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1}=\\sigma^{2}\\left(\\xi_{i j}\\right)_{i, j=0, \\cdots, k}$$\n\n### Testing Hypotheses\n\n$$\n{{\\sigma}^{\\prime}}^{2}=\\frac{\\widehat{\\varepsilon}^{\\prime} \\widehat{\\varepsilon}}{n-k-1},\\quad \\frac{(n-k-1){{\\sigma}^{\\prime}}^{2}}{\\sigma^2}\\sim\\chi^2(n-k-1) \n$$\n\n$$ \\frac{\\hat\\beta_j-\\beta_j^{\\star}}{\\sqrt{\\xi_{jj}}{{\\sigma}^{\\prime}}^{2}}\\sim t(n-k-1)\n$$\n\n### Prediction\n\n$$\n\\hat{\\mathbf{Y}}=\\mathbf{x}^{\\prime}\\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{Y}\n$$\n\n$$\nVar(\\hat{\\mathbf{Y}})=\\mathbf{x}^{\\prime}\\left(\\mathbf{X}^{\\prime}\\mathbf{X}\\right)^{-1}\\mathbf{x}\\sigma^2\n$$\n\n$$\n\\frac{Y-\\hat{Y}}{\\sigma^{\\prime}\\left[1+z^{\\prime}\\left(Z^{\\prime} Z\\right)^{-1} z\\right]^{1 / 2}}\\sim t(n-k-1)\n$$\n\n### Multiple R Squared\n\n$$R^{2}=1-\\frac{\\sum_{i=1}^{n}\\left(y_{i}-\\hat{y}_{i}\\right)^{2}}{\\sum_{i=1}^{n}\\left(y_{i}-\\bar{y}\\right)^{2}}$$\n\n$$adj\\ R^2=1-\\frac{\\hat\\sigma^2}{\\text {SST}/n-1}=1-\\frac{(1-R^2)(n-1)}{n-k-1}$$\n\n### Tests of Joint Hypotheses\n\nTest for an overall significant relationship between the response variable and all of the explanatory variables.\n\n#### F Test\n\n$$F=\\frac{1}{2}\\left(\\frac{t_{1}^{2}+t_{2}^{2}-2 \\hat{\\rho}_{t_{1}, t_{2}} t_{1} t_{2}}{1-\\hat{\\rho}_{t_{1}, t_{2}}^{2}}\\right)$$\n\nThe homoskedasticity-only F-statistic\n\n$$F =\\frac{(SSR_{restricted} - SSR_{unrestricted})/q}{SSR_{unrestricted}/(n - k_{unrestricted} - 1)}$$\n\n$$F =\\frac{(R_{unrestricted}^2 - R_{restricted}^2)/q}{(1 - R_{unrestricted}^2)(n -k_{unrestricted} - 1)} $$\n\n## ANOVA\n\nANOVA permits comparisons of multiple populations and even subgroups.\n\n### One-way ANOVA\n\nThe design matrix has a special form:\n\n$$\\boldsymbol{Z}=\\left[\\begin{array}{cccc}1 \u0026 0 \u0026 0 \u0026 0 \\\\\u0026 \\vdots \u0026 \u0026 \\\\1 \u0026 0 \u0026 0 \u0026 0 \\\\0 \u0026 1 \u0026 0 \u0026 0 \\\\\u0026 \\vdots \u0026 \u0026 \\\\0 \u0026 1 \u0026 0 \u0026 0 \\\\0 \u0026 0 \u0026 1 \u0026 0 \\\\\u0026 \\vdots \u0026 \u0026 \\\\0 \u0026 0 \u0026 1 \u0026 0 \\\\0 \u0026 0 \u0026 0 \u0026 1 \\\\\u0026 \\vdots \u0026 \u0026 \\\\0 \u0026 0 \u0026 0 \u0026 1\\end{array}\\right]$$\n\n#### Partitioning a Sum of Squares\n\n$$ S_{\\mathrm{Tot}}^{2}=S_{\\mathrm{Resid}}^{2}+S_{\\mathrm{Betw}}^{2}\n\n$$\n\n$$ S_{\\text {Resid }}^{2}=\\sum_{i=1}^{p} \\sum_{j=1}^{n_{i}}\\left(Y_{i j}-\\bar{Y}_{i+}\\right)^{2}, S_{\\text {Betw }}^{2}=\\sum_{i=1}^{p} n_{i}\\left(\\bar{Y}_{i+}-\\bar{Y}_{++}\\right)^{2} ,S_{\\mathrm{Tot}}^{2}=\\sum_{i=1}^{p} \\sum_{j=1}^{n_{i}}\\left(Y_{i j}-\\bar{Y}_{++}\\right)^{2}$$\n\n-   $\\bar Y_{++}$ is the overall average of all n observations.\n-   $S_{Resid}^2 /\\sigma^2$ has the $\\chi^2$ distribution with $n- p$ degrees of freedom and is independent of $S_{Betw}$.\n\n#### Testing Hypotheses\n\n$$U ^2 = \\frac{S_{Betw}^ 2 /(p - 1)}{S_{Resid}^2/(n-p)}$$\n\nhas the $F$ distribution with $p - 1$ and $n - p$ degrees of freedom.\n\nImportant ratio:\n\n$$\\frac{\\text{Variability AMONG/BETWEEN the means}}{\\text{Variability AROUND/WITHIN the distributions}}$$\n\n-   If the variabitlity BETWEEN the means (distance from overall mean) in the numerator is relatively large compared to the variance WITHIN the samples (internal spread) in the denominator, the ratio will be much larger than 1. The samples then most likely do NOT come from a common population; REJECT Null Hypothesis that mean(s) are equal.\n\n### Two-way ANOVA\n\n## Logistic Regression\n\n### Logit Model\n\n_Model_:\n\n$$\\pi_i=Pr(Y_i=1|X_i=x_i)=\\dfrac{\\text{exp}(\\beta_0+\\beta_1 x_i)}{1+\\text{exp}(\\beta_0+\\beta_1 x_i)}$$\n\nor,\n\n$$\\begin{aligned} \\text{logit}(\\pi_i)\u0026=\\text{log}\\left(\\dfrac{\\pi_i}{1-\\pi_i}\\right)\\\\ \u0026= \\beta_0+\\beta_1 x_i\\\\ \u0026= \\beta_0+\\beta_1 x_{i1} + \\ldots + \\beta_k x_{ik}\\\\ \\end{aligned}$$\n\n-   It uses maximum likelihood estimation (MLE) rather than ordinary least squares (OLS) to estimate the parameters, and thus relies on large-sample approximations.\n\nThe _maximum likelihood estimator_ (MLE) for $(\\beta_0, \\beta_1)$ is obtained by finding $(\\hat{\\beta}_0,\\hat{\\beta}_1)$ that maximizes:\n\n$$L(\\beta_0,\\beta_1)=\\prod\\limits_{i=1}^N \\pi_i^{y_i}(1-\\pi_i)^{n_i-y_i}=\\prod\\limits_{i=1}^N \\dfrac{\\text{exp}\\{y_i(\\beta_0+\\beta_1 x_i)\\}}{1+\\text{exp}(\\beta_0+\\beta_1 x_i)}$$\n\n-   $exp(\\beta_0)$ = the odds that the characteristic is present in an observation _i_ when _Xi_ = 0, i.e., at baseline.\n-   $exp(\\beta_1)$ = for every unit increase in _X_, the odds that the characteristic is present is multiplied by $exp(\\beta_1)$. This is similar to simple linear regression but instead of additive change it is a multiplicative change in rate. This is an estimated _odds ratio_.\n\n$$\\dfrac{\\text{exp}(\\beta_0+\\beta_1(x_{i1}+1))}{\\text{exp}(\\beta_0+\\beta_1 x_{i1})}=\\text{exp}(\\beta_1)$$\n\n### Probit Model\n\nThe _probit_ model\n\n$$\\text{probit}(\\pi(x))=\\beta_0+\\beta x$$\n\nuses _normal_ cdf\n\n$$\\text{probit}(\\pi)=F^{-1}(X \\leq x)$$\n\n### Hypothesis Tests\n\nLikelihood ratio tests\n\nThe likelihood for $n$ observations:\n\n$$L=\\prod_{i=1}^{n}\\left(\\frac{\\exp \\left(x_{i}^{\\prime} \\beta\\right)}{1+\\exp \\left(x_{i}^{\\prime} \\beta\\right)}\\right)^{\\sum_{i=1}^{n} Y_{i}}\\left(1-\\frac{\\exp \\left(x_{i}^{\\prime} \\beta\\right)}{1+\\exp \\left(x_{i}^{\\prime} \\beta\\right)}\\right)^{n-\\sum_{i=1}^{n} Y_{i}}$$\n\nLikelihood Ratio\n\n$$LR = −2\n\nl(\\hat\\beta|H_0) − 2l(\\hat\\beta|H_A)\\sim \\chi^2_p $$\n\nneed to fit two models: the full model and the model under $H_0$. Then $l(\\hat\\beta|H_0)$ is the log-likelihood from the model under $H_0$, and $l(\\hat\\beta|H_A)$ is the log-likelihood from the full model.\n\n$$LR=Deviance_A-Deviance_0 $$\n\n### Wald tests\n\n$$\\frac{\\hat{\\beta}_{j}-\\beta_{j 0}}{\\hat{s e}(\\hat{\\beta})} \\sim N(0,1)$$\n\nLimitation\n\n### Overdispersion\n\nFor the binomial response, if $Y_i \\sim Bin(n_i, \\pi_i)$, the mean is $\\mu_i=n_i\\pi_i$ and the variance is $n_i\\pi_i(1-\\pi_i)$.\n\n-   **_Overdispersion_** means that the data show evidence that the variance of the response is greater than $n_i\\pi_i(1-\\pi_i)$.\n-   Overdispersion can be explained by\n    -   variation among the success probabilities\n    -   correlation between the binary responses\n\nThe most popular method for adjusting for overdispersion comes from the theory of quasi-likelihood.\n\n\n## Reference\n\nIntroduction to Econometrics / James H. Stock \u0026 Mark W. Watson C6-C9 esp. multiple t test\n\nProbability and Statistics / Morris H. DeGroot \u0026 Mark J. Schervish C7-C11 except C10\n\n[Lesson 7: Further Topics on Logistic Regression](https://online.stat.psu.edu/stat504/node/217/)\n\n[极大似然估计和贝叶斯估计](https://zhuanlan.zhihu.com/p/61593112)\n\n[Probability \u0026 Statistics Fundamental](https://nancyyanyu.github.io/posts/c27004a0/)\n\n[Logistic 回归模型的参数估计为什么不能采用最小二乘法？](https://www.zhihu.com/question/23817253)\n\n[在进行 OLS 估计时，为了满足 BLUE 条件，为什么会有 X 取值要在重复抽样时固定的前提？](https://www.zhihu.com/question/25832437)\n\n[](https://www.groups.ma.tum.de/fileadmin/w00ccg/statistics/czado/lec5.pdf)\n\n[](https://courses.washington.edu/b515/l13.pdf)\n\n[逻辑回归是否靠谱，你懂得如何裁判吗？](https://mp.weixin.qq.com/s?subscene=23\u0026__biz=MzAxMDA4NjU3OA==\u0026mid=2652553697\u0026idx=1\u0026sn=09f2a67c9fe3a7081ee8fd76d40150a6\u0026chksm=80bbd03cb7cc592a928c50b7b16518b1837d7a1258fa6d6cad305ff5e09525b98e26b1b147c8\u0026scene=7\u0026key=cc7cc2a0b445493e5a74d4ae079f895dfc0c723c3cff51870eaa2a2a299182d9309998c97eb86ff92300a6f2c05bd4d4f760054842fab5deff7b4ff39f1e151212234c47c80d1d2bf5d2c619ceb025d8a1f838dd7fbcb62c777b6239e637772bdecc698e4c1aadb4a61511031c88bfc27f30af629897d1c218e8cc582ff5a929\u0026ascene=0\u0026uin=MjU1NDk5MDUwOA%3D%3D\u0026devicetype=Windows+10+x64\u0026version=6300002f\u0026lang=zh_CN\u0026exportkey=A5G3CGCLpGJLnOrCZ13ZVHs%3D\u0026pass_ticket=ok4tnaFWS7zPPSCRKPSyUIzrRRcpn0LMaKl%2FkngUWsaWK0ChENo%2FKgwaJH5CCexq\u0026wx_header=0)",title:"Untitled Page"},"/Published/Statistical Inference":{content:"## Estimation\n\n### Prior and Posterior Distributions\n\n-   Suppose that one has a statistical model with parameter $\\theta$. If one treats $\\theta$ as random, then the distribution that one assigns to $\\theta$ before observing the other random variables of interest is called its prior distribution.\n-   Consider a statistical inference problem with parameter $\\theta$ and random variables $X_1, . . . , X_n$ to be observed. The conditional distribution of $\\theta$ given $X_1, . . . , X_n$ is called the posterior distribution of $\\theta$.\n-   Suppose that the $n$ random variables $X_1, . . . , X_n$ form a random sample from a distribution for which the p.d.f. or the p.f. is $f (x|\\theta)$. Suppose also that the value of the parameter $\\theta$ is unknown and the prior p.d.f. or p.f. of $\\theta$ is $\\xi(\\theta)$. Then the posterior p.d.f. or p.f. of $\\theta$ is\n\n$$\\xi(\\theta \\mid \\boldsymbol{x})=\\frac{f\\left(x_{1} \\mid \\theta\\right) \\cdots f\\left(x_{n} \\mid \\theta\\right) \\xi(\\theta)}{g_{n}(\\boldsymbol{x})} \\quad \\text { for } \\theta \\in \\Omega$$\n\n-   where $g_n$ is the marginal joint p.d.f. or p.f. of $X_1, . . . , X_n$.\n\n$$g_{n}(\\boldsymbol{x})=\\int_{\\Omega} f_{n}(\\boldsymbol{x} \\mid \\theta) \\xi(\\theta) d \\theta$$\n\n### Conjugate Prior Distributions\n\n### Bayes Estimators\n\n-   A Bayes estimator is an estimator that is chosen to minimize the posterior mean of some measure of how far the estimator is from the parameter, such as squared error or absolute error.\n-   expected loss：\n\n$$E[L(\\theta, a) \\mid \\boldsymbol{x}]=\\int_{\\Omega} L(\\theta, a) \\xi(\\theta \\mid \\boldsymbol{x}) d \\theta$$\n\n-   For each possible value $x$ of $X$, let $\\delta^\\star(\\boldsymbol x)$ be a value of a such that $E[L(\\theta, a)|x]$ is minimized. Then $\\delta^\\star$ is called a Bayes estimator of $\\theta$.\n-   Suppose that the squared error loss function is used and that the posterior mean of $\\theta, E(\\theta \\mid \\boldsymbol{X}),$ is finite. Then, a Bayes estimator of $\\theta$ is $\\delta^{*}(\\boldsymbol{X})=E(\\theta \\mid \\boldsymbol{X})$.\n-   To apply the theory, it is necessary to specify a particular loss function, such as the squared error or absolute error function, and also a prior distribution for the parameter. Meaningful specifications may exist, in principle, but it may be very difficult and time-consuming to determine them.\n\n### Maximum Likelihood Estimators\n\n-   When the joint p.d.f. $f_n(\\boldsymbol{x}|\\theta)$ of the observations in a random sample is regarded as a function of $\\theta$ for given values of $x_1, . . . , x_n$, it is called the likelihood function.\n-   If we plug the observed values of the data into the conditional p.f. or p.d.f. of the data given the parameter, the result is a function of the parameter alone, which is called the likelihood function.\n-   Maximum Likelihood Estimator/Estimate. For each possible observed vector $\\boldsymbol{x},$ let $\\delta(\\boldsymbol{x}) \\in \\Omega$ denote a value of $\\theta \\in \\Omega$ for which the likelihood function $f_{n}(\\boldsymbol{x} \\mid \\theta)$ is a maximum, and let $\\hat{\\theta}=\\delta(\\boldsymbol{X})$ be the estimator of $\\theta$ defined in this way. The estimator $\\hat{\\theta}$ is called a maximum likelihood estimator of $\\theta .$ After $\\boldsymbol{X}=\\boldsymbol{x}$ is observed, the value $\\delta(\\boldsymbol{x})$ is called a maximum likelihood estimate of $\\theta$.\n\n#### Limitations of Maximum Likelihood Estimation\n\nNonexistence of an M.L.E.\n\n$$f(x \\mid \\theta)=\\left\\{\\begin{array}{ll}\\frac{1}{\\theta} \u0026 \\text { for } 0\u003cx\u003c\\theta \\\\0 \u0026 \\text { otherwise }\\end{array}\\right.$$\n\nNon-uniqueness of an M.L.E.\n\n$$f_{n}(\\boldsymbol{x} \\mid \\theta)=\\left\\{\\begin{array}{ll}1 \u0026 \\text { for } \\theta \\leq x_{i} \\leq \\theta+1,(i=1, \\ldots, n) \\\\0 \u0026 \\text { otherwise }\\end{array}\\right.$$\n\nThus, it is possible to select as an M.L.E. any value of $\\theta$ in the interval\n\n$$ \\max \\left\\{x_{1}, \\ldots, x_{n}\\right\\}-1 \\leq \\theta \\leq \\min \\left\\{x_{1}, \\ldots, x_{n}\\right\\} $$\n\nSampling from a Mixture of Two Distributions\n\n### Properties of Maximum Likelihood Estimators\n\n-   Invariance: Let $\\hat\\theta$ be an M.L.E. of $\\theta$, and let $g(\\theta)$ be a function of $\\theta$. Then an M.L.E. of $g(\\theta)$ is $g(\\hat\\theta)$.\n-   Consistency: the sequence of M.L.E.’s converges in probability to the unknown value of $\\theta$ as $n \\rightarrow \\infty$.\n\n## Sampling Distributions of Estimators\n\n### Joint Distribution of the Sample Mean and Sample Variance\n\n-   Let $X_{1}, \\ldots, X_{n}$ be a random sample from the normal distribution with mean $\\mu$ and variance $\\sigma^{2}$. Then the sample mean $\\hat{\\mu}=\\bar{X}{n}=\\frac{1}{n} \\sum{i=1}^{n} X_{i}$ and sample variance $\\widehat{\\sigma^{2}}=\\frac{1}{n} \\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}_{n}\\right)^{2}$ are independent random variables. Furthermore, $\\hat{\\mu}$ has the normal distribution with mean $\\mu$ and variance $\\sigma^{2} / n,$ and $n \\widehat{\\sigma}^{2} / \\sigma^{2}$ has a chi-square distribution with $n-1$ degrees of freedom.\n\n### Confidence Intervals\n\n-   We can find an interval $(A, B)$ that we think has high probability of containing $θ$. The length of such an interval gives us an idea of how closely we can estimate $θ$.\n-   Let $X = (X_1, . . . , X_n)$ be a random sample from a distribution that depends on a parameter (or parameter vector) $\\theta$. Let $g(\\theta)$ be a real-valued function of $\\theta$. Let $A \\leq B$ be two statistics that have the property that for all values of $\\theta$,\n\n$$Pr(A \u003c g(\\theta) \u003c B) ≥ \\gamma$$\n\n-   Then the random interval $(A, B)$ is called a coefficient $\\gamma$ confidence interval for $g(θ)$.\n\n### Unbiased Estimators\n\n-   Let $\\delta$ be an estimator of a function $g$ of a parameter $\\theta$. We say that $\\delta$ is unbiased if $E_{\\theta}[\\delta(X)] = g(\\theta)$ for all values of $\\theta$.\n-   The quality of an unbiased estimator must be evaluated in terms of its variance or its M.S.E.\n-   Limitations:\n    -   Nonexistence of an Unbiased Estimator\n        -   suppose that $X_1, . . . , X_n$ form n Bernoulli trials for which the parameter $p$ is unknown. It can be shown that there will be no unbiased estimator of $p^{1/2}$.\n    -   Inappropriate Unbiased Estimators\n        -   Consider an infinite sequence of Bernoulli trials for which the parameter $p$ is unknown $(0 \u003c p \u003c 1)$, and let $X$ denote the number of failures that occur before the first success is obtained.\n\n## Testing Hypotheses\n\n### Problems of Testing Hypotheses\n\nConcepts:\n\n-   Because of focusing on type I error instead of type II error, we usually regard type I error as having more serious consequences than type II error.\n    \n-   Hence, in formulating null and alternative hypotheses, we use the more conservative hypothesis as the null hypothesis, and will only reject it when the data provide statistically significant evidence against it.\n    \n-   Type I \u0026 II Error\n    \n    $$\\begin{array}{r|cc} \u0026\\text{Actually $H_0$ is True}\u0026\\text{Actually $H_1$ is True}\\\\ \\hline\\text{Do not reject $H_0$}\u0026 \\text{Correct} \u0026\\text{Type II Error} \\\\ \\text{Reject $H_0$} \u0026 \\text{Type I Error} \u0026\\text{Correct} \\\\ \\end{array}$$\n    \n-   Size\n    \n    -   Loosely, the size $\\alpha(\\delta)$ of a given test $\\delta$ is the maximum probability of type I error.\n-   Level\n    \n    -   $\\delta$ is a level $\\alpha_0$ test if and only if $\\alpha(\\delta)\\leq\\alpha_0$.\n-   $p$-value\n    \n    -   A $p$-value is a probability that provides a measure of the evidence against the null hypothesis provided by the sample.\n    -   In general, the $p$-value is the smallest level $\\alpha_0$ such that we would reject the null hypothesis at level $\\alpha_0$ with the observed data.\n    -   For each $x$, let $\\delta_x$ be the test that rejects $H_0$ if $X\\geq x$. Then the $p$-value equals:\n    \n    $$ \\sup _{\\theta \\in \\Omega_{0}} \\pi\\left(\\theta | \\delta_{x}\\right)=\\sup _{\\theta \\in \\Omega_{0}} \\operatorname{Pr}(X \\geq x | \\theta)\n    \n    $$\n    \n-   Critical Value\n    \n    -   The critical values are the boundaries of the acceptance region of the test.\n    -   The critical value will be a quantile of a certain distribution.\n\n### The t Test\n\n### Comparing the Means of Two Normal Distributions\n\n### The F Distributions\n\n## Categorical Data and Nonparametric Methods\n\n### Tests of Goodness-of-Fit\n\n### Goodness-of-Fit for Composite Hypotheses\n\n### Contingency Tables\n\n### Tests of Homogeneity\n\n### Simpson’s Paradox\n\n## Four Steps to Hypothesis Testing\n\n### Compute the test statistic\n\n| Situation                                                | Null Hypothesis | Test Statistic                                               | Critical Region     |\n| :------------------------------------------------------- | --------------- | ------------------------------------------------------------ | --------------------------------- |\n| Mean of a Population (known $\\sigma$) | $\\mu=\\mu_0$ | $U=\\frac{\\bar x-\\mu_0}{\\sigma/\\sqrt{n}}$ | $\\{\\lvert U\\rvert\\geq U_{1-\\alpha/2}\\}$ |\n| Mean of a Population (unknown $\\sigma$) |      $\\mu=\\mu_0$            | $T=\\frac{\\bar x-\\mu_0}{s/\\sqrt{n}}$                          | $\\{\\lvert T\\rvert\\geq t_{1-\\alpha/2}(n-1)\\}$ |\n| Proportion of a Population | $p= p_0$ | $U=\\frac{\\hat{p}-p_{0}}{\\sqrt{\\frac{p_{0}\\left(1-p_{0}\\right)}{n}}}$ | $\\{\\lvert U\\rvert\\geq U_{1-\\alpha/2}\\}$ |\n| Means of Two Populations (known $\\sigma$) | $\\mu_1=\\mu_2$ | $U=\\frac{(\\bar x-\\bar{y})}{\\sqrt{\\frac{\\sigma_{1}^{2}}{m}+\\frac{\\sigma_{2}^{2}}{n}}}$ |   $\\{\\lvert U\\rvert\\geq U_{1-\\alpha/2}\\}$   |\n| Means of Two Populations (unknown $\\sigma$ and $\\sigma_1=\\sigma_2$ ) | $\\mu_1=\\mu_2$ | $T=\\frac{\\bar x-\\bar y}{s_p\\sqrt{\\frac{1}{m}+\\frac{1}{n}}},\\\\ s_{p}^{2}=\\frac{(m-1) s_{x}^{2}+(n-1) s_{y}^{2}}{m+n-2}$ | $\\{\\lvert T\\rvert\\geq t_{1-\\alpha/2(m+n-2)}\\}$ |\n| Means of Two Populations (unknown $\\sigma_1,\\sigma_2,\\sigma_1\\neq\\sigma_2$ and large sample) | $\\mu_1=\\mu_2$ | $U=\\frac{\\bar x-\\bar y}{\\sqrt{\\frac{s_x^2}{m}+\\frac{s_y^2}{n}}}$ | $\\{\\lvert U \\rvert\\geq U_{1-\\alpha/2}\\}$ |\n| Means of Two Populations (unknown $\\sigma_1,\\sigma_2,\\sigma_1\\neq\\sigma_2$ and small sample)[Do not need to know] | $\\mu_1=\\mu_2$ | $T=\\frac{\\bar x-\\bar y}{\\sqrt{\\frac{s_x^2}{m}+\\frac{s_y^2}{n}}}$ | $\\{\\lvert T\\rvert\\geq t_{1-\\alpha/2}(l-1)\\},\\\\l=\\frac{s^{4}}{\\frac{s_{x}^{4}}{m^{2}(m-1)}+\\frac{s_{y}^{4}}{n^{2}(n-1)}},s_{0}^{2}=\\frac{s_{x}^{2}}{m}+\\frac{s_{y}^{2}}{n}$ |\n| Proportion of Two Populations | $p_1=p_2$ | $U=\\frac{\\hat{p}_{1}-\\hat{p}_{2}}{\\sqrt{\\hat{p}(1-\\hat{p})\\left(\\frac{1}{n_{1}}+\\frac{1}{n_{2}}\\right)}}, \\hat{p}=\\frac{n_{1} \\hat{p}_{1}+n_{2} \\hat{p}_{2}}{n_{1}+n_{2}}$ | $\\{\\lvert U\\rvert\\geq U_{1-\\alpha/2}\\}$ |\n| Matched Pairs | $\\delta=\\mu_1-\\mu_2,\\delta=\\mu_0$ | $T=\\frac{\\delta-\\mu_0}{s_{\\delta}/\\sqrt{n}}$ | $\\{\\lvert T\\rvert \\geq t_{1-\\alpha/2}(n-1)\\}$ |\n| Variance of Two Populations | $\\sigma_1^2=\\sigma_2^2$ | $F=\\frac{s_x}{s_y}$ | $\\left\\{F \\leq F_{\\alpha/2}(m-1, n-1) \\text { or } F \\geq F_{1-\\alpha / 2}(m-1, n-1)\\right\\}$ |\n| Coefficient | $\\hat\\beta_j=\\beta_j^{\\star}$ | $T=\\frac{\\hat\\beta_j-\\beta_j^{\\star}}{SE(\\hat \\beta_j)}$ | $\\{\\lvert T\\rvert \\geq t_{1-\\alpha/2}(n-k-1)\\}$ |\n| Goodness of Fit (known $p_i$) | $P(A_i)=p_i$ | $Q=\\sum_{i=1}^{k} \\frac{\\left(N_{i}-n p_{i}\\right)^{2}}{n p_{i}}$ | $\\{Q\\geq \\chi^2_{1-\\alpha}(k-1)\\}$ |\n| Goodness of Fit (unknown $p_i$) | $P(A_i)=p_i$ | $Q=\\sum_{i=1}^{k} \\frac{\\left[N_{i}-n \\pi_{i}(\\hat{\\theta})\\right]^{2}}{n \\pi_{i}(\\hat{\\theta})}$ | $\\{Q\\geq \\chi^2_{1-\\alpha}(k-s-1)\\}$ |\n| Independence in Contingency Tables | $p_i, p_j\\ independent$ | $Q=\\sum_{i=1}^{R} \\sum_{j=1}^{c} \\frac{\\left(N_{i j}-\\hat{E}_{i j}\\right)^{2}}{\\hat{E}_{i j}}$ | $\\{Q\\geq \\chi^2_{1-\\alpha}((R-1)(C-1))\\}$ |\n\n**Note:** $\\bar x,\\bar y$ is the sample mean. $s,s_x,s_y$ is the standard deviation of sample. i.e. $s=\\sqrt{\\frac{\\sum\\left(X_{i}-\\bar{X}\\right)^{2}}{n-1}}$. ",title:"Untitled Page"},"/Published/Swap":{content:"## 利率互换\n\n- 互换利率是互换交易中的固定利率（息票利率）\n- 互换利差=互换利率-同期国债利率\n- 对于美国市场的标准互换合约，互换利率=（Bid+Offer）/2\n    - Bid: pay fixed receive LIBOR\n    - Ask: pay LIBOR receive fixed\n\n### 利用互换转变负债的性态\n\n- 利率互换可将其浮动利率贷款转换为固定利率贷款。\n    - 支付给外部贷款人的利率为LIBOR+0.1%\n    - 在互换合约中收入LIBOR\n    - 在互换合约中付出5%。\n- 利率互换可将其固定利率贷款转换为浮动利率贷款。\n    - 支付给外部贷款人的利率为5.2%\n    - 在互换合约中付出LIBOR\n    - 在互换合约中收入5%。\n\n### 利用互换转变资产的性态\n\n- 将收入为固定利率的资产转换为收入为浮动利率的资产\n\n- 将其浮动利率资产转换为固定利率资产\n\n### 做市商\n\n- 金融机构在进入利率互换的同时，不一定要进入与其他交易对手之间的互换交易。\n\n- 买入和卖出利率的平均值被称为互换利率。\n\n- 如果合约中的固定利率等于当前的互换利率，可以合理地假设这一互换的价值为0.\n\n$$B_{fix}=B_{float}$$\n\n### 确定LIBOR/互换零息利率\n\n- “连续更新”的LIBOR利率\n- 新发行的券息为LIBOR的浮动息债券价格将总会等于本金价格（平价）\n- 而对于一个**新成交**的互换交易，**当固定利率等于互换利率时**，固定利率的价格等于浮动利率的价格也就是**本金**，互换利率定义了一组平价债券\n- LIBOR和固定息互换利率定义了一系列平价债券\n- 用票息剥离法来确定并**延长**LIBOR/互换零息曲线\n\n$$\\begin{aligned}\n\n\u00260.5\\times swap\\ rate \\times e^{-LIBOR_{6m}\\times 0.5}\\\\\u0026+0.5\\times swap\\ rate \\times e^{-LIBOR_{12m}\\times 1}\\\\\u0026+0.5\\times swap\\ rate \\times e^{-LIBOR_{18m}\\times 1.5}\\\\\u0026+(100+0.5\\times swap\\ rate )\\times e^{-LIBOR_{24m}\\times 2}=100\n\n\\end{aligned}$$\n\n### OIS利率\n\n- 联邦基金利率（Fed funds rate）是美国金融机构之间的无抵押隔夜拆借利率，由经纪商所促成交易的加权平均利率为有效联邦基金利率（Effective federal funds rate）\n- OIS是将一段时间内的固定利率和隔夜利率的几何平均值进行交换的合约，其中的固定利率被称为隔夜指数互换利率（OIS rate）\n- OIS利率是对于无风险利率的一个好的近似估计\n\n### 确定OIS零息利率\n\n- 需要长期的OIS零息利率时，可以假设OIS利率和相应的LIBOR/互换利率的溢差在一定期限之外是一样的\n\n### 利率互换的定价\n\n横向分解\n\n- 浮动利率债券多头＋固定利率债券空头\n- 浮动利率债券空头＋固定利率债券多头\n- 浮动利率债券：相当于第一期初买一个平价债券，持有一期；在第二期期初收回本息，再买一个平价债券……一直到第n期\n- 在每一个付息日（在支付利息之后），浮动利率债券的价格等于面值\n- the value of the floating-rate bond today is $(L+k^{\\star})e^{-r^{\\star}t^{\\star}}$, where $r^{\\star}$ is the LIBOR/swap zero rate for a maturity of $t^{\\star}$.\n- 注意利息支付是否是复利的：一期本金+利息再折现\n\n纵向分解：看成是后付的FRA\n\n- 利率互换中的每一次支付交换就是一个远期利率合约\n- 定价过程：\n    - 计算用于决定互换现金流的LIBOR远期利率\n    - 假定LIBOR利率等于远期利率，并计算互换的现金流\n    - 用无风险利率对现金流进行贴现。\n- 注意要用利率期限结构估计出LIBOR的远期利率再代入FRA的计算中\n\n## 货币互换\n\n定义$V_{swap}$为收入美元并支付外币的货币互换的美元价值，那么：\n\n$$\nV_{swap}=B_D-S_0B_F$$\n\n其中$B_F$为互换中外汇现金流所对应的债券以外币计价的价值，$B_D$为互换中本国货币现金流所对应的债券以美元计价的价值，$S_0$为即期汇率（1单位外币所对应的美元数量）。\n\n\n## 信用风险\n\n- 在对手违约时，如果互换对于金融机构具有正价值，金融机构将蒙受损失；但如果互换对于金融机构具有负价值，则违约不会产生影响。\n\n- 市场风险来源于利率、汇率等市场变量，可以通过进入相互抵消的合约来进行对冲，但信用风险不能简单地对冲。\n\n## 其他互换\n\n- 本金数量在互换期限内可能有变化：amortizing swap, step-up swap\n- 在未来的某一时刻才开始利息交换：deferred swap, forward swap\n- 固定期限互换：LIBOR与某种互换利率交换\n- Diff互换/Quanto\n- 股权互换：某个股指的总收益与某固定或浮动利率互换\n- 可延期互换、可赎回互换\n- 商品互换、波动率互换\n",title:"Untitled Page"},"/Published/TBA Market and Dollar Roll":{content:"---\nArea: Finance\nSource: Paper\nStatus: Done\nType: Notes\n---\n\n\n\n本文综述了Song and Zhu两位教授发表于RFS的文章“Mortgage Dollar Roll”，并辅以其他文献整理总结 Agency MBS、TBA 市场及 Dollar Roll 的融资机制。\n\n## 机构 MBS (Agency MBS)\n\nAgency MBS 是指由 Ginnie Mae (GNMA)、Fannie Mae (FNMA) 和 Freddie Mac (FHLM) 担保的抵押贷款支持证券 (MBS)，是美国固定收益市场的主要组成部分。其重要性主要体现在以下特点：\n\n- **规模大**：根据 SIFMA 的数据，截至 2017 年第二季度，机构抵押贷款支持证券（MBS）的流通量约为 9.2 万亿美元，仅次于美国国债市场的流通量 14.0 万亿美元。\n- **货币政策传导作用**：美联储自 2009 年以来进行了多轮量化宽松（QE），累计面值为 1.74 万亿美元。\n- **住房抵押贷款作用**：RMBS 满足了居民的购房需要，而机构 MBS 市场对抵押贷款市场的健康发展至关重要。\n\n## TBA市场 (To-be-announced market, TBA market)\n\nTBA 合约本质上是MBS的远期买卖合约。在 TBA 交易中，买卖双方只约定六个参数：发行人 (Agency)、到期日 (Maturity)、票息 (Coupon)、面值 (Par Amount)、价格 (Price)、结算日 (Settlement Date)。与其他远期合约不同，TBA 合约每月只有一个结算日，由 SIFMA 设定。\n\nTBA 交易的独特之处在于，在结算日交付的交易双方并未在交易日指定具体的需要买卖的 MBS CUSIP，而是仅指定几个关键的 MBS 特征。这种交易设计显著增加了可交付 MBS 的数量并提高了市场流动性。 \n\nTBA 市场可以为抵押贷款发起人提供风险对冲和融资作用。贷款机构通常会给予优质申请人30天到90天的利率锁定期，允许申请人在锁定期内决定是否按照特定的固定利率借入款项，这实质上相当于给予贷款申请人一个30天到90天的“固定利率期权”。贷款发起人将面临市场利率变动所引发的利率风险。通过TBA市场，抵押贷款发起人可以在发放贷款之前就锁定MBS的转售价格，比较直接地实现了对贷款利率风险的对冲目的。因此，即使是小规模贷款机构也可以发放贷款，使购房者获得更低廉的利率。\n\n## 美元滚动交易 (Dollar Roll)\n\n美元滚动交易由两笔 TBA 交易组成。卖家 (roll seller, MBS持有者，即融入资金方）出售一张MBS，承诺在近月 (front month) 交付这张券给对方，同时承诺在远月 (future month) 再把同类同面值的券买回来。这两个 MBS 不需要完全相同，只要它们具有相同的 TBA 特征即可。 \n\n![](Pasted%20image%2020220319222213.png)\n\n美元滚动交易的“下跌” (dollar roll drop) 是近月和远月 TBA 合约之间的价差，一般来说是正的，原因有二。 \n\n- 由于没有规定两次交易时交付的券是一致的，所以在逆向选择的前提下，卖家在远月会收到较差的券，所以 MBS 的价值也较低。\n- 其次，卖家在近月卖出了这张 MBS 后，也放弃了这期间的本金和利息收入，所以会存在dollar roll drop.\n\n这两个特征将 dollar roll 与 MBS 回购交易区分开来。在 MBS 回购交易中，融出资金方必须归还相同的 MBS pool，并且原始所有者在回购期间会收取本金和利息。\n\n## 美元滚动交易的特殊性 (Dollar Roll Specialness)\n\n如果通过 dollar roll 融资时的隐含融资利率低于现行利率（例如 MBS 回购利率），就称这个 dollar roll 为“特殊 (on special)”。可以通过计算回购利率与隐含融资利率之间的差值衡量一个 dollar roll 的“特殊”程度 (specialness).\n\n- 因为不指定两次交易时需要同样的个券，所以当资金融入方回购 MBS 时，融出资金方可以选更便宜的券交付，通常更便宜的券对应更高的“提前偿付风险”。正的 specialness 是对卖方承担再交付风险的补偿。\n    \n- 持有稀缺的 MBS 可以在回购市场和证券借贷市场中融到更多的钱。如果不进入回购市场而是进行 dollar roll，卖方不仅放弃了利息和本金支付，而且放弃了与更便宜的融资利率和贷款费用。因此，dollar roll中的均衡隐含融资利率必然下降，从而导致更高的specialness. 特定类别 MBS 的稀缺性可能受到交易商和贷款发行人的做空和对冲以及新发行的 MBS 数量的推动。\n\n\n\n### Dollar Roll Specialness 的决定因素\n\n#### 再交付风险和逆向选择\n\n相对于回购融资，dollar roll 的一个关键特征是融出资金方（借出现金并接收 MBS）可以选择在滚动合约的远月交付基本相似但不同的 MBS. 所以由于逆向选择，buyer 会选择交付一个最差的 MBS. 因为 Agency MBS 不存在违约风险，所以更差的券一般意味着更大的提前偿还风险。所以可交付的 MBS 范围内，**提前偿还风险的分散度 (dispersion) 越大，specialness 越高。**\n\n\n除了类似于回购市场中供应量对融资利率的影响机制，dollar roll还有一个特殊之处：由于逆向选择的存在，市场参与人对于交付最差证券的行为具有充分的理性预期，**MBS 的流动将缩小到最便宜可交付券 (CTD, Cheapest-to-deliver)**。这进一步导致了可流动的 MBS 供应量的减少。**即使 MBS 总供应不变，更高的逆向选择可以缩小 MBS 的有效供应，使其 specialness 增加**。这种逆向选择和供应之间的内生反馈是 dollar roll 独有的。\n\n随着可交付 MBS 的分散度变大，卖家因为会想到买家一定会交付回更差的 MBS，所以一开始就不愿意在 dollar roll 中交易高质量的 MBS。所以高质量的 MBS 将在指定池市场 (specified pool market) 交易。因此，**提前偿还风险的分散度 (dispersion) 越大，specified pool market 交易应该越活跃**。 所以 **specialness 和 specified pool market 的交易量正相关**。\n\n#### MBS 所有权的交换 (Ownership Exchange)\n\n**杠杆率的影响：**\n\n- 基于 Dollar roll 的融资可以被看做表外业务，而通过回购融资更可能被看做表内业务。所以使用 dollar roll 融资（相对于回购）可以更节约表空间。所以 **specialness 与金融机构的杠杆负相关**。\n  \n**提前偿付风险的转移：**\n\n- 在融资期间，dollar roll 中MBS的利息和本金偿还均直接给到资金融出方，而回购中，抵押品的一切利息和本金收益均由资金融入方获得。因此，买方承担提前还款风险。如果持有的是 premium MBS，提前还款会造成损失，如果持有的是 discount MBS，提前还款会带来收益。所以如果提前还款风险比预期更高，则买方如果收到了 premium MBS，则期待更高的融资利率；如果收到了 discount MBS，则会期待更低的融资利率。**Specialness 正向（负向）依赖于premium（discount）MBS 抵押品在融资期间的提前还款速度**。\n\n\n### Dollar Roll Specialness 与 MBS 回报之间的关系\n\n**Dollar roll specialness 与预期 MBS 回报呈负相关。**\n\nMBS 回报率越高，dollar roll 相对于 MBS 回购放弃掉的回报率就越大，市场参与者会更青睐回购，回购利率上升，specialness 下降。Specialness 较高的 MBS 为其持有者在融资市场上提供了“便利收益 (convenience yield)”，所以这些持有者愿意接受较低的预期回报。\n\n\n## 实证研究\n\n### 再交付风险\n\n作者建立了如下的模型进行面板数据回归：\n\n$$\nSpecialness_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Disp_{it}^{CPR}+\\varepsilon_{i t}\n$$\n\n\n$Specialness_{it}$: dollar roll specialness, dollar roll financing rates 和一个月的 MBS 回购利率的差值。\n\n$D_{t}, D_{i}$分别是息票利率和时间的哑变量。\n\n$Disp_{it}^{CPR}$: 用提前偿还率的分散度作为 value dispersion 的代理变量。剔除至少具有以下特征之一的 MBS CUSIP：剩余本金余额低于 150,000 美元，再融资份额大于 75%，平均 LTV 比率高于 85%，平均 FICO 分数低于 680。这些特征使提前还款的可能性降低，因此不太可能成为 CTD. 基于可能交易的 MBS 的 SMM数据，根据SMM计算CPR，再计算CPR的范围，即相同息票$i$和时间$t$下，各个CUSIP的CPR从高到低排序，计算最高CPR与最低CPR的差。\n\n结论是$Disp_{it}^{CPR}$增加 1个标准差，dollar roll specialness 将提高约 41 个bp. \n\n另一种衡量 value dispersion 的方法是利用 specified pool 数据，计算$Payup_{it}$和$Trade^{SP}$. Specified pool 指定了可交割的 MBS，不存在再交付风险，因此对寻求融资优质MBS的市场参与者更具吸引力。因此$Payup_{it}$定义为 SP 和 TBA 的价格差异，也是 value dispersion 的代表。计算方法为相同息票$i$和时间$t$下按交易量加权平均的 SP 和 TBA 的价格差。$Trade^{SP}$是相同息票$i$和时间$t$下 SP 的交易量。回归后结论都是和 specialness 呈正相关。\n\n$$\nSpecialness_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Payup_{it}+\\varepsilon_{i t}\n$$\n\n$$\nSpecialness_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Trade_{it}^{SP}+\\varepsilon_{i t}\n$$\n\n\n\n\n\n### 所有权交换\n\n作者建立了以下模型研究杠杆率对 specialness 的影响：\n\n$$\nSpecialness_{it}=\\sum_{i} \\gamma_{i} D_{i}+\\beta Leverage_{t-1}+\\varepsilon_{i t}\n$$\n\n$Leveraget_{t-1}$: 上一期 primary dealer 的 asset/equity ratio 的平方和，用以衡量是否有出表的需求，越大说明资产比例越高，越不需要出表。\n\n结论是$Leverage$增加 1个标准差，dollar roll specialness 将降低约 11 个bp. \n\n作者定义$CPR^{Signed,Change}$为：如果是 premium MBS则是$\\Delta CPR$，如果是 discount MBS则是$-\\Delta CPR$，以便进行回归分析。作者建立下面的模型来观察提前偿还风险的变化（超出预期）是否会对买家对 MBS 的优劣产生影响进而对 specialness 有影响。\n\n$$\nSpecialness_{it}=\\sum_{i} \\gamma_{i} D_{i}+\\beta CPR^{Signed,Change}+\\varepsilon_{i t}\n$$\n\n结论是$CPR^{Signed,Change}$增加 1个标准差，dollar roll specialness 将降低约 21 个bp. \n\n\n### Dollar Roll Specialness 和 MBS 回报率\n\n作者建立了如下的模型进行面板数据回归：\n\n$$\nOAS_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Specialness_{i t}+\\varepsilon_{i t}\n$$\n\n$$\nRet_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Specialness_{i t}+\\varepsilon_{i t}\n$$\n\n其中 [OAS](OAS.md) 是基于利率 $r_{t}$ 上使得 MBS 预期现金流的现值等于该 MBS 的市场价格所需收益率价差。可以按以下方法倒解出 OAS：\n\n设$r_{t}, t=1, \\cdots, T$是利率曲线，给定$r_{j t}, t=1, \\cdots, T$是状态 $j=1, \\cdots, N$下的利率，每个状态下 MBS 的现金流可以$C_{j t}, t=1, \\cdots, T$确定，OAS被定义为：\n$$\nV_{M B S}=\\sum_{j=1}^{N} p_{j}\\left[\\sum_{t=1}^{T} \\frac{C_{j t}}{\\left(1+r_{j 1}+O A S\\right) \\times \\cdots\\left(1+r_{j t}+O A S\\right)}\\right]\n$$\n其中 $p_{j}$ 是状态 $j$的概率。\n\nRet是FNMA 30YR TBA 合约的月度回报率。可以避免使用OAS带来的内生性问题。\n\n**结论是 dollar roll specialness 和 MBS 回报率负相关。**\n\n\n\n\n## 美联储在量化宽松期间使用 dollar roll\n\n\n美联储在金融危机之中采用了量化宽松政策，大量购买了 Agency MBS 和 Treasury，以达成维持就业水平与稳定物价的双重目标。**这将推升近月合约的价格，造成 drop 数值高于合理值，借压低长期利率，支持抵押贷款市场，让资金状况更为宽松。**\n\n金融机构因此担忧大量的 MBS 购买是否会造成 MBS 的市场扭曲，新发行 MBS 的速度是否能美联储购买的速度。\n\n\n美联储可以通过 dollar roll 把交割日移到下个月, 等于推迟了 MBS 交割。为了研究美联储的 dollar roll sale 是否意在对市场 specialness 的关注，是否减轻了 MBS 市场的资金扭曲，作者比较了 specialness 在美联储 dollar roll sale 之后的变化。\n\n$$\n\\Delta Specialness_{it}=\\sum_{t}\\alpha_t D_t+ \\beta_1 d^{Roll}_{it}+ \\epsilon_{it}\n$$\n\n$d_{Roll}$是哑变量，判断美联储是否实行了 dollar roll sales. \n\n$\\beta_1$的估计结果为负值，意味着在美联储 dollar roll sales后，specialness 会下降。\n\n## 结论\n\nDollar roll 可以看做以 MBS 为抵押品的融资，但在以下方面又与 MBS 回购不同。\n  \n- 再交付风险：资金融出者可以选择在贷款到期时归还不同的 MBS 抵押品。\n\n- 所有权交换：MBS 的所有权在融资期间有所转移。\n  \n因此造成了通过 dollar roll 融资的成本比回购更低，也即 dollar roll specialness.\n\n美联储可以通过 dollar roll sale 推迟交割，缓解由量化宽松购买 MBS 造成的供应短缺。\n\n\n## Reference\n\nSong, Z., \u0026 Zhu, H. (2019). Mortgage Dollar Roll. _The Review of Financial Studies_, _32_(8), 2955–2996. [https://doi.org/10.1093/rfs/hhy117](https://doi.org/10.1093/rfs/hhy117)\n\n[美元滚动策略即dollar roll是什么，能直白的解释下吗？ - 知乎](https://www.zhihu.com/question/67960832/answer/2331550109)\n\n\n[李力，雕刻现金流：从证券化到项目融资，中信出版集团股份有限公司，2017](https://weread.qq.com/web/reader/78c32f805e10dc78c9981c5kc81322c012c81e728d9d180)\n\n[林华，中国资产证券化产品投资手册，中信出版集团股份有限公司，2017](https://weread.qq.com/web/reader/cab3224071ae93c6cabb193kc81322c012c81e728d9d180)\n\n",title:"Untitled Page"},"/Published/利率及利率衍生品":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n## 利率的种类\n\n### 国债收益率\n\n### LIBOR\n\n-   银行之间短期无抵押拆借利率\n\n### 联邦基金利率\n\n-   隔夜拆借利率被称为联邦基金利率（federal funds rate）\n-   借入和借出资金交易往往通过经纪商达成，由经纪商达成交易的利率加权平均（权重与交易规模有关）被称为有效联邦基金利率（effective federal funds rate）\n\n### 再回购利率\n\n-   是有抵押借贷利率\n-   拥有证券的金融机构同意将证券出售给合约的另一方，并在将来以稍高价格将证券买回\n    -   隔夜回购（overnight repo）\n    -   期限回购（term repo）\n\n### 零息利率\n\n-   $n$年的零息利率是指在今天投入资金并连续保持n年后所得的收益率\n-   也叫$n$年期的即期利率（spot rate），或者$n$年期零息率（zero rate）\n\n### 天数计量\n\n天数计算定义了一段时间内利息累积的方式\n\n-   三种报价方式：\n    -   实际天数/实际天数（期限内）\n    -   30/360\n    -   实际天数/360\n-   “实际天数/实际天数（期限内）”惯例适用于美国长期国债；“30/360”惯例适用于美国的企业及市政债券；“实际天数/360”惯例适用于美国短期国债及其他货币市场产品。\n\n## 债券定价\n\n### 债券收益率(YTM)\n\n### 平价收益率\n\n-   平价收益率（par yield）是使债券价格等于面值的券息率（coupon rate）\n-   $d$为债券到期时收到1美元的贴现值，$A$为年金现金流的当前价值（年金：annuity，在每个券息日支付1美元），$m$是每年券息支付的次数：\n\n$$100=A\\frac{c}{m}+100d$$\n\n### 确定国库券零息利率\n\n-   票息剥离方法（bootstrap method）\n-   Zero curve不是一条水平线的原因在于市场预期现在和1年后的1年期即期利率不一样\n\n### 久期和修正久期\n\n（麦考利）久期\n\n$$D=\\sum_{i=1}^{n} t_{i}\\left[\\frac{c_{i} \\mathrm{e}^{-y t_{i}}}{B}\\right] $$\n\n**YTM以连续复利计时**，麦考利久期乘以到期收益率的变动为债券价格变动的百分比\n\n$$ \\begin{aligned} \\Delta B\u0026=-\\Delta y \\sum_{i=1}^{n} c_{i} t_{i} \\mathrm{e}^{-yt_i}\\\\ \\frac{\\Delta B}{B}\u0026=-D\\Delta y \\end{aligned}\n\n$$\n\n修正久期\n\n修正了连续复利情况下的上述推导。\n\n$y$为一年$m$次复利的情形：\n\n$$\\begin{aligned}{\\Delta B=-\\frac{B D \\Delta y}{1+y / m}} \\\\ {D^{*}=-\\frac{D}{1+y / m}}\\end{aligned} $$\n\n美元久期：修正久期和债券价格的乘积\n\n### 债券组合的久期\n\n-   债券组合的久期可以被定义为构成债券的组合中每一个债券的久期的加权平均，其权重与相应债券价格成正比。\n\n### 凸性\n\n$$C=\\frac{1}{B} \\frac{\\mathrm{d}^{2} B}{\\mathrm{d} y^{2}}=\\frac{\\sum_{i=1}^{n} c_{i} t_{i}^{2} \\mathrm{e}^{-y t}}{B}$$\n\n$$\\begin{aligned}\\Delta B=\\frac{\\mathrm{d} B}{\\mathrm{d} y} \\Delta y+\\frac{1}{2} \\frac{\\mathrm{d}^{2} B}{\\mathrm{d} y^{2}} \\Delta y^{2} \\\\\\frac{\\Delta B}{B}=-D \\Delta y+\\frac{1}{2} C(\\Delta y)^{2}\\end{aligned}$$\n\n## 远期利率\n\n$$R_F=\\frac{R_2T_2-R_1T_1}{T_2-T_1}=R_2+(R_2-R_1)\\frac{T_1}{T_2-T_1}$$\n\n-   如果零息利率曲线向上倾斜，则在$T_2$结束的时间段上的远期利率大于期限为$T_2$的零息利率。反之亦然。\n\n$$R_F=R+T\\frac{\\partial R}{\\partial T}=-\\frac{\\partial}{\\partial T}lnP(0,T)$$\n\n-   瞬时远期利率$R_F$\n-   $P(0,T)$为$T$时刻到期的零息债券价格：\n\n$$P(0,T)=e^{-RT}$$\n\n-   远期利率代表了市场对即期利率的预期，如果投资者的看法与其不同，可以做收益率赌博\n\n### 远期利率合约（FRA）\n\n-   远期利率合约（FRA）是一种场外交易，目的是锁定在将来一段时间借入或借出一定数量资金时的利率，常常设为LIBOR.\n-   名义贷款，但不交割本金，只交割协议利率和参考利率的利差\n-   目的：规避未来利率风险或利用未来利率波动进行投机\n-   如果合约中约定的固定利率大于对应于同一时段的LIBOR利率，借入方要支付借出方固定利率和LIBOR利率的差乘以面值。\n-   如果合约中约定的固定利率小于对应于同一时段的LIBOR利率，借出方要支付借入方固定利率和LIBOR利率的差乘以面值。\n\n定义\n\nFRA 6×9意味着6个月对9个月，即从交易日$T_0$起6个月末T_1为起息日，而交易日后的9个月末为到期日$T_2$，协议利率的期限为3个月期。 在$T_0$时刻X同意在$T_1$和$T_2$之间将资金借给公司Y。则递延期限：$T_1-T_0$，协议期限：$T_2-T_1$.\n\n交割额是$T_1$时刻双方资金的转移。\n\n$R_K$：FRA中的约定利率\n\n$R_F$：由今天$T_0$时刻计算的介于时间$T_1$和$T_2$之间的LIBOR利率\n\n$R_M$：在时间$T_1$观察到的$T_1$和$T_2$之间的真正LIBOR利率\n\n$L$：合约的本金\n\n交割额的计算：\n\n-   取基准日的参考利率与协议利率之差，乘以协议金额，乘以协议期限，得到名义贷款的利息差\n-   以\u003cu\u003e参考利率\u003c/u\u003e作为贴现率，对上一步计算得到的利息差进行贴现，计算出利息差在交割日的现值，即交割额\n\n则对X，$T_1$时刻的收益为： $$ \\frac{L(R_K-R_M)(T_2-T_1)}{1+R_M(T_2-T_1)} $$ 对Y，$T_1$时刻的收益为： $$ \\frac{L(R_M-R_K)(T_2-T_1)}{1+R_M(T_2-T_1)} $$\n\n\u003e 注意：名义贷款在期初交割而不是期末，所以要贴现回来。交割额的贴现不采用连续复利的假设。贴现的利率是参考利率：例如当天的LIBOR，而不是无风险利率\n\n### 定价\n\nFRA的定价是今天$T_0$时刻FRA的价值。\n\n今天我们不知道$T_1$时真正的LIBOR利率会是多少，但我们可以用远期利率公式计算出$R_F$：由今天$T_0$时刻计算的介于时间$T_1$和$T_2$之间的LIBOR利率。\n\n定价过程：\n\n-   用远期利率代替实际利率计算收益\n-   将收益用\u003cu\u003e无风险利率\u003c/u\u003e贴现\n\n$$ V_{FRA}=L(R_F-R_K)(T_2-T_1)e^{-r_{f,T_2}T_2} $$\n\n## 短期利率期货\n\n### 欧洲美元期货\n\n-   以债务工具为标的，管理利率风险\n-   以芝加哥商品交易所(CME)交易的欧洲美元期货为例介绍短期利率期货，标的资产是在将来某三个月里按欧洲美元利率借款100万美元上所付的利息\n-   （多头）买入一份期货合约相当于承诺在未来以约定的利率水平存入100万美元（贷款）\n    -   如果担心利率下降导致在三个月内存款所获得的利息减少，应该进入多头，因为利率下降意味着报价上升\n-   （空头）卖出一份合约则相当于在未来以约定的利率水平借入100万美元（借款）\n    -   如果担心利率上升导致在三个月内贷款需要付出的利率增加，应该进入空头，因为利率上升意味着报价下降\n-   对一个持有欧洲美元期货的人来说，**利率下降时对多头有利，利率上升时对空头有利**\n-   欧洲美元期货相当于试图将未来某3个月的利率提前锁定在某个值\n-   但对冲不总是完美的，因为期货的结算在合约到期日，而利率支付在3个月之后\n\n### 欧洲美元期货的报价\n\n-   在合约的最后一个结算日之前，按通常的方式每天以市值定价，100-$R$\n-   其中，$R$为3个月每季度复利的欧洲美元利率\n-   无论3个月的实际天数是多少，名义存款的期限都规定为1/4年。\n-   标的利率变动0.01%=期货报价变动1个基点=25美元的收益或亏损\n\n### 远期利率和期货利率\n\n-   欧洲美元期货和FRA都能暂时锁定一段时间的利率，因为每日结算和到期日结算的不同，导致期货利率和远期利率有所不同\n-   从每天结算变为只在期末结算会降低事先约定的未来某一段时间的利率\n-   远期利率=期货利率-$\\frac{1}{2}\\sigma^2T_1T_2$\n-   $T_1$是期货的期限，$T_2$是期货的到期时间，$\\sigma^2$是短期利率一年的标准差\n\n## 中长期国债期货\n\n### 美国国债期货\n\n-   从交割月份的第1天算起，任何期限介于15年与25年之间的债券均可以用于交割。\n-   将整个投资收益人为分为利息收入和资本利得\n    -   便于税收管理\n    -   便于财务核算\n\n### 报价\n\n-   超级国债和长期国债期货合约均是以美元和美元的1/32为单位报出的。\n\n### 困难\n\n-   空头没有办法买入某种特定的现货交割\n-   解决办法：指定一种虚拟国债：10年期美国国债期货\n\n### 转换因子\n\n-   每交割100美元面值的债券所收入的现金价格为\u003cu\u003e（最新的期货报价×转换因子）+累计利息\u003c/u\u003e（发票价）\n-   在假定所有期限的利率均为每年6%（按半年复利）的前提下，转换因子等于\u003cu\u003e按交割月份第1天的债券报价所对应1美元面值的债券价格。\u003c/u\u003e\n-   对于息票利率大于6%的可交割国债来说，在其他条件相同的情况下，期限越长，转换因子越大；反之亦然。\n\n\u003e 20年的债券，coupon rate为10%，半年付息。转换因子： $$ CF=\\sum_{i=1}^{40}\\frac{100\\times5\\%}{(1+0.03)^i}+\\frac{100}{(1+0.03)^{40}} $$\n\n### 最便宜可交割债券\n\n-   设计转换因子体系的目的是减少采用不同期限、不同息票利率的可交割国债进行交割的差异，降低交割品种选择权的价值\n    -   由于债券价值与收益率、期限的关系是非线性的，而转换因子体系是线性的，所以转换因子体系不能完全消除交割品种选择权的价值\n    -   考虑到期货运作机制的要求，交易所规定把交割国债品种的选择权赋予卖方\n-   空头方收到的现金量为：\u003cu\u003e（期货的最新报价×转换因子）+累计利息\u003c/u\u003e\n-   买入债券费用为：\u003cu\u003e债券报价+累计利息\u003c/u\u003e\n-   最便宜交割债券是使得：\u003cu\u003e债券报价-（期货的最新报价×转换因子）\u003c/u\u003e达到最小的债券。\n-   空头提供债券，多头提供钱。\n-   在市场上有一些因素决定了最便宜可交割债券。\n    -   当市场收益率大于6%时，转换因子系统倾向于息票率较\u003cu\u003e低\u003c/u\u003e同时期限较\u003cu\u003e长\u003c/u\u003e的债券。\n    -   当市场收益率小于6%时，系统倾向于息票率较\u003cu\u003e高\u003c/u\u003e同时期限较\u003cu\u003e短\u003c/u\u003e的债券。\n    -   当收益率曲线为上坡形时，系统倾向于交割期限较\u003cu\u003e长\u003c/u\u003e的债券。\n    -   当收益率曲线为下坡形时，系统倾向于交割期限较\u003cu\u003e短\u003c/u\u003e的债券。\n\n### 确定期货价格\n\n如果假定已知最便宜可交割债券及交割日期，长期国债期货等价于一个为持有人提供中间收入的证券上期货合约。 $$ F_0=(S_0-I)e^{rT} $$ $I$为期货期限内券息的贴现值，$S_0$要加上累计利息；计算出的$F_0$要减去从计算到交割这段时间的累积利息，然后要根据转换因子折回报价。\n\n\u003e 假定对于某一国债期货已知最便宜可交割的债券的息票利率为12%，转换因子为1.6。假定期货交割日期为270天以后。券息的支付为每半年一次。上一次券息支付为60天以前，下一次券息支付为122天以后，再下一次券息支付为305天以后。利率期限结构为水平，利率为年率10%（连续复利）。假定债券的当前报价为115美元。债券的现金价格等于报价加上从上一次付息至今的累计利息。债券现金价格为： $$ 115+\\frac{60}{60+122} \\times 6=116.978 $$ 在122天（0.3342年）后，债券持有者将收到6美元的利息。该利息的贴现值为： $$ 6e^{-0.1×0.3342}=5.803 $$ 期货合约将持续270天（0.7397年）。如果期货合约是关于券息率为12%的债券，期货的现金价格为： $$ （116.978-5.803)e^{0.1\\times 0.7397}=119.711 $$ 在债券交割时，会产生148天的累计利息。如果期货合约是有关于券息率为12%的债券，期货的报价为： $$ 119.711-6 \\times \\frac{148}{148+35}=114.859 $$ 由转换因子定义得出，1.60倍的标准债券等价于一个12%的债券。因此，期货的报价应为： $$ \\frac{114.859}{1.60}=71.79 $$\n\n## 久期套期保值\n\n### 对于资产及负债组合的对冲\n\n-   久期匹配不能使得证券组合免疫于收益率曲线的非平行移动（即其价格不受平行移动的影响），这是该对冲策略的不足之处。\n-   在实践中，短期利率的变化幅度较大，并且与长期利率没有完美的相关性，有时甚至短期利率及长期利率会朝两个相反的方向变动。\n\n### 采用期货来实现基于久期的对冲\n\n$V_F$：利率期货合约的价格\n\n$D_F$：期货标的资产在期货到期日的久期值\n\n$P$：被对冲的债券组合在对冲到期日的远期价格\n\n$D_F$：被对冲的证券组合在对冲到期日的久期 $$ N^*=\\frac{PD_P}{V_FD_F} $$\n\n-   当采用国债期货来进行对冲时，对于交割某个特定的债券，对冲者一定以$D_F$为假设前提。$D_F$h和最便宜交割债券的久期相等。这意味着对冲者在实施对冲时，必须估计哪一个债券可能是最便宜可交割债券。如果利率环境发生了变化，以至于其他债券变为了最便宜可交割债券，对冲者必须将对冲头寸进行调节，因此对冲效果也许比预期的要差。\n-   利用利率期货来进行对冲时，对冲者应注意利率与期货价格呈相反方向变动。当利率上升时，利率期货价格下降；当利率下降时，利率期货价格上升。因此，在利率下降时会承受损失的公司应进入期货的多头头寸。类似地，在利率上升时会承受损失的公司应进入期货的空头头寸。\n\n---\n\n## 常见问题\n\n### 给出两支不同期限和票息的债券，计算某一时期的spot rate\n\n### 给出两支债券，在无套利的情况下为第三支定价\n\n分别待定系数，列二元一次方程，使得每一期的现金流都相等\n\n### 计算某个债券的dirty price和clean price\n\ndirty price: 其实就是现金流折现时下面用的系数不再是$(1+r)^t$，而是$(1+r)^{t-d}$，$d$意味着过去了多久。\n\nclean price\n\n=dirty price-accured interest\n\n=dirty price-coupon×days since last payment date/days between coupon payments\n\n### 远期利率的计算\n\n### 计算某方在FRA中的收入\n\n注意折现时使用的是由今天计算的远期LIBOR利率而不是约定的利率\n\n### FRA的定价和计算\n\n先由zero curve计算market implied forward rate，再用面值乘以利率差乘以时间长度，再用结束时的无风险利率贴现\n\n### 寻找某个债券是CTD\n\n计算cost=债券报价-期货settlement×CF，最小的那个\n\n### 投资人担心利率未来上涨，应该进入期货的多头还是空头\n\n担心利率上涨，进入空头，因为利率上涨时对空头有利\n\n### 根据曲率调整公式计算远期利率和期货利率之间的关系\n\n注意要把从欧洲美元期货报价中看到的利率转换成连续复利\n\n具体而言，欧洲美元期货报价是94，意味着3个月复利的年化利率是6%（实际天数/360），每90天的利率是1.5%\n\n按照连续复利，有$e^{r\\times 90/365}=1+1.5\\%,r=6.038\\%$.\n\n然后再用公式减去0.5×标准差的平方×期限×（期限+0.25）\n\n---\n\n首先针对每种金融产品相关的数字，应该想明白**哪些是交易出来的，哪些是合约中人为设定的**。所谓交易出来，就是这个数字是（理论上）由市场的供需决定的，而不是人为决定的。然后，捋清事物发展的脉络。\n\n由相对价值的想法，我们从市场上已有的债券价格入手，通过票息剥离法画出了zero curve；然后用曲线来（试图）计算其他产品的价格。这条曲线说明市场上所有的交易者对利率水平有一个自己的预期，而这些预期通过债券（和其他产品）的价格反映出来。\n\n当我们得到zero curve之后，很容易想到如何衡量交易者对市场未来利率的预期，因此我们定义了远期利率。\n\n如果投资者自己的认知和市场上反映出来的认知不同，那么他就有很多获利的机会。比如通过远期利率合约，交易者可以锁定自己未来一段时间的利率。\n\n短期利率期货如欧洲美元期货也可以锁定未来的某三个月存款利率，甚至可以到未来十年以后的三个月。远期利率合约中的约定利率$R_K$和欧洲美元期货的报价，都相当于在一定程度上反映着不同投资者对未来的预期。\n\n由于我们被要求学会很多计算（理论）定价的方法，这很容易让人以为债券或者其他衍生品的价格都是严格算出来的。倒不如说是市场上的交易者通过买卖各种证券的方式，将自己的看法price in至金融产品中。\n\n最后但最重要的是，思考每种金融产品的出现可能的原因和解决的问题，并且在解决问题的同时，又生发出哪些值得注意的问题。这或许能更好记忆每个条件存在的意义。",title:"Untitled Page"},"/Published/数据结构与算法":{content:"---\nArea: Coding\nSource: Book\nStatus: Done\nType: Notes\n---\n\n## 绪论\n### 问题和算法\n- 算法（Algorithm）是问题求解过程的精确描述，具有如下性质：\n    - 有穷性（描述的有穷性）：由有限条“指令”或“语句”构成\n    - 能行性：指令（语句）含义简单明确，其过程可以完全机械地进行\n    - 确定性：作用于所求解问题的给定输入（要处理的问题实例的某种描述），将产生出唯一的确定的动作序列\n    - 终止性（行为的有穷性）：产生的动作序列有穷，它或终止并给出问题的解；或终止并指出对给定的输入本问题无解\n    - 输入/输出：有确定的输入和输出\n### 大O表示法\n- 定义：如果存在两个正常数c和n0，当实例的规模n≥n0后，某算法的时间（或者空间）代价T(n)≤c·f(n)（或S(n)≤c·f(n)），则说该算法的时间代价（或者空间代价）为O(f(n)) \n    - 朴素的解释：当实例的规模n充分大时，该算法所需时间（空间）不大于f(n)的某个常数倍\n    - 也说该算法的时间（或空间）代价的增长率为f(n)\n### 数据结构\n- 一种数据结构是采用一套特定方式建立起来的一种数据组织结构\n- 特征：\n    - 逻辑结构：数据元素之间有某种特定的逻辑关系\n        - 集合结构、线性结构、树形结构、图结构\n    - 物理结构：数据的逻辑结构在计算机存储器中的映射（或表示），又称存储结构，或数据结构的存储表示\n    - 行为特征：作用于数据结构上的各种运算。例如检索元素、插入元素、删除元素等一般性操作，还可能有一些特殊操作\n\n## 抽象数据类型和Python类\n\n## 数据结构的公共操作\n- 作用上看：\n    - 构造：构造出一个新实例\n    - 访问：从已有数据结构中提取某些信息，但不创建新结构，也不修改被操作的结构\n    - 变动：修改已有的结构\n- 支持操作类型：\n    - 不变\n    - 变动\n\n\n## 线性表\n- 一种元素集合，其中还记录着元素间的一种顺序关系。\n- 实现模型：顺序表和链接表\n### 顺序表\n- 元素顺序存放在一片足够大的连续存储区内，表中首元素存入存储区的开始位置，其余元素依次顺序存放\n- 地址计算公式：$Location(e_i)=Location(e_0)+ci$，其中c是一个元素的存储量\n#### 操作\n- 访问第i个元素：O(1)\n- 表空、表满：O(1)\n- 查找给定元素的位置：通过循环，和表内元素逐个比较\n- 尾端加入、删除：O(1)\n- 首端（定位）加入：不要求保序：O(1)；要求保序：O(n)\n- 加入操作平均移动次数：$\\sum_{i=0}^{n}(n-i) p_{i}$\n- 删除操作平均移动次数：$\\sum_{i=0}^{n-1}(n-i-1)p_i^{\\prime}$\n#### 优缺点\n- 优点：\n    - O(1) 时间（随机，直接）按位置存取元素\n    - 元素存储紧凑，除表元素存储外只需 O(1)空间存放辅助信息\n- 缺点：\n    - 需要连续的大块存储区存放表中的元素，可能有大量空闲单元\n    - 加入删除操作时通常要移动许多元素\n    - 需要考虑元素存储区的大小（有时事先很难估计）\n#### 顺序表的实现\n- 一体式实现\n- 分离式实现\n    - 优点：可以根据需要换一块元素存储，扩大容量\n    - 表满时：\n        - 申请一块更大的元素存储区\n        - 把表中已有的元素拷贝到新存储区\n        - 改变表对象的元素区链接\n        - 实际加入新元素\n    - 常量增长策略：O(n^2)\n    - 比例增长策略：O(n)\n#### Python中list的实现\n- append:O(1)\n- len:O(1)\n- 不是尾端加入、切片替换、切片删除、表拼接：O(n)\n### 链接表\n#### 优点与缺点\n- 优点：\n    - 表结构是通过一些链接起来的结点形成的，结构很容易调整修改\n    - 不修改结点里的数据元素，只通过修改链接，就能灵活地修改表的结构和内容。如加入/删除一个或多个元素，翻转整个表，重排元素的顺序，将一个表分解为两个或多个等\n    - 整个表由一些小存储块构成，较容易安排和管理\n- 缺点：\n    - 一些操作的开销大：基于位置找到表中元素需要线性时间\n    - 尾端操作需要线性时间（增加尾指针可以将尾端加入元素变为常量操作，但仍不能有效实现尾端删除）\n    - 找当前元素的前一元素需要从头扫描表元素（双链表可以解决这个问题，但每个结点要付出更多存储代价），应尽量避免\n#### 结点类及操作\n\n\n```python\nclass LNode:\n    def __init__(self,elem,next_=None):\n        self.elem=elem\n        self.next=next_\n\npnode=LNode(1)\nfor i in range(2,11):\n    pnode.next=LNode(i)\n    pnode=pnode.next\n    print(pnode.elem)\n```\n\n    2\n    3\n    4\n    5\n    6\n    7\n    8\n    9\n    10\n\n\n#### 单链表基本操作\n- 创建空链表：把表头变量设置为空链接（Python中设置为None）\n- 删除：Python里将表指针设置为None\n- 判断表是否为空：表头变量的值和空链接比较\n- 链接表不会满\n- 复杂性：\n    - 基本操作：\n        - 创建空表：O(1)\n        - 删除表：在 Python 里是 O(1)。当然存储管理也需要时间\n        - 判断空表：O(1)\n    - 加入元素（都需要加一个 T(分配) 的时间）：\n        - 首端加入元素：O(1)\n        - 尾端加入元素：O(n)，因为需要找到表的最后结点\n        - 定位加入元素：O(n)，平均情况和最坏情况\n    - 删除元素：\n        - 首端删除元素：O(1)；尾端删除：O(n)\n        - 定位删除元素：O(n)，平均情况和最坏情况\n        - 其它删除通常需要扫描整个表或其一部分，O(n)\n    - 其他：\n        - 求长度、遍历：O(n)\n\n\n```python\nclass LinkedListUnderflow(ValueError):\n    pass\nclass LList:\n    def __init__(self):\n        self._head=None\n    def is_empty(self):\n        return self._head is None\n    def prepend(self,elem):\n        self._head=LNode(elem,self._head)#LNode要标明链接\n    def append(self,elem):\n        if self._head is None:\n            self._head=LNode(elem)\n        p=self._head\n        while p.next is not None:\n            p=p.next\n        p.next=LNode(elem)#这一行不能放在while循环里\n    def popfirst(self):\n        if self._head is None:\n            raise LinkedListUnderflow('in popfirst')\n        else:\n            e=self._head.elem\n            self._head=self._head.next\n            return e\n    def poplast(self):\n        if self._head is None:\n            raise LinkedListUnderflow('in poplast')\n        else:\n            p=self._head\n            if self._head.next is None:#表中只有一个元素\n                e=self._head.elem\n                self._head=None\n                return e\n            while p.next.next is not None:#找到了倒数第二个\n                p=p.next\n            e=p.next.elem\n            p.next=None\n            return e\n    def printall(self):\n        p=self._head\n        while p is not None:#这里不能写成while p.next !=None，否则就不会输出最后一个结点\n            print(p.elem)\n            p=p.next\ntest=LList()\ntest.is_empty()\ntest.prepend(1)\ntest.append(10)\ntest.append(20)\ntest.popfirst()\ntest.poplast()\ntest.printall()\n```\n\n    10\n\n\n#### 链接表的变形\n##### 带尾节点引用的单链表\n- 头结点的next直接指向尾节点\n\n\n```python\nclass LList_tail(LList):\n    def __init__(self):\n        LList.__init__(self)\n        self.rear=None\n    def append(self,elem):\n        if self._head is None:\n            self._head=LNode(elem,self._head)\n            self.rear=self._head\n        else:\n            self.rear.next=LNode(elem)\n            self.rear=self.rear.next\ntest2=LList_tail()\ntest2.append(10)\ntest2.append(20)\ntest2.append(30)\ntest2.printall()\n```\n\n    10\n    20\n    30\n\n\n##### 循环单链表\n- 让表对象指向概念上的尾结点更有利\n\n\n```python\nclass LClist:\n    def __init__(self):\n        self._rear=None\n    def is_empty(self):\n        return self._rear is None\n    def prepend(self,elem):\n        p=LNode(elem)\n        if self._rear is None:\n            p.next=p\n            self._rear=p\n        else:\n            p.next=self._rear.next\n            self._rear.next=p\n    def append(self,elem):\n        p=LNode(elem)\n        if self._rear is None:\n            p.next=p\n            self._rear=p\n        else:\n            p.next=self._rear.next\n            self._rear.next=p\n            self._rear=self._rear.next\n    def pop(self):\n        if self._rear is None:\n            raise LinkedListUnderflow('in pop of CLList')\n        p=self._rear.next\n        if self._rear is p:\n            self._rear=None\n        else:\n            self._rear.next=p.next\n        return p.elem\n    def printall(self):\n        if self.is_empty():\n            return\n        else:\n            p=self._rear.next\n            while True:\n                print(p.elem)\n                if p is self._rear:\n                    break\n                p=p.next\nmlist=LClist()\nmlist.append(3)\nmlist.append(4)\nmlist.prepend(1)\nmlist.prepend(2)\nmlist.append(5)\nmlist.printall()\n```\n\n    2\n    1\n    3\n    4\n    5\n\n\n##### 双链表\n- 需要延伸结点类，增加指向前面的链接\n\n\n\n```python\nclass LDNode(LNode):\n    def __init__(self,elem,prev=None,next_=None):\n        LNode.__init__(self,elem,next_)\n        self.prev=prev\nclass LDList(LList_tail):\n    def __init__(self):\n        LList_tail.__init__(self)\n    def rev(self):\n        p=None\n        while self._head is not None:\n            q=self._head\n            self._head=q.next\n            q.next=p\n            p=q\n        self._head=p\nr=LDList()\nr.append(10)\nr.append(20)\nr.append(30)\nr.append(40)\nr.printall()\nr.rev()\nr.printall()\n```\n\n    10\n    20\n    30\n    40\n    40\n    30\n    20\n    10\n\n\n#### 总结\n- 单链表只有一个方向的链接，支持O(1)的前端插入和删除，定位操作或尾端操作都需要O(n)时间。\n- 增加了尾结点引用的单链表可很好支持首端/尾端插入和首端弹出，都是O(1)时间复杂度的操作，但不能支持高效的尾端删除\n- 循环单链表支持高效首端/尾端插入和首端弹出，扫描需注意结束判断\n- 双链表中结点有两个方向的链接，能高效找到前后结点。有尾结点引用时两端插入和删除都是O(1)时间操作。\n- 单链表的遍历和检索只能从表头开始，需O(n)时间。双链表的这些操作可从表头或表尾开始，复杂度不变。与它们对应的循环链表，遍历和检索可以从表中任何一个地方开始，但要注意结束条件\n\n#### 表的应用\n- 约瑟夫问题的顺序表算法和循环链表算法\n\n\n```python\nclass Josephus(LClist):\n    def turn(self,m):\n        for i in range(m):\n            self._rear=self._rear.next\n            #新方法，沿next方向移动m步\n    def __init__(self,n,k,m):\n        LClist.__init__(self)\n        for i in range(n):\n            self.append(i+1)\n        self.turn(k-1)\n        while not self.is_empty():\n            self.turn(m-1)\n            print(self.pop())\nJ=Josephus(10,3,2)\n```\n\n    4\n    6\n    8\n    10\n    2\n    5\n    9\n    3\n    1\n    7\n\n\n## 字符串\n### 概念\n- 字符串是特殊的线性表，表中元素选自选定字符集\n- 字符集是有穷的一组字符构成的集合\n- 称s1为s2的一个子串，如果存在两个串s和s'使下式成立:s2 = s + s1 + s'\n- 如果s1是s2的子串，也说s1在s2里出现，称s2里与s1相同的字符段的第一个字符的位置为：s1在s2里出现的位置\n### Python字符串\n- 一体式的连续形式\n### 字符串匹配\n- 模式串长小于目标串\n#### 朴素的串匹配算法\n- 时间复杂度：O(mn)\n- 效率低的原因：每次都看作完全独立的操作；回溯\n- 通配符(？，*)与正则表达式（顺序组合，选择组合|，星号）\n\n\n```python\ndef naivematch(pattern,target):\n    p=len(pattern)\n    t=len(target)\n    i=0#这里一定要先声明\n    j=0\n    while i\u003cp and j\u003ct:\n        if pattern[i]==target[j]:\n            i=i+1\n            j=j+1\n        else:\n            j=j-i+1\n            i=0\n    if i==p:#比较已经比较到了pattern的最后一位\n        return j-i#应该返回target串能匹配上的首下标，而不是最后一个刚刚比较完的下标\nnaivematch('abc','shdlabc')\n```\n\n\n\n\n    4\n\n\n\n## 栈\n- 可以看作只在一端插入和删除的表\n- LIFO\n- 采用顺序表方式实现，在后端插入删除都是O(1)操作\n- 采用链接表方式实现，在前端插入删除都是O(1)操作\n\n\n```python\nclass StackUnderflow(ValueError):\n    pass\nclass SStack:#顺序表实现\n    def __init__(self):\n        self._elems=[]\n    def is_empty(self):\n        return self._elems==[]\n    def top(self):\n        if self._elems==[]:\n            raise StackUnderflow('in top')\n        else:\n            return self._elems[-1]\n    def push(self,elem):\n        self._elems.append(elem)\n    def pop(self):\n        if self._elems==[]:\n            raise StackUnderflow('in pop')\n        else:\n            return self._elems.pop()\n        \nclass LStack:\n    def __init__(self):\n        self._top=None\n    def is_empty(self):\n        return self._top is None\n    def top(self):\n        if self._top is None:\n            raise StackUnderflow('in top')\n        else:\n            return self._top.elem\n    def push(self,elem):\n        self._top.next=LNode(elem)\n    def pop(self):\n        if self._top==None:\n            raise StackUnderflow('in pop')\n        else:\n            p=self._top\n            self._top=p.next\n            return p.elem\n\n```\n\n### 栈的应用\n#### 括号配对问题\n- 顺序检查字符串字符\n- 遇到开括号将其压入一个栈\n- 遇到闭括号弹出栈顶元素与其匹配\n\n\n```python\ndef paresmatch(text):\n    open_pares='([{'\n    close_pares=')]}'\n    pair={')':'(',']':'[','}':'{'}\n    st=SStack()\n    try:\n        for i in range(len(text)):\n            if text[i] in open_pares:\n                st.push(text[i])\n            elif text[i] in close_pares:\n                if st.pop()!=pair[text[i]]:\n                    print('Unmatch!')\n                    return False\n                else:\n                    print('Success!')\n                    return True\n    except:\n        print('Unmatch!')\n        return False\nprint(paresmatch('[abc]'))\nprint(paresmatch('([c)'))\n```\n\n    Success!\n    True\n    Unmatch!\n    False\n\n\n#### 表达式的表示、计算和变换\n##### 后缀表达式的计算\n- 不是运算符就压入栈\n- 是运算符就弹出最近的两个数\n- 计算之后再压入栈\n- 下面的程序没有考虑栈深和其他的错误\n\n\n```python\ndef cal(exp):\n    st=SStack()\n    oper='+-*/'\n    for i in range(len(exp)):\n        if not exp[i] in oper:\n            st.push(float(exp[i]))#这一步是必要的，否则就变成了字符串拼接\n        elif exp[i] in oper:\n            a=st.pop()\n            b=st.pop()\n            if exp[i] =='+':\n                c=a+b\n            elif exp[i]=='-':\n                c=a-b\n            elif exp[i]=='*':\n                c=a*b\n            elif exp[i]=='/':\n                c=a/b\n            st.push(c)\n    return st.pop()\ncal('12+4*')\n```\n\n\n\n\n    12.0\n\n\n\n##### 中缀表达式到后缀表达式的转换\n- 遇到运算对象应直接输出（因为运算符应该在它们的后面）\n- 需要考虑中缀运算符的优先级，适时输出 \n- 遇到运算符时不能直接输出，只有下一运算符的优先级不高于本运算符时，才应该做本运算符要求的计算\n### 栈与函数调用\n- 可以证明：任何递归定义的函数（程序），都可以通过引入一个栈保存中间结果，翻译为一个非递归的过程。与此对应，任何一个包含循环的程序都可翻译为一个不包含循环的递归程序。这两个翻译过程都可计算，可以写出完成这两种翻译的程序，把任何递归定义的函数翻译到完成同样工作的非递归的函数，或者把任何包含循环的程序翻译为不包含循环的递归程序\n\n\n```python\ndef knap(weight,wlist,n):\n    if weight==0:\n        return True\n    elif weight\u003c0 or (weight\u003e0 and n\u003c1):\n        return False\n    elif knap(weight-wlist[n-1],wlist,n-1):\n        print(n,wlist[n-1])\n        return True\n    elif knap(weight,wlist,n-1):\n        return True\n    else:\n        return False\nknap(10,[1,2,3,4,2],3)\n```\n\n\n\n\n    False\n\n\n\n## 队列\n- 可看作只在一端插入另一端访问和删除的表\n- FIFO\n### 队列的链接表实现\n- 只需用带尾结点的单链表\n### 队列的顺序表实现\n- 总会有入队/出队其中之一是O(n)\n- 记住队头，会导致前面有浪费的空余\n- 环形队列\n\n\n```python\nclass SQueue:\n    def __init__(self,init_len=8):\n        self._len=init_len\n        self._elems=[0]*init_len\n        self._head=0\n        self._num=0\n    def is_empty(self):\n        return self._num==0\n    def peek(self):\n        if self._num==0:\n            raise QueueUnderflow\n        return self._elems[self._head]\n    def dequeue(self):\n        if self._num==0:\n            raise QueueUnderflow\n        e=self._elems[self._head]\n        self._head=(self._head+1)%self._len\n        self._num=self._num-1\n        return e\n    def enqueue(self,elem):\n        if self._num==self._len:\n            self.__extend()\n        self._elems[(self._head+self._num)%self._len]=e\n        self._num=self._num+1\n    def __extend(self):\n        old_len=self._len\n        self._len=self._len*2\n        new_elems=[0]*self._len\n        for i in range(old_len):\n            new_elems[i]=self._elems[(self._head+i)%old_len]\n        self._elems=new_elems\n        self._head=0\n```\n\n\n\n## 二叉树与树\n### 概念\n- 有序树和无序树\n- 一个结点的子节点个数成为该结点的度数\n- 结点都有层数，根在0层，子结点的层数比其父结点大1\n- 二叉树：\n    - 结点的有限集合，集合或为空集，或由一个根节点和两棵不相交的二叉树组成\n    - 左子树和右子树\n    - 是与树不同的结构，不是特殊情况\n    - 满二叉树：树中每个分支结点都有两棵非空子树\n    - 完全二叉树：除最下两层外，其余结点度数都是2（显然都不是叶结点），如果最下一层的结点不满，则所有空位都在在右边，左边没有空位\n    - 扩充二叉树（由已有非空二叉树生成的一种二叉树）：原二叉树的最小结点扩充，使原树中所有结点的度数都变成2，扩充结点的个数比原树结点的个数多1\n### 性质\n- 二叉树性质：\n    - 性质1 非空二叉树第$i$层上至多有$ 2i $个结点\n    - 性质2 高度为$ k $的二叉树至多有$ 2k-1 $个结点\n    - 性质3 对任何非空二叉树，若其叶结点个数为$n_0$，度数为2的结点个数为$n_2$，则$n_0 = n_2 + 1$\n    - 性质4 $n$个结点的完全二叉树的高度$k = \\lceil log_2(n+1)\\rceil$\n    - 性质5 满二叉树里的叶结点比分支结点多一个\n    - 性质6 （完全二叉树）如果$ n $个结点的完全二叉树的结点按层次并从左到右的顺序从 0 开始编号，对任一结点$ i（0 ≤ i ≤ n-1) $都有：\n        - 序号 0 的结点是根\n        - 对于$ i \u003e 0$，其父结点是$\\lfloor (i - 1)/2\\rfloor$\n        - 若 $2i + 1 ≤ n$，其左子结点序号为$2  i + 1$；否则它无左子结点\n        - 若 $2  i + 2 ≤ n$，其右子结点序号为$2  i + 2$；否则它无右子结点\n\n### 二叉树的类实现\n- 如果知道一棵二叉树的中根序列，又知道先根/后根序列，就可以唯一确定这个二叉树\n- 先根序遍历的平均空间复杂性是O(logn),关键是栈中最大深度（遍历的二叉树高度）。\n- 时间复杂性是O(n)\n\n\n### 优先队列\n- 特点是存入优先队列的每项数据都有一个优先级，保证任何时候访问或弹出的总是当时所存元素中最优先的\n- 顺序表实现，总会在插入和取出元素的时候有一种是O(n)的复杂度\n#### 堆\n- 一个堆在结构上是一棵在结点里存储数据的完全二叉树\n- 去掉一个堆的最后元素，剩下的仍是堆\n- 一个堆去掉堆顶，其余元素形成两个堆\n- 给按上面方式得到的两个堆加一个元素作为根，得到一棵完全二叉树但未必是堆\n- 在一个堆的最后加上一个元素，整个结构是一棵完全二叉树，但未必是堆\n- 操作：加入一个元素，把加入后得到的完全二叉树转变为堆/弹出最小元素后，如何将剩下的元素重新做成堆：复杂度：O(n)\n##### 实现\n- 向上筛选：新加入的结点与其父结点比较，如果新加入的较小就交换\n- 向下筛选：用e与B、C的顶元素（根）比，最小者作为整个堆的顶。\n\n\n\n```python\nclass PrioQueue:\n    def __init__(self,elist=[]):\n        self.elems=list(elist)\n        if elist!=[]:\n            self.buildheap()\n    def is_empty(self):\n        return self.elem==[]\n    def peek(self):\n        if self.is_empty():\n            raise PrioQueueError('in top')\n        return self.elems[0]\n    def enqueue(self,e):\n        self.elems.append(None)\n        self.siftup(e,len(self.elems)-1)\n    def siftup(self,e,last):\n        elems=self.elems\n        i=last\n        j=(last-1)//2\n        while i\u003e0 and e\u003celems[j]:\n            elems[i]=elems[j]\n            i=j\n            j=(j-1)//2\n        elems[i]=e\n    def dequeue(self):\n        if self.is_empty():\n            raise PrioQueueError('in pop')\n        elems=self.elems\n        e0=elems[0]\n        e=elems.pop()\n        if len(elems)\u003e0:\n            self.siftdown(e,0,len(elems))\n        return e0\n    def siftdown(self,e,begin,end):\n        elems=self.elems\n        i=begin\n        j=begin*2+1\n        while j\u003cend:\n            if j+1\u003cend and elems[j+1]\u003celems[j]:\n                j=j+1\n            if e\u003celems[j]:\n                break\n            elems[i]=elems[j]\n            i=j\n            j=2*j+1\n        elems[i]=e\n    def buildheap(self):\n        end=len(self.elems)\n        for i in range(end//2,-1,-1):\n            self.siftdown(self.elems[i],i,end)#?\n```\n\n##### 堆排序\n- 时间复杂性是O(nlogn)，空间是O(1)\n\n\n\n```python\ndef heap_sort(elems):\n    end=len(elems)\n    for i in range(end//2,-1,-1):\n        siftdown(elems,elems[i],i,end)\n    for i in range((end-1),0,-1):\n        e=elems[i]\n        elems[i]=elems[0]\n        PrioQueue.siftdown(elems,e,0,i)#?\n```\n\n### 哈夫曼树\n- 重复以下步骤，直到只剩一棵树为止：\n    - 从F选取两棵权最小的树作为左右子树，构造一棵新二叉树，设置其根节点权值为两棵子树的根结点的权值之和\n    - 从F删除所选的两棵树，把新构造的二叉树加入F\n#### 哈夫曼编码\n- 构造一棵哈夫曼树，在得到的哈夫曼树中，给所有从一个结点到其左子结点的边标上二进制数字0；引向其右子结点的边标上1\n- 以从根结点到一个叶结点的路径上的二进制数字序列，作为这个叶结点的字符的编码。这就是哈夫曼编码\n\n### 树与树林\n- 从树、树林转换为二叉树的步骤： \n    - 对于相邻的兄弟结点，从左到右，从前一子结点和后一子结点连一条边（对树林，相邻树的根之间也同样连一条边）\n    - 对每个非叶结点，只保留从它到其最左子结点的边，删去它到它的其它子女的边\n- 从二叉树转换到树林：\n    - 如果某结点是其父结点的左子树，则将其向右的路径上的各个结点作为其父结点的顺序的各个子结点\n    - 去掉原二叉树中各结点到其右子结点的连线\n#### 表示\n- 子结点引用表示\n- 父结点引用表示\n- 子表表示\n\n## 图\n- 一个图是一个二元组G=(V,E)\n- 有向图用尖括号表示，无向图用圆括号表示\n- 两个限制：不考虑顶点到自身的边、顶点间没有重复出现的边\n- 完全图：任意两顶点间都有边的图\n- 度：与一个顶点邻接的边的条数。\n$$\ne=\\frac{1}{2}\\sum_{i=1}^n D(v_i)\n$$\n- 回路：起点和终点相同的路径。如果除起点和终点以外其他顶点均不相同，称为简单回路\n- 简单路径：内部不包含回路的路径\n- 有根图：如果在有向图G里存在一个顶点v，从v到图G中其他每个顶点均有路径，则称G为一个有根图。\n    - 包含n个顶点的最小有根图恰好包含n-1条边\n- 连通图：\n    - 无向图：G中任意两个不同顶点之间都连通。包含n个顶点的最小连通无向图恰有n-1条边\n    - 有向图：注意路径有方向\n- 带权的连通无向图称为网络\n### 表示方法\n#### 邻接矩阵表示法\n- 无向图的邻接矩阵表示是一个对称矩阵\n- 缺点：空间复杂性和结点数的平方成正比\n#### 邻接表表示法\n- 每个顶点的邻接边用一个（不一定等长的）list 表示，元素形式 为(vj,w)，vj是边的终点，w是边的信息（权或者1）\n\n\n```python\nclass Graph:\n    def __init__(self,mat,unconn=0):\n        vnum=len(mat)\n        for x in mat:\n            if len(x)!=vnum:\n                raise ValueError('Argument for Graph')\n        #self._mat=[mat[i][:] for i in range(vnum)]\n        self._unconn=unconn\n        self._vnum=vnum\n        self._mat=[]\n        for i in range(vnum):\n            edges=[]\n            for j in range(len(mat[i])):\n                if mat[i][j]!=unconn:\n                    edges.append((j,mat[i][j]))\n            self._mat.append(edges)\n            \n    def _invalid(self,v):\n        return 0\u003ev or v\u003e=self._vnum\n    def vertex_num(self):\n        return self._vnum\n    def add_vertex(self):\n        self._mat.append([])\n        self._vnum=self._vnum+1\n        return self._vnum-1\n    def add_edge(self,vi,vj,val=1):\n        if self._vnum==0:\n            raise GraphError('Cannot add edge to empty graph')\n        if self._invalid(vi) or self._invalid(vj):\n            raise GraphError(str(vi)+'or'+str(vj)+'is not valid vertex')\n        row=self._mat[vi]\n        i=0\n        while i\u003clen(row):\n            if row[i][0]==vj:\n                self._mat[vi][i]=(vj,val)\n                return\n            if row[i][0]\u003evj:\n                break\n            i=i+1\n        self._mat[vi].insert(i,(vj,val))\n    def get_edge(self,vi,vj):\n        if self._invalid(vi) or self._invalid(vj):\n            raise GraphError(str(vi)+'or'+str(vj)+'is not a valid vertex')\n        for i, val in self._mat[vi]:\n            if i==vj:\n                return val\n        return self._unconn\n    def out_edges(self,vi):\n        if self._invalid(vi):\n            raise GraphError(str(vi)+'is not a valid vertex')\n        return self._mat[vi]\nG=Graph([[0,1,1,0],[1,0,0,1],[1,0,0,0],[0,1,0,0]])\nprint(G.vertex_num())\nprint(G._mat)\nprint(G.get_edge(1,1))\nprint(G.out_edges(2))                  \n```\n\n    4\n    [[(1, 1), (2, 1)], [(0, 1), (3, 1)], [(0, 1)], [(1, 1)]]\n    0\n    [(0, 1)]\n\n\n### 基本图算法\n#### 遍历\n##### 深度优先遍历\n- 从指定顶点v出发，先访问v（并将其标记为已访问）\n- 从v的未访问过的邻接顶点出发进行深度优先搜索（邻接顶点可能排定一种顺序），直到与v连通的所有顶点都已访问（递归）\n- 如果图中还存在未访问顶点，则选出一个未访问顶点，由它出发重复前述过程，直到图中所有顶点都已访问为止\n###### 非递归算法\n\n\n```python\ndef DFS(graph,v0):\n    vnum=graph.vertex_num()\n    visited=[0]*vnum\n    seq=[v0]\n    visited[0]=1\n    st=SStack()\n    st.push((0,graph.out_edges(v0)))\n    while not st.is_empty():\n        i,edges=st.pop()\n        if i\u003clen(edges):\n            v,e=edges[i]\n            st.push((i+1,edges))\n            if not visited[v]:\n                seq.append(v)\n                visited[v]=1\n                st.push((0,graph.out_edges(v)))\n    return seq\nDFS(G,0)\n#Q\n```\n\n\n\n\n    [0, 1, 3, 2]\n\n\n\n###### 生成树概念\n- 从连通无向图或强连通有向图G的任一顶点v0出发，或从有根有向图的根v0出发，存在到图中其它各结点的路径\n###### 递归算法\n\n\n```python\ndef DFS_span_tree(graph):\n    vnum=graph.vertex_num()\n    span_forest=[None]*vnum\n    def dfs(graph,v):\n        for u,w in graph.out_edges(v):\n            if span_forest[u] is None:\n                span_forest[u]=(u,w)\n                dfs(graph,u)\n    for v in range(vnum):\n        if span_forest[v] is None:\n            span_forest[v]=(v,0)\n            dfs(graph,v)\n    return span_forest\nDFS_span_tree(G)#?\n```\n\n\n\n\n    [(0, 0), (1, 1), (2, 1), (3, 1)]\n\n\n\n##### 广度优先遍历\n- 从指定顶点v出发，先访问v并将其标记为已访问\n- 依次访问v的所有相邻顶点v1,v2,……,vm（可规定顺序），再依次访问与v1,v2,……,vm邻接的所有未访问顶点，直到访问完所有顶点\n- 如果图中还存在未访问顶点，则选择一个未访问顶点，由它出发进行广度优先搜索，直到所有顶点都已访问为止\n\n### 最小生成树\n- 网络 G（带权连通无向图）的每条边带有一个给定的权值，它的一棵生成树中各条边的权值之和称为该生成树的权\n- 网络 G 可能有多棵不同生成树，其权值可能不同。其中权值最小的生成树称为 G 的最小生成树\n#### MST性质\n- 设G=(V，E)是网络，U是V的任一真子集，e=(u,v)∈E且u∈U，v∈V-U，而且e在G中所有一个端点在U另一端点在V-U的边中权值最小，那么：G必有一棵包括边e的最小生成树\n- 证明：取G的一棵最小生成树T（必定存在），若e属于T得证。否则将e加入T得到T'，由于T连通T'中必定有环。设环中另一条一端在 U另一端在V-U的边为e'。去掉e'得到另一生成树。由于e的定义，新生成树的权不大于T，即为所需。\n#### Kruskal算法\n- 按权排序\n- 逐步加入最小权的边，观察是否能减少连通分量\n\n\n```python\ndef Kruskal(graph):\n    vnum=graph.vertex_num()\n    reps=[i for i in range(vnum)]\n    mst=[]\n    edges=[]\n    for vi in range(vnum):\n        for v,w in graph.out_edges(vi):\n            edges.append((w,(vi,v)))\n    edges.sort()\n    for w,e in edges:\n        if reps[e[0]]!=reps[e[1]]:\n            mst.append((e,w))\n            if len(mst)==vnum-1:\n                break\n            rep,orep=reps[e[0]],reps[e[1]]\n            for i in range(vnum):\n                if reps[i]==orep:\n                    reps[i]=rep\n    return mst\nKruskal(G)#？\n```\n\n\n\n\n    [((0, 1), 1), ((0, 2), 1), ((1, 3), 1)]\n\n\n\n#### Prim算法\n- 初始把(0，0，0)放入优先队列，表示从顶点0到自身的长0的边\n- 循环的第一次迭代把顶点0记入最小生成树顶点集U，方法是设 mst[0]=((0，0)，0)，同时把顶点0到其余顶点的边用权值作为优先数存入优先队列cands，表示待考察的候选边集合\n- 执行中反复选择cands里记录的最短边(u,v)。如果v是V-U的顶点（该边连接U中顶点与V-U中顶点），就把该边及其权记入mst[v]，并把顶点v的出边存入cands；否则直接丢掉\n- 结束时mst中是最小生成树的n条边，包括边(0,0)以方便实现\n\n\n```python\ndef Prim(graph):\n    vnum=graph.vertex_num()\n    mst=[None]*vnum\n    cands=PrioQueue([(0,0,0)])\n    count=0\n    while count\u003cvnum and not cands.is_empty():\n        w,u,v=cands.dequeue()\n        if mst[v]:\n            continue\n        mst[v]=((u,v),w)\n        count=count+1\n        for vi,w in graph.out_edges(v):\n            if not mst[vi]:\n                cands.enqueue((w,v,vi))\n    return mst\n```\n\n### 最短路径\n#### Dijkstra算法\n\n\n\n```python\ndef dijkstra(graph,v0):\n    vnum=graph.vertex_num()\n    assert 0\u003c=v0\u003cvnum\n    paths=[None]*vnum\n    count=0\n    cands=PrioQueue([(0,v0,v0)])\n    while count\u003cvnum and not cands.is_empty():\n        plen,u,vmin=cands.dequeue()\n        if paths[vmin]:\n            continue\n        paths[vmin]=(u,plen)\n        for v,w in graph.out_edges(vmin):\n            if not paths[v]:\n                cands.enqueue((plen+w,vmin,v))\n        count=count+1\n    return paths\n```\n\n## 字典\n- 静态字典和动态字典\n- 平均检索长度ASL：\n$$\nASL=\\sum_{i=0}^{n-1}p_ic_i\n$$\n### 关联\n\n\n```python\nclass Assoc:\n    def __init__(self,key,value):\n        self.key=key\n        self.value=value\n    def __lt__(self,other):\n        return self.key\u003cother.key\n    def __le__(self,other):\n        return self.key\u003cother.key or self.key==other.key\n    def __str__(self):\n        return 'Assoc({0},{1})'/format(self.key,self.value)\n    \n```\n\n### 字典的顺序表实现\n- 简单的顺序表缺点：平均检索长度大（删除依赖于检索）\n#### 有序顺序表和二分检索\n- 插入数据时需要保序：O(n)\n- 删除时可以用二分检索，但是实际删除时需要移动数据：O(n)\n- 检索时间：O(logn)\n- 平均检索长度：\n$$\n\\begin{aligned} A S L \u0026=\\frac{1}{n} *\\left(\\sum_{i=1}^{j} i * 2^{i-1}\\right) \\\\ \u0026=\\frac{1}{n} * \\sum_{i=1}^{j} \\sum_{m=i}^{j} 2^{m-1} \\\\ \u0026=\\frac{1}{n} * \\sum_{i=1}^{j}\\left(2^{j}-2^{i-1}\\right) \\\\ \u0026=\\frac{1}{n} *\\left(j * 2^{j}-2^{j}+1\\right) \\\\ \u0026=\\frac{n+1}{n} * \\log _{2}(n+1)-1 \\end{aligned}\n$$\n- 最大检索长度：$\\lceil log_2(n+1)\\rceil$\n\n\n```python\ndef bisearch(lst,key):\n    low=0\n    high=len(lst)-1\n    while low\u003c=high:\n        mid=(low+high)//2\n        if key==lst[mid].key:\n            return lst[mid].value\n        if key\u003clst[mid].key:\n            high=mid-1\n        else:\n            low=mid+1\n            \nbisearch([Assoc(1,2),Assoc(2,3),Assoc(3,4)],2)\n```\n\n\n\n\n    3\n\n\n\n### 散列\n- 关键码的映射\n- 负载因子=散列表中实际元素个数/基本存储区能容纳的元素个数\n- 除余法：整数关键码\n    - 以关键码除以一个不大于散列表长度m的整数p得到的余数（或者余数加1）作为散列地址，p可以取小于m的最大素数\n- 基数转换法：整数或字符串关键码\n- 冲突消解问题\n    - 内消解方法\n    - 外消解方法\n\n### 集合\n- 无序：求交集的复杂性是O(mn)\n- 按序排列，求交集/并集的复杂性为O(m+n)，但插入元素的复杂性变成了O(n)\n#### 集合的位向量实现\n- 如果所需要的集合对象有一个公共超集U\n- 假定U包含n个元素，给每个元素一个编号作为该元素的“下标”。\n- 对任何要考虑的集合S（注意 S⊆U），用一个n位的二进制序列 （位向量）vS表示S。对元素e∈U，如果e∈S，令vS里对应于 e（的编号，下标）的那个位取值1，否则令该位取值0\n### 二叉排序树与字典\n- 二叉排序树或者为空；或者是具有下列性质的二叉树：\n    - 其根结点保存着一个数据项（及其关键码）\n    - 如果其左子树不空，则其左子树中所有结点保存的（关键码）值均小于它的根结点保存的（关键码）值；\n    - 如果其右子树不空，则其右子树中所有结点保存的（关键码）值均大于它的根结点保存的（关键码）值；\n    - 左右子树（如果存在）也是二叉排序树\n- 检索操作的空间复杂度：O(1)，检索时间开销：O(logn)\n#### 插入\n#### 删除\n- q是叶结点，只需将其父结点p到q的引用置为None，删除完成\n- q无左子结点，只需把q的右子树直接改作p的左子树\n    - 删除之后，除了结点q已经不在，其余部分的顺序不变。 如果原来序列中的关键码递增，删除后也一样\n- q有左子树，找到q左子树的最右结点，设为r，显然它无右子树\n    - 用q的左子结点代替q作为p的左子结点 \n    - 将q的右子树作为r的右子树\n\n## 排序\n### 简单排序算法\n- 基本操作：\n    - 比较关键码，确定序关系\n    - 移动数据记录\n- 评价标准\n    - 执行时间\n    - 所需要的附加空间\n#### 插入排序\n- 空间复杂性：只需要记录的辅助空间\n- 时间复杂度：O(n^2)\n\n\n```python\ndef naivesort(list1):\n    for i in range(1,len(list1)):\n        j=i\n        while j\u003e0 and list1[j-1]\u003elist1[i]:\n            list1[j]=list1[j-1]\n            j=j-1\n        list1[j]=list1[i]\n    return list1\nnaivesort([1,2,5,6,2,5,3])#？\n```\n\n\n\n\n    [1, 2, 5, 6, 6, 6, 6]\n\n\n\n#### 选择排序\n- 用一个内层循环顺序比较，维护已发现的最小记录下标\n- 循环结束时，找到未排序段的最小记录，交换到已排序段之后\n- 未排序段剩下一个元素时就不必再选择（工作完成）\n- 记录复制：最好 0（增加判断i=k时不交换），最坏 2×(n-1)\n- 比较：n(n-1)/2\n- 总的时间复杂度：O(n^2)\n- 稳定性：不稳定\n    - 找到最小元素后的直接交换，是导致不稳定的根源\n    - 如果找到最小元素后，逐个后移k前面的尚未排序的元素，腾出未排序段最前位置后存入最小元素，得到的算法就是稳定的\n    - 直接选择排序没有适应性，对任何序列都需要 O(n2) 次比较\n\n\n```python\ndef select_sort(list2):\n    for i in range(len(list2)-1):\n        k=i\n        for j in range(i,len(list2)):\n            if list2[k]\u003elist2[j]:\n                k=j\n        if i!=k:\n            list2[i],list2[k]=list2[k],list2[i]\n    return list2\nselect_sort([1,2,6,4,7,2])\n```\n\n\n\n\n    [1, 2, 2, 4, 6, 7]\n\n\n\n#### 冒泡排序\n- 通过交换逆序对实现排序的方法\n- 比较相邻元素，遇到相邻的逆序对时交换它们\n- 改进算法：\n    - 用一个辅助变量，内循环开始时赋 False，遇到逆序赋True\n    - 内层循环结束后检查这个变量，值为 False 就结束排序 \n- 最坏时间复杂度为O(n^2)，平均时间复杂度也为O(n^2),辅助空间是 O(1)\n- 起泡排序算法具有稳定性，相等元素不交换\n\n\n```python\ndef bubble(list3):\n    for i in range(len(list3)):\n        for j in range(1,len(list3)-i):\n            if list3[j-1]\u003elist3[j]:#前后比较\n                list3[j-1],list3[j]=list3[j],list3[j-1]\n    return list3\nbubble([1,2,4,6,3,6])\n```\n\n\n\n\n    [1, 2, 3, 4, 6, 6]\n\n\n\n#### 快速排序\n- 把被排序序列按某种标准分为大小两组，确定了两个元素组的顺序\n- 而后采用同样方式递归地分别对两组记录排序\n- 划分到每个子部分最多包含一个记录时，整个序列的排序完成\n\n#### 归并排序\n- 初始时把待排序的 n 个记录看成 n 个有序子序列，长度均为 1\n- 把序列集合里的有序子序列两两归并，完成一遍，序列集合的规模减半，集合中的子序列长度加倍\n- 重复上面操作，最终得到一个长度为 n 的有序序列\n\n#### 分配排序\n\n",title:"Untitled Page"},"/Published/计量经济学":{content:"---\nArea: Statistics\nSource: Book\nStatus: Todo\nType: Notes\n---\n\n## 简单回归模型\n\n$$\ny=\\beta_{0}+\\beta_{1} x+u\n$$\n\n**零条件均值**假定下：\n$$\n\\begin{array}{l}{\\mathrm{E}(u)=0} \\\\ {\\operatorname{Cov}(x, u)=\\mathrm{E}(x u)=0}\\end{array}\n$$\n矩估计：\n$$\n\\begin{array}{c}{\\frac{1}{n} \\sum_{i=1}^{n}\\left(y_{i}-\\hat{\\beta}_{0}-\\hat{\\beta}_{1} x_{i}\\right)=0} \\\\ {\\frac{1}{n} \\sum_{i=1}^{n} x_{i}\\left(y_{i}-\\hat{\\beta}_{0}-\\hat{\\beta}_{1} x_{i}\\right)=0}\\end{array}\n$$\n得到估计的斜率：\n$$\n\\hat{\\beta}_{1}=\\frac{\\sum_{i=1}^{n}\\left(x_{i}-\\overline{x}\\right)\\left(y_{i}-\\overline{y}\\right)}{\\sum_{i=1}^{n}\\left(x_{i}-\\overline{x}\\right)^{2}}\n$$\n定义总平方和（total sum of squares，SST）、解释平方和（explained sum of squares，SSE）、残差平方和（residual sum of squares，SSR）（也叫做剩余平方和）：\n$$\n\\begin{array}{l}{\\mathrm{SST} \\equiv \\sum_{i=1}^{n}\\left(y_{i}-\\overline{y}\\right)^{2}} \\\\ {\\mathrm{SSE} \\equiv \\sum_{i=1}^{n}\\left(\\hat{y}_{i}-\\overline{y}\\right)^{2}} \\\\ {\\mathrm{SSR} \\equiv \\sum_{i=1}^{n} \\hat u_{i}^{2}}\\\\ \\mathrm{SST}=\\mathrm{SSE}+\\mathrm{SSR}\\end{array}\n$$\n\n\u003e 解释平方和有时会被称为回归平方和（regression sum of squares），容易和residual sum of squares混淆。\n\n拟合优度：\n$$\nR^{2} \\equiv \\mathrm{SSE} / \\mathrm{SST}=1-\\mathrm{SSR} / \\mathrm{SST}\n$$\nOLS的相关假定：\n\n- 假定SLR.1: 线性于参数\n- 假定SLR.2: 随机抽样\n- 假定SLR.3: 解释变量的样本有波动\n- 假定SLR.4: 零条件均值\n- 假定SLR.5: 同方差性\n\n满足假定1-4，则$\\hat\\beta_1,\\hat\\beta_0$估计有无偏性\n$$\n\\begin{aligned} \\mathrm{E}\\left(\\hat{\\beta}_{1}\\right) \u0026=\\beta_{1}+\\mathrm{E}\\left[\\left(1 / \\mathrm{SST}_{x}\\right) \\sum_{i=1}^{n} d_{i} u_{i}\\right]=\\beta_{1}+\\left(1 / \\mathrm{SST}_{x}\\right) \\sum_{i=1}^{n} \\mathrm{E}\\left(d_i u_{i}\\right) \\\\ \u0026=\\beta_{1}+\\left(1 / \\mathrm{SST}_{x}\\right) \\sum_{i=1}^{n} d_{i} \\mathrm{E}\\left(u_{i}\\right)=\\beta_{1}+\\left(1 / \\mathrm{SST}_{x}\\right) \\sum_{i=1}^{n} d_{i} \\cdot 0=\\beta_{1}\\\\\n\\mathrm{E}\\left(\\hat{\\beta}_{0}\\right)\u0026=\\beta_{0}+\\mathrm{E}\\left[\\left(\\beta_{1}-\\hat{\\beta}_{1}\\right) \\overline{x}\\right]+\\mathrm{E}(\\overline{u})=\\beta_{0}+\\mathrm{E}\\left[\\left(\\beta_{1}-\\hat{\\beta}_{1}\\right)\\right] \\overline{x} =\\beta_0\\end{aligned}\n$$\n\n\n满足假定1-5，OLS统计量的抽样方差：\n$$\n\\begin{align}\n\\operatorname{Var}\\left(\\hat{\\beta}_{1}\\right)\u0026=\\left(1 / \\operatorname{SST}_{x}\\right)^{2} \\operatorname{Var}\\left(\\sum_{i=1}^{n} d_{i} u_{i}\\right)=\\left(1 / \\operatorname{SST}_{x}\\right)^{2}\\left(\\sum_{i=1}^{n} d_{i}^{2} \\operatorname{Var}\\left(u_{i}\\right)\\right)\\\\\u0026=\\left(1 / \\mathrm{SST}_{x}\\right)^{2}\\left(\\sum_{i=1}^{n} d_{i}^{2} \\sigma^{2}\\right)\\\\\u0026=\\sigma^{2}\\left(1 / \\operatorname{SST}_{x}\\right)^{2}\\left(\\sum_{i=1}^{n} d_{i}^{2}\\right)=\\sigma^{2}\\left(1 / \\mathrm{SST}_{x}\\right)^{2} \\mathrm{SST}_{x}=\\sigma^{2} / \\mathrm{SST}_{x}\\\\\n\\operatorname{Var}\\left(\\hat{\\beta}_{0}\\right)\u0026=\\frac{\\sigma^{2} n^{-1} \\sum_{i=1}^{n} x_{i}^{2}}{\\sum_{i=1}^{n}\\left(x_{i}-\\overline{x}\\right)^{2}}\n\\end{align}\n$$\n满足假定1-5，误差方差：\n$$\n\\begin{align}\n\\hat{\\sigma}^{2}=\\frac{1}{n-2} \\sum_{i=1}^{n} \\hat{u}_{i}^{2}=\\frac{\\mathrm{SSR}}{n-2},\\quad E\\left(\\hat{\\sigma}^{2}\\right)=\\sigma^{2}\\end{align}\n$$\n\n\n\n\n\n## 多元回归分析：估计\n\n$$\ny=\\beta_{0}+\\beta_{1} x_{1}+\\beta_{2} x_{2}+\\beta_{3} x_{3}+\\cdots+\\beta_{k} x_{k}+u\n$$\n\n\n\n$\\hat\\beta_i$意为排除了其他变量之后，$x_i$对$y$的影响。\n\n利用现有样本，以$x_i$为因变量，其他变量为自变量做回归，得到残差；再将$y$对OLS残差进行回归就能得到$\\hat\\beta_i$\n\n[Frisch–Waugh–Lovell theorem的一个简要解释](https://zhuanlan.zhihu.com/p/75716921)\n\n### 基本假定\n\n- 假定MLR.1: 线性于参数\n- 假定MLR.2: 随机抽样\n- 假定MLR.3: 无完全共线性\n- 假定MLR.4: 零条件均值\n- 假定MLR.5: 同方差性\n- 假定MLR.6: 正态性\n\n### OLS统计量的无偏性\n\n满足假定1-4，OLS估计值就是无偏的。\n\n#### 包含无关变量\n\n在回归模型中包含了无关变量，并不会影响到OLS估计量的无偏性，但会影响其方差。\n\n#### 遗漏变量偏误\n\n$$\n\\hat{\\beta}_{1}=\\hat{\\beta}_{1}+\\hat{\\beta}_{2} \\hat{\\delta}_{1}\n$$\n\n其中，$\\hat\\delta_1$是$x_{i2}$对$x_{i1}$进行简单回归的斜率系数。\n\n由于模型满足假定1-4，所以估计是无偏的，假如遗漏了变量$x_2$：\n$$\nE\\left(\\tilde{\\beta}_{1}\\right)=E\\left(\\hat{\\beta}_{1}+\\hat{\\beta}_{2} \\tilde{\\delta}_{1}\\right)=E\\left(\\hat{\\beta}_{1}\\right)+E\\left(\\hat{\\beta}_{2}\\right) \\tilde{\\delta}_{1}\n$$\n偏误为：\n$$\n\\operatorname{Bias}\\left(\\tilde{\\beta}_{1}\\right)=E\\left(\\tilde{\\beta}_{1}\\right)-\\beta_{1}=E\\left(\\hat{\\beta}_{1}\\right)+E\\left(\\hat{\\beta}_{2}\\right) \\tilde{\\delta}_{1}-\\beta_1=\\beta_1+\\beta_2\\tilde\\delta_1-\\beta_1=\\beta_{2} \\tilde{\\delta}_{1}\n$$\n\n### OLS估计量的方差\n\n在假定1-5下：\n$$\n\\operatorname{Var}\\left(\\beta_{j}\\right)=\\frac{\\sigma^{2}}{\\operatorname{SST}_{j}\\left(1-R_{j}^{2}\\right)}\n$$\n其中，$\\mathrm{SST}_{j}=\\sum_{i=1}^{n}\\left(x_{i j}-\\overline{x}_{j}\\right)^{2}$是$x_j$的总样本变异，而$R_j^2$则是将$x_j$对所有其他自变量（并包含一个截距项）进行回归所得到的$R^2$\n\n### 误差项的方差\n\n$$\n\\sigma^{2}=\\frac{\\sum_{i=1}^{n} \\hat{u}_{i}^{2}}{n-k-1}=\\frac{\\mathrm{SSR}}{n-k-1}\n$$\n\n在假定1-5下，$E\\left(\\sigma^{2}\\right)=\\sigma^{2}$.\n\n### 调整后的R方\n\n$$\nadj\\ R^2=1-\\frac{\\hat\\sigma^2}{\\text {SST}/n-1}=1-\\frac{(1-R^2)(n-1)}{n-k-1}\n$$\n\n### OLS的有效性：高斯马尔可夫定理\n\n在假定1-5下，$\\hat{\\beta}_{0}, \\hat{\\beta}_{1}, \\cdots, \\hat{\\beta}_{k}$分别是$\\beta_{0}, \\beta_{1}, \\cdots, \\beta_{k}$的最优线性无偏估计量。\n\n最优被定义为最小方差。\n\n### 经典线性模型（CLM）\n\nCLM估计量是最小方差无偏估计。\n\n误差项的正态性导致OLS估计量的正态抽样分布。\n\n## 多元回归分析：推断\n\n### 检验单个参数：t检验\n\n在假定1-6下：\n$$\n\\left(\\hat{\\beta}_{j}-\\beta_{j}\\right) / \\operatorname{sd}\\left(\\hat{\\beta}_{j}\\right) \\sim t_{n-k-1}\n$$\n\n### 检验多个参数：F检验\n\n$$\nF \\equiv \\frac{\\left(\\mathrm{SSR}_{r}-\\mathrm{SSR}_{u r}\\right) / q}{\\operatorname{SSR}_{u r} /(n-k-1)}\\sim F_{q, n-k-1}\n$$\n\n其中，$SSR_r$是受约束模型（变量多）的残差平方和，$SSR_{ur}$是不受约束模型（变量少）的残差平方和，$q$是两个模型的估计参数之差，分母是**不受约束模型**的方差的无偏估计量。\n\n#### 另一种F统计量\n\n$$\nF=\\frac{\\left(R_{ur}^{2}-R_{r}^{2}\\right) / q}{\\left(1-R_{u r}^{2}\\right) /(n-k-1)}=\\frac{\\left(R_{u r}^{2}-R_{r}^{2}\\right) / q}{\\left(1-R_{u r}^{2}\\right) / d f_{u r}}\n$$\n\n\n\n## 多元回归分析：OLS的渐近性\n\n不能找到无偏估计量时，找到一个一致估计量也是有用的。\n\n## 异方差性\n\n异方差对估计的无偏性和拟合优度没有影响。\n\n对统计检验有影响。\n\n### OLS估计后的异方差稳健推断\n\n#### 异方差稳健的标准误\n\n$$\n\\widehat{\\operatorname{Var}\\left(\\hat{\\beta}_{j}\\right)}=\\frac{\\sum_{i=1}^{n} \\hat{r}_{i j}^{2} \\hat{u}_{i}^{2}}{\\mathrm{SSR}_{j}^{2}}\n$$\n\n其中，$\\hat r_{ij}$表示将$x_j$对所有其他自变量做回归所得到的第$i$个残差，而$\\text {SSR}_j$则是这个回归的残差平方和。\n\n稳健的$t$统计量的分布在小样本容量的时候可能不是那么接近于$t$分布，从而使我们的推断可能犯错误。\n\n#### 异方差稳健的LM统计量\n\n1. 从约束模型中得到$\\tilde u$\n2. 将原假设中所排除的每个自变量分别对原假设包含的所有自变量进行回归，如果有$q$个被排除变量，就得到$q$个残差（$\\tilde{r}_{1}, \\tilde{r}_{2}, \\cdots \\tilde{r}_{q}$）构成的集合\n3. 求出每个$\\tilde r_j$和$\\tilde u$的积\n4. 在不包括截距的情况下将1对$\\tilde{r}_{1} \\tilde{u}, \\tilde{r}_{2} \\tilde{u}  \\cdots, \\tilde{r}_{q} \\tilde{u}$做回归，异方差稳健的LM统计量就是$n-\\text{SSR}_1$, LM统计量渐近服从$\\chi^{2}_q$分布。\n\n### 对异方差的检验\n\n#### 布罗施-帕甘检验\n\n1. 用OLS估计模型，得到残差平方（每次观测得到一个）\n\n2. 用残差平方对所有自变量回归：\n   $$\n   \\hat u^{2}=\\delta_{0}+\\delta_{1} x_{1}+\\delta_{2} x_{2}+\\cdots+\\delta_{k} x_{k}+v\n   $$\n   得到这个回归的$R_u^2$\n\n3. 计算F统计量，其服从$F_{k,n-k-1}$分布：\n   $$\n   F=\\frac{R_{u}^{2} / k}{\\left(1-R_{u^{2}}^{2}\\right) /(n-k-1)}\n   $$\n   或者LM统计量，渐近服从$\\chi^{2}_k$分布：\n   $$\n   LM=nR_{\\hat u^2}^2\n   $$\n   如果$p$值低于显著性水平，那么就拒绝同方差假设\n\n#### 怀特检验\n\n1. 用OLS估计模型，得到残差和拟合值，计算残差平方和拟合值的平方\n2. 做回归$\\hat u^2=\\delta_0+\\delta_1\\hat y+\\delta_2\\hat y^2+v$，得到$R_{\\hat u^2}^2$\n3. 按上述构造F或LM统计量\n\n### 加权最小二乘估计（WLS）\n\n$$\n\\begin{aligned} y_{i} / \\sqrt{h_{i}}=\u0026 \\beta_{0} / \\sqrt{h_{i}}+\\beta_{1}\\left(x_{i 1} / \\sqrt{h_{i}}\\right)+\\beta_{2}\\left(x_{i 2} / \\sqrt{h_{i}}\\right)+\\cdots+\\beta_{k}\\left(x_{k} / \\sqrt{h_{i}}\\right) \\\\ \u0026+\\left(u_{i} / \\sqrt{h_{i}}\\right) \\end{aligned}\n$$\n\n### 可行GLS（FGLS）\n\n1. 用OLS估计模型得到残差\n2. 将OLS残差平方后取对数得到$log(\\hat u^2)$\n3. $log(\\hat u^2)$对$x_{1}, x_{2}, \\cdots, x_{k}$回归，并得到拟合值$\\hat g$\n4. $\\hat{h}=\\exp (\\hat{g})$\n5. 以$1/\\hat h$为权，用WLS估计：在上面的方程里用$\\hat h_i$取代了$h_i$\n\n\n\n\n## 工具变量回归\n\n### 两阶段最小二乘法回归\n\n- 工具变量和解释变量有关，和干扰项无关\n- 先用$Z$对$X$回归，再将估计的$X$对$Y$回归\n- TSLS的估计：$\\beta^{TSLS}=\\frac{cov(Y,Z)}{cov(X,Z)}$\n\n### TSLS的统计推断\n\n- 大样本下TSLS估计是渐进服从正态分布的\n$$\n\\hat\\beta_1^{TSLS}\\sim N(\\beta_1,\\sigma^2)\n$$\n$$\n\\sigma=\\frac{1}{n}\\frac{var[(Z_i-\\mu_Z)u_i]}{[cov(Z_i,X_i)]^2}=\\frac{\\sigma^2}{n\\sigma_x^2\\rho_{x,z}^2}\n$$\n- $\\sigma^2$是干扰项的总体方差，$\\rho_{x,z}^2$是解释变量和工具变量的相关系数的平方。\n- 求工具变量标准误\n\n### 工具变量有效性的检验\n\n#### 检验相关性\n\n- 先用所有的工具变量和控制变量对$X$做回归\n- $F$检验：零假设所有工具变量前面的系数全为零\n- $F$统计量大于10，认为是一个弱的工具变量\n\nAnderson-Rubin置信区间\n\nMoreira’s Conditional Likelihood Ratio置信区间\n\n#### 检验外生性\n\n- 只有在过度识别的时候才能使用$J$检验\n- 用所有的真实的$X$对$Y$做回归，得到估计的$\\hat Y$\n- 计算残差\n- 用所有的工具变量和控制变量对残差做回归\n- $F$检验：零假设是所有工具变量前的系数都为零\n- $J=mF$，$m$是工具变量的个数，服从自由度是$m-k$的卡方分布，$k$是解释变量的个数\n- $J$检验的零假设是所有的工具变量都是外生的，$J$统计量大说明有工具变量是内生的",title:"Untitled Page"},"/Published/货币金融学":{content:"[《货币金融学》米什金](https://book.douban.com/subject/5939751/)笔记\n\n---\n\n## 第一章 为什么研究货币、银行与金融市场\n\n### 为什么研究金融市场\n\n#### 债券市场与利率\n\n- 证券（金融工具）：对发行人未来收入与资产的索取权。\n- 债券：承诺在一个特定的时间段中进行定期支付。\n- 利率：借款的成本或为借入资金支付的价格。\n\n#### 股票市场\n\n- 普通股：代表持有者对公司的所有权。\n\n### 对总产出、总收入、物价水平和通货膨胀率的定义\n\n- 总产出与总收入\n- 实际量与名义量的区别\n- 物价总水平\n- 增长率与通货膨胀率\n\n\n\n##第二章 金融体系概览\n\n###金融市场的功能\n\n- 从那些由于支出少于收入而积蓄了盈余资金的家庭、公司和政府那里，将资金引导到那些由于支出超过收入而资金短缺的经济主体那里。金融市场有助于资本的合理配置。\n\n### 金融市场的结构\n\n#### 债务与股权市场\n\n#### 一级市场和二级市场\n\n- 一级市场：投资银行是一级市场上协助证券首次出售的重要的金融机构。投资银行的做法是证券承销（underwriting），确保公司证券能够按照某一价格销售出去，之后再向公众推销这些证券。\n- 二级市场：\n  - 经纪人（broker）负责匹配证券的买方和卖方；交易商（dealer）按照报价买卖证券。\n  - 功能：使得投资者可以更加容易出售金融工具，实现筹措资金的目的。决定了发行企业在一级市场上销售证券的价格。\n\n#### 交易所和场外市场\n\n- 二级市场的组织形态有两种：\n  - 交易所：证券的买卖双方在一个集中的场所进行交易的二级市场。（如纽约证券交易所）\n  - 场外市场（over-the-counter market）：分处各地的拥有证券存货的交易商随时向与其联系并愿意接受其报价的人在“柜台”上买卖证券的二级市场。（如美国政府债券市场）\n\n#### 货币市场和资本市场\n\n- 货币市场：交易短期债务工具（原始期限通常为一年以下）的金融市场。\n- 资本市场：交易长期债务工具（原始期限通常为一年或一年以上）的金融市场。\n\n### 金融市场工具\n\n#### 货币市场工具\n\n- 美国国库券\n- 可转让存单\n- 商业票据（commercial paper）\n- 回购协议（repos）\n- 联邦基金\n  - 通常是指银行在美联储的存款的隔夜贷款。联邦基金利率可以反映银行贷款市场与货币政策的松紧状况。如果联邦基金利率较高，说明银行资金头寸比较紧张；如果联邦基金利率较低，说明银行的信贷需求较少。\n\n#### 资本市场工具\n\n- 股票\n- 抵押贷款和抵押支持证券\n- 企业债券\n\n### 金融市场的国际化\n\n#### 国际债券市场、欧洲债券市场与欧洲货币市场\n\n- 外国债券：在国外发行并以发行国货币计价的债券。\n- 欧洲债券：在外国市场上发行，并非以发行国货币来计价的债券。\n- 欧洲货币：存放在货币发行国之外的银行的外国货币。由于短期存款同样可以赚取利息，因此他们就类似于短期欧洲债券。\n\n#### 世界股票市场\n\n![](https://static.notion-static.com/88e5786b-537e-49e9-8289-d60914b57db1/Untitled)\n\n### 金融中介机构的功能：间接融资\n\n- 1. Savings Function\n  2. Wealth Function\n  3. Liquidity Function\n  4. Credit Function\n  5. Payment Function\n  6. risk-sharing Function\n  7. Policy Function\n  8. Information Function\n- 交易成本\n- 风险分担\n- 信息不对称：逆向选择和道德风险\n- 范围经济和利益冲突\n\n### 金融中介机构的类型\n\n#### 存款机构\n\n- 商业银行\n- 储蓄与贷款协会和互助储蓄银行\n- 信用社\n\n#### 契约型储蓄机构\n\n- 人寿保险公司\n- 火灾和意外伤害保险公司\n- 养老基金和政府退休基金\n\n#### 投资中介机构\n\n- 财务公司\n- 共同基金\n- 货币市场共同基金\n- 对冲基金\n- 投资银行\n\n### 金融体系的监管\n\n##第三章 什么是货币\n\n###货币的含义\n\n- 货币：在产品和服务支付以及债务偿还中被普遍接受的东西。\n- 财富：用于价值储藏的各项财产总和。\n- 收入：单位时间段内收益的流量，而货币是存量概念。\n\n### 货币的功能\n\n#### 交易媒介\n\n- 货币的功能\n  - 大大缩短了产品和服务交易的时间\n  - 人们可以专门从事他们所擅长的工作\n- 怎样有效发挥货币的功能\n  - 易于标准化，可以方便地确定其价值\n  - 被普遍接受\n  - 易于分割\n  - 易于携带\n  - 不会很快腐化变质\n\n#### 记账单位\n\n- 经济社会中价值衡量的手段\n\n#### 价值储藏\n\n- 流动性：某一资产转化为交易媒介的便利程度和速度。\n\n### 支付体系的演进\n\n- 商品货币\n- 不兑现纸币\n- 支票\n- 电子支付\n  - 借记卡\n  - 智能卡\n  - 电子现金\n\n### 货币的计量\n\n- 联邦储备体系的货币总量\n- M1=通货+旅行者支票+活期存款+其他支票存款\n- M2=M1+小额定期存款+储蓄存款与货币市场存款账户+货币市场共同基金份额（零售）\n\n##第四章 理解利率\n\n### 利率的计量\n\n- 现值\n- 四种类型的信用市场工具\n  - 普通贷款\n  - 固定支付贷款（分期偿还贷款）\n  - 息票债券\n  - 贴现发行债券（零息债券）\n- 到期收益率\n  - 使债务工具所有未来回报的现值与其今天的价值相等的利率。\n    - 息票债券的特例：永续债券（perpetuity），没有到期日，不必偿还本金，只需要支付固定的息票利息\n      - P=C/i\n- 利率和回报率的区别\n  - 第一项是当期收益率i，第二项是资本利得率g\n\n  $$R=\\frac{C+P_{t+1}-P_t}{P_t}=\\frac{C}{P_t}+\\frac{P_{t+1}-P_t}{P_t}$$\n\n- 期限与债券回报率的波动：利率风险\n  - 长期债券的价格和回报率的波动性比短期债券大。\n  - 到期期限和持有期一样短的债券就不存在利率风险。\n\n### 实际利率与名义利率的区别\n\n\n\n## 第五章 利率行为\n\n### 资产需求的决定因素\n\n#### 财富\n\n- 个人拥有的全部资源。拥有的财富增加时，有了更多可以用于购买资产的资源。\n- 假定其他因素不变，财富的增长会增加对资产的需求数量。\n\n#### 预期回报率\n\n- 在其他因素不变的情况下，某一资产相对于其他替代性资产的预期回报率上升会增加对该资产的需求数量。\n\n#### 风险\n\n- 假定其他因素不变，如果一种资产相对于其他替代性资产的风险增大，则对该资产的需求数量会相应减少。\n\n#### 流动性\n\n- 该资产以较低成本转化为现金的速度。\n- 假定其他因素不变，一种资产相对于其他替代性资产的流动性越强，就越受到人们的青睐，对它的需求越多。\n\n### 均衡利率的变动\n\n- 债券需求曲线的位移\n\n![](https://static.notion-static.com/05895397-96aa-414b-a1c9-8d10c1bc1e53/Untitled)\n\n![](https://static.notion-static.com/780a3340-52c4-4a16-8f74-8300602765c2/Untitled)\n\n- 债券供给曲线的位移\n\n  ![](https://static.notion-static.com/7e90e238-5909-4e0c-b7d6-2b1da030e417/Untitled)\n\n  - 各种投资机会的预期盈利性\n  - 预期通货膨胀率\n    - **在给定的利率水平上**，随着预期通货膨胀率的上升，借款的真实成本就会下降，于是对应于给定债券价格水平的债券供给数量会相应增加。\n  - 政府预算赤字\n    - 美国财政部发行债券来弥补政府支出和收入之间的差额即政府赤字。\n    - 政府赤字非常大时，财政部就会出售更多的债券。\n  - 费雪效应\n    - 预期通货膨胀率上升：需求曲线左移（对实体资产更偏好），供给曲线右移（真实借款成本下降）\n    - 预期通货膨胀率的上升会引起利率的上升\n\n### 流动性偏好理论：货币市场的供给与需求\n\n![](https://static.notion-static.com/0195b2bc-6076-4c38-bad3-544b5e9e1c7a/Untitled)\n\n### 流动性偏好理论：均衡利率的变动\n\n- 货币需求曲线的位移\n  - 收入效应：收入水平上升导致任意利率水平上的货币需求增加，需求曲线右移。\n    - 随着经济的扩张和收入的增加，财富增长，人们愿意持有更多的货币储藏价值。\n    - 随着经济的扩张和收入的增加，人们愿意利用货币这一交易媒介进行更多的交易，希望持有更多的货币。\n  - 价格效应：物价水平的上升导致任意利率水平上的货币需求增加，需求曲线右移。\n    - 物价水平上升时，相同名义量的货币价值降低，所能购买的产品和服务数量减少，为了将实际货币持有量恢复到原先的水平，人们希望持有更多名义量的货币。\n- 货币供给曲线的位移\n- 收入变化\n  - 经济周期扩张阶段，假定其他经济变量不变，利率随着收入的增加而上升。\n\n  ![](https://static.notion-static.com/2203c4fb-e5a3-4a8c-847e-1fcf3ae53410/Untitled)\n\n- 物价水平的变动\n- 货币供给的变化\n\n### 货币与利率\n\n弗雷德曼认为货币供给增加无法保证“其他条件都不变”的假设，现实情况似乎反映了收入效应、价格效应、通货膨胀预期效应会超过流动性效应，因此提高货币增长速度会提高而非降低利率。\n\n- 收入效应：利率随收入水平的提高而上升。\n- 价格效应：利率随价格水平的上升而上升。\n- 通货膨胀预期效应：利率随预期通货膨胀率的上升而上升。\n\nb图比较符合实际情况。\n\n![](https://static.notion-static.com/9665bed8-6dc0-4986-b977-476677a5052d/Untitled)\n\n\n\n\n\n## 第六章 利率的风险结构与期限结构\n\n### 利率的风险结构\n\n#### 违约风险\n\n- 具有违约风险的债券的风险溢价总为正，且风险溢价随着违约风险的上升而增加。\n\n![](https://static.notion-static.com/09bced6f-e000-4f8a-8ae9-7b03629826dd/Untitled)\n\n#### 流动性\n\n- 企业债券流动性较差，出售债券的代价很高。国债的流动性较好。\n\n#### 所得税因素\n\n- 市政债券的风险高于国债，流动性低于国债，为什么利率低于国债呢？\n- 市政债券的利息支付可以免交联邦所得税。\n- 从税后回报率的角度和供求关系的角度分析。\n\n![](https://static.notion-static.com/5b101d69-6c49-4f6c-84a5-524e37aff52b/Untitled)\n\n### 利率的期限结构\n\n- 具有相同风险、流动性、税收的债券，由于距离到期日的时间不同，利率也会有所差异。将期限不同但风险、流动性、税收政策相同的债券收益率连接成一条曲线，即得到收益率曲线。\n- 经验事实\n  - 到期期限不同的债券的利率随时间一起波动。\n  - 短期利率较低，收益率曲线很可能向上倾斜；短期利率较高，收益率曲线很可能向下倾斜。\n  - 收益率曲线几乎总是向上倾斜的。\n\n  #### 预期理论\n\n  - 长期债券的利率等于在其有效期内人们所预期的短期利率的平均值。\n  - 收益率曲线向上倾斜说明市场预期未来的短期利率将上升。\n  - n阶段债券的利率满足：\n\n  $$i_m=\\frac{i_t+i^e_{t+1}+i^e_{t+2}+...+i^e_{t+(n-1)}}{n}$$\n\n  #### 分割市场理论\n\n  - 将到期期限不同的债券市场看作完全独立和相互分割的。到期期限不同的每种债券的利率取决于该债券的供给与需求，具有其他到期期限的债券的预期回报率对此毫无影响。\n  - 风险厌恶投资者的意愿持有期较短，愿意持有利率风险较小的短期债券，可以说明典型的收益率曲线是向上倾斜的。\n\n  #### 流动性溢价理论与期限优先理论\n\n  - 长期债券的利率应当等于两项之和，第一项是长期债券到期之前预期短期利率的平均值，第二项是随债券供求状况变动而变动的流动性溢价。\n  - 流动性溢价理论，lm为n阶段债券在时间t的流动性（期限）溢价，总是为正，并随到期期限n的延长而上升。\n\n  $$i_m=\\frac{i_t+i^e_{t+1}+i^e_{t+2}+...+i^e_{t+(n-1)}}{n}+l_m$$\n\n  - 仅通过观察收益率曲线的斜度，就可以判断市场对未来短期利率的预测。\n\n  ![](https://static.notion-static.com/89c6abc9-f368-4b5a-a9ec-03f49e0fbfba/Untitled)\n\n\n\n##第七章 股票市场、理性预期理论与有效市场假说\n\n### 计算普通股价格\n\n#### 单阶段估值模型\n\n#### 推广的股利估值模型\n\n- Pn在很远的将来，对P0就几乎没有影响，股票现在的价值可以被简化为所有未来股利流的现值。\n\n#### 戈登增长模型\n\n- 假定股利永远按照不变的比率增长。\n- 假定股利增长率低于股票投资的要求回报率k。\n\n### 市场如何确定股票价格\n\n- 价格是由愿意支付最高价格的买主确定的。\n- 市场价格是由最能有效利用该资产的买主确定的。\n- 关于资产的更为全面准确的信息能够通过降低它的风险提高其价值。\n\n### 理性预期理论\n\n- 预期应与利用所有可得信息作出的最优预测（即对将来的最好估计）相一致。\n- 如果某一变量的运动方式发生变化，那么对该变量预期形成的方式也要随之改变。\n- 预期的预测误差平均为零，且事先无法预知。\n\n### 有效市场假说：金融市场中的理性预期\n\n### 行为金融\n\n- 损失厌恶：缺乏足够的卖空交易，无法推动股票价格回归其基础价格。\n- 过分自信：交易往往基于自己的信条，而非纯粹的事实。\n- 社会传染：媒体报道所创造的氛围，使得越来越多的投资者对股票价格上升充满信心。\n\n\n\n## 第八章 金融结构的经济学分析\n\n### 世界各国金融结构的基本事实\n\n- 股票不是企业最主要的外部融资来源。\n- 发行可流通的债务和股权证券不是企业为其经营活动筹资的主要方式。\n- 与直接融资相比，间接融资的重要性大出数倍。\n- 金融中介，特别是银行，是企业外部资金最重要的来源。\n- 金融体系是经济体中受到最严格监管的部门。\n- 只有信誉卓著的大公司才能进入金融市场为其经营活动筹资。\n- 抵押品是居民个人和企业债务合约的普遍特征。\n- 典型的债务合约是对借款人行为设置了无数限制条件的、极为复杂的法律文本。\n\n### 交易成本\n\n- 交易成本如何影响金融结构\n- 金融中介如何降低交易成本\n  - 规模经济\n  - 专门技术\n\n### 信息不对称：逆向选择和道德风险\n\n### 次品车问题：逆向选择如何影响金融结构\n\n### 道德风险如何影响债务合约和股权合约的选择\n\n- 股权合约：委托代理问题\n- 解决委托代理问题的方法\n  - 信息生产：监督\n  - 旨在增加信息的政府监管\n  - 金融中介（VC）\n  - 债务合约\n\n道德风险如何影响债权市场的金融结构\n- 债务合约要求借款人支付固定的金额，除此之外的收入则为借款人的利润，借款人有动机参与风险程度超过贷款人意愿的投资项目。\n- 解决债务合约中道德风险问题的办法\n  - 净值与抵押品：实现了债务合约的激励相容，将借款人和贷款人的动机统一起来\n  - 限制性条款的监督和执行\n    - 限制违背贷款人意愿的行为的条款\n    - 鼓励符合贷款人意愿的行为的条款\n    - 保持抵押品价值的条款\n\n## 第九章 银行业与金融机构的管理（TODO）\n\n## 第十章 金融监管的经济学分析\n\n### 信息不对称是金融监管存在的原因\n\n#### 政府安全网\n\n- 银行业恐慌以及对存款保险的需求\n  - 如果经济遭受不利冲击，一部分银行会破产；储户不知道自己的银行是否会破产，所以有提前取款的动机：银行挤兑。\n  - 存款保险制度\n    - 偿付法\n    - 收购与接管法\n- 其他安全网\n  - 中央银行向陷入困境的机构房贷\n  - 政府接管（国有化）陷入困境的机构\n- 政府安全网的缺陷\n  - 道德风险\n    - 银行可能会冒更大的风险：“正面，我赚；反面，纳税人赔。”\n  - 逆向选择\n    - 收到政府安全网保护的储户和债权人没有动机对银行进行市场约束\n  - 太大不能倒闭（too big to fail problem）\n    - 强化了大银行的道德风险动机\n- 金融并购与政府安全网\n  - 金融并购导致金融机构规模扩张，加剧了“太大不能倒闭”问题。\n  - 银行与其他金融服务企业的并购意味着政府安全网需要扩展到证券承销、保险、不动产等新的业务领域，加大了过度冒险的可能。\n\n### 金融监管的类型\n\n#### 对资产持有的限制\n\n- 对银行持有的资产予以限制，减少道德风险问题，不得持有普通股等风险资产\n- 鼓励银行提高多元化程度，通过限制特定种类贷款或者像单个借款人贷款的规模来降低风险\n\n#### 资本金要求\n\n- 基于杠杆比率：\n  - 资本与银行总资产的比率必须超过5%\n- 基于风险：\n  - 表外业务增加了银行风险\n  - 《巴塞尔协议》要求银行持有的资本至少占其风险加权资产的8%。\n  - 资产被分为四个类别：\n    - 风险权重为零：准备金、经济合作与发展组织（OECD）成员国的政府证券\n    - 风险权重为20%：OECD成员国的银行债权\n    - 风险权重为50%：市政债券、住房抵押贷款\n    - 风险权重为100%：消费者贷款、企业贷款\n  - 通过规定一个信用风险换算系数，将表外业务转化为表内项目\n  - 监管套利：保留风险权重相同但风险较高的资产\n\n#### 即时整改行动\n\n- 资本金规模下降到一个很低的水平：银行资本缓冲减少，破产的可能性加大；金融机构的资本金越少，在赌博中可能遭受的损失就越小，更有可能出现过度冒险的行为。\n- 根据银行资本，银行可分为五个类别：\n  - 资本充裕型：可承销某些证券\n  - 资本充足型：满足最低资本金要求\n  - 资本不充足型：没有满足资本金要求\n  - 资本相当不充足型、资本严重不充足型：不得支付高于平均水平的存款利率\n\n#### 注册与检查\n\n#### 风险管理评估\n\n- 压力测试\n- 在险价值\n\n#### 信息披露要求\n\n#### 消费者保护和对竞争的限制\n\n\n\n## 第十一章 银行业：结构与竞争（TODO）\n\n\n\n## 第十二章 金融危机\n\n### 什么是金融危机\n\n金融脆弱性加剧时，金融市场无法有效地将资金从储蓄者融通给具有生产性投资机会的居民和企业，进而导致经济活动的收缩。\n\n### 金融危机的发展过程\n\n#### 阶段一：金融危机的爆发\n\n信贷繁荣和破灭\n\n- 金融自由化是要取消对金融市场和金融机构的管制，在短期内推动金融机构大规模房贷，通常被称为信贷繁荣。\n- 存款保险制度等政府安全网弱化了市场约束，增加了银行过度冒险的道德风险\n- 最终贷款损失开始累积，贷款相对于负债的价值减少，从而拉低银行和其他金融机构的净值资本水平。\n- 资本减少后，银行就会削减向借款支出者的放款，这一过程被称为去杠杆化。\n- 资本减少后，银行和其他金融机构风险增加，贷款-储蓄者就会抽逃资金。\n- 资金外流后，生产性投资得到的贷款融资减少，即信贷冻结；信用繁荣转化为贷款暴跌。\n\n资产价格繁荣和破灭\n\n- 股票和房地产等资产价格在投资者心理的作用下可以远远超过其基础经济价值，被称为资产价格泡沫。\n- 泡沫崩溃，资产价格回归其基础经济价值，自有资产减少，更倾向于进行高风险投资。（道德风险）\n\n不确定性增加\n\n#### 阶段二：银行业危机\n\n- 储户挤提，银行紧急抛售，资不抵债，传染行为使多家银行破产\n\n#### 阶段三：债务萎缩\n\n- 经济倒退使得价格急剧下降，复苏过程受阻，债务萎缩\n- 价格意料之外的下跌会增加负债的实际价值，但资产的实际价值没有改变，净值减少\n- 加剧了逆向选择和道德风险问题\n\n### 全球金融危机：2007-2009年\n\n#### 2007-2009年金融危机的起因\n\n抵押市场上的金融创新：担保债务权益（CDO）\n\n抵押市场上的代理问题\n\n信息不对称和信用评级机构\n\n#### 2007-2009年金融危机的影响\n\n居民住宅市场：泡沫积聚和崩溃\n\n金融机构的资产负债表恶化\n\n影子银行体系挤提\n\n全球金融市场\n\n知名公司破产\n\n#### 2007-2009年金融危机的顶点\n\n#### 政府干预与经济复苏\n\n实施问题资产援助计划\n\n实施旨在提振经济的财政政策\n\n### 金融监管的反应\n\n#### 宏观审慎监管和微观审慎监管\n\n#### 《多德-弗兰克华尔街改革和消费者保护法案》\n\n消费者保护\n\n清算权力\n\n系统性风险监管\n\n沃尔克法则\n\n衍生品\n\n### “太大不能倒闭”和未来的金融监管\n\n#### 应对\n\n- 分拆具有系统重要性的大型金融机构\n- 提高资本金要求\n- 交给弗兰克法案\n\n#### 其它问题\n\n- 金融服务业的薪酬\n- 政府发起的企业\n- 信用评级机构\n- 过度监管的风险\n\n##第十三章 中央银行与联邦储备体系（TODO）\n\n## 第十四章 货币供给过程（TODO）\n\n\n\n## 第十五章 货币政策工具（TODO）\n\n\n\n## 第十六章 货币政策操作（TODO）\n\n\n\n## 第十七章 外汇市场（TODO）\n\n\n\n##第十八章 国际金融体系（TODO）\n\n\n\n## 第十九章 货币数量论、通货膨胀与货币需求\n\n### 货币数量论\n\n#### 货币流通速度和交易方程式\n\n- 流通速度$V=\\frac{P*Y}{M}$,(Irving Fisher)\n\n#### 数量论与通货膨胀\n\n- 通货膨胀的数量论表明通货膨胀率等于货币供给的增长率减去总产出的增长率。\n\n### 预算赤字与通货膨胀\n\n#### 政府的预算约束\n\n- 政府的三种支付选择：通过征税来增加收入，发行政府债券来借款，创造货币来支付产品和服务。\n- 政府预算赤字等于政府支出和税收收入之差，等于基础货币变化量和公众持有的政府债券变化量的和。\n- $DEF=G-T=\\triangle{MB}+\\triangle{B}$\n- 政府可以用增发的货币来支付超过其税收收入的购买行为。如果不具有发行钞票的权力，政府会通过向公众发行债券的方式来弥补预算赤字。\n- 由于政府债券最终不是由公众持有，中央银行事实公开市场购买而买入债券：债务货币化（monetizing the debt）\n- 长时间通过货币创造的方式弥补预算赤字会导致持续的通货膨胀。\n\n### 凯恩斯的货币需求理论\n\n#### 交易动机\n\n#### 预防动机\n\n#### 投机动机\n\n#### 综合三种动机\n\n- 实际货币余额的需求被称为流动性偏好函数：\n- $$\\frac{M^d}{P}=L(i,Y)$$\n- 与名义利率负相关，与实际收入正相关。\n- 重要结论：流通速度不是常量，而是会随着利率的变动而变动。\n\n### 货币需求的组合理论\n\n#### 组合选择理论与凯恩斯流动性偏好理论\n\n#### 其他影响货币需求的因素\n\n- 财富\n- 风险\n- 通胀对冲资产：通货膨胀保值证券（TIPS）、黄金、不动产\n- 其他资产的流动性\n\n#### 总结\n\n![1528010478641](C:\\Users\\Ada\\Desktop\\1528010478641.png)\n\n### 货币需求的实证分析\n\n\n\n\n\n## 第二十章 IS曲线\n\n### 总需求\n\n$$\nY^{ad}=C+I+G+NX\\\\C=\\bar{C}+mpc×Y_D=\\bar{C}+mpc×(Y-T)\\\\I=\\bar{I}-dr_i\\\\r_i=r+\\bar{f}\\\\NX=\\bar{NX}-xr\\\\G=\\bar{G}\\\\T=\\bar{T}\\\\Y=Y^{ad}\n$$\n\n$\\bar{C}$代表自主性消费支出，外生变量。$mpc$代表边际消费倾向。\n\n$d$是反映投资对实际利率响应程度的参数。$r_i$是实际利率，不仅反映安全的短期债务工具的利率$r$，还反映金融脆弱性（$f$，由阻碍金融市场有效发挥作用的壁垒所引致的额外的借款成本）。\n\n$x$是反映净出口对实际利率响应程度的参数。\n\n\n\n## 第二十一章 货币政策与总需求曲线\n\n### 美联储与货币政策\n\n- 美联储通过调节提供给银行体系的准备金数量来控制联邦基金利率。如果美联储将准备金抽离银行体系，银行可以用于贷放的资金就会较少，流动性短缺造成联邦基金利率上升。\n\n### 货币政策曲线\n\n- 反映了中央银行设置的实际利率与通货膨胀率之间的联系。\n- $$r=\\bar{r}+\\lambda\\pi$$\n- $\\bar{r}$代表中央银行设置的实际利率中的自主性（外生性）部分，与当前的通货膨胀率水平以及模型中的其他变量都无关。$\\lambda$代表实际利率对通货膨胀率的敏感性。\n- 泰勒定理：货币政策曲线向上倾斜。\n\n#### 货币政策曲线的位移\n\n- 美联储提高实际利率：“紧缩的”货币政策。\n- 美联储降低实际利率：“宽松的”货币政策。\n- 沿着货币政策曲线的移动：2004-2006年联邦基金利率指标的上调\n- 货币政策曲线的位移：全球金融危机爆发阶段的**自主性宽松货币政策**\n\n### 总需求曲线\n\n- 总需求曲线反映了任意通货膨胀率水平对应的均衡总产出，总需求曲线向下倾斜，和IS曲线同向位移。\n\n\n\n## 第二十二章 总需求-总供给分析（TODO）\n\n\n\n## 第二十三章 货币政策理论\n\n### 货币政策对冲击的反应\n\n- 中央银行通过实施旨在缩小通货膨胀率和通货膨胀指标之间差距的货币政策，达到物价稳定的目标。\n- 中央银行希望产出缺口最小化。\n\n####面向总需求冲击的反应\n\n##### 无政策反应\n\n- 通货膨胀率下降\n\n##### 短期内稳定经济活动和通货膨胀的政策\n\n- 实施自主性宽松货币政策，降低任意通货膨胀率对应的实际利率水平，刺激投资支出，增加总需求。\n- 在总需求冲击的情况下，不需要在物价稳定和经济活动稳定这两个目标间进行权衡。\n\n#### 面对持续性供给冲击的反应\n\n##### 无政策反应\n\n- 通货膨胀率上升\n\n##### 稳定通货膨胀的政策\n\n- 通过减少总需求，可以实现通货膨胀稳定。\n- 实施自主性紧缩货币政策，提高任意通货膨胀率对应的实际利率，从而导致投资支出减少。\n- 不需要在物价稳定和经济活动稳定这两个目标间进行权衡。\n\n#### 面对暂时性供给冲击的反应\n\n##### 无政策反应\n\n- 不进行任何调整，随着时间的推移，通货膨胀和经济活动会趋于稳定。但在较长的周期内，经济会承受低产出和高失业的痛苦。\n\n##### 短期内稳定通货膨胀的政策\n\n##### 短期内稳定经济活动的政策\n\n- 面对暂时性供给冲击时，稳定经济活动的政策不能稳定通货膨胀。\n\n### 通货膨胀型货币政策的起因\n\n#### 高就业率目标与通货膨胀\n\n- 成本推进型通货膨胀\n  - 暂时性负面攻击冲击，或者工人要求的工资增长幅度超过了产出增长率。\n- 需求拉动型通货膨胀\n  - 政府实施增加总需求的政策。\n\n### 零利率下限的货币政策\n\n- 零利率下限情况下，MP曲线向下倾斜，总需求曲线是向上倾斜的。\n- 零利率下限情况下自我纠错机制失效。经济进入螺旋式下降。\n- $Y\u003cY^P\\Rightarrow \\pi\\downarrow\\Rightarrow r\\uparrow\\Rightarrow Y\\downarrow \\Rightarrow Y\u003c\u003cY^P\\Rightarrow\\pi\\downarrow\\Rightarrow r\\uparrow\\Rightarrow Y\\downarrow$\n- 货币当局为促进产出和提高通货膨胀率，不得不求助于三种类型的非常规货币政策：提供流动性、购买资产（量化宽松）、预期管理。\n\n## 第二十四章  理性预期对于货币政策的意义（TODO）\n\n\n\n## 第二十五章 货币政策的传导机制\n\n### 货币政策传导机制\n\n#### 传统的利率传导途径\n\n- 认为宽松性货币政策导致了实际利率水平的下降，这会降低筹资成本，进而引起投资支出（也包括对住宅和耐用消费品的支出）的增加，最终导致总需求的上升。\n- 强调影响消费者和企业决策的是实际利率而非名义利率。\n- 当名义利率触及零下限时，承诺实施扩张性货币政策，会提高预期通货膨胀率，降低实际利率，刺激支出。\n\n#### 其他资产价格途径\n\n- 传统理论的缺点在于，仅仅关注利率一种资产价格形式，忽略了其他众多资产的价格。\n\n##### 汇率水平对于净出口的作用\n\n- $r\\downarrow\\Rightarrow E\\downarrow\\Rightarrow NX\\uparrow\\Rightarrow Y^{ad}\\uparrow$\n- $E$是美元，国内实际利率水平的下降降低了国内美元资产相对于外币资产的吸引力。美元贬值，净出口增加，总需求增加。\n\n##### 托宾q理论\n\n- 托宾将$q$定义为企业的市场价值与资本重置成本之比。$q$值高，说明企业的市场价值相对于其资本重置成本较高，新的厂房和设备相对于企业的市价就会更便宜，公司就会发行股票。由于企业发行少量的股票就可以购买到大量的资本品，因此企业的投资支出将会增加。\n- 债券的实际利率下降，股票更具吸引力，价格升高。\n- $r\\downarrow\\Rightarrow P_s\\uparrow\\Rightarrow q\\uparrow\\Rightarrow I\\uparrow\\Rightarrow Y^{ad}\\uparrow$\n\n##### 财富效应\n\n- $r\\downarrow\\Rightarrow P_s\\uparrow\\Rightarrow wealth\\uparrow\\Rightarrow consumption\\uparrow\\Rightarrow Y^{ad}\\uparrow$\n\n#### 信用途径观点\n\n认为信用市场的金融脆弱性问题会导致两类货币政策传导途径，一类是通过影响银行的放贷行为发挥作用，另一类通过影响企业和消费者的资产负债表发挥作用。\n\n##### 银行贷款途径\n\n- 扩张性货币政策使银行准备金增加，银行存款增加，银行贷款增加，投资和总需求增加。\n\n##### 资产负债表途径\n\n- 宽松性货币政策导致股价升高，企业净值上升，由于逆向选择和道德风险问题得以缓解，投资和总需求增加。\n\n##### 现金流途径\n\n- 宽松性货币政策使名义利率下降，现金流增加，逆向选择和道德风险下降，贷款增加，投资和总需求增加。\n\n##### 意料之外的物价水平途径\n\n##### 对家庭流动性的影响\n\n##### 信用途径的重要性\n\n- 信用市场的金融脆弱性会影响企业雇用员工以及支出等方面的决策。\n- 小规模的企业比大企业更容易受到货币紧缩政策的影响。\n- 信用途径的核心是信息不对称造成的金融脆弱性。\n\n### 对货币政策的启示\n\n- 把货币政策的松紧简单同短期名义利率水平的升降联系起来通常是十分危险的。\n- 短期债务工具等其他资产价格中包含着货币政策动向的重要信息。\n- 即使短期利率水平几乎为零，货币政策也可以对疲软的经济产生有效的刺激作用。\n- 保持物价水平稳定应当是货币政策的首要长期目标。",title:"Untitled Page"},"/Published/金融市场与金融机构":{content:"[金融市场与金融机构(第2版)/曹凤岐、贾春新](https://book.douban.com/subject/26046346/)读书笔记\n\n---\n\n## 第一章 导论\n\n### 第一节 为什么要研究金融市场与金融机构\n\n### 第二节 金融资产\n\n#### 一、资产与金融资产\n\n- \u003cu\u003e有形资产\u003c/u\u003e：土地、房屋\n  - 可再生\u0026不可再生\n- \u003cu\u003e无形资产\u003c/u\u003e：对某种未来收益的合法要求权\n  - 金融资产是无形资产的一种，是由\u003cu\u003e货币的贷放\u003c/u\u003e而产生的，通常以\u003cu\u003e凭证、收据或者其他法律文件\u003c/u\u003e来表示\n\n#### 二、金融资产的估价\n\n- 估计现金流并贴现\n- 如果市场是有效的，金融资产的价格应该已经反映了所有的相关信息\n\n#### 三、金融资产的性质\n\n- \u003cu\u003e货币性\u003c/u\u003e\n  - 货币：现金、支票存款等\n  - 准货币：国库券、储蓄存款、定期存款\n- \u003cu\u003e可分性\u003c/u\u003e\n- \u003cu\u003e可逆性\u003c/u\u003e：指投资者在购买金融资产后将其转手换回现金\n  - 又称为返回成本（round-trip cost）。\n  - 对银行存款而言，这一成本很低；对二级市场交易的金融资产，在存在做市商制度的情况下，其返回成本包括买卖价差（bid-ask spread）、佣金、税收以及皮鞋成本等。\n- \u003cu\u003e到期期限\u003c/u\u003e\n- \u003cu\u003e流动性\u003c/u\u003e\n- \u003cu\u003e可转换性\u003c/u\u003e\n- \u003cu\u003e币种\u003c/u\u003e\n- \u003cu\u003e现金流入和收益的可预测性\u003c/u\u003e\n- \u003cu\u003e复合性\u003c/u\u003e\n- \u003cu\u003e税务状况\u003c/u\u003e\n\n#### 四、金融资产的作用\n\n- \u003cu\u003e调配资源\u003c/u\u003e\n- \u003cu\u003e转移或减少风险\u003c/u\u003e\n- \u003cu\u003e国家宏观经济调控\u003c/u\u003e的工具\n\n### 第三节 金融市场\n\n#### 一、金融市场的分类\n\n- 按交易工具分：\n  - 债权市场\u0026股票市场\n  - 交易债务工具和优先股的市场统称为固定收入市场，不包括优先股的市场称为普通股市场\n- 按期限划分：\n  - \u003cu\u003e一年和一年以下的短期金融市场\u003c/u\u003e称为货币市场\n  - 一年以上的长期金融市场称为资本市场\n- 按照金融资产进入市场的时间划分：\n  - 发行金融资产的市场称为一级市场\n  - 在投资者之间进行交易的市场称为二级市场\n- 按交易方式：\n  - 场内交易市场和场外交易市场\n    - 中国现在的\u003cu\u003e场内股权交易市场\u003c/u\u003e是上海证券交易所市场和深圳证券交易所市场\n    - \u003cu\u003e银行间债券市场\u003c/u\u003e是中国目前最大的场外交易市场\n- 按交易对象：\n  - 主板市场：属于针对大型成熟公司的股票市场\n  - 二板市场：面向中小公司的市场\n\n#### 二、金融市场的功能\n\n- \u003cu\u003e创造与交易金融资产\u003c/u\u003e\n- \u003cu\u003e价格发现\u003c/u\u003e\n- \u003cu\u003e降低搜寻成本和信息成本\u003c/u\u003e\n- \u003cu\u003e储蓄\u003c/u\u003e功能\n- \u003cu\u003e财富\u003c/u\u003e功能\n- \u003cu\u003e信贷\u003c/u\u003e功能\n- \u003cu\u003e支付\u003c/u\u003e功能\n- \u003cu\u003e风险\u003c/u\u003e功能\n- \u003cu\u003e政策\u003c/u\u003e功能\n\n#### 三、盈余与赤字\n\n$R-E=\\triangle FA-\\triangle D$\n\n$R$代表当前收入，$E$代表当前支出，$\\triangle FA$代表持有的金融资产的变化，$D$代表未付债务与股权的变化。\n\n- 赤字预算单位：企业和政府部门一般属于这类\n- 盈余预算单位：居民家庭部门一般属于这类\n- 平衡预算单位\n\n#### 四、金融交易的发展\n\n- 直接融资：资金从贷出者直接流向借入者\n  - 例如企业直接面向投资者发行股票、债券，居民之间相互借贷，立字为证（IOU）\n  - 缺点：\n    - \u003cu\u003e要求借贷双方在金融交易的数量上必须一致\u003c/u\u003e\n    - 借款人风险很大，期限长又\u003cu\u003e缺乏流动性\u003c/u\u003e\n    - 在寻找对方时必须付出较高的\u003cu\u003e交易成本\u003c/u\u003e\n  - 直接融资中的金融要求权被称为初级证券\n- 半直接融资：通过\u003cu\u003e经纪人和交易商\u003c/u\u003e进行\n  - 经纪人负责提供买卖的信息，交易商以自己的资金买卖证券\n- 间接融资：以金融机构为媒介，实现资金从贷出者向借入者转移的融资方式\n  - \u003cu\u003e金融中介机构将资金提供给最终借款人\u003c/u\u003e：创造初级证券；\u003cu\u003e金融机构还创造出了对自己的金融要求权\u003c/u\u003e：创造次级证券\n  - 银行以吸收存款的方式获得资金，再以发放贷款的方式提供资金给企业\n  - 间接融资由于同时创造了初级与次级证券，所以创造出的金融资产的数量是直接融资时的\u003cu\u003e二倍\u003c/u\u003e\n\n#### 五、脱媒\n\n- 脱媒（金融的非中介化、市场中介化）：资金融通由间接融资走向直接融资\n  - 西方于20世纪70年代脱媒：因为市场利率的上升和金融中介受到的利率管制。垃圾债券、商业票据市场的发展使得借款人减少了对银行的依赖\n    - \u003cu\u003eRegulation Q\u003c/u\u003e：美国商业银行的活期存款利率为0，实行定期存款的利率最高限\n    - 50年代后，美国的\u003cu\u003e通货膨胀\u003c/u\u003e逐渐严重。名义利率由于条例要求不能改变，通货膨胀不断上升后，实际利率就逐渐变为负利率。\n    - 投资人将银行存款取出，直接去购买其他债券\n  - 近年来，资产证券化过程中，一些金融机构主动出售了他们的贷款，一些企业通过证券化而不是银行筹措资金。\n    - 窗口指导：是指央行通过劝告和建议来影响商业银行信贷行为，属于温和的、非强制性的货币政策工具。是一种劝谕式监管手段，指监管机构向金融机构解释说明相关政策意图，提出指导性意见，或者根据监管信息向金融机构提示风险。\n    - 我国严格的金融管制导致金融脱媒（银行的贷款不能超过存款的75%）。\n    - 表外业务受到的管制比较小，于是银行将表内业务移动到表外，产生各种银行理财产品\n    - 我国政府态度：反对——默许——公开鼓励（“增加直接融资比例，降低间接融资比例”）\n\n#### 六、金融市场的全球化\n\n原因：\n\n- 世界范围内的\u003cu\u003e金融自由化浪潮\u003c/u\u003e：对金融市场的管制不断放松\n- \u003cu\u003e信息技术的进步\u003c/u\u003e：使得金融企业和其他投资者能够更加迅速地获得信息，有效处理信息和远距离调动资金\n- \u003cu\u003e金融市场的机构化（institutionalization）\u003c/u\u003e：从散户（retail investor）到机构投资者（institutional investor）的过渡\n\n金融市场的分类：\n\n- \u003cu\u003e内部市场（本国市场）\u003c/u\u003e：\n  - 国内市场：本国发行人发行的证券\n  - 外国市场：外国发行人在本国发行的证券\n- \u003cu\u003e外部市场（国际市场、离岸市场、欧洲市场）\u003c/u\u003e：同时在许多国家发行而且不受任何一国法令制约的市场\n\n### 第四节 金融机构与金融监管\n\n#### 一、金融市场的参加者\n\n\u003cu\u003e政府部门\u003c/u\u003e\n\n\u003cu\u003e国际机构\u003c/u\u003e：世界银行、亚洲开发银行\n\n\u003cu\u003e居民家庭\u003c/u\u003e\n\n\u003cu\u003e非金融企业\u003c/u\u003e\n\n\u003cu\u003e金融机构\u003c/u\u003e\n\n- \u003cu\u003e资产转换\u003c/u\u003e：将最终借款者的债务转换成更容易为投资者所接受的资产，形成自己的负债\n- \u003cu\u003e代理业务\u003c/u\u003e，代客户买卖金融资产\n- \u003cu\u003e自营业务\u003c/u\u003e，为自己的账户买卖金融资产\n- \u003cu\u003e发行业务\u003c/u\u003e，协助发行人创造金融资产并销售\n- 为客户提供\u003cu\u003e投资咨询\u003c/u\u003e\n- \u003cu\u003e管理其他市场参与者的投资组合\u003c/u\u003e\n\n#### 二、金融机构\n\n##### 金融机构的功能和作用\n\n- \u003cu\u003e提供期限中介\u003c/u\u003e\n- \u003cu\u003e分散和降低风险\u003c/u\u003e\n- \u003cu\u003e降低订立合同和处理信息的成本\u003c/u\u003e：防止逆向选择和道德风险（规模经济）\n- \u003cu\u003e提供支付机制\u003c/u\u003e：信用卡等\n\n##### 存款性金融机构\n\n- 商业银行\n- 储蓄机构\n- 信用合作社\n\n##### 非存款性金融机构\n\n- 保险公司\n- 养老基金\n- 投资基金\n- 投资银行\n\n#### 三、金融机构的资产和负债\n\n##### 金融机构的负债\n\n- 负债是指必须在一定时间支出的满足债务合同条款的现金\n  - 现金支付的时间和数量都是确定的：银行存款\n  - 数量确定时间不确定：人寿保单\n  - 时间确定数量不确定：银行发行的可变利率存单\n  - 数量和时间均不确定：财产保险公司的家庭财产保单\n\n##### 金融机构的资产\n\n![1551666826387](C:\\Users\\Ada\\AppData\\Roaming\\Typora\\typora-user-images\\1551666826387.png)\n\n#### 四、金融市场监管\n\n- \u003cu\u003e信息披露\u003c/u\u003e监管：委托代理问题；美国的1933年证券法和1934年证券交易法\n- \u003cu\u003e金融活动\u003c/u\u003e监管：管理者、从业人员可能拥有更多的信息，对他们的交易活动必须加以限制\n- \u003cu\u003e金融机构\u003c/u\u003e监管：对金融机构的资产、负债业务以及资本金进行限制\n- \u003cu\u003e对外国参与者的管理\u003c/u\u003e：A股和B股划分、QFII制度\n\n## 第二章 存款性金融机构\n\n### 第一节 存款性金融机构概述\n\n#### 一、存款性金融机构的特征\n\n- 存款性金融机构是以存款为重要基金来源的金融机构\n- 收入来自于：\u003cu\u003e贷款、投资、收取费用\u003c/u\u003e\n- \u003cu\u003e赚取资产收入和资金成本的差额，称为差额收入（spread income）或利差（margin）\u003c/u\u003e\n- \u003cu\u003e中间业务收入\u003c/u\u003e\n- 风险：\n  - \u003cu\u003e违约风险\u003c/u\u003e\n  - \u003cu\u003e监管风险\u003c/u\u003e\n  - 融资风险（利率风险）\n  - \u003cu\u003e操作风险\u003c/u\u003e\n  - \u003cu\u003e流动性风险\u003c/u\u003e\n  - \u003cu\u003e市场风险\u003c/u\u003e\n\n#### 二、储蓄贷款协会\n\n#### 三、互助储蓄银行\n\n#### 四、信用合作社\n\n### 第二节 商业银行的主要业务\n\n#### 一、商业银行的基本业务\n\n- 银行通过出售一种具有一定流动性、风险和回报特点的资产，再购买另一种具有一定流动性、风险和回报特点的资产，并获得利润的过程称为资产转换\n\n#### 二、商业银行的负债业务\n\n##### 1.存款\n\n- \u003cu\u003e支票存款（活期存款）\u003c/u\u003e\n  - 百分之百流动性\n  - 持有者持有金融资产后，有权向第三方签发支票，用于购买商品劳务和支付债务\n  - NOW（negotiable order of withdrawal）账户：含有利率、流动性百分之百\n  - 中国在2003年9月才把个人结算账户和活期储蓄区别开来\n- \u003cu\u003e定期存款和储蓄存款\u003c/u\u003e\n  - 定期储蓄是中国居民家庭和非营利组织存入的定期存款\n  - 定期存款的概念则专门指\u003cu\u003e企业\u003c/u\u003e的定期存款\n    - 公款私存：一些储蓄存款是企业以个人名义存入的，目的是逃避财务监督和赚取利息收入中饱私囊\n    - 私款公存：1999年11月开始征收利息所得税，由于对公存款不征收利息税，所以逃避税收储蓄存款开始以企业的名义存入\n  - 美国的定期存款概念对应的是中国的定期存款和定期储蓄两者的总和\n  - ATS（automatic transfer service）account：作为传统活期存款账户基础上诞生的一种新型账户，可以使客户兼得活期账户和储蓄账户的双重优点，即一方面可以利用活期账户开支票对外支付；另一方面又可以利用储蓄账户获取利息收入。\n- \u003cu\u003e货币市场存款账户（MMDA）\u003c/u\u003e\n  - 没有到期日，投资者有有限的开出支票的权利，类似于货币市场共同基金，为了应对Q条例才被创造出来\n- 同业存单\n  - 利率市场化\n\n##### 2.借款\n\n- \u003cu\u003e中央银行借款\u003c/u\u003e\n  - \u003cu\u003e再贴现\u003c/u\u003e：商业银行把各种合格证券卖给中央银行\n    - 美国银行较少使用再贴现窗口：不愿意美联储对其进行调查和监管\n  - \u003cu\u003e再贷款\u003c/u\u003e：信用放款/有抵押的放款\n- \u003cu\u003e同业拆借\u003c/u\u003e\n  - 星期三：Federal Funds Rate\n- \u003cu\u003e证券回购协议\u003c/u\u003e\n  - 银行向其他机构的借款\n- \u003cu\u003e商业票据发行\u003c/u\u003e\n  - 短期融资券：直接融资方式，将银行和市场联系起来，银行依赖短期融资工具可能使得银行非常脆弱\n- 国际金融市场借款\n- 结算过程中的资金占用\n  - 从汇款汇出到收款人收款，会有一个时间间隔\n  - 在这一过程中，资金既不属于付款人，也不属于收款人，从而成为银行的资金来源\n- 发行金融债券（可以作为长期资金来源）\n\n##### 3.银行的自有资本\n\n- 银行的净值，等于资产总额与负债总额之差\n- 贷款损失准备金：由银行根据预计的资产损失从收入中提前提取\n  - 尽早处理坏账、减少税款缴纳\n\n#### 三、商业银行的资产业务\n\n##### 1.现金类资产\n\n- 准备金\n  - 法定存款准备率+超额准备率=准备率\n- 应收现金\n- 同业存款\n\n##### 2.贷款\n\n- \u003cu\u003e交易型贷款\u003c/u\u003e\n  - 基于银行相对容易取得的“硬”信息，例如企业的财务状况、抵押资产的价值，这些信息便于书面表述和传递，而不是基于通过长期银企关系才能取得的“软”信息。\n- \u003cu\u003e关系型贷款（小企业）\u003c/u\u003e\n  - 基于中小企业的“软信息”，例如企业主的个人品德和员工的工作满意度等，这些信息难以通过书面文字表达，企业与贷款者建立一种稳定关系，并倾向于与贷款者进行较长期的合作\n\n- 按有无抵押分：\n  - \u003cu\u003e抵押贷款\u003c/u\u003e\n  - \u003cu\u003e信用贷款\u003c/u\u003e\n- 按贷款对象分：\n  - 工商贷款\n  - 农业贷款\n  - 消费者贷款\n  - 不动产贷款\n  - 同业放款\n- 按还款方式：\n  - 一次偿还\n  - 分期偿还\n    - 消费者贷款\n    - 不动产贷款\n\n##### 3.证券投资\n\n- 商业银行通过购买并持有证券也可以获得利息收入，除了可以增加收益外，也可以增加流动性：\u003cu\u003e国库券等流动性强的金融工具\u003c/u\u003e可以在支付不足时迅速转化为现金，被称为二线准备金\n\n- 在中国法律规定禁止银行持有股票\n\n##### 4.其他资产\n\n- 银行的房地产、设备等\n\n#### 四、商业银行的中间业务\n\n- 中间业务：\u003cu\u003e影响商业银行的利润，但并不反映在银行的资产负债表上的业务\u003c/u\u003e\n- 转账结算：对商品、劳务交换所产生的债权债务进行清偿\n- 承兑业务：票据承兑\n- 信用证业务：银行的一种付款承诺\n- 银行保函：作为担保人向受益人开出的书面保证文件\n- 代理业务\n- 经济信息咨询业务\n- 租赁业务\n- 贷款承诺\n  - 信贷额度\n  - 循环贷款承诺\n  - 票据发行便利\n- 贷款销售\n- 衍生产品服务\n- 信托服务\n\n#### 五、中国商业银行的不良资产问题\n\n- 标准普尔2003年对内地银行体系的不良资产比例估值为45%\n- 拨备覆盖率=贷款损失减值准备金余额/不良贷款余额\n- 历史上不良资产的处置：\n  - 资产管理公司\n  - \u003cu\u003e债转股、拍卖、ABS\u003c/u\u003e\n    - 银行将债券卖给资产管理公司，使资产管理公司成为暂时的债权人，再由暂时的债权人变成企业的所有人\n  - \u003cu\u003e政府注资，提取贷款损失准备金\u003c/u\u003e\n  - 银行内部处置\n  - 加大贷款总量、扩大分母、进行稀释\n\n### 第三节 商业银行的发展与结构\n\n#### 一、西方国家商业银行的产生与发展\n\n- 1580年成立的威尼斯银行是第一家以银行命名的金融机构\n- 现代银行的产生：\n  - 新组建股份制银行的方式\n  - 由旧的高利贷性质的银行转变为现代银行\n\n#### 二、中国商业银行的产生与发展\n\n- 1845年，英资银行丽如银行：第一家新式银行\n- 1897年，中国通商银行：第一家中资银行\n- 1949年建国后：\n  - 没收、改造、合并、新建：建立了银行体系\n- 1956-1978：\n  - 只有中国人民银行，大一统的金融体制\n  - 按照行政区划设置，禁止其他金融机构的活动与商业信用\n  - 既负责金融管理，又办理具体的金融业务\n  - 中国人民银行负责对企业的开户、结算、现金出纳进行监督\n  - 内部实行严格的计划管理\n- 1979年后：\n  - 中国人民银行的国外业务部独立出来，组成中国银行，也称为外汇管理局；后来外汇管理局又并入中国人民银行，中国银行成为专业的外汇外贸银行\n  - 分设出中国农业银行\n  - 设立了中国人民建设银行\n- 1986年后：\n  - 交通银行的建立，开了组建新的股份制银行的先河\n- 2000年：\n  - 银行上市\n\n#### 三、商业银行的结构\n\n- 总分行制\n  - 优点：规模效应、分散风险\n  - 缺点：垄断、周转不灵、难以监管、利润也可能会受到外地经济状况的影响\n- 单一银行制\n  - 优点：为客户提供个性化服务\n  - 银行建立持股公司以持有多家银行的股权、电子银行设施的发展\n- 向总分行制发展的原因：\n  - 客户从城市向郊区的流动\n  - 银行的倒闭与收购\n  - 企业贷款需求的成长、小银行无法满足\n\n#### 四、银行合并现象\n\n- \u003cu\u003e规模经济\u003c/u\u003e\n- \u003cu\u003e资产多元化与分散风险\u003c/u\u003e\n- \u003cu\u003e高层经营者的利益\u003c/u\u003e\n- \u003cu\u003e垄断价格\u003c/u\u003e\n\n银行业务国际化\n\n- 一些国家国外银行数目剧增\n- 一些国家商业银行跨国经营机构越来越多\n- 一些国家的外国银行资产占所在国银行总资产的比重不断上升\n- 国际融资由银行贷款向证券发行方向转化\n- 商业银行已经成为国际债券的重要发行者和持有者\n\n#### 五、金融创新\n\n- 金融工具多样化\n- 金融机构业务交叉\n- 促进了金融机构和组织的发展\n- 推动金融制度的进一步放宽\n\n## 第三章非存款性金融机构\n\n### 第一节非存款性金融机构概述\n\n#### 一、非存款性金融机构的性质及种类\n\n- 主要不以吸收存款为资金来源，而从事投资和其他金融服务的金融机构。\n- \u003cu\u003e契约性机构\u003c/u\u003e：这类机构主要是\u003cu\u003e保险公司和养老保险机构\u003c/u\u003e等。它们根据合同来收取一定的费用或资金，用于金融服务和投资。 \n- \u003cu\u003e投资中介机构\u003c/u\u003e：这类机构主要以\u003cu\u003e收取佣金和手续费为收入来源，也通过投资的方式获得收入\u003c/u\u003e，包括投资银行(证券公司)、财务公司、投资公司、信托公司、租赁公司、金融公司等。\n\n#### 二、保险公司\n\n- 防范逆向选择\n  - \u003cu\u003e筛选\u003c/u\u003e\n  - \u003cu\u003e根据风险确定保险费\u003c/u\u003e\n- 防止道德风险\n  - \u003cu\u003e限制性条款\u003c/u\u003e\n  - \u003cu\u003e注销保险\u003c/u\u003e\n  - \u003cu\u003e免赔额与联合保险。\u003c/u\u003e在保险契约中应该规定，如果损失发生了，保险公司并不会负责承担全部损失，而是只负责其中的一部分，另一部分要由投保人自己承担。这可以从利益角度限制保险金额\n- 保险公司的收入包括\u003cu\u003e保费收入和投资收入\u003c/u\u003e，支出包括\u003cu\u003e对保单的理赔支出和保险公司的运营费用\u003c/u\u003e。两者的差额就是保险公司的利润。\n\n#### 三、养老保险机构\n\n- 是商业保险和社会保障相结合的体制\n\n#### 四、金融公司（财务公司）\n\n##### 1.销售金融公司\n\n- 销售金融公司(sales finance companies)为消费者在特定的销售者那里购货进行融资。这种金融公司使得消费者可以在购货地得到便捷的信贷服务。\n- 优点在于，它可以\u003cu\u003e把制造与零售活动和融资活动分离开来。\u003c/u\u003e\n- 与商业银行不同，金融公司没有法定准备要求。\n\n##### 2.消费者金融公司\n\n- 消费者金融公司(consumer finance companies)：为消费者提供贷款，为消费者\u003cu\u003e购买家具、装修住房、偿付债务融通资金\u003c/u\u003e。这类公司有些是独立的，有些是附属于银行的，贷款规模一般小于销售金融公司。\n\n##### 3.工商金融公司\n\n- 工商金融公司(commercial finance companies)是直接向\u003cu\u003e工商企业\u003c/u\u003e提供融资服务的金融公司。融资方式可能是贷款，也可能是代理收款、设备租赁等。\n\n#####风险\n\n- 流动性风险利率风险和信用风险\n- 由于金融公司的资产大部分是各种贷款，因此信用风险较为严重。\n\n#### 五、政策性银行\n\n- 政策性银行一般是由政府投资创办的金融机构，要按照政府的意图与计划从事信贷活动。政策性银行与财政不同，它发放的贷款是必须偿还的，银行经营要坚持保本微利的原则。\n- 实现专业银行的商业化经营，割断政策性业务与基础货币的联系\n- \u003cu\u003e国家开发银行\u003c/u\u003e负责承接中国建设银行原来的政策性业务，筹集和引导社会资金用于国家重点建设项目和基础产业。\n- \u003cu\u003e中国进出口银行\u003c/u\u003e负责承担中国银行原来的政策性业务，为进出口提供政策性金融支持。\n- \u003cu\u003e中国农业发展银行\u003c/u\u003e负责中国农业银行原来的政策性业务，为农业基建、重点工程、农副产品流通提供政策性金融服务。 \n- 政策性银行的资金来源主要有三方面：\u003cu\u003e财政拨付、中央银行再贷款、发行金融债券筹集资金。\u003c/u\u003e\n\n### 第二节 投资基金\n\n#### 一、投资基金的形式\n\n##### 1.开放式基金\n\n- 基金发起设立后，可以随时向公众卖出基金股份，并承诺投资者可以随时将基金售回给公司。\n- 申购价格为\u003cu\u003e基金的每股净资产值加上买入佣金\u003c/u\u003e\n\n##### 2.封闭式基金\n\n- 封闭式基金的发行数额是固定的，这种基金并不给投资者\u003cu\u003e赎回基金\u003c/u\u003e的权利。\n- 基金的流动性体现在二级市场的交易上，投资者可以在二级市场上买卖封闭式基金，但基金公司本身不参加交易。\n- 折价交易的原因：\n  - \u003cu\u003e可能与投资者情绪有关。\u003c/u\u003e\n  - \u003cu\u003eNAV没有经过税收调整\u003c/u\u003e\n  - \u003cu\u003e封闭式基金的规模是固定的，所以基金设立后，一般不需要大量做广告宣传\u003c/u\u003e\n  - \u003cu\u003e证券难以估价，因而会导致基金的折价交易\u003c/u\u003e\n  - 封闭式基金由于额度固定，需要依赖于融资。\n  - 基金的杠杆率和风险也是决定折价率的重要因素。\n- 因为存在折价交易的问题，封闭式基金的流动性比开放式基金差。\n- 封闭式基金一般是溢价发行，溢价部分也就是发行成本，是由最初的购买者承担的。\n- 开放式基金的缺点：\n  - 为了应付客户赎回，开放式基金必须\u003cu\u003e保存更多的现金资产\u003c/u\u003e，因而成本较高\n  - 封闭式基金在二级市场买卖，手续费较低。\n\n##### 3.单位信托\n\n- 在美国，单位信托只发行固定数目的份额，称为单位凭证，这一点和封闭式基金相同。但它们是由发行公司负责投资者的申购和赎回，这点又和开放式基金一样。\n\n#### 二、基金的结构和收支\n\n#### 三、基金的投资策略\n\n- 成长型基金注重投资于有增值潜力的股票，相应的风险较大。基金追求的是发现被错误定价的股票。\n- 收入型基金注重当前收入，往往投资于高红利的股票和高利息的债券。\n- 股票基金专门投资于股权，债券基金专门投资于债券。\n\n#### 四、交易所交易基金\n\n- 开放式基金的交易存在明显缺点。\n  - \u003cu\u003e基金的申购和赎回都要依赖于基金净资产，而净资产的确定依赖于基金持有资产的收盘价。这样，基金每天只能有一个价格，而没有不同交易时点的变化。\u003c/u\u003e\n  - \u003cu\u003e如果投资者赎回基金，基金由于卖出资产，实现资本利得，必须缴纳资本利得税。\u003c/u\u003e\n- 封闭式基金交易价格可能与基金净资产不同，形成折价或溢价交易。 \n\n#### 五、投资基金的监管 \n\n### 第三节中国的投资基金\n\n#### 一、投资基金的折价交易\n\n- \u003cu\u003e中国的证券市场不规范，投机气氛很浓，投资者热衷于短线操作。\u003c/u\u003e\n- \u003cu\u003e投资基金规模不断扩大，各家基金的市场定位趋同，投资组合雷同，不像西方有多种不同的基金种类，使得市场供给相对偏多。\u003c/u\u003e\n- \u003cu\u003e我国的投资基金往往重仓持有许多股票，成为市场上的庄家，这就形成了流动性风险。因为基金如果抛售这些证券，必然会付出大量的市场执行成本。因而基金的净资产中含有一定的泡沫。\u003c/u\u003e\n\n####  二、货币市场共同基金问题\n\n- 银行纷纷推出类似货币市场基金的信托产品。2005年，商业银行终于获准组建基金公司。\n\n#### 三、开放式基金\n\n#### 四、契约型基金\n\n- 委托人、信托人和受益人三方共同组成。\n- \u003cu\u003e委托人即基金的管理人，受托人在中国由商业银行担任，负责信托财产的保管。受益人即基金的持有者\u003c/u\u003e\n- 契约型基金与公司型基金的差别主要有： \n  - \u003cu\u003e法人资格不同\u003c/u\u003e。公司型基金具有法人资格，而契约型基金没有法人资格。相应地，在信托财产的运用上，公司型基金的依据是公司章程，契约型基金的依据是信托契约。\n  - \u003cu\u003e发行的融资工具不同\u003c/u\u003e。公司型基金可以发行股票、债券、认股权证等，契约型基金只能发行受益凭证。\n  - \u003cu\u003e投资者的地位不同\u003c/u\u003e。公司型基金的投资者是股东，享有公司法赋予的权利。契约型基金的投资者仅仅是基金的受益人。 \n\n#### 五、指数基金和ETF\n\n#### 六、机构投资者的发展\n\n- 基金业的价格操纵问题\n- 基金业的内幕交易\n-  “老鼠仓”问题\n- 利用优势，基金还可以选择投机\n- 中国的上市公司一股独大现象严重，基金难以进行有效的监督。\n\n#### 七、基金法的修订\n\n### 第四节投资银行\n\n#### 一、投资银行的主要业务\n\n##### 1.发行业务\n\n- 在承销中，投资银行挣得买入与卖出证券的价格差，称为利差(gross spread)或承销折扣(underwriting discount)。由于承销存在很大的风险，所以投资银行往往组织承销团进行承销\n\n#####  2.证券交易\n\n- 做市活动的收入包括证券的买卖价差与持有证券的资本利得。\n\n##### 3.证券私募\n\n- 投资银行在私募市场上为发行人和潜在投资者设计新的证券并为之定价，再努力将证券销售出去。在证券私募(private placement of securities)过程中，投资银行往往会担任顾问的角色。\n\n##### 4.资产证券化\n\n##### 5.收购与兼并\n\n- 投资银行为收购公司提供资金支持时，有不同的方法。一是向收购方提供过桥贷款，二是为收购方承销股票或债券，三是直接持有目标公司的股权。\n\n##### 6.商人银行业务\n\n- 投资银行运用自有资金对公司进行股权或债权投资\n- 股权投资是希望获得资本利得；债权投资主要是指为客户提供过桥贷款\n\n##### 7.衍生工具业务\n\n##### 8.资金管理\n\n#### 二、投资银行业的监管\n\n#### 三、投资银行业的风险\n\n- \u003cu\u003e市场风险\u003c/u\u003e\n  - 投资银行的许多业务收入与市场状况密切相关。当股市向好时，投资银行的自营、经纪和并购等业务都会增加收入；反之，股市低迷时，投资银行的许多收入都会下降。\n- \u003cu\u003e利率\u003c/u\u003e\n  - 风险利率的波动会影响投资银行持有的股票特别是债券的价格。利率的波动，也会引起投资者资产选择的变化，从而影响投资银行经纪业务的收入。 \n- \u003cu\u003e信用风险投资\u003c/u\u003e\n  - 银行的过桥贷款等业务存在较强的信用风险。\n- \u003cu\u003e流动性风险\u003c/u\u003e\n  - 当投资银行大量依赖短期商业票据融资时，这一风险尤为严重。\n\n#### 四、投资银行业的结构\n\n- 大额认购公司(bulge bracket firms)是在规模、声誉、客户基础等方面最好的投资银行。\n- 主要认购公司(major bracket firms)的地位仅次于前者，但也提供全面的投资银行服务。\n- 次级认购公司(submajor bracket firms)为特殊的投资者群体和小公司服务。\n- 专营公司(boutiques)专营某一项主要的投资银行业务。如区域公司主要是为本地区的地方政府和公司服务。研究公司专门提供研究服务。商人银行进行并购与融资业务。有些公司专门负责高科技企业的证券发行等。\n\n### 第五节中国的投资银行\n\n#### 一、中国证券经营机构的组成\n\n- 券商，即证券公司。根据《证券法》的规定，券商分为综合类券商和经纪类券商。\n- 中外合资的投资银行\n- 国债一级自营商\n- 企业集团财务公司\n\n#### 二、中国证券经营机构的业务现状\n\n- 业务品种与结构单一、雷同\n- 在业务结构上，证券发行、自营和经纪业务是中国券商的三项主要业务。\n\n#### 三、中国券商的融资问题\n\n- 中国券商的融资渠道主要有：银行同业拆借与国债回购、股票质押贷款等。\n- 由于融资狭窄，券商不得不采取各种变相、非规范的融资渠道，实际生活中经常出现的方式有：挪用客户保证金、变相吸收个人和公司的存款、绕过中央银行变相和私下违规发行金融债券、以各种违规方式利用银行信贷资金等。\n\n\n\n## 第四章 中央银行\n\n### 第一节 中央银行的职能与类型\n\n#### 一、中央银行的产生\n\n#### 二、中央银行的职能\n\n##### 1.中央银行是发行银行\n\n由于每一家商业银行的信誉都是有限的，因此也限制了银行券的广泛流通。由中央银行垄断货币发行权，就可以解决这样的问题，为经济发展提供一个稳定的货币环境。\n\n##### 2.中央银行是银行的银行\n\n- \u003cu\u003e中央银行集中商业银行的存款准备\u003c/u\u003e\n- \u003cu\u003e作为商业银行的最后贷款人\u003c/u\u003e\n- \u003cu\u003e票据结算中心\u003c/u\u003e\n  - 各家商业银行一般都在中央银行开立存款账户\n  - 需要将A银行在中央银行的存款账户上的资金划转到B银行的户头上。这可以看作是中央银行的一种中间业务。\n\n##### 3.中央银行是政府的银行\n\n- \u003cu\u003e代理国库\u003c/u\u003e。在现代社会，政府的各级财政部门都会在中央银行开立存款账户，财政支出则委托中央银行无偿办理\n- \u003cu\u003e代理财政馈券的发行。\u003c/u\u003e\n- \u003cu\u003e为政府提供资金支持。\u003c/u\u003e\n- \u003cu\u003e保存、管理、经营黄金和外汇储备。\u003c/u\u003e\n- \u003cu\u003e金融监管\u003c/u\u003e\n\n#### 三、中国中央银行的产生与发展\n\n- 1983年9月，中国政府决定建立中央银行制度，将当时的人民银行一分为二。\n- 最初，中央银行按照行政区划设立分支机构。这种方式的缺点是，中央银行的金融管理容易受到地方政府的干预。\n\n#### 四、中央银行的资产负债表\n\n##### 1.中央银行的负债\n\n- \u003cu\u003e流通中货币\u003c/u\u003e。现金是社会公众所持有的金融资产，同时也就是中央银行对社会公众的负债。现代社会的货币发行一般是由中央银行垄断的。\n- \u003cu\u003e金融机构存款\u003c/u\u003e。金融机构需要向中央银行存人准备金，包括法定存款准备金和超额准备金。\n- \u003cu\u003e政府及公共机构存款\u003c/u\u003e。中央银行有代理财政金库的职能。所以，政府部门在中央银行拥有存款账户。\n- \u003cu\u003e资本项目\u003c/u\u003e。\n  - 中央银行的资本金来源，主要包括以下几方面\n    - 一是中央政府出资。中央银行是政府所有的。因而，在大多数国家，这是中央银行资本金的唯一来源。中国的情况就是如此。\n    - 二是地方政府或者国有的机构，如国有企业、一些公共部门等出资。\n    - 三是私人部门出资。\n\n##### 2.中央银行的资产\n\n- \u003cu\u003e对存款货币银行债权\u003c/u\u003e。这是中央银行对存款机构的债权，包括贴现和放款等。\n- \u003cu\u003e对中央政府债权\u003c/u\u003e。这包括中央银行持有的政府债券和财政借款。\n- \u003cu\u003e金银、外汇占款\u003c/u\u003e。这是中央银行作为政府的银行持有的黄金外汇储备。\n- 其他资产。包括应收现金、自有资产等。\n\n#### 五、中央银行的类型\n\n##### 1.单一型中央银行制度\n\n- \u003cu\u003e一元式中央银行\u003c/u\u003e\n  - 这是指一个国家设立专门的中央银行，一般是在首都设立总行，采取总分行制，在各地设立不同级别的分支机构。中国等大部分国家就是采用这种制度。 \n- \u003cu\u003e二元式中央银行\u003c/u\u003e\n  - 这是指政府在中央和地方分别设立相对独立的中央银行机构。地方银行接受中央级机构的领导，但不属于后者的分支机构，因而存在比较大的独立性。德国曾经实行过这种制度。\n- \u003cu\u003e多元式中央银行\u003c/u\u003e\n  - 这是指一个国家内设立许多平行的中央银行机构。\n\n##### 2.复合型中央银行制度\n\n- 这是指一个国家没有专门的中央银行，而是由一家大商业银行同时行使中央银行的职能。中国以前实行的就是这种体制。这种制度很不规范，不能适应现代经济制度的需要。\n\n##### 3.跨国型中央银行制度\n\n- 这是指参加某一货币联盟的国家共同组成的中央银行制度。 \n\n##### 4.准中央银行制度\n\n- 这是指政府设立某种类似中央银行的机构，或者授权某些商业银行行使部分中央银行的权力。\n\n#### 六、中央银行的独立性\n\n- 主张中央银行应该具有更大独立性：\n  - 可以减少其承受的政治压力，而政治压力往往会导致通货膨胀。\n  - 政府如果能够控制中央银行，很容易就会使中央银行成为弥补财政赤字的工具，诱发通货膨胀。\n  - 政治家不是经济专家，不具有决定货币政策的能力。独立的中央银行制定政策时，也可以顶住公众的压力，从而实施符合公众长远利益的政策。比如，如果紧缩是必要的，则不管失业者如何反对，紧缩政策都必须坚持。\n- 反对中央银行独立性的观点：\n  - 把中央银行的货币政策决策权交给少数几个精英人物，与民主原则相冲突。因为没有理由认定这几个人的决策一定是正确的。\n  - 中央银行的独立性过大，可能会使它更多地追求自身的利益。\n  - 财政政策与货币政策的配合可能也难以进行。\n\n### 第二节 中央银行与货币供给\n\n#### 一、派生存款创造\n\n- 前提\n  - 银行实行\u003cu\u003e部分准备制\u003c/u\u003e\n  - 经济中的\u003cu\u003e非现金结算制度\u003c/u\u003e\n\n##### 1.派生存款的创造过程\n\n##### 2.派生存款的紧缩过程\n\n##### 3.模型的缺陷\n\n- 商业银行是否会持有超额准备金\n\n##### 4.中国银行的货币创造 \n\n##### 5.存贷款关系\n\n- 对于整个银行体系来说，两者的关系是贷款决定存款，因为贷款能够创造出新的存款。但是，对于单个银行来讲，还是先有存款后有贷款。单个银行是不能创造存款的，必须首先吸收存款，然后才能发放贷款。所以，各家银行都会非常重视吸收存款。\n\n#### 二、完整的货币供给模型\n\n##### 1.基础货币\n\n$B=C+R$\n\n##### 2.货币乘数\n\n$$\nB=RR+ER+C=r_dD+r_tt'D+e'D+c'D\n$$\n\n$$\nMoney\\ supply=D+C=D+c'D\n$$\n\n$RR$：法定存款准备金\n\n$ER$：超额准备金\n\n$D$：活期存款\n\n$t'$：定期存款/活期存款\n\n$e'$：超额准备金/活期存款\n\n$c'$：通货/活期存款\n\n$r_d$：活期存款的法定存款准备率\n\n$r_t$：定期存款的法定存款准备率\n\n#### 三、决定货币供给的四方面因素分析 \n\n##### 1.中央银行与货币供给\n\n- \u003cu\u003e公开市场业务\u003c/u\u003e\n- \u003cu\u003e贴现政策\u003c/u\u003e\n- \u003cu\u003e调整法定存款准备率\u003c/u\u003e\n- 基础货币中，中央银行能够控制的只是基础货币减去贴现放款的部分，即非借入货币基础（nonborrowed monetary base）\n\n##### 2.存款者与货币供给\n\n- \u003cu\u003e财富\u003c/u\u003e。存款者的财富越多，其持有现金的比率往往越低。一般而言，低收入者倾向于使用现金，高收入者倾向于使用支票。所以，现金可以看作是一种必需品。 \n- \u003cu\u003e资产的预期报酬率\u003c/u\u003e。 \n- \u003cu\u003e风险。\u003c/u\u003e在出现金融危机时，人们会明显增加对现金的持有。 \n- \u003cu\u003e流动性与交易成本。\u003c/u\u003e \n- \u003cu\u003e非法经济活动。\u003c/u\u003e地下经济越发达，通货一活期存款比率越高。因为毒品交易、高利货、赌博等地下交易更倾向于使用现金而不是支票。逃税与现金的使用也有一定的关系。税率越高，在交易中人们就越愿意接受现金。\n\n##### 3.借款者与货币供给\n\n- 如果借款需求旺盛，商业银行资金不足，就会向中央银行融资。\n\n##### 4.商业银行与货币供给\n\n- \u003cu\u003e超额准备金占活期存款的比率\u003c/u\u003e\n  - 市场利率：负相关，持有超额准备金的机会成本变高\n  - 准备金利率：正相关\n  - 预期存款流出及其不确定性：正相关\n- \u003cu\u003e向中央银行借款\u003c/u\u003e\n  - 市场利率：如果市场利率上升，发放贷款更加有利可图，商业银行就会增加向中央银行的借款\n  - 贴现率：如果贴现率上升，向中央银行借款的成本上升，商业银行就会减少这种借款。\n\n### 第三节 货币政策的目标与工具\n\n#### 一、货币政策的主要目标\n\n- \u003cu\u003e充分就业\u003c/u\u003e\n  - 中央银行应该追求的起使失业率符合自然失业率的水平。自然失业率是指在不刺激通货膨胀的情况下，可以维持的最低失业率。\n\n- \u003cu\u003e物价稳定\u003c/u\u003e\n\n- \u003cu\u003e经济增长\u003c/u\u003e\n- \u003cu\u003e外汇市场稳定\u003c/u\u003e\n- 1995年，《中央银行法》颁布，将中国的货币政策目标表述为“保持货币币值的稳定，并以此促进经济的增长。”\n\n#### 二、货币政策的工具\n\n##### (一) 一般性政策工具\n\n###### 1.调整法定存款准备率\n\n- 优点：\n  - 是一项强有力的工具，会立即产生效力，而且对所有的银行一视同仁\n- 缺点：\n  - \u003cu\u003e效果太猛烈\u003c/u\u003e\n  - \u003cu\u003e容易影响银行的经营，提高银行的管理成本\u003c/u\u003e\n\n###### 2.贴现政策\n\n- \u003cu\u003e用于调整货币供应量\u003c/u\u003e\n- \u003cu\u003e防止出现银行恐慌\u003c/u\u003e\n- \u003cu\u003e告示效应(announcement effect)。\u003c/u\u003e中央银行调高贴现率时， 就是在传递中央银行实行紧缩货币政策的信息。公众因而会预期未来利率将上升，经济增长将放慢，并据此调整自己的经济决策。由于贴现率是货币市场上的重要基准利率，因此贴现率的变动往往会立刻引起市场短期利率的同步变动\n- 缺点：\n  - \u003cu\u003e中央银行在实行贴现攻策时只能调整贴现率\u003c/u\u003e，而不能直接决定贴现放款额，后者归根结底是由商业银行决定的。所以，即使中央银行提高贴现率，贴现放款也未必会按照中央银行所希望的程度减少。\n  - \u003cu\u003e信息传递过程中可能会出现失真的问题\u003c/u\u003e。比如，当市场利率上升后，如果中央银行不调整贴现率，贴现放款会增加，货币供应量就会扩大。如果中央银行选择调高贴现率，虽然这种调高是适应市场利率变动的被动行为，但可能会被公众误认为其正在实行紧缩性的货币\n\n###### 3.公开市场业务\n\n- 动态的(dynamic)公开市场业务，目的在于使基础货币与货币供应量发生意愿的变化\n- 防卫性的(defensive)公开市场业务，目的在于抵消基础货币的非意愿变化。\n- 公开市场业务作为货币政策工具之一，具有以下优点\n  - \u003cu\u003e在实行公开市场操作时，中央银行处于主动地位。\u003c/u\u003e\n  - \u003cu\u003e在开展公开市场操作时，中央银行可以进行微调。如果只需要货币供应量较小的变动，中央银行也可以很容易通过公开操作做到。\u003c/u\u003e\n  - \u003cu\u003e及时迅速，易于进行反向操作。中央银行可以经常性、连续性地进行公开市场操作\u003c/u\u003e \n\n##### (二) 选择性货币政策工具\n\n- \u003cu\u003e不动产信用控制\u003c/u\u003e\n- \u003cu\u003e消费者信用控制\u003c/u\u003e\n- \u003cu\u003e证券市场信用控制\u003c/u\u003e\n\n##### (三) 直接信用控制\n\n- 这是指以行政命令或其他方式直接干预金融活动\n\n##### (四) 道义劝导\n\n- 这是指中央银行以发出通告、指示或面谈的方式劝告商业银行遵守政府政策。道义劝导既可以用于总量调节，也可以用于结构调节。政策的效力以中央银行的权威为前提。\n\n### 第四节 货币政策的传导机制与中介目标\n\n#### 一、凯恩斯主义的货币政策传导机制\n\n$M→r→I→E→Y​$\n\n#### 二、货币学派的货币政策传导机制\n\n- 货币供给的增加不一定会引起利率的下降\n- 货币供给的变化会影响名义收入的变化（黑箱理论）\n\n#### 三、货币政策的中介目标\n\n- \u003cu\u003e相关性、可计量性、可控性、抗干扰性\u003c/u\u003e\n- 利率和货币供应量是最经常采用的货币政策中介目标。\n  - 从相关性看，货币供给的变化对名义收入的变化会有重要的影响。利率会影响投资与消费支出，所以也会对名义收入产生重要影响。\n  - 从可计量性看，利率和货币供应量都有迅速及时的统计数据，但要区分名义利率和实际利率。\n  - 从可控性看，中央银行可以对货币供应量施加影响，但中央银行不能完全控制货币供应量。中央银行可以制定贴现率，可以通过公开市场业务影响债券的价格和收益率，但是，由于预期的原因，中央银行不能制定实际贴现率。\n  - 从抗干扰性看，比较而言，利率的抗干扰性比较差。\n\n#### 四、货币政策的时滞\n\n- \u003cu\u003e内部时滞\u003c/u\u003e，是指从经济形势发生变化到货币当局采取行动的时间。\n  - \u003cu\u003e认知时滞\u003c/u\u003e：从形势发生变化需要采取行动到中央银行意识到需要采取行动的时间。\n    - 存在认知时滞的原因：\n      - 可能在于统计上存在一定的滞后\n      - 可能在于中央银行的认识能力不足。\n  - \u003cu\u003e行动时滞\u003c/u\u003e：指从中央银行认识到需要采取行动到实际采取行动的时间。长短取决于中央银行的工作效率、政策手段以及法律因素等。\n- \u003cu\u003e外部时滞\u003c/u\u003e，是指从中央银行采取行动到对最终目标产生结果的时间。\n  - \u003cu\u003e财政政策\u003c/u\u003e由于能直接改变总支出，所以外部时滞较短。货币政策的外部时滞相对较长。 \n\n### 第五节 银行监管\n\n#### 一、注册和检查\n\n#### 二、对银行持有资产的限制\n\n#### 三、银行资本要求\n\n- 一是进一步扩展、完善了最低资本充足率的内容与要求，并就资本充足率计算中的各种风险测算进行了较为深入的探讨\n- 二是转变监管部门监督检査的方式与重点，监管当局的监督检査既要监督银行的资本金与其风险数量相匹配，也要监督银行的资本金与其风险管理水平相匹配，以鼓励银行开发和采用更好的风险管理技术来监测、管理它们的风险，对银行的全面风险进行行业监管，等等。 \n- 三是对银行的公开信息披露提出了一整套强制规定要求和建议，对银行全面风险进行社会监管。在信息不够透明的情况下，银行将进行更为谨慎的管理。\n\n#### 四、存款保险\n\n- 存款保险制度也不可避免地会带来逆向选择和道德风险问题。\n- 为了解决逆向选择的问题，美国在1991年开始实行差额保险金制度，风险高的银行要缴纳更多的保险金。\n- 太大而不能倒( too big to fail)的问题。\n  - 一是使大储户缺乏监督银行的动力；二是妨碍公平，因为这既是对储户的不公平对待，也是对银行的不公平对待。\n\n#### 五、对银行业务活动范围的管理——分业经营与混业经营\n\n- 混业经营的优点\n  - 由于银行提供的是全方位的金融服务，因此有利于银行\u003cu\u003e吸引客户\u003c/u\u003e。\n  - 混业经营有利于\u003cu\u003e银行掌握更多的有关客户的信息\u003c/u\u003e。银行不仅可以了解客户的存贷款状况，还可以了解客户的证券投资、信托资金信息，\u003cu\u003e减少逆向选择与道德风险\u003c/u\u003e。 而且，由于证券与银行等业务可以利用同样的信息，因此有利于\u003cu\u003e减少成本\u003c/u\u003e。\n  - \u003cu\u003e有利于增加竞争\u003c/u\u003e。所有的机构都从事各种金融业务，可以使银行与证券等业务都有更充分的竞争， 从而有利于客户。\n- 分业经营的优点\n  - \u003cu\u003e有利于防范金融风险\u003c/u\u003e\n  - \u003cu\u003e认为混业经营有可能侵犯客户的利益。\u003c/u\u003e\n\n### 第六节 2008年金融危机及其影响\n\n#### 一、危机的缘起：次级抵押市场\n\n- 真实票据论：存款是商业银行资金的主要来源，为应付存款突然提现，就需要保持资金的流动性。因此，商业银行的放款应是短期的和商业性的，因为短期的和商业性的贷款带有自动清偿性。即是说，只有以真实票据作担保抵押的银行券发行和贷款才是实在的、才不会过剩。\n\n- 次级贷款\n\n  - FICO score\u003c660：\u003cu\u003e高风险\u003c/u\u003e；违约率至少是正常贷款的7倍\n  - \u003cu\u003e高成本\u003c/u\u003e：贷款的申请费和服务费比较高\n  - 主要是汽车和抵押贷款\n  - 往往被称为故事贷款\n  - 次级抵押市场1980年代初出现\n  - 发展的原因：\n    - \u003cu\u003e法律的放松\u003c/u\u003e：利率管制和税收政策的放松\n    - \u003cu\u003e利率\u003c/u\u003e的变化\n    - \u003cu\u003e证券化\u003c/u\u003e的发展\n\n- 危机的直接原因\n\n  - \u003cu\u003e2006年后美国住宅价格增速减缓\u003c/u\u003e\n\n  - 部分次级抵押贷款结束了\u003cu\u003e初始利率优惠期\u003c/u\u003e\n\n  - 2004年6月后美联储\u003cu\u003e多次提高利率\u003c/u\u003e\n\n    \u003e 中国：量化宽松，希望减息促进经济增长；但无法保持汇率的稳定——中央银行给商业银行发放贷款\n\n#### 二、危机的进一步发展\n\n- 商业银行：SIV\n- 投资银行\n- 衍生产品市场：CDS\n- 保险公司：AIG\n- 股票市场\n- 对手风险\n- 评级公司\n  - SEC建立了NRSRO制度，圈定认可的评级组织，并依据他们的评级确定金融机构的资本要求\n- 适当性\n- 监管与货币政策\n- LTCM和道德风险\n  - 太大不能倒：大公司倾向于冒险\n\n#### 四、金融危机与实体经济\n\n- 各国政府的救助：为创造流动性，用7000亿美金购买问题金融机构的优先股\n- 金融发展与经济增长\n- 金融危机影响经济增长\n  - 信贷紧缩和流动性缺乏\n  - 消费下降\n\n#### 五、对中国金融与经济的影响\n\n- 直接冲击：\n  - 商业银行：国际化程度低，所以冲击的程度有限\n  - 投资银行：国际化程度更低\n  - 保险公司\n  - 中央银行和主权基金\n    - 中投公司\n    - 中央银行不能在一级银行买入国债：避免货币政策成为财政政策的附庸\n    - 通过农业银行作为通道购买国债\n- 金融市场\n\n#### 六、金融危机后金融监管的变化\n\n- 2010: Dodd-Frank\n- 通过增进金融体系的责任和透明度终结太大不能倒\n- 保护纳税人、保护消费者不受欺诈\n\n\n\n## 第五章 市场组织与结构 \n\n### 第一节 一级市场 \n\n#### 一、公募方式 \n\n##### 1.证券发行的注册 \n\n- 首先由发行人提交注册说明书\n- 证交会的公司融资部负责审查注册说明书\n- 等待期：红鲱鱼（red herring）\n\n##### 2.415规则\n\n- 在1982年以前，每次发行证券都要经过上述程序，这对需要连续发行证券的发行人极为不利。因为当发行人根据当时的金融形势决定发行证券后，并不能立刻进行实际的发行。而等到发行最终实施时，金融市场可能已发生很大变化。\n- 1982年，SEC通过了415规则：\u003cu\u003e允许发行人在未来两年内一次或多次发行一定数量的某种证券。\u003c/u\u003e\n\n##### 3.持续报告要求\n\n- 公开发行证券的公司为报告公司，必须持续向SEC和市场提供财务报告。\n\n##### 4.投资银行的承销\n\n- 提供的服务包括发行条件的确定、协助注册登记等\n- 为发行人提供咨询，设计适合发行的证券或证券组合\n- 一般组成承销团承销证券以分散风险\n- 企业和承销团的路演\n- 公开发行：\n  - 包销（firm commitment）：由投资银行承担证券发行的全部风险\n  - 代销（best effort selling）：由投资银行代理发行证券，发行风险由发行人承担\n  - 备用包销（standby underwriting）：投资银行按照备用协议负责接收被拒绝购买的证券\n\n- 投资者担心赢者诅咒，可能不会在二级市场购买股票。 \n- 管理者可能希望股权结构更加分散。\n- 投资银行在二级市场维护股价，吸引没有信息的投资者介人。方法：\n  - 由承销团卖空(syndicate short)。就是说，牵头承销商预计分配给承销团成员的股份数可能大于实际分配的股份数。比如A投资银行预计分得200万股，并已经全部售出，但最终却只分得了180万股，形成卖空，它就必须在二级市场买入不足的20万股。在预期股票的需求较弱时，投资银行就会采取这种方法。 \n  - 绿鞋技术(green shoe technique)。由发行人给予承销商超额配售的权利，一般不超过发行数(正股数)的15%。最早采用这种方式的为绿鞋公司。如果二级市场股价偏低，承销商就从二级市场买入股票。如果二级市场股价正常，承销商则请求发行人追加股票发行，也可以综合利用两种方法。与承销团卖空相比，这种方法多了一种期权安排。 \n  - 二级市场购入。投资银行直接入市购买股票，稳定股价。这种方法在市场上非常少见。 \n  - 对一上市就抛出股票的投资者进行处罚，包括拒绝他们的下次参与，以及处罚把股票卖给他们的承销团成员。如果不能最终稳定股价，承销团再决定是否放弃。\n\n- 大型的投资银行有很好的声誉，其声誉就有利于在二级市场维护估价。较小的投资银行则没有这种优势。 \n  - 一般而言，大型投资银行倾向于采用\u003cu\u003e包销\u003c/u\u003e方式介入股票发行，小的投资银行倾向于采用\u003cu\u003e代销\u003c/u\u003e方式。\n\n#### 二、私募方式\n\n##### 1.私募与公募的差异\n\n- 美国的SEC在1982年的D条例， 规定免于注册的证券必须销售给有经验的投资者，如有能力评估风险、净资产达到100万美元等。 \n- 中国，界定是否私募的一般标准是投资者是否达到200人。这个市场一度非常混乱。 \n- 私募发行的成本较低，相应地，流动性也比较差。由于私募只针对少数投资者，因此其发行价格一般较低。 \n- 投资银行往往是私募证券的设计者，并为私募提供咨询甚至承销服务。 \n\n##### 2.144A规则\n\n- 证交会的144A规则取消了私募两年内不能自由买卖的限制。\n- 提高了私募证券的流动性，吸引了许多大机构投资者购买私募证券。\n- 由于私募的信息披露要求较低，也吸引了更多的外国发行者在美发行债券。 \n\n#### 三、发行价格的确定\n\n- 抑价指的是新股发行上市后，二级市场的首日交易价格常常会大于一级市场的发行价格。\n  - 衡量方法是\u003cu\u003e用新股上市第一天的收盘价减去发行价格再除以发行价格，结果称为初始回报或首日收益(initial return)。\u003c/u\u003e\n- 信息不对称：\n  - \u003cu\u003e发行人拥有比投资者更多的信息。\u003c/u\u003e为了向投资者传递关于股票质量的信息，高质量的公司可以将IPO的价格定低，将来公司按照较高的二级市场价格增发新股时，可以筹得更多的资金。 而低质量的公司由于很可能无法通过未来的二级市场增发收回IPO低定价所付出的成本，因此很难模仿高质量公司的这种做法。\n  - \u003cu\u003e投资银行(承销商)比发行人拥有更多的信息。\u003c/u\u003e由于监督投资银行是需要成本的，因此为了调动投资银行的发行积极性，发行人有必要容忍一定的抑价。 \n    - 问题：抑价本身对投资银行也是不利的，因为投资银行发行挣得的毛利差与发行定价直接相关。投资银行的这种损失，有可能从增加的佣金中获得补偿。抑价以后，投资银行会把更多的股票分配给自己的关系客户，后者会选择这家投资银行作为经纪人并可能支付更高的佣金。\n  - \u003cu\u003e投资者之间拥有的信息不对称。\u003c/u\u003e投资者可以分为有信息的投资者和无信息的投资者。有信息的投资者只申购定价低(于股票价值)的股票，从而得到较高的投资回报。无信息的投资者不了解IPO股票的实际价值，他们只能对所有IPO的股票进行申购。无信息的投资者投资IPO股票的回报率偏低。为了吸引无信息的的投资者，所以抑价发行。\n  - \u003cu\u003e机构投资者比投资银行拥有更多信息。\u003c/u\u003e在西方国家，新股发行多采用询价(book building)方法，较少采用拍卖法。 投资银行首先给出一个初始价格区间(initial range)，再通过路演收集潜在投资者的需求信息，最后确定发行价格。作为拥有信息的投资者，如果他们将真实信息告知投资银行，投资银行据此确定的发行价格将对他们不利。\n  - \u003cu\u003e发行公司决策者与其他股东之间信息不对称。\u003c/u\u003e委托代理关系中的利益冲突的角度进行分析，对于承销商的选择主要是由发行公司的管理层和创业投资公司(如果有的话)的一般合伙人做出的，而发行前就存在的其他股东(包括创业投资公司的有限合伙人和其他股东)则影响有限，这就存在利益冲突问题了。\n\n- 价格定低，目的是降低诉讼的可能性。 \n  - 如果新股价格较高，上市后一段时间价格下滑，很容易跌到发行价格以下。如果新股价格定得较低，上市价格就不容易跌到发行价格以下。\n  - 一级市场投资者获得的损失补偿为卖出价格或诉讼时的市场价格(如果还没有卖出)减去发行价格，二级市场投资者获得的损失补偿取决于买入价格和发行价格中较低的那个。所以，把发行价格定得较低，投资者要发起诉讼，获得的赔偿数量可能就较少。\n\n- 就已发行证券的新发售而言，新股权的发行往往会同时引起二级市场般价的下跌。\n  -  一个可能的原因是，公司管理层往往会选择股票价格偏高时发行股票，投资者对股票的评估因而会发生变化。\n\n#### 四、新的证券承销方式\n\n##### 1.大额承销\n\n- 大额承销是由投资银行与潜在发行人在很短的时间内迅速完成交易，然后再把这些证券分销给其他的投资银行和自己的客户，特别是那些机构投资者。 \n- 在415规则下，大额承销使得从发行人决定发行证券到实际发行证券的时间间隔大大缩短，相应地要求证券承销的及时性。 \n- 组建承销团的目的是分散风险。大额承销使整个投资银行的风险加大。于是，开展这种承销业务的投资银行需要利用衍生产品来降低风险。\n\n##### 2.拍卖法\n\n- 数量的确定。一般情况下，单个投资者愿意购买的数量比发行数量少得多，这样出价最好(报出收益率最低)的承销者可以首先成交，然后是出价次优的投资者。如此递延下去，直到全部债券数量出清。 这种拍卖方法的一个问题是，最后一个投资者的出价虽能被满足，但报出的数量不一定能满足。\n- 价格的确定。\n  - \u003cu\u003e单一价格拍卖\u003c/u\u003e(single-price auction)，此时，所有中标者统一支付最高的收益率。\n  - \u003cu\u003e多重价格拍卖\u003c/u\u003e(multiple-price auction)，中标人各自支付自己的投标价格，这在一定程度上对发行人有利，对投标人不利。\n\n#### 五、境外发行的原因\n\n\u003cu\u003e1.本国市场不发达\u003c/u\u003e\n\n\u003cu\u003e2.降低筹资成本\u003c/u\u003e\n\n\u003cu\u003e3.改变公司的资金来源结构\u003c/u\u003e\n\n\u003cu\u003e4.减少汇率风险\u003c/u\u003e\n\n### 第二节 二级市场\n\n#### 一、二级市场\n\n##### 1.二级市场的作用\n\n- \u003cu\u003e提供流动性。\u003c/u\u003e\n\n- \u003cu\u003e价格发现。\u003c/u\u003e由于存在大量的买者和大量的卖者，二级市场上的价格往往趋向于均衡价格。二级市场的价格，代表着市场对发行人资金运用行为的评价，使得发行者借此可以了解再次进入一级市场的成本。\n\n- \u003cu\u003e降低成本。\u003c/u\u003e对于投资者而言，发达的二级市场为其提供了统一的价格和充分竞争的市场，降低了其搜寻成本和交易成本。\n\n##### 2.连续型和叫卖型市场\n\n- \u003cu\u003e连续型市场\u003c/u\u003e的价格确定是随着买方和卖方的下单(submit orders)而连续进行的。下单者的买卖价格和数量决定了该时刻证券的价格。这样，证券的价格波动可能与总的供求状况无关。\n- \u003cu\u003e叫卖型市场\u003c/u\u003e上，证券的价格不是瞬时变化的，而是取决于集中撮合的次数。每次撮合时，集中起来的买卖委托按照同一价格同时得到执行，拍卖可以口头形式进行，也可通过书面形式。叫卖型市场制度可能会降低证券价格的波动性。 \n- 如果证券市场同时具有上述两种特征，则称为混合型市场。 \n\n#### 二、二级市场委托单的类别\n\n- 市价委托单\n- 限价委托单：买入：限价低于市价；卖出：限价高于市价\n- 停止委托单：买入：限价高于市价；卖出：限价低于市价\n- 限价停止委托单 \n- 指定价格委托单 \n\n#### 三、委托单的时间限制\n\n- 当日委托(day orders)是指委托必须在交易日的当天执行。如果到交易日结束时委托并未执行，则自动作废。 \n- 定时委托(time specific orders)是指只在交易的某个特定时间段(如开市、闭市)执行的命令。 \n- 开放式委托单(open order)，也叫撤销前有效委托单(good-till-canceled)，或GTC，在成交或被取消前一直有效，但需要投资者的定期确认(confirm)。 \n- 执行或取消委托单(fill-or-kill orders)，或称FOK，要么立刻被执行，要么立刻作废。 \n\n#### 四、委托单的数量\n\n- 投资者可以以整数、零数或整零混合的方式交易。 \n\n#### 五、保证金交易\n\n1.初始保证金要求 \n\n2.实际保证金 \n\n3.维持保证金要求 \n\n#### 六、卖空 \n\n##### 1.卖空的操作\n\n- \u003cu\u003e证券的卖空交易数量占近期总交易量平均值\u003c/u\u003e的比率称为卖空比率。 \n\n##### 2.卖空的作用与管理\n\n- 卖空机制使得金融资产的价格能够更充分地反映市场参与者的判断，提高\u003cu\u003e价格发现功能。\u003c/u\u003e \n  - 由于卖空受到制度限制，当交易者观点不同时，悲观者可能不会选择卖空。于是，股票价格还是会只反映最乐观投资者的判断。所以，当金融资产价格偏离价值时，卖空机制只可以在一定程度上校正泡沫现象。\n  - \u003cu\u003e升幅交易\u003c/u\u003e（uptick trade）\n    - 中国：融券卖出的申报价格不得低于该证券的最新成交价；当天没有成交的，申报价格不得低于前收盘价。（升幅交易）\n  - \u003cu\u003e零涨幅交易\u003c/u\u003e（zero plus uptick）\n    - 2007年美国取消了升幅交易和零涨幅交易的规则\n- 卖空为什么不能校正泡沫：一致行动风险\n\n##### 3.卖空行为的保证金要求\n\n- 保证金比例=保证金/（融券卖出数量×融券卖出价格）\n\n#### 七、证券交易所的会员及其作用 \n\n##### 1.佣金经纪人\n\n- 佣金经纪人(commission brokers)负责为投资者办理代理买卖证券的业务，并借此收取一定的佣金。 \n\n##### 2.场内经纪人\n\n- 当佣金经纪人在交易指令蜂拥而入难以及时处理的时候，场内经纪人(floor brokers)将为其分担一部分工作量，并相应地分享一部分佣金。 \n\n##### 3.场内自营商\n\n- 稳定价格\n  - 交易商可以看作是交易的即时性(immediacy)，即迅速完成交易的能力的提供者。 \n- 提供更好的价格信息。 \n  - 自营商比普通投资者拥有更多的市场指令信息，其买卖活动也就是传递这些信息的过程。\n\n##### 4.专营商\n\n- 负责不能立即执行的限价交易委托、止损和限价止损交易委托，把这些指令存入自己的专营商(specialist)簿中保存，待将来执行时分享一部分佣金。\n- 作为自营商专门负责维持一只或几只股票的供求平衡。 \n\n#### 八、市场效率\n\n##### 1.运行效率\n\n- 衡量的是资本市场上投资者支付的交易成本的大小。 \n- 显性交易成本。\n  - \u003cu\u003e佣金\u003c/u\u003e和交易商的买卖价差(bid ask spread)。\n    - soft dollars：经纪人可能会向投资者免费提供研究报告等服务。\n  - \u003cu\u003e手续费\u003c/u\u003e。是指为保管投资者的证券和过户等所收取的费用等。\n  - \u003cu\u003e税收\u003c/u\u003e。\n\n- 隐性成本\n  - \u003cu\u003e执行成本\u003c/u\u003e：证券买卖委托执行与否一般会使证券价格发生一定的变化。\n    - 改变了市场的供求情况。\n\n##### 2.定价效率\n\n- 指资本市场上证券价格反映所有相关信息的能力。\n  - 有效率的市场上，相关信息能够迅速反映在证券价值上，证券价值等于投资价值。\n\n### 第三节 中国的发行与交易市场\n\n#### 一、证券发行的审批与核准\n\n- 审批制：\n  - 一是使得上市公司普遍偏小因为各地方政府在获得固定额度后，为了使更多的企业发行上市，会把额度分给尽可能多的企业。 \n  - 二是许多企业的股本往往先缩后增。由于法规规定社会公众股不得低于拟发行股本总额的25%，这样，一家企业要想成为上市公司，其总股本至多只能是其所获得发行额度的4倍。因而，虽然特大企业难以上市，但如果企业稍大一些，则必须尽量缩股。\n- 1997年，“总量控制，限报家数”。采用这样的做法后，各地上市公司家数受到控制，地方政府与上市公司为了多等集资金，尽量扩大公司股本规模，市场上大盘股的数量逐渐增多。  \n  - 在审批制下，股票的发行数量由政府决定，其供给曲线是垂直的，而股票价格取决于供求曲线的交点。所以，当需求曲线移动时，为保持价格基本稳定，政府不得不随时调整供给曲线。\n- 在核准制下，股票不再由行政部门负责推荐，股票发行审核委员会独立负责审核，看其是否符合《公司法》和《证券法》等规定的条件。\n  - 审批制：行政部门审批；核准制：发行审核委员会审核\n- 券商的通道制：\n  - 拥有主承销业务资格的券商，按照其规模实力大小不同，获得数量不同的推荐企业发行上市的通道。\n  - 券商每推荐家企业发行上市，就要占用一个通道。只有当这家企业被核准发行上市，空出通道后，券商才能推荐另一家企业发行上市。\n  - 目的在于，促使券商重视承销公司的质量，加快通道周转速度，推荐更多质量好的公司。\n- 2004年2月起，中国股票市场开始实行保荐人制度，让券商和责任人对其承销发行的股票，负有一定的持续性连带担保责任。\n  - 由于保荐制度和通道制的目的是相同的，2005年1月1日，通道制被废止。 \n  - 美国没有保荐制度：声誉资本来约束已经足够了\n\n#### 二、中国的股票发行方式(投资人选择)\n\n##### 1.认购表抽签 \n\n##### 2.存单抽签\n\n- 类似权证\n- 一级半市场：买卖中签号码\n\n##### 3.上网发行\n\n- 分网上定价发行和网上竞价发行。 \n\n##### 4.网下发行与网上发行\n\n#### 三、新股发行价格的确定\n\n#### 四、二级市场的组织\n\n##### 1.竞价交易方式\n\n- 价格优先、时间优先的顺序原则执行。\n\n- 集合竞价是指由计算机交易系统对所有有效的买进卖出委托按上述优先原则进行排序。对买进委托，排列顺序由高到低。卖出委托则相反，是由低到高。系统将自动确定一个能使成交量最大的交易价格，并以此形成开盘价。\n\n- 连续竞价是指开盘以后，对于每一个新的委托，比如一个新的买人委托，如果其限价大于等于卖出委托排列的最低价格，则可以按顺序与卖出委托成交，成交价格为卖方叫价。如果限价小于卖出委托的最低价格，则无法成交。 \n\n##### 2.成交与不成交\n\n##### 3.证券的清算、交割与过户\n\n- 清算是证券交易成交之后，交易有关各方计算应收应付证券与资金净额的程序。\n- 交割是指证券买卖双方价款与证券的转移。它包括投资者与券商的交割和券商之间的交割两个方面。交割与清算是一个共同的过程，因为它必须依赖清算的结果。\n\n## 第九章 股权市场\n\n### 第一节 普通股股票市场 \n\n公司为什么要上市？\n\n- 公司有投资机会，所以发行新股筹资\n  - 募集资金投向变更\n- IPO会导致公司价值的提升\n  - 股权分散后悔使得投资者对公司股价高估，对企业家（创业者）更有利\n  - 公司上市后会受到更多的外部监督，这会提高公司的价值\n  - 流动性提高，公司股票的价值也会提高\n- 改善公司治理\n- 风险投资的退出\n- 做大做强\n- 吸引眼球\n- 缺点：信息披露\n\n#### 一、二级市场 \n\n##### 1.股票交易所\n\n- 股票交易所属于有组织的交易场所，由SEC审批，并接受SEC的监管。它拥有多家会员。只有会员才可以利用交易所的设备交易股票。非会员则只能依靠会员代理交易。\n\n##### 2.场外交易市场\n\n- 在场外市场，由于没有集中的交易场所，不能实行公开竞价，所以必须有做市商制度，以保证价格的公平和交易的效率。\n- 在场内市场交易的股票，称为上市(listed)股票。在场外市场交易的股票，称为未上市(unlisted)股票。 \n\n##### 3.第三市场\n\n- 指的是在证券交易所之外交易上市股票的市场。\n- 当年，由于交易所要求其会员实行固定佣金制度，所以，为逃避固定最低佣金的规定，第三市场(third market)发展了起来。\n\n##### 4.第四市场\n\n- 投资者\u003cu\u003e不通过经纪人而直接进行交易\u003c/u\u003e的市场称为第四市场(fourth market)。这一市场也是因固定佣金制度而产生的。目前，计算机系统极大地促进了这一市场的发展。 \n\n##### 5.场内与场外交易商的比较\n\n- 在场内市场，大量的交易委批集中于一起撮合成交，有利于形成更好的价格。\n- 场外市场有多个报价，成交价是最好的报价。在场内市场，只有一种报价，但成交价一般在专营商报价之内。而且，在场内市场，专营商并非绝对处于垄断地位。\n\n#### 二、股权市场结构\n\n- 分割的市场可能无法有效地实现价格发现功能。这意味着投资者不能得到最有利的价格。 \n\n#### 三、大宗交易与程序交易\n\n##### 1.大宗交易\n\n- 大宗交易(block trades)指的是交易大量的同种股票 \n\n##### 2.程序交易\n\n- 程序交易(program trades)指的是\u003cu\u003e机构投资者同时买卖大量的不同种类的股票\u003c/u\u003e。NYSE的定义是购买或出售至少15种股票，或者总价值达到100万美元的一揽子交易。 机构投资者可能因为调整投资组合，或进行指数化投资等原因而进行程序交易。\n\n#### 四、股票市场指标\n\n##### 1.按照指数编制方法的不同对指标进行分类\n\n- 样本股票\n- 相对权重\n- 平均方法\n\n##### 2.按编制者的不同对指标进行分类\n\n- 由交易所编制，以所内全部股票为基础的指标。如NYSE综合指数、 NASDAQ综合指数就属于这一类。\n- 由一些机构主观地选择一些股票而编制的指标。比如道・琼斯工业平均数( Dow Jones Industrial Average，DJIA)、S\u0026P500指数、价值线综合平均数(VLCA)等。\n- 由一些机构按照客观的标准选择一些股票而编制的指标。比如威尔士指数\n\n##### 3.广义股票价格指数与狭义股票价格指数？\n\n- 广义股票价格指数：\n  - 股票价格平均数：在平均股票价格的基础上，对一些不可比因素进行修正后形成的股票价格指标\n  - 狭义股票价格指数：根据不同时期股票价格平均数对比所得的动态相对数，报告期股价平均数与基期股价平均数的比值，基期指数一般取100、50、10或1000点\n- 拆股：新除数=旧除数×计入调整事项的新股价之和/不计入调整事项的旧股价之和\n\n##### 4.几种著名的股价指数\n\n$$\nDJIA=\\sum_{i=1}^{30}\\frac{p_i}{D}\n$$\n\n$$\nNYSE=\\frac{\\sum_{i=1}^nN_iP_i}{OV}\\times50\n$$\n\n#### 五、定价效率的检验\n\n检验市场是否有定价效率，也就是检验市场能否产生异常收益\n\n##### 1.弱有效的检验\n\n- 历史上的价格波动无法预测未来。\n\n##### 2.半强有效的检验\n\n- \u003cu\u003e小公司效应\u003c/u\u003e。一些研究发现，投资于市值较小的公司的投资组合的业绩要超过整体市场的表现。 \n- \u003cu\u003e低市盈率效应\u003c/u\u003e。有的研究发现，由市盈率比较低(low price-earnings ratio)的股票组成的投资组合与高市盈率的股票组成的投资组合相比，前者的表现要强于后者。 \n- \u003cu\u003e被忽视公司效应\u003c/u\u003e。有研究发现，投资于受证券分析师关注的公司的股票，其业绩要劣于投资于不受关注的股票。因而，根据证券投资分析师是否关注来进行投资能获得异常收益。 \n- \u003cu\u003e日历效应\u003c/u\u003e。在特定的时间执行投资战略可能会获得异常收益。比如，在一月、节日、一年中的某一月或者一星期中的某一天等。此外，定价无效率还可能表现为证券的定价是非理性的。市场作为整体可能被非理性地错误定价。\n\n##### 3.强有效的检验\n\n- 有的研究分析了内幕人士(insiders)的活动，发现他们的投资业绩一般会强于大市。\n\n#### 六、普通股投资的方法\n\n### 第二节 中国的股权市场\n\n#### 一、B股市场\n\n- 以人民币标明面值，以外币认购交易，在境内上市\n- 市场分割，境外投资者投资理念不同，上市公司往往缺乏投资价值\n\n#### 二、H股与红筹股市场\n\n- 对中国具有重要的意义。\n  - \u003cu\u003e有利于改善香港的上市公司结构\u003c/u\u003e。H股和红筹股多为工业及综合类上市公司，这对香港的产业结构调整意义深远。\n  - \u003cu\u003e有利于维护香港的国际金融中心地位\u003c/u\u003e。红筹股和H股的上市，使得大量的资金经由香港联交所投向上市公司。在一部分外资撤走的同时，香港仍能成为重要的金融交易中心。这有利于香港经济的繁荣和稳定。\n  - \u003cu\u003e可以为内地筹集资金\u003c/u\u003e。\n\n#### 三、国家股、法人股、社会公众股\n\n##### 1.股权市场分割的原因\n\n- 国家、法人和社会公众持股在任何股市都是正常的。说中国股权分割的特性明显是因为这些股份同股不同权，\u003cu\u003e国家股不可以上市流通，法人股可以在法人之间协议转让。\u003c/u\u003e\n- \u003cu\u003e意识形态考虑\u003c/u\u003e：政府强调国家必须对股份制企业拥有控制\n- \u003cu\u003e股市承受力的考虑\u003c/u\u003e：当时人们担心，如果允许公有股上市流通，过量的供给会使股市很难承受。\n- \u003cu\u003e额度管理\u003c/u\u003e：由于部门都想把尽可能多的企业推向股票市场，于是，每家企业的社会公众股的占比就偏低。\n\n##### 2.国家股、法人股的来源与变化\n\n##### 3.国家股、法人股不能上市对二级市场的影响\n\n- \u003cu\u003e二级市场并购难\u003c/u\u003e。由于可流通股部分只占上市公司总股份的30%，因此在二级市场开展并购活动几乎不可能。 \n- \u003cu\u003e股市回报率低\u003c/u\u003e。只有一部分股票流通时，由于公司是按面值分红的，所以，虽然国家股、法人股股东分红比率不低，但是多倍溢价的社会公众股股东的分红就显得少而又少。 \n- \u003cu\u003e投机严重\u003c/u\u003e。由于只有30%的可流通股，所以，有效的公司治理结构很难建立，投资者永远也无法对企业的行为进行约束，使之趋于合理。社会公众股东只有用脚投票的机会，而缺乏用手投票的殊荣。所以，二级市场只能是一个投机市。加上在不可能依靠分红获得回报的情况下，投资者只能寄希望于资本增值。\n\n#### 四、中国的政策市问题\n\n- 中国股市经常大起大落，其波动与经济形势基本无关。就是说，多数情况下，这种波动既与宏观经济的总体趋势无关，也与上市公司的总体业绩无关。除政策市问题外，另一个原因则是投机过度。当然，许多时候，政策的干预也是在投机过度的情况下不得已而采取的措施。\n\n#### 五、中国上市公司的舞弊问题\n\n- \u003cu\u003e法治不健全。\u003c/u\u003e\n- \u003cu\u003e上市公司有为获得IPO、配股权利以及避免被ST而舞弊的动机。\u003c/u\u003e\n- \u003cu\u003e上市公司参与舞弊，往往还与大股东的行为有关。\u003c/u\u003e国有股东一股独大。\n\n#### 六、中国概念股风波\n\n### 第三节 二板市场与做市商制度\n\n#### 一、海外的二板市场\n\n- 二板是相对于主板(main board)而言的。\n- 许多国家是在交易所内设立一个上市标准较低的新的交易板块，称为二板市场。\n- 也有的国家是在交易所之外另外设立二板市场。\n- 美国的成功可能有几个原因：\n  - \u003cu\u003e上市费用低， NASDAQ市场比NYSE的上市费用低很多。\u003c/u\u003e\n  - \u003cu\u003e交易系统先进\u003c/u\u003e， NASDAQ投入大量资金用于交易系统建设与改进。\n  - 高科技企业的成功。\n- 欧洲的失败可能有多个原因：\n  - 许多企业在二板上市后就转向了主板市场，使二板市场空壳化。 \n  - 主板市场与二板市场的差异相对较小，使二板市场与主板市场相比的竞争力不足。\n\n#### 二、二板市场的价格形成机制\n\n- 证券市场的价格形成机制主要有两种方式\n  - 做市商(market maker)制度\n    - 在证券的二级市场上，有一些实力较强、有良好信誉的交易商连续不断地为每一种证券提供双向报价，并根据报价用自己的资金与投资者成交。通过这种方式，做市商既使证券市场增加了流动性，又可以为自己挣得证券买卖的价差。\n    - \u003cu\u003e稳定价格。提供更准确的价格信息。\u003c/u\u003e\n  - 竞价(auction)交易制度\n    - 竞价制度则是将买卖双方的委托都交给经纪人，由经纪人传输到市场上，再由市场对双方的买卖委托进行撮合成交。\n\n#### 三、 NASDAQ市场的价格形成机制\n\n##### 1.起源与发展\n\n##### 2.做市商及其种类\n\n- 批发商。这类做市商往往为3000只以上的股票做市。\n- 批零兼营的公司。这类做市商做市的股票一般为500-1000只。\n- 机构经纪商。这类做市商主要为机构投资者服务，做市的股票一般低于500只。机构投资者的多数委托不要求立即执行，以追求较低的交易成本。\n- 地区性经纪公司。这类做市商规模较小，不属于华尔街，往往为支持承销和零售而做市。\n- 非挂牌交易特权做市商。在芝加哥证券交易所，专营商以这种方式为在 NASDAQ上市的股票做市。\n\n##### 3.做市商的报价规则\n\n- 固定报价。在这种报价方式下，做市商必须保证按照报出的价格与下单的投资者成交。\n- 协商报价。这种报价没有做市商的承诺，在与投资者协商后，交易才能正式达成。 \n- 询价报价。做市商对于交易活跃的股票或者大宗交易，要征求其他做市商或持有人的意见。\n\n##### 4.做市商的价格操纵行为\n\n- 在报价时相互协调，做市商为了与客户成交，会要求其他做市商调整报价。如果有做市商拒绝合作，其他做市商就会联合起来，拒绝与之交易。做市商内部称合作的做市商为友好竟争者。\n- 不及时准确地公布交易信息。这样做的目的是利用信息为自己谋利。同时，客户也无法知道自己成交的价格是否为最优价格。\n- 拒绝报价承诺。\n- 政策：\n  - \u003cu\u003e要求做市商在市场上报出最好的委托价格。\u003c/u\u003e\n  - \u003cu\u003e取消交易商内部市场与公开市场的价差。\u003c/u\u003e\n\n#### 四、做市商制度与竞价交易制度的比较\n\n##### 1.流动性方面\n\n##### 2.投资者的交易成本\n\n- 在做市商市场上，投资者要向做市商支付买卖价差。做市商收取的买卖价差也可以看作是为证券市场服务所收取的价格。\n  - \u003cu\u003e做市商进行交易的成本\u003c/u\u003e，如设备成本、管理与操作费用等。\n  - \u003cu\u003e风险补贴\u003c/u\u003e\n    - 证券价格波动的风险\n    - 由于市场的厚度(交易量的大小)决定的平仓的顺利程度的风险。\n\n##### 3.透明度与内部操纵\n\n- \u003cu\u003e做市商拥有比投资者更多的市场交易信息\u003c/u\u003e\n- 做市商可以合法地在中长期内持有股票，如果他们合谋勾结，就有可能形成对市场的操纵。在竞价市场上，因为交易前的委托和交易后的报告信息都可以迅速传递，市场的透明度较高。\n\n##### 4.价格稳定性\n\n- 竞价市场上透明度较高，有利于信息迅速地传递并反映到价格上，使价格反映投资价值。相对来讲较不容易出现价格大幅度偏离价值的情况。而且， 由于价格确定是连续进行的，因此，价格上升和下降都会比较平稳地进行。\n- 在做市商市场上，由于做市商在平抑价格波动，因此，当价格背离价值累积到一定程度后，有可能出现价格更迅速的上升和下降。这种突然的、大幅度的波动容易引起市场进一步的迅速波动。\n\n#### 五、多家做市商制度与一家专营商制度的比较\n\n- \u003cu\u003e流动性\u003c/u\u003e：多家做市商流动性强\n- \u003cu\u003e价格稳定性\u003c/u\u003e：专营商负有维持股票价格稳定的义务，市场价格更稳定\n- \u003cu\u003e垄断与交易成本\u003c/u\u003e：专营商垄断内幕信息\n- \u003cu\u003e价格与速度\u003c/u\u003e\n  - NASDAQ是交易商市场，交易商会提供即时性，所以委托可以得到更快的执行。与分散的做市商制度不同，NYSE实行竞价制度，专营商可以为投资者实现更好的交易价格，但是需要更长的时间。\n\n## 第十章货币市场\n\n### 第一节 美国的货币市场\n\n#### 一、国库券市场\n\n- \u003cu\u003e为了应付财政先支后收的短期资金需要\u003c/u\u003e\n- \u003cu\u003e在需要长期资金时，为了等待更有利的筹集资金的时机\u003c/u\u003e\n- \u003cu\u003e出于中央银行公开市场操作的考虑。\u003c/u\u003e \n\n##### 1.买卖报价\n\n按收益率报价\n$$\ni_{db}=\\frac{F-P_d}{F}\\times\\frac{360}{t}\n$$\n$i_{db}$：国库券的收益率\n\n$F$：面值\n\n$P_d$：国库券的美元价格\n\n$t$：到期期限\n\n##### 2.国库券的拍卖市场\n\n- 国库券的拍卖既可以采用竞争性报价方式，由投资者报出收益率和认购数量，也可以采取非竞争性报价方式，投资者不报出收益率，只报出认购数量。前者一般适用于机构投资者，后者一般适合小额投资人。所以前者占比大而后者占比小。 \n\n#### 二、商业票据\n\n- 商业票据(commercial paper)是公司在公开市场发行的短期无担保本票\n\n##### 1.商业票据的发行者与投资者\n\n- 信用担保支持的商业票据\n- 原来只有大公司能发，结果现在中等公司也能参与发行，原因：银行在面对商业票据等金融工具对其负债业务的竞争时，变被动为主动，开展中间业务挣得收入的重要方式。以这种方式发行的商业票据称为LOC票据。另一种是资产担保支持的商业票据。它以一揽子应收账款作抵押，来发行商业票据。\n- 原因：\n  - \u003cu\u003e因为一些短期的资金需求\u003c/u\u003e\n  - \u003cu\u003e出于桥式融资(bridge financing)的考虑\u003c/u\u003e\n\n##### 2.一级市场与二级市场\n\n- 商业票据按发行方式的不同可分为两种：\n  - 直接发行票据(direct paper)，这是由发行公司直接卖给投资者的票据。采用这种方式的公司多为金融公司。对这些公司而言，商业票据是重要的资金来源，需要经常发行，因而直接发行的成本较低。\n  - 交易商票据(dealer-placed paper)，即不是由公司直接发行，而是由交易商代销(best efforts)。\n- 影响：\n  - \u003cu\u003e影响银行资金来源，因为在投资者看来，商业票据是银行存款的重要替代品。\u003c/u\u003e\n  - \u003cu\u003e影响资金运用，因为在发行公司看来，商业票据是银行贷款的替代品。\u003c/u\u003e\n\n##### 3.商业票据的期限与收益\n\n- 商业票据的额度较大。最低交易额一般为10万美元。\n- 商业票据的期限最短为3天，最长一般少于270天，多数为30-50天。\n- 商业票据的收益一般高于同期限的国库券。这是因为：\n  - \u003cu\u003e商业票据有违约风险\u003c/u\u003e，而国库券是无风险债券，所以商业票据要有风险补贴。\n  - \u003cu\u003e国库券有免税的优点\u003c/u\u003e，即免征州和地方政府所得税。为使税后利率一致，商业票据的利率也要高些。\n  - 流动性原因，如前所述，商业票据的流动性较差。 \n\n##### 4.违约风险与信用评级\n\n- 投资级和非投资级\n\n##### 5.非美国商业票据市场\n\n#### 三、银行承兑汇票\n\n- 在国际贸易中，进口商与出口商的交易活动，创造了银行承兑票据。银行承诺进口商的货款一定支付。此时，一般会伴随融资活动，称为承兑融资。 \n\n#### 四、大额可转让存单\n\n##### 1.存单的发行者与投资者\n\n- 本国银行发行的存单。\n- 在美国之外发行的以美元标值的存单，称为欧洲美元存单(Eurodollar CDS)，由美、日、加等国主要在伦教发行。\n- 外国银行的美国分支机构发行的以美元标值的存单，称为扬基存单。\n- 储蓄银行和储蓄贷款协会发行的储蓄存单。\n- 存单的期限多数短于1年。超过1年的称为定期存单\n\n##### 2.存单的收益\n\n- 信用风险稍高和流动性稍差，所以存单的利率要高一些。\n\n#### 五、回购协议\n\n- 回购协议(repurchase agreements)是一种证券购买协议，协议中同时规定卖方将在未来特定时间以特定价格将证券买回。这种协议实际上是一种以证券为抵押的贷款\n\n##### 1.回购利率\n\n- 不同回购协议的利率是不同的，这主要取决于：\n  - \u003cu\u003e抵押品的质量\u003c/u\u003e。高质量的抵押品利率低。 \n  - \u003cu\u003e回购期限\u003c/u\u003e。不同期限的债券回购利率一般不同\n  - \u003cu\u003e交割要求\u003c/u\u003e。交割的交易成本越高，利率越低。 \n  - \u003cu\u003e抵押品的易得性\u003c/u\u003e。难以获得的抵押品对买方有一定的吸引力，所以买方可以要求一个较低的利率。 \n\n##### 2.信用风险\n\n- 为了保证买方利益，现在，回购协议的贷款额一般小于抵押品价值，两者的差额就是保证金(margin)。在回购期间，要定期钉住证券市场。如果市价下跌，那么，要么由卖方追加保证金，要么是给回购协议重新定价，即卖方将部分资金退还买方。 \n\n##### 3.市场主体\n\n- \u003cu\u003eMMMF、市政机构等部门\u003c/u\u003e一般通过回购协议进行投资，\u003cu\u003e商业银行和储蓄银行\u003c/u\u003e则往往通过回购协议筹集资金。\n- 许多交易商不仅利用回购市场(repo market)为其头寸融资，而且同时\u003cu\u003e进行相同期限的回购和逆回购\u003c/u\u003e，以赚取两者之间的利差。 \n\n#### 六、通知贷款\n\n- 通知贷款是一种短期放款，借贷双方都有权提前一天通知对方结束贷款。这种贷款由银行提供给证券的经纪人或交易商。贷款要求证券作为抵押。保证金账户上的证券经常充当这种抵押。 \n\n#### 七、联邦基金市场\n\n- 银行同业间拆出拆入准备的市场即为联邦基金市场。\n- 联邦基金利率与回购协议利率密切相关，因为他们同是商业银行筹集资金的方式。 \n- 一般而言，回购利率较联邦基金利率低。这主要是因为有无担保的差异。 \n\n### 第二节 中国的货币市场 \n\n#### 一、货币市场的发育状况\n\n#### 二、同业拆借市场\n\n- 这一同业拆借市场有两级网络\n  - 一级网络的参加者为商业银行的总行和来自35个城市的35家融资中心。\n  - 二级网络则是在这35家融资中心内，由各家商业银行的分行以及其他非银行金融机构在本地进行交易。\n  - 最初几个月，拆借市场的利率有一个最高限额。当年6月，利率最高限被取消。同业拆借利率可以看作实行了完全的市场化\n- Shibor和过去的 Chibor有明显的不同。\n  - 从形成方式看， Chibor是实盘交易形成的利率，而 Shibor是报价行报出的利率。\n  - 过去，实际上由于市场主体的参与意愿较弱，拆借市场流动性弱，交易规模小，相应的波动幅度也较大，而且容易受到操纵。\n  -  Shibor由交易活跃的银行参与报价，报价期限从隔夜到1年共16个，每天准时报价，为市场提供一个统一、完整和有效的短期利率曲线。\n\n#### 三、债券回购市场\n\n- 回购主要是国债回购。回购既可以在机构间进行，也可以在中央银行与金融机构间进行。\n- 我国的国债回购最早出现在1991年，是由中国证券市场研究设计中心(联办)所建立STAQ系统开办的。\n- 推出国债回购的目的，是提高国债的流动性，便利国债的发行。 \n- 买断式回购与封闭式回购：\n  - 现有的国债封闭式回购实际上是一种质押式回购，回购成交后，相应国债所有权并没有发生转移，因此，封闭式回购仅具有融资功能。\n  - 相对而言，国债买断式回购是一种“实券过户”的交易，回购成交后，相应国债从融资方账户过户至融券方账户，融券方在回购期间拥有相应国债的所有权和使用权，因此，买断式回购不仅是一种融资的工具，同时也可以作为融券的工具。\n  - 此外，封闭式回购实行“标准券”质押制度，买断式回购的标的券种为指定的单只国债。\n  - 买断式回购利率反而比封闭式回购利率高\n  - 大银行质押式融出资金，中小银行质押式融入，买断式融出\n\n#### 四、票据市场\n\n- 中国票据市场中的金融工具主要是银行承兑汇票。商业票据和本票都比较少。\n- 中国的商业票据主要是企业、商业银行和中央银行参与，比较单调，资金只有这样一条线，而且只有以商品交易为基础的票据。\n\n\n\n## 第十一章 财政证券市场\n\n### 第一节 西方国家的财政证券市场\n\n- 2/3为个人或私人机构，机构主要是商业银行等金融机构。地方政府与外国投资者也是重要的持有人。\n- 约有1/3的财政证券由联邦政府机构和联邦储备体系持有，这一点被许多人认为是不正常的。 \n\n#### 一、美国财政证券的类型\n\n- 贴现证券\n- 付息证券\n- 可交易证券在到期前可以被多次交易。它包括国库券、财政票据和财政债券。\n- 不可交易证券包括以下几类：\n  - 一类是由财政部对各种政府机构和信托基金发行的政府账户系列债券。当这些机构资金充裕时，就借款给财政部，以减少公开市场上的财政借款。\n  - 二是出售给公众的储蓄债券(savings bonds)。\n  - 三是对外国投资者和政府发行的非交易美元证券和以外币标值的证券(外国投资者持有的债券也包括可交易证券，因为在美国之外的伦敦、东京等地也有比较发达的美国国债二级市场)。\n  - 四是对州和地方政府发行的特种国债，这可以为后者筹集的资金提供一个短期投资渠道。 \n\n#### 二、美国财政证券的一级市场\n\n- 国债发行量巨大，所以必须定期分批拍卖，让市场消化。\n- 投标者包括竞争性投标者和非竞争性投标者。\n  - 竞争性投标者包括货币中心银行和证券公司等，大约占每次拍卖数的75%-85%。\n  - 非竞争性投标者主要是小的金融机构和个人。\n- 中央银行一般不在一级市场购买国债。因为这可能会影响到中央银行的独立性，使货币政策成为财政政策的附庸。\n- 在拍卖市场上，必须防止一级自营商垄断市场。\n- 财政部对拍卖市场进行了改革，允许非一级自营商在不缴纳保证金的情况下替客户投标，允许小交易商进行投标(投标者越多，勾结的可能性越小)，推动投标由书面投标向自动化投标转变等。\n- 公开拍卖与密封拍卖比较\n  - 公开拍卖更容易使投资者之间进行勾结。因为在公开拍卖中，投标者在共谋后，能够比较容易地监督对方的背叛行为。而在密封拍卖时，即使投标者达成了协议，也很容易出现背叛行为，所以就不容易出现共谋。\n  - 传统上，美国财政证券的拍卖多数采用多重价格拍卖方式，而且是密封进行的，称为第一价格密封拍卖(first-price sealed auction)方式。\n  - 多重价格拍卖\n    - 有利：发行者的发行收入，也使投标者之间有充分的竞争，\n    - 不利：\n      - 投标者如果出价偏低，就不大可能中标。如果出价偏高，虽然中标的概率较高，但也可能面临债券转手的损失，形成“赢者的损失”。\n      - 投标人不会愿意向财政部暴露自己的判断。\n      - 保密的方式使得交易商容易大量投标垄断市场。\n  - 单一价格拍卖\n    - 有利：不存在赢家的损失问题。投标者更有积极性。大量投标人的参加(需求增加)可能会提高发行价格。\n    - 不利：这种方法又使得财政部必须对所有中标者支付相同的最低价格。\n  - 增加价格拍卖(ascending price auction)：由财政部报出多个价格，投标者报出在每一个价格下的投标数量，寻找能使全部证券售出的价格，并以此价格发行。这种方式不再使用密封投标，交易者可以知道其他交易商的信息。其缺点是在多个价格下投标的交易成本较高。\n  - 招标：\n    - 缴款期招标。此时，国债发行的票面利率和发行价格都已确定。承销机构的中标与否取决于其缴款的时间顺序。\n    - 价格招标。在附息国债中，如果投标价格高于面值，就是国债的收益率低于票面利率；如果投标价格低于面值，就是国债的收益率高于票面利率；如果投标价格等于面值， 就是国债的收益率等于票面利率。\n    - 收益率招标。在进行价格或收益率招标的情况下，票面利率可能事先确定，但般是用所有中标收益率的加权平均来计算票面利率。\n\n#### 三、美国财政证券的二级市场\n\n##### 1.二级市场的流动性\n\n- 二级市场主要存在于场外。原因：\n  - 一是债券特别是财政债券的价格波动较小，投机性较弱，不一定需要交易所的价格发现。\n  - 二是债券主要由机构投资者持有。如果在交易所集中竞价，容易因为大宗交易影响价格。\n  - 三是债券的种类较多，发行条件各不相同，经常会有上市、下市的情况，业务处理较为复杂，在交易所交易的成本比较高。这类批发业务比较适合采用一对一的询价方式。\n\n##### 2.报价方式\n\n##### 3.交易中的利息补偿\n\n##### 4.市场的交易方式\n\n- 国债经纪商既可以代客买卖，也可以为自己的账户买卖。\n- 财政证券交易商持有的证券头寸往往是其资本的几十倍，因而其资产组合95%以上由短期贷款支持。这些短期贷款包括银行的通知放款与回购协议。\n\n#### 四、分拆的财政证券\n\n#### 五、联邦机构证券\n\n##### 1. 政府资助的企业证券\n\n- 政府资助的企业(CSEs)是由国会创建、公众经营但是由私人拥有的实体，目的是为某些特定部门的融资提供便利。\n- 对这些部门，如农场主、家庭住房所有者和学生等，政府有支持的义务。但是政府如果直接支持，则既不公平，又不一定有效率。\n- 例子：房利美和房地美\n\n##### 2.联邦有关机构证券市场\n\n- 联邦有关机构是政府的助手，如政府国民抵押协会、美国进出口银行、小企业管理局、海上管理局。\n\n- 联邦机构证券也是在场外交易的，往往是由国债交易商交易，其流动性比较差，所以买卖差价也比较大。\n\n#### 六、其他西方国家的政府证券市场\n\n- 有些国家的证券并不仅仅支付固定收益率。考虑到通货膨胀的因素，许多国家发行的一些政府债券收益率与物价指数挂钩。\n- 英国使用的主要是特别拍卖系统(ad hoc auction system)，即不是定期拍卖，而是在市场条件有利时再拍卖。这种方法比较灵活，而且不会引起市场的定期波动。\n- 还有随卖(tap system)方式，是政府对已发行证券的追加发行。 \n- 主权债务(sovereign debt)是一国中央政府的债务。S\u0026P、穆迪和惠誉都对主权债务进行评级。\n  - 评级分为两种：本币债务评级( local currency debt rating)与外币债务评级(foreign currency debt rating)。\n  - 之所以做这种划分，是因为二者的违约风险是不一样的。对于本币债务，政府可以通过调整货币政策和财政政策偿还，而外币债务需要用外汇偿还。\n\n### 第二节中国的国债市场\n\n- 1994年起国债发行数量迅速增长的原因，主要是财政赤字不能再向中央银行融资，而必须通过发行国债的方式弥补。\n- 1996年以后，启动经济的需要成为更重要的原因\n- 立法机关不具体限定中央政府当年国债发行额度，而是通过限定一个年末不得突破的国债余额上限来达到科学管理国债规模的方式。\n\n#### 一、中国国债市场的主要特征\n\n##### 1.中国国债发行的品种\n\n- 普通型国债包括：\n  - 无记名(实物)国债。这是一种实物债券，以实物券的形式记录债权，不记名\n  - 记账式国债。这种国债以电脑记账形式记录债权，通过无纸化方式在交易所和银行间债券市场发行和交易，后来又扩展到银行柜台发行，可以记名、挂失。\n  - 凭证式国债。这是一种储蓄债券，可以记名、挂失，以“凭证式国债收款凭证”记录债权，可提前兑付，不能上市流通，从购买之日起计息。\n  - 电子式储蓄国债\n- 特殊型国债包括：\n  - 定向债券。这是由财政部主要向养老保险基金待业保险基金(简称“两金”)及其他社会保险基金定向募集的债券，称为特种定向债券，简称定向债券。这种债券以收款凭证记录债权。\n  - 特别国债。1998年8月，筹集的资金全部用于补充国有独资商业银行资本金。2007年，用于购买2000亿美元外汇\n  - 专项国债。专项用于国民经济和社会发展急需的基础设施投入。此外，中国还发行过重点建设债券、保值公债等形式的国债。\n\n##### 2.中国国债的发行期限与利率\n\n- 1981年最初发行时，国债的期限为10年。1985年改为5年，后来又改为3年\n- 1994 年，中国第一次发行半年期国债，1996年发行了3个月期的国债。\n- 2001年以前，中国国内发行的国债以3-5年的中期国债为主，较长和较短期限的国债都比较少\n- 2001年6月，中国在全国银行间债券市场首次发行了长期国债\n- 从利息情况看，中国发行的国债最初都是到期一次性还本付息。\n  - 开始阶段，与美国的情况相反，中国的国债利率一般高于同期限银行款利率。\n  - 中国的国债市场利率逐步正常化。\n    - 目前，在银行间债券市场上，记账式国债交易的利率明显低于同期银行存款利率水平。\n    - 凭证式国偾的利率水平般高于或等于同期限银行存款利率水平。 \n\n#### 二、中国的一级市场\n\n- 1981-1990年采用的是行政推派的办法\n- 1991-1994年，中国主要实行承购包销方式。承购包销方式即为传统的组织承销团进行承销的方式。\n  - 按照国际惯例，先由承销团将国债买下，再由各成员向市场推销。\n  - 这种方式有利于政府及时获得资金，控制局面。但在中国，发行条件主要都是由政府确定的。这样，承购包销并不是真正的市场行为。以行政方法定价，如果国债定价过低，则会提高政府的融资成本；如果定价过高，就有可能发行失败。\n- 1994年起，柜台销售方式开始盛行。主要是利用银行的销售网点销售凭证式国债。 \n- 1995年起开始实行记账式国馈招标方式，即拍卖方式。\n- 1996年开始放开国债发行利率。 \n- 目前，国债一级市场基本上是银行间债券市场、柜台市场、交易所并存的局面\n- 招标方式\n\n#### 三、中国的国债二级市场\n\n- 中国的国债二级市场也由银行间债券市场、柜台交易市场和两个交易所组成\n- 中国的银行间债券市场实行做市商制度。\n\n## 第十二章公司债券市场\n\n### 第一节西方国家的公司债券市场\n\n- 发公司债的原因：\n  - 不会削弱现有股东的控制权力\n  - 可以降低交易成本\n\n#### 一、公司债券的期限\n\n- 公司债券的发行面额一般为100美元。\n- 大多数公司债券是定期债券\n- 小于10年的债务称为票据。20世纪初，公司债券甚至会超过100年。50-60年代，公司债务主要采用20-30年期限的债券形式。70-80年代，由于通货膨胀的影响，加上金融衍生产品能有效地防范短期利率风险，债券期限大大缩短了。90年代后，通货膨胀率下降， 100年期限的债券又重新出现了。\n\n#### 二、债券的担保\n\n##### 1.抵押债券\n\n##### 2.担保信托债券\n\n- 用自己持有的各种有价证券作为担保。\n\n##### 3.设备信托凭证\n\n- 设备信托凭证(equipment trust certificates)不是抵押债券，而是采取信托方式，但实际是以设备为抵押发行的，它使得公司可以以最低的公司债券市场利率筹资。\n\n##### 4.信用债券\n\n- 信用债券(debenture bonds)是没有特定财产担保的。但是，如果发行人不能履约，投资者仍然对其财产和收人有要求权。\n\n##### 5.次等级信用债券\n\n- 次等级信用债券(subordinated debenture bonds)是对发行人资产和收人的求偿权排位更靠后的债券。不仅位于信用债券之后，也位于其他一些债权人之后。 \n\n##### 6.担保债券\n\n- 担保债券(guaranteed bonds)需由另一实体作为担保。\n\n##### 7.收入债券\n\n- 收入债券是公司在重组或面临其他财务困难时发行的债券。与股票类似，只有在公司盈利时债券才有利息，但其对公司利润的求偿权优先于股东。\n\n#### 三、有关债券清偿的条款\n\n##### 1. 早赎和再融资条款\n\n- 由于利率会不断变化，所以公司债券的利息成本可能会变得偏高。当市场利率变得明显低于债券的息票利率时，公司如果赎回债券并发行新的低利息债券，就可以降低成本\n- 投资者的这种风险称为赎回风险。\n\n##### 2.偿债基金条款\n\n- 债券契约有时注明发行人有义务定期赎回一定比例的债券，这样做的目的是降低信用风险。\n\n#### 四、一级市场\n\n- 公司债券的公开发行一般要由几个由投资银行组成的承销团进行投标。\n- 公开发行公司债券一般要向SEC注册。法律对一些债券的发行和交易给予了免于注册的优惠。财政证券、市政证券是不需要注册的。\n\n#### 五、垃圾债券市场\n\n- 如果一种债券在初次发行时就被评为非投资级债券，那么，这种债券就称为初次发行高收益债券。\n- 除了初次发行高收益债券外，其他的高收益债券都是由投资级债券降级而形成的。降级的原因，可能是杠杆收购或者资本重组。如果不是因为杠杆收购或者资本重组，而是由于其他原因使投资级债券降级为非投资债券，这种垃圾债券就称为堕落天使。\n- 垃圾债券市场的发展，使得许多依赖银行贷款的公司，现在转而通过发行债券融资\n- 垃圾债券市场的成功确实有其积极意义：\n  - 第一，许多公司通过垃圾债券市场融资，而不是像以前那样依赖于银行贷款，这意味着最终风险承担者的转变。如果公司通过银行融资，那么风险最终可能是由FDIC的主办者——政府，并进而由全体选民承担的。这些人可能并不愿意承担风险。而通过垃圾债券市场融资，风险的承担者就是那些愿意承担风险的投资者了。\n  - 第二，垃圾债券的期限一般会长于从银行贷款的期限，公司因而可以得到更长期的资金支持。\n  - 第三，由于比较高的违约风险，许多公司是不可能从银行贷款的。垃圾债券市场使得那些被银行拒之门外的公司现在也拥有了融资机会。\n- 垃圾债券的收益率水平一般比同期限的国债高3%一7%，也高于投资级公司债券但低于普通股的收益率。在经济衰退时，垃圾债券的风险溢价会更高。\n\n#### 六、二级市场\n\n公司债券的流动性较差。 \n\n#### 七、欧洲债券市场\n\n欧洲债券(Eurobond)一般是由银行组成的承销团发行的短期无担保债券。\n\n### 第二节 中国的企业债券与公司债券市场\n\n#### 一、中国企业债券市场的发展\n\n- 1984年起，中国开始出现企业债券。当时，债券发行主要是一些企业自发进行的，内部职工是重要的投资者。这时发行的企业债券往往很不规范，甚至并不采取企业债券形式。\n- 1987年3月，国家开始对企业债券进行统一管理\n- 1993年起，整顿金融秩序，打击各种乱集资行为\n- 中国纯粹的企业债券的发债主体主要是国有企业进行固定资产投资。\n- 浮动利率债券发行逐渐增加，2007年开始，企业债券的发行开始尝试以Shibor为基准利率。企业债券的发行方式也在逐步市场化。\n\n- 滞后的原因：\n  - 政府方面：\n    - 长期以来，中国的企业融资先是依靠财政，后是依靠银行。政府集中精力培育股票市场。无需偿还，融资能力强。\n    - 在审批制下，企业很难及时发行企业债券。=\u003e后来改成了条件核准制\n    - 强调企业债券发行必须有固定的项目，企业的发债能力受到很大的限制。\n  - 利率方面：\n    - 按照1993年的规定，中国企业债券的发行利率不得高于同期银行储蓄存款利率的40%。\n    - 与管制银行利率一样，管制企业债券利率的目的也是防范金融风险。但是，管制企业债券利率的结果与管制银行利率截然不同。\n    - 由于银行在中国金融领域具有垄断地位，而且银行存款几乎是无违约风险的，所以无须担心银行的资金来源。但企业债券是有风险的，而且这一市场本来就很不发达，所以，管制本身就可能使得企业债券市场难以为继。\n\n#### 二、公司债券市场的发展\n\n#### 三、金融债券市场的发展\n\n- 中国金融债券的发行始于1985年。\n- 1998年，国家开发银行率先在银行间债券市场成功进行了金融债券的市场化发债。\n- 债券发行得到了人民银行的扶植。\n- 目前的金融债券主要包括：\n  - 政策性金融债券，由政策性银行在银行间市场发行。\n  - 商业银行债券。2004年后，商业银行为了满足资本充足率的要求，纷纷发行债券特别是次级债券和混合资本债券。混合资本债券属于商业银行的附属资本，求偿权位于次级债务之后、股权资本之前。\n  - 证券公司债券，包括短期融资券和次级债务等。\n  - 保险公司次级债。 \n  - 财务公司债务。\n\n ",title:"Untitled Page"},"/Regression Analysis":{content:"## Linear Statistical Models\n\n### OLS\n\nWe shall minimize $Q$ with respect to $\\beta_0$ and $\\beta_1$ by taking the partial derivatives and setting them to 0. We have\n\n$$\\frac{\\partial Q}{\\partial \\beta_{0}}=-2 \\sum_{i=1}^{n}\\left(y_{i}-\\beta_{0}-\\beta_{1} x_{i}\\right) =0 $$\n\n$$ \\frac{\\partial Q}{\\partial \\beta_{1}}=-2\\sum_{i=1}^{n}\\left(y_{i}-\\beta_{0}-\\beta_{1} x_{i}\\right) x_{i}=0$$\n\nNormal Equation\n\n$$\\begin{aligned}\\beta_{0} n+\\beta_{1} \\sum_{i=1}^{n} x_{i} \u0026=\\sum_{i=1}^{n} y_{i} \\\\\\beta_{0} \\sum_{i=1}^{n} x_{i}+\\beta_{1} \\sum_{i=1}^{n} x_{i}^{2} \u0026=\\sum_{i=1}^{n} x_{i} y_{i} .\\end{aligned}$$\n\n### Simple Linear Regression\n\n$$E(Y |x_1, . . . , x_k) = \\beta_0 + \\beta_1x_1 + . . . + \\beta_kx_k. $$\n\n$$Y=\\beta_0+\\beta_1x+\\varepsilon,\\varepsilon\\sim N(0,\\sigma^2)$$\n\nAssumptions:\n\n-   Normality. For $i = 1, . . . , n,$ the conditional distribution of $Y_i$ given the values $x_1, . . . , x_n$ is a normal distribution.\n\n-   Linear Mean. There are parameters $\\beta_0$ and $\\beta_1$ such that the conditional mean of $Y_i$\n\ngiven the values $x_1, . . . , x_n$ has the form $\\beta_0 + \\beta_1x_i$ for $i = 1, . . . , n$.\n\n-   Common Variance. There is a parameter $\\sigma^2$ such that the conditional variance of $Y_i$ given the values $x_1, . . . , x_n$ is $\\sigma^2$ for $i = 1, . . . , n.$ This assumption is often called **homoscedasticity**. Random variables with different variances are called **heteroscedastic**.\n    -   The error term is homoskedastic if the variance of the conditional distribution of $\\varepsilon_i$ given $X_i$ is constant for $i = 1,\\cdots, n$ and in particular does not depend on $X_i$. Otherwise, the error term is heteroskedastic.\n-   Independence. The random variables $Y_1, . . . , Y_n$ are independent given the observed $x_1, . . . , x_n$.\n-   Predictor is known.\n\nWe can now find the M.L.E.\n\n#### M.L.E. of Estimators\n\n$$\\hat{\\beta}_{1}=\\frac{\\sum_{i=1}^{n} x_{i} Y_{i}-n \\bar{x}_{n} \\bar{Y}_{n}}{\\sum_{i=1}^{n} x_{i}^{2}-n \\bar{x}_{n}^{2}}=\\frac{\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}_{n}\\right)\\left(Y_{i}-\\bar{Y}_{n}\\right)}{\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}_{n}\\right)^{2}}$$\n\n$$\n\n\\hat{\\beta}_{0}=\\bar{Y}_{n}-\\hat{\\beta}_{1} \\bar{x}_{n}$$\n\nLet us introduce the symbol\n\n$$\n\ns_{x}=\\left(\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}\\right)^{2}\\right)^{1 / 2}$$\n\nThus\n\n$$\n\\operatorname{E}[\\hat\\beta_1]=\\beta_1,\\operatorname{E}[\\hat\\beta_0]=\\beta_0\n$$\n\n$$\n\\operatorname{Var}\\left(\\hat{\\beta}_{1}\\right)=\\frac{\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}\\right)^{2} \\operatorname{Var}\\left(Y_{i}\\right)}{s_{x}^{4}}=\\frac{\\sigma^{2}}{s_{x}^{2}}\n$$\n\n$$\n  \n\\begin{aligned} \\operatorname{Var}(\\hat{\\beta_{0}})\u0026=\\operatorname{Var}(\\bar{Y}-\\hat{\\beta_{1}} \\bar{x})\\\\\u0026=\\operatorname{Var}(\\bar{Y})+\\bar{x}^{2}-2 \\bar{x} \\operatorname{Cov}(\\bar{Y}, \\hat{\\beta_{1}})\\\\\u0026=\\frac{\\sigma^{2}}{n}+\\frac{\\sigma^{2}}{s_{x}^{2}} \\bar{{x}}^{2}-0 \\\\\u0026=\\left(\\frac{1}{n}+\\frac{\\bar{x}^{2}}{s_{x}^{2}}\\right) \\sigma^{2} \\end{aligned}\n$$\n\n\n$$\n\\begin{aligned} \\operatorname{Cov}(\\hat{\\beta_{0}},\\hat{\\beta_{1}})\u0026=\\operatorname{Cov}(\\bar{Y}-\\hat{\\beta_{1}} \\bar{x},\\hat{\\beta_{1}})\\\\\u0026=\\operatorname{Cov}(\\bar{Y}, \\hat{\\beta_{1}})-\\bar{x} \\operatorname{Cov}(\\hat{\\beta_{1}}, \\hat{\\beta_{1}})\\\\\u0026=-\\bar{x} \\operatorname{Var}(\\bar{\\beta_{1}}) \\\\\u0026=-\\frac{\\bar{x} \\sigma^{2}}{s_{x}^{2}}\\end{aligned}\n$$\n\nSo we can calculate the expectations and variances of the linear combinations of $\\beta_0$ and $\\beta_1$.\n\n#### M.S.E. of Prediction\n\n$$\n\\begin{aligned}E\\left[(\\hat{Y}-Y)^{2}\\right] \u0026=E\\left\\{[(\\hat{Y}-\\mu)-(Y-\\mu)]^{2}\\right\\} \\\\\u0026=\\operatorname{Var}(\\hat{Y})+\\operatorname{Var}(Y)-2 \\operatorname{Cov}(\\hat{Y}, Y)\\\\\u0026=\\sigma^{2}\\left[1+\\frac{1}{n}+\\frac{(x-\\bar{x})^{2}}{s_{x}^{2}}\\right]\\end{aligned}\n$$\n\n#### M.L.E. for $\\sigma^2$\n\n$$\n\\hat \\sigma^2=\\frac{1}{n}\\sum_{i=1}^n\\left[Y_i-(\\hat\\beta_0+\\hat\\beta_1x_i)\\right]^2\n$$\n\nThe distribution of $n\\hat\\sigma^2/\\sigma^2$ is the $\\chi^2$ distribution with $n-2$ degrees of freedom.\n\n### Statistical Inference in Simple Linear Regression\n\n#### Unbiased Estimator of $\\sigma^2$\n\n$$ \n\\sigma^{\\prime}=\\left(\\frac{S^{2}}{n-2}\\right)^{1 / 2}, \\text{where}\\ \\ S^{2}=\\sum_{i=1}^{n}\\left(Y_{i}-\\hat{\\beta}_{0}-\\hat{\\beta}_{1} x_{i}\\right)^{2}\n$$\n\nNote that it is different from the M.L.E.\n\n#### Linear Combination of $\\beta_0$ and $\\beta_1$\n\n$$\n\\left[\\frac{c_{0}^{2}}{n}+\\frac{\\left(c_{0} \\bar{x}-c_{1}\\right)^{2}}{s_{x}^{2}}\\right]^{-1 / 2} \\frac{c_{0} \\hat{\\beta}_{0}+c_{1} \\hat{\\beta}_{1}-\\left(c_{0} \\beta_{0}+c_{1} \\beta_{1}\\right)}{\\sigma^{\\prime}}\n$$\n\nhas the $t$ distribution with $n-2$ degrees of freedom under the assumptions of simple linear regression.\n\nWe can use this random variable to test hypotheses about or to construct confidence intervals.\n\nPlug $\\sigma^{\\prime}$ into $\\operatorname{Var}\\left(\\hat{\\beta}{1}\\right)=\\frac{\\sigma^{2}}{s_{x}^{2}}$ and get the equation.\n\n#### Confidence Intervals\n\nThe open interval is a coefficient $1-\\alpha_0$ confidence interval for $c_0\\beta_0+c_1\\beta_1$.\n\n$$c_{0} \\hat{\\beta}_{0}+c_{1} \\hat{\\beta}_{1} \\pm \\sigma^{\\prime}\\left[\\frac{c_{0}^{2}}{n}+\\frac{\\left(c_{0} \\bar{x}-c_{1}\\right)^{2}}{s_{x}^{2}}\\right]^{1 / 2} T_{n-2}^{-1}\\left(1-\\frac{\\alpha_{0}}{2}\\right)$$\n\n#### Prediction Interval\n\n$$\\hat{Y} \\pm T_{n-2}^{-1}\\left(1-\\frac{\\alpha_{0}}{2}\\right) \\sigma^{\\prime}\\left[1+\\frac{1}{n}+\\frac{(x-\\bar{x})^{2}}{s_{x}^{2}}\\right]^{1 / 2}$$\n\n#### Coefficient of Determination\n\n$$R^2=1-\\frac{SSE}{SST}=1-\\frac{\\sum_{i=1}^{n}\\left(y_{i}-\\hat{y}_{i}\\right)^{2}}{\\sum\\left(y_{i}-\\bar{y}_{n}\\right)^{2}}$$\n\n## Multiple Linear Regression\n\nDesign Matrix $\\mathbf{X}$\n\n$$\\mathbf{X}=\\left[\\begin{array}{ccc}x_{10} \u0026 \\cdots \u0026 x_{1 p-1} \\\\x_{20} \u0026 \\cdots \u0026 x_{2 p-1} \\\\\\vdots \u0026 \\ddots \u0026 \\vdots \\\\x_{n} 0 \u0026 \\cdots \u0026 x_{n p-1}\\end{array}\\right]$$\n\n$$ \\mathbf{Y}_{n \\times 1}=\\mathbf{X}_{n \\times r} \\boldsymbol{\\beta}_{(k+1) \\times 1}+\\varepsilon_{n \\times 1}$$\n\n### Mean Vector and Covariance Matrix\n\n$$\n\n\\varepsilon_{i} \\sim N\\left(0, \\sigma_{i}^{2}\\right), \\quad E(\\varepsilon)=\\mathbf{0}, \\quad \\operatorname{Cov}(\\mathbf{Y})=\\operatorname{Cov}(\\varepsilon)=\\sigma^{2} \\mathbf{I}$$\n\nThe coordinates $Y_1, . . . , Y_n$ of $\\mathbf{Y}$ are independent.\n\n### The Joint Distribution of the Estimators\n\n$$\n\n\\widehat{\\boldsymbol{\\beta}}=\\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{Y},\\quad\\widehat{\\boldsymbol{\\beta}} \\sim N_{r}\\left(\\boldsymbol{\\beta}, \\sigma^{2}\\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1}\\right)$$\n\n$$\n\n\\operatorname{Var}(\\widehat{\\boldsymbol{\\beta}})=\\sigma^{2}\\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1}=\\sigma^{2}\\left(\\xi_{i j}\\right)_{i, j=0, \\cdots, k}$$\n\n### Testing Hypotheses\n\n$$\n{{\\sigma}^{\\prime}}^{2}=\\frac{\\widehat{\\varepsilon}^{\\prime} \\widehat{\\varepsilon}}{n-k-1},\\quad \\frac{(n-k-1){{\\sigma}^{\\prime}}^{2}}{\\sigma^2}\\sim\\chi^2(n-k-1) \n$$\n\n$$ \\frac{\\hat\\beta_j-\\beta_j^{\\star}}{\\sqrt{\\xi_{jj}}{{\\sigma}^{\\prime}}^{2}}\\sim t(n-k-1)\n$$\n\n### Prediction\n\n$$\n\\hat{\\mathbf{Y}}=\\mathbf{x}^{\\prime}\\left(\\mathbf{X}^{\\prime} \\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\prime} \\mathbf{Y}\n$$\n\n$$\nVar(\\hat{\\mathbf{Y}})=\\mathbf{x}^{\\prime}\\left(\\mathbf{X}^{\\prime}\\mathbf{X}\\right)^{-1}\\mathbf{x}\\sigma^2\n$$\n\n$$\n\\frac{Y-\\hat{Y}}{\\sigma^{\\prime}\\left[1+z^{\\prime}\\left(Z^{\\prime} Z\\right)^{-1} z\\right]^{1 / 2}}\\sim t(n-k-1)\n$$\n\n### Multiple R Squared\n\n$$R^{2}=1-\\frac{\\sum_{i=1}^{n}\\left(y_{i}-\\hat{y}_{i}\\right)^{2}}{\\sum_{i=1}^{n}\\left(y_{i}-\\bar{y}\\right)^{2}}$$\n\n$$adj\\ R^2=1-\\frac{\\hat\\sigma^2}{\\text {SST}/n-1}=1-\\frac{(1-R^2)(n-1)}{n-k-1}$$\n\n### Tests of Joint Hypotheses\n\nTest for an overall significant relationship between the response variable and all of the explanatory variables.\n\n#### F Test\n\n$$F=\\frac{1}{2}\\left(\\frac{t_{1}^{2}+t_{2}^{2}-2 \\hat{\\rho}_{t_{1}, t_{2}} t_{1} t_{2}}{1-\\hat{\\rho}_{t_{1}, t_{2}}^{2}}\\right)$$\n\nThe homoskedasticity-only F-statistic\n\n$$F =\\frac{(SSR_{restricted} - SSR_{unrestricted})/q}{SSR_{unrestricted}/(n - k_{unrestricted} - 1)}$$\n\n$$F =\\frac{(R_{unrestricted}^2 - R_{restricted}^2)/q}{(1 - R_{unrestricted}^2)(n -k_{unrestricted} - 1)} $$\n\n## ANOVA\n\nANOVA permits comparisons of multiple populations and even subgroups.\n\n### One-way ANOVA\n\nThe design matrix has a special form:\n\n$$\\boldsymbol{Z}=\\left[\\begin{array}{cccc}1 \u0026 0 \u0026 0 \u0026 0 \\\\\u0026 \\vdots \u0026 \u0026 \\\\1 \u0026 0 \u0026 0 \u0026 0 \\\\0 \u0026 1 \u0026 0 \u0026 0 \\\\\u0026 \\vdots \u0026 \u0026 \\\\0 \u0026 1 \u0026 0 \u0026 0 \\\\0 \u0026 0 \u0026 1 \u0026 0 \\\\\u0026 \\vdots \u0026 \u0026 \\\\0 \u0026 0 \u0026 1 \u0026 0 \\\\0 \u0026 0 \u0026 0 \u0026 1 \\\\\u0026 \\vdots \u0026 \u0026 \\\\0 \u0026 0 \u0026 0 \u0026 1\\end{array}\\right]$$\n\n#### Partitioning a Sum of Squares\n\n$$ S_{\\mathrm{Tot}}^{2}=S_{\\mathrm{Resid}}^{2}+S_{\\mathrm{Betw}}^{2}\n\n$$\n\n$$ S_{\\text {Resid }}^{2}=\\sum_{i=1}^{p} \\sum_{j=1}^{n_{i}}\\left(Y_{i j}-\\bar{Y}_{i+}\\right)^{2}, S_{\\text {Betw }}^{2}=\\sum_{i=1}^{p} n_{i}\\left(\\bar{Y}_{i+}-\\bar{Y}_{++}\\right)^{2} ,S_{\\mathrm{Tot}}^{2}=\\sum_{i=1}^{p} \\sum_{j=1}^{n_{i}}\\left(Y_{i j}-\\bar{Y}_{++}\\right)^{2}$$\n\n-   $\\bar Y_{++}$ is the overall average of all n observations.\n-   $S_{Resid}^2 /\\sigma^2$ has the $\\chi^2$ distribution with $n- p$ degrees of freedom and is independent of $S_{Betw}$.\n\n#### Testing Hypotheses\n\n$$U ^2 = \\frac{S_{Betw}^ 2 /(p - 1)}{S_{Resid}^2/(n-p)}$$\n\nhas the $F$ distribution with $p - 1$ and $n - p$ degrees of freedom.\n\nImportant ratio:\n\n$$\\frac{\\text{Variability AMONG/BETWEEN the means}}{\\text{Variability AROUND/WITHIN the distributions}}$$\n\n-   If the variabitlity BETWEEN the means (distance from overall mean) in the numerator is relatively large compared to the variance WITHIN the samples (internal spread) in the denominator, the ratio will be much larger than 1. The samples then most likely do NOT come from a common population; REJECT Null Hypothesis that mean(s) are equal.\n\n### Two-way ANOVA\n\n## Logistic Regression\n\n### Logit Model\n\n_Model_:\n\n$$\\pi_i=Pr(Y_i=1|X_i=x_i)=\\dfrac{\\text{exp}(\\beta_0+\\beta_1 x_i)}{1+\\text{exp}(\\beta_0+\\beta_1 x_i)}$$\n\nor,\n\n$$\\begin{aligned} \\text{logit}(\\pi_i)\u0026=\\text{log}\\left(\\dfrac{\\pi_i}{1-\\pi_i}\\right)\\\\ \u0026= \\beta_0+\\beta_1 x_i\\\\ \u0026= \\beta_0+\\beta_1 x_{i1} + \\ldots + \\beta_k x_{ik}\\\\ \\end{aligned}$$\n\n-   It uses maximum likelihood estimation (MLE) rather than ordinary least squares (OLS) to estimate the parameters, and thus relies on large-sample approximations.\n\nThe _maximum likelihood estimator_ (MLE) for $(\\beta_0, \\beta_1)$ is obtained by finding $(\\hat{\\beta}_0,\\hat{\\beta}_1)$ that maximizes:\n\n$$L(\\beta_0,\\beta_1)=\\prod\\limits_{i=1}^N \\pi_i^{y_i}(1-\\pi_i)^{n_i-y_i}=\\prod\\limits_{i=1}^N \\dfrac{\\text{exp}\\{y_i(\\beta_0+\\beta_1 x_i)\\}}{1+\\text{exp}(\\beta_0+\\beta_1 x_i)}$$\n\n-   $exp(\\beta_0)$ = the odds that the characteristic is present in an observation _i_ when _Xi_ = 0, i.e., at baseline.\n-   $exp(\\beta_1)$ = for every unit increase in _X_, the odds that the characteristic is present is multiplied by $exp(\\beta_1)$. This is similar to simple linear regression but instead of additive change it is a multiplicative change in rate. This is an estimated _odds ratio_.\n\n$$\\dfrac{\\text{exp}(\\beta_0+\\beta_1(x_{i1}+1))}{\\text{exp}(\\beta_0+\\beta_1 x_{i1})}=\\text{exp}(\\beta_1)$$\n\n### Probit Model\n\nThe _probit_ model\n\n$$\\text{probit}(\\pi(x))=\\beta_0+\\beta x$$\n\nuses _normal_ cdf\n\n$$\\text{probit}(\\pi)=F^{-1}(X \\leq x)$$\n\n### Hypothesis Tests\n\nLikelihood ratio tests\n\nThe likelihood for $n$ observations:\n\n$$L=\\prod_{i=1}^{n}\\left(\\frac{\\exp \\left(x_{i}^{\\prime} \\beta\\right)}{1+\\exp \\left(x_{i}^{\\prime} \\beta\\right)}\\right)^{\\sum_{i=1}^{n} Y_{i}}\\left(1-\\frac{\\exp \\left(x_{i}^{\\prime} \\beta\\right)}{1+\\exp \\left(x_{i}^{\\prime} \\beta\\right)}\\right)^{n-\\sum_{i=1}^{n} Y_{i}}$$\n\nLikelihood Ratio\n\n$$LR = −2\n\nl(\\hat\\beta|H_0) − 2l(\\hat\\beta|H_A)\\sim \\chi^2_p $$\n\nneed to fit two models: the full model and the model under $H_0$. Then $l(\\hat\\beta|H_0)$ is the log-likelihood from the model under $H_0$, and $l(\\hat\\beta|H_A)$ is the log-likelihood from the full model.\n\n$$LR=Deviance_A-Deviance_0 $$\n\n### Wald tests\n\n$$\\frac{\\hat{\\beta}_{j}-\\beta_{j 0}}{\\hat{s e}(\\hat{\\beta})} \\sim N(0,1)$$\n\nLimitation\n\n### Overdispersion\n\nFor the binomial response, if $Y_i \\sim Bin(n_i, \\pi_i)$, the mean is $\\mu_i=n_i\\pi_i$ and the variance is $n_i\\pi_i(1-\\pi_i)$.\n\n-   **_Overdispersion_** means that the data show evidence that the variance of the response is greater than $n_i\\pi_i(1-\\pi_i)$.\n-   Overdispersion can be explained by\n    -   variation among the success probabilities\n    -   correlation between the binary responses\n\nThe most popular method for adjusting for overdispersion comes from the theory of quasi-likelihood.\n\n\n## Reference\n\nIntroduction to Econometrics / James H. Stock \u0026 Mark W. Watson C6-C9 esp. multiple t test\n\nProbability and Statistics / Morris H. DeGroot \u0026 Mark J. Schervish C7-C11 except C10\n\n[Lesson 7: Further Topics on Logistic Regression](https://online.stat.psu.edu/stat504/node/217/)\n\n[极大似然估计和贝叶斯估计](https://zhuanlan.zhihu.com/p/61593112)\n\n[Probability \u0026 Statistics Fundamental](https://nancyyanyu.github.io/posts/c27004a0/)\n\n[Logistic 回归模型的参数估计为什么不能采用最小二乘法？](https://www.zhihu.com/question/23817253)\n\n[在进行 OLS 估计时，为了满足 BLUE 条件，为什么会有 X 取值要在重复抽样时固定的前提？](https://www.zhihu.com/question/25832437)\n\n[](https://www.groups.ma.tum.de/fileadmin/w00ccg/statistics/czado/lec5.pdf)\n\n[](https://courses.washington.edu/b515/l13.pdf)\n\n[逻辑回归是否靠谱，你懂得如何裁判吗？](https://mp.weixin.qq.com/s?subscene=23\u0026__biz=MzAxMDA4NjU3OA==\u0026mid=2652553697\u0026idx=1\u0026sn=09f2a67c9fe3a7081ee8fd76d40150a6\u0026chksm=80bbd03cb7cc592a928c50b7b16518b1837d7a1258fa6d6cad305ff5e09525b98e26b1b147c8\u0026scene=7\u0026key=cc7cc2a0b445493e5a74d4ae079f895dfc0c723c3cff51870eaa2a2a299182d9309998c97eb86ff92300a6f2c05bd4d4f760054842fab5deff7b4ff39f1e151212234c47c80d1d2bf5d2c619ceb025d8a1f838dd7fbcb62c777b6239e637772bdecc698e4c1aadb4a61511031c88bfc27f30af629897d1c218e8cc582ff5a929\u0026ascene=0\u0026uin=MjU1NDk5MDUwOA%3D%3D\u0026devicetype=Windows+10+x64\u0026version=6300002f\u0026lang=zh_CN\u0026exportkey=A5G3CGCLpGJLnOrCZ13ZVHs%3D\u0026pass_ticket=ok4tnaFWS7zPPSCRKPSyUIzrRRcpn0LMaKl%2FkngUWsaWK0ChENo%2FKgwaJH5CCexq\u0026wx_header=0)",title:"Untitled Page"},"/Statistical Inference":{content:"## Estimation\n\n### Prior and Posterior Distributions\n\n-   Suppose that one has a statistical model with parameter $\\theta$. If one treats $\\theta$ as random, then the distribution that one assigns to $\\theta$ before observing the other random variables of interest is called its prior distribution.\n-   Consider a statistical inference problem with parameter $\\theta$ and random variables $X_1, . . . , X_n$ to be observed. The conditional distribution of $\\theta$ given $X_1, . . . , X_n$ is called the posterior distribution of $\\theta$.\n-   Suppose that the $n$ random variables $X_1, . . . , X_n$ form a random sample from a distribution for which the p.d.f. or the p.f. is $f (x|\\theta)$. Suppose also that the value of the parameter $\\theta$ is unknown and the prior p.d.f. or p.f. of $\\theta$ is $\\xi(\\theta)$. Then the posterior p.d.f. or p.f. of $\\theta$ is\n\n$$\\xi(\\theta \\mid \\boldsymbol{x})=\\frac{f\\left(x_{1} \\mid \\theta\\right) \\cdots f\\left(x_{n} \\mid \\theta\\right) \\xi(\\theta)}{g_{n}(\\boldsymbol{x})} \\quad \\text { for } \\theta \\in \\Omega$$\n\n-   where $g_n$ is the marginal joint p.d.f. or p.f. of $X_1, . . . , X_n$.\n\n$$g_{n}(\\boldsymbol{x})=\\int_{\\Omega} f_{n}(\\boldsymbol{x} \\mid \\theta) \\xi(\\theta) d \\theta$$\n\n### Conjugate Prior Distributions\n\n### Bayes Estimators\n\n-   A Bayes estimator is an estimator that is chosen to minimize the posterior mean of some measure of how far the estimator is from the parameter, such as squared error or absolute error.\n-   expected loss：\n\n$$E[L(\\theta, a) \\mid \\boldsymbol{x}]=\\int_{\\Omega} L(\\theta, a) \\xi(\\theta \\mid \\boldsymbol{x}) d \\theta$$\n\n-   For each possible value $x$ of $X$, let $\\delta^\\star(\\boldsymbol x)$ be a value of a such that $E[L(\\theta, a)|x]$ is minimized. Then $\\delta^\\star$ is called a Bayes estimator of $\\theta$.\n-   Suppose that the squared error loss function is used and that the posterior mean of $\\theta, E(\\theta \\mid \\boldsymbol{X}),$ is finite. Then, a Bayes estimator of $\\theta$ is $\\delta^{*}(\\boldsymbol{X})=E(\\theta \\mid \\boldsymbol{X})$.\n-   To apply the theory, it is necessary to specify a particular loss function, such as the squared error or absolute error function, and also a prior distribution for the parameter. Meaningful specifications may exist, in principle, but it may be very difficult and time-consuming to determine them.\n\n### Maximum Likelihood Estimators\n\n-   When the joint p.d.f. $f_n(\\boldsymbol{x}|\\theta)$ of the observations in a random sample is regarded as a function of $\\theta$ for given values of $x_1, . . . , x_n$, it is called the likelihood function.\n-   If we plug the observed values of the data into the conditional p.f. or p.d.f. of the data given the parameter, the result is a function of the parameter alone, which is called the likelihood function.\n-   Maximum Likelihood Estimator/Estimate. For each possible observed vector $\\boldsymbol{x},$ let $\\delta(\\boldsymbol{x}) \\in \\Omega$ denote a value of $\\theta \\in \\Omega$ for which the likelihood function $f_{n}(\\boldsymbol{x} \\mid \\theta)$ is a maximum, and let $\\hat{\\theta}=\\delta(\\boldsymbol{X})$ be the estimator of $\\theta$ defined in this way. The estimator $\\hat{\\theta}$ is called a maximum likelihood estimator of $\\theta .$ After $\\boldsymbol{X}=\\boldsymbol{x}$ is observed, the value $\\delta(\\boldsymbol{x})$ is called a maximum likelihood estimate of $\\theta$.\n\n#### Limitations of Maximum Likelihood Estimation\n\nNonexistence of an M.L.E.\n\n$$f(x \\mid \\theta)=\\left\\{\\begin{array}{ll}\\frac{1}{\\theta} \u0026 \\text { for } 0\u003cx\u003c\\theta \\\\0 \u0026 \\text { otherwise }\\end{array}\\right.$$\n\nNon-uniqueness of an M.L.E.\n\n$$f_{n}(\\boldsymbol{x} \\mid \\theta)=\\left\\{\\begin{array}{ll}1 \u0026 \\text { for } \\theta \\leq x_{i} \\leq \\theta+1,(i=1, \\ldots, n) \\\\0 \u0026 \\text { otherwise }\\end{array}\\right.$$\n\nThus, it is possible to select as an M.L.E. any value of $\\theta$ in the interval\n\n$$ \\max \\left\\{x_{1}, \\ldots, x_{n}\\right\\}-1 \\leq \\theta \\leq \\min \\left\\{x_{1}, \\ldots, x_{n}\\right\\} $$\n\nSampling from a Mixture of Two Distributions\n\n### Properties of Maximum Likelihood Estimators\n\n-   Invariance: Let $\\hat\\theta$ be an M.L.E. of $\\theta$, and let $g(\\theta)$ be a function of $\\theta$. Then an M.L.E. of $g(\\theta)$ is $g(\\hat\\theta)$.\n-   Consistency: the sequence of M.L.E.’s converges in probability to the unknown value of $\\theta$ as $n \\rightarrow \\infty$.\n\n## Sampling Distributions of Estimators\n\n### Joint Distribution of the Sample Mean and Sample Variance\n\n-   Let $X_{1}, \\ldots, X_{n}$ be a random sample from the normal distribution with mean $\\mu$ and variance $\\sigma^{2}$. Then the sample mean $\\hat{\\mu}=\\bar{X}{n}=\\frac{1}{n} \\sum{i=1}^{n} X_{i}$ and sample variance $\\widehat{\\sigma^{2}}=\\frac{1}{n} \\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}_{n}\\right)^{2}$ are independent random variables. Furthermore, $\\hat{\\mu}$ has the normal distribution with mean $\\mu$ and variance $\\sigma^{2} / n,$ and $n \\widehat{\\sigma}^{2} / \\sigma^{2}$ has a chi-square distribution with $n-1$ degrees of freedom.\n\n### Confidence Intervals\n\n-   We can find an interval $(A, B)$ that we think has high probability of containing $θ$. The length of such an interval gives us an idea of how closely we can estimate $θ$.\n-   Let $X = (X_1, . . . , X_n)$ be a random sample from a distribution that depends on a parameter (or parameter vector) $\\theta$. Let $g(\\theta)$ be a real-valued function of $\\theta$. Let $A \\leq B$ be two statistics that have the property that for all values of $\\theta$,\n\n$$Pr(A \u003c g(\\theta) \u003c B) ≥ \\gamma$$\n\n-   Then the random interval $(A, B)$ is called a coefficient $\\gamma$ confidence interval for $g(θ)$.\n\n### Unbiased Estimators\n\n-   Let $\\delta$ be an estimator of a function $g$ of a parameter $\\theta$. We say that $\\delta$ is unbiased if $E_{\\theta}[\\delta(X)] = g(\\theta)$ for all values of $\\theta$.\n-   The quality of an unbiased estimator must be evaluated in terms of its variance or its M.S.E.\n-   Limitations:\n    -   Nonexistence of an Unbiased Estimator\n        -   suppose that $X_1, . . . , X_n$ form n Bernoulli trials for which the parameter $p$ is unknown. It can be shown that there will be no unbiased estimator of $p^{1/2}$.\n    -   Inappropriate Unbiased Estimators\n        -   Consider an infinite sequence of Bernoulli trials for which the parameter $p$ is unknown $(0 \u003c p \u003c 1)$, and let $X$ denote the number of failures that occur before the first success is obtained.\n\n## Testing Hypotheses\n\n### Problems of Testing Hypotheses\n\nConcepts:\n\n-   Because of focusing on type I error instead of type II error, we usually regard type I error as having more serious consequences than type II error.\n    \n-   Hence, in formulating null and alternative hypotheses, we use the more conservative hypothesis as the null hypothesis, and will only reject it when the data provide statistically significant evidence against it.\n    \n-   Type I \u0026 II Error\n    \n    $$\\begin{array}{r|cc} \u0026\\text{Actually $H_0$ is True}\u0026\\text{Actually $H_1$ is True}\\\\ \\hline\\text{Do not reject $H_0$}\u0026 \\text{Correct} \u0026\\text{Type II Error} \\\\ \\text{Reject $H_0$} \u0026 \\text{Type I Error} \u0026\\text{Correct} \\\\ \\end{array}$$\n    \n-   Size\n    \n    -   Loosely, the size $\\alpha(\\delta)$ of a given test $\\delta$ is the maximum probability of type I error.\n-   Level\n    \n    -   $\\delta$ is a level $\\alpha_0$ test if and only if $\\alpha(\\delta)\\leq\\alpha_0$.\n-   $p$-value\n    \n    -   A $p$-value is a probability that provides a measure of the evidence against the null hypothesis provided by the sample.\n    -   In general, the $p$-value is the smallest level $\\alpha_0$ such that we would reject the null hypothesis at level $\\alpha_0$ with the observed data.\n    -   For each $x$, let $\\delta_x$ be the test that rejects $H_0$ if $X\\geq x$. Then the $p$-value equals:\n    \n    $$ \\sup _{\\theta \\in \\Omega_{0}} \\pi\\left(\\theta | \\delta_{x}\\right)=\\sup _{\\theta \\in \\Omega_{0}} \\operatorname{Pr}(X \\geq x | \\theta)\n    \n    $$\n    \n-   Critical Value\n    \n    -   The critical values are the boundaries of the acceptance region of the test.\n    -   The critical value will be a quantile of a certain distribution.\n\n### The t Test\n\n### Comparing the Means of Two Normal Distributions\n\n### The F Distributions\n\n## Categorical Data and Nonparametric Methods\n\n### Tests of Goodness-of-Fit\n\n### Goodness-of-Fit for Composite Hypotheses\n\n### Contingency Tables\n\n### Tests of Homogeneity\n\n### Simpson’s Paradox\n\n## Four Steps to Hypothesis Testing\n\n### Compute the test statistic\n\n| Situation                                                | Null Hypothesis | Test Statistic                                               | Critical Region     |\n| :------------------------------------------------------- | --------------- | ------------------------------------------------------------ | --------------------------------- |\n| Mean of a Population (known $\\sigma$) | $\\mu=\\mu_0$ | $U=\\frac{\\bar x-\\mu_0}{\\sigma/\\sqrt{n}}$ | $\\{\\lvert U\\rvert\\geq U_{1-\\alpha/2}\\}$ |\n| Mean of a Population (unknown $\\sigma$) |      $\\mu=\\mu_0$            | $T=\\frac{\\bar x-\\mu_0}{s/\\sqrt{n}}$                          | $\\{\\lvert T\\rvert\\geq t_{1-\\alpha/2}(n-1)\\}$ |\n| Proportion of a Population | $p= p_0$ | $U=\\frac{\\hat{p}-p_{0}}{\\sqrt{\\frac{p_{0}\\left(1-p_{0}\\right)}{n}}}$ | $\\{\\lvert U\\rvert\\geq U_{1-\\alpha/2}\\}$ |\n| Means of Two Populations (known $\\sigma$) | $\\mu_1=\\mu_2$ | $U=\\frac{(\\bar x-\\bar{y})}{\\sqrt{\\frac{\\sigma_{1}^{2}}{m}+\\frac{\\sigma_{2}^{2}}{n}}}$ |   $\\{\\lvert U\\rvert\\geq U_{1-\\alpha/2}\\}$   |\n| Means of Two Populations (unknown $\\sigma$ and $\\sigma_1=\\sigma_2$ ) | $\\mu_1=\\mu_2$ | $T=\\frac{\\bar x-\\bar y}{s_p\\sqrt{\\frac{1}{m}+\\frac{1}{n}}},\\\\ s_{p}^{2}=\\frac{(m-1) s_{x}^{2}+(n-1) s_{y}^{2}}{m+n-2}$ | $\\{\\lvert T\\rvert\\geq t_{1-\\alpha/2(m+n-2)}\\}$ |\n| Means of Two Populations (unknown $\\sigma_1,\\sigma_2,\\sigma_1\\neq\\sigma_2$ and large sample) | $\\mu_1=\\mu_2$ | $U=\\frac{\\bar x-\\bar y}{\\sqrt{\\frac{s_x^2}{m}+\\frac{s_y^2}{n}}}$ | $\\{\\lvert U \\rvert\\geq U_{1-\\alpha/2}\\}$ |\n| Means of Two Populations (unknown $\\sigma_1,\\sigma_2,\\sigma_1\\neq\\sigma_2$ and small sample)[Do not need to know] | $\\mu_1=\\mu_2$ | $T=\\frac{\\bar x-\\bar y}{\\sqrt{\\frac{s_x^2}{m}+\\frac{s_y^2}{n}}}$ | $\\{\\lvert T\\rvert\\geq t_{1-\\alpha/2}(l-1)\\},\\\\l=\\frac{s^{4}}{\\frac{s_{x}^{4}}{m^{2}(m-1)}+\\frac{s_{y}^{4}}{n^{2}(n-1)}},s_{0}^{2}=\\frac{s_{x}^{2}}{m}+\\frac{s_{y}^{2}}{n}$ |\n| Proportion of Two Populations | $p_1=p_2$ | $U=\\frac{\\hat{p}_{1}-\\hat{p}_{2}}{\\sqrt{\\hat{p}(1-\\hat{p})\\left(\\frac{1}{n_{1}}+\\frac{1}{n_{2}}\\right)}}, \\hat{p}=\\frac{n_{1} \\hat{p}_{1}+n_{2} \\hat{p}_{2}}{n_{1}+n_{2}}$ | $\\{\\lvert U\\rvert\\geq U_{1-\\alpha/2}\\}$ |\n| Matched Pairs | $\\delta=\\mu_1-\\mu_2,\\delta=\\mu_0$ | $T=\\frac{\\delta-\\mu_0}{s_{\\delta}/\\sqrt{n}}$ | $\\{\\lvert T\\rvert \\geq t_{1-\\alpha/2}(n-1)\\}$ |\n| Variance of Two Populations | $\\sigma_1^2=\\sigma_2^2$ | $F=\\frac{s_x}{s_y}$ | $\\left\\{F \\leq F_{\\alpha/2}(m-1, n-1) \\text { or } F \\geq F_{1-\\alpha / 2}(m-1, n-1)\\right\\}$ |\n| Coefficient | $\\hat\\beta_j=\\beta_j^{\\star}$ | $T=\\frac{\\hat\\beta_j-\\beta_j^{\\star}}{SE(\\hat \\beta_j)}$ | $\\{\\lvert T\\rvert \\geq t_{1-\\alpha/2}(n-k-1)\\}$ |\n| Goodness of Fit (known $p_i$) | $P(A_i)=p_i$ | $Q=\\sum_{i=1}^{k} \\frac{\\left(N_{i}-n p_{i}\\right)^{2}}{n p_{i}}$ | $\\{Q\\geq \\chi^2_{1-\\alpha}(k-1)\\}$ |\n| Goodness of Fit (unknown $p_i$) | $P(A_i)=p_i$ | $Q=\\sum_{i=1}^{k} \\frac{\\left[N_{i}-n \\pi_{i}(\\hat{\\theta})\\right]^{2}}{n \\pi_{i}(\\hat{\\theta})}$ | $\\{Q\\geq \\chi^2_{1-\\alpha}(k-s-1)\\}$ |\n| Independence in Contingency Tables | $p_i, p_j\\ independent$ | $Q=\\sum_{i=1}^{R} \\sum_{j=1}^{c} \\frac{\\left(N_{i j}-\\hat{E}_{i j}\\right)^{2}}{\\hat{E}_{i j}}$ | $\\{Q\\geq \\chi^2_{1-\\alpha}((R-1)(C-1))\\}$ |\n\n**Note:** $\\bar x,\\bar y$ is the sample mean. $s,s_x,s_y$ is the standard deviation of sample. i.e. $s=\\sqrt{\\frac{\\sum\\left(X_{i}-\\bar{X}\\right)^{2}}{n-1}}$. ",title:"Untitled Page"},"/Swap":{content:"## 利率互换\n\n- 互换利率是互换交易中的固定利率（息票利率）\n- 互换利差=互换利率-同期国债利率\n- 对于美国市场的标准互换合约，互换利率=（Bid+Offer）/2\n    - Bid: pay fixed receive LIBOR\n    - Ask: pay LIBOR receive fixed\n\n### 利用互换转变负债的性态\n\n- 利率互换可将其浮动利率贷款转换为固定利率贷款。\n    - 支付给外部贷款人的利率为LIBOR+0.1%\n    - 在互换合约中收入LIBOR\n    - 在互换合约中付出5%。\n- 利率互换可将其固定利率贷款转换为浮动利率贷款。\n    - 支付给外部贷款人的利率为5.2%\n    - 在互换合约中付出LIBOR\n    - 在互换合约中收入5%。\n\n### 利用互换转变资产的性态\n\n- 将收入为固定利率的资产转换为收入为浮动利率的资产\n\n- 将其浮动利率资产转换为固定利率资产\n\n### 做市商\n\n- 金融机构在进入利率互换的同时，不一定要进入与其他交易对手之间的互换交易。\n\n- 买入和卖出利率的平均值被称为互换利率。\n\n- 如果合约中的固定利率等于当前的互换利率，可以合理地假设这一互换的价值为0.\n\n$$B_{fix}=B_{float}$$\n\n### 确定LIBOR/互换零息利率\n\n- “连续更新”的LIBOR利率\n- 新发行的券息为LIBOR的浮动息债券价格将总会等于本金价格（平价）\n- 而对于一个**新成交**的互换交易，**当固定利率等于互换利率时**，固定利率的价格等于浮动利率的价格也就是**本金**，互换利率定义了一组平价债券\n- LIBOR和固定息互换利率定义了一系列平价债券\n- 用票息剥离法来确定并**延长**LIBOR/互换零息曲线\n\n$$\\begin{aligned}\n\n\u00260.5\\times swap\\ rate \\times e^{-LIBOR_{6m}\\times 0.5}\\\\\u0026+0.5\\times swap\\ rate \\times e^{-LIBOR_{12m}\\times 1}\\\\\u0026+0.5\\times swap\\ rate \\times e^{-LIBOR_{18m}\\times 1.5}\\\\\u0026+(100+0.5\\times swap\\ rate )\\times e^{-LIBOR_{24m}\\times 2}=100\n\n\\end{aligned}$$\n\n### OIS利率\n\n- 联邦基金利率（Fed funds rate）是美国金融机构之间的无抵押隔夜拆借利率，由经纪商所促成交易的加权平均利率为有效联邦基金利率（Effective federal funds rate）\n- OIS是将一段时间内的固定利率和隔夜利率的几何平均值进行交换的合约，其中的固定利率被称为隔夜指数互换利率（OIS rate）\n- OIS利率是对于无风险利率的一个好的近似估计\n\n### 确定OIS零息利率\n\n- 需要长期的OIS零息利率时，可以假设OIS利率和相应的LIBOR/互换利率的溢差在一定期限之外是一样的\n\n### 利率互换的定价\n\n横向分解\n\n- 浮动利率债券多头＋固定利率债券空头\n- 浮动利率债券空头＋固定利率债券多头\n- 浮动利率债券：相当于第一期初买一个平价债券，持有一期；在第二期期初收回本息，再买一个平价债券……一直到第n期\n- 在每一个付息日（在支付利息之后），浮动利率债券的价格等于面值\n- the value of the floating-rate bond today is $(L+k^{\\star})e^{-r^{\\star}t^{\\star}}$, where $r^{\\star}$ is the LIBOR/swap zero rate for a maturity of $t^{\\star}$.\n- 注意利息支付是否是复利的：一期本金+利息再折现\n\n纵向分解：看成是后付的FRA\n\n- 利率互换中的每一次支付交换就是一个远期利率合约\n- 定价过程：\n    - 计算用于决定互换现金流的LIBOR远期利率\n    - 假定LIBOR利率等于远期利率，并计算互换的现金流\n    - 用无风险利率对现金流进行贴现。\n- 注意要用利率期限结构估计出LIBOR的远期利率再代入FRA的计算中\n\n## 货币互换\n\n定义$V_{swap}$为收入美元并支付外币的货币互换的美元价值，那么：\n\n$$\nV_{swap}=B_D-S_0B_F$$\n\n其中$B_F$为互换中外汇现金流所对应的债券以外币计价的价值，$B_D$为互换中本国货币现金流所对应的债券以美元计价的价值，$S_0$为即期汇率（1单位外币所对应的美元数量）。\n\n\n## 信用风险\n\n- 在对手违约时，如果互换对于金融机构具有正价值，金融机构将蒙受损失；但如果互换对于金融机构具有负价值，则违约不会产生影响。\n\n- 市场风险来源于利率、汇率等市场变量，可以通过进入相互抵消的合约来进行对冲，但信用风险不能简单地对冲。\n\n## 其他互换\n\n- 本金数量在互换期限内可能有变化：amortizing swap, step-up swap\n- 在未来的某一时刻才开始利息交换：deferred swap, forward swap\n- 固定期限互换：LIBOR与某种互换利率交换\n- Diff互换/Quanto\n- 股权互换：某个股指的总收益与某固定或浮动利率互换\n- 可延期互换、可赎回互换\n- 商品互换、波动率互换\n",title:"Untitled Page"},"/TBA Market and Dollar Roll":{content:"---\nArea: Finance\nSource: Paper\nStatus: Done\nType: Notes\n---\n\n\n\n本文综述了Song and Zhu两位教授发表于RFS的文章“Mortgage Dollar Roll”，并辅以其他文献整理总结 Agency MBS、TBA 市场及 Dollar Roll 的融资机制。\n\n## 机构 MBS (Agency MBS)\n\nAgency MBS 是指由 Ginnie Mae (GNMA)、Fannie Mae (FNMA) 和 Freddie Mac (FHLM) 担保的抵押贷款支持证券 (MBS)，是美国固定收益市场的主要组成部分。其重要性主要体现在以下特点：\n\n- **规模大**：根据 SIFMA 的数据，截至 2017 年第二季度，机构抵押贷款支持证券（MBS）的流通量约为 9.2 万亿美元，仅次于美国国债市场的流通量 14.0 万亿美元。\n- **货币政策传导作用**：美联储自 2009 年以来进行了多轮量化宽松（QE），累计面值为 1.74 万亿美元。\n- **住房抵押贷款作用**：RMBS 满足了居民的购房需要，而机构 MBS 市场对抵押贷款市场的健康发展至关重要。\n\n## TBA市场 (To-be-announced market, TBA market)\n\nTBA 合约本质上是MBS的远期买卖合约。在 TBA 交易中，买卖双方只约定六个参数：发行人 (Agency)、到期日 (Maturity)、票息 (Coupon)、面值 (Par Amount)、价格 (Price)、结算日 (Settlement Date)。与其他远期合约不同，TBA 合约每月只有一个结算日，由 SIFMA 设定。\n\nTBA 交易的独特之处在于，在结算日交付的交易双方并未在交易日指定具体的需要买卖的 MBS CUSIP，而是仅指定几个关键的 MBS 特征。这种交易设计显著增加了可交付 MBS 的数量并提高了市场流动性。 \n\nTBA 市场可以为抵押贷款发起人提供风险对冲和融资作用。贷款机构通常会给予优质申请人30天到90天的利率锁定期，允许申请人在锁定期内决定是否按照特定的固定利率借入款项，这实质上相当于给予贷款申请人一个30天到90天的“固定利率期权”。贷款发起人将面临市场利率变动所引发的利率风险。通过TBA市场，抵押贷款发起人可以在发放贷款之前就锁定MBS的转售价格，比较直接地实现了对贷款利率风险的对冲目的。因此，即使是小规模贷款机构也可以发放贷款，使购房者获得更低廉的利率。\n\n## 美元滚动交易 (Dollar Roll)\n\n美元滚动交易由两笔 TBA 交易组成。卖家 (roll seller, MBS持有者，即融入资金方）出售一张MBS，承诺在近月 (front month) 交付这张券给对方，同时承诺在远月 (future month) 再把同类同面值的券买回来。这两个 MBS 不需要完全相同，只要它们具有相同的 TBA 特征即可。 \n\n![](Pasted%20image%2020220319222213.png)\n\n美元滚动交易的“下跌” (dollar roll drop) 是近月和远月 TBA 合约之间的价差，一般来说是正的，原因有二。 \n\n- 由于没有规定两次交易时交付的券是一致的，所以在逆向选择的前提下，卖家在远月会收到较差的券，所以 MBS 的价值也较低。\n- 其次，卖家在近月卖出了这张 MBS 后，也放弃了这期间的本金和利息收入，所以会存在dollar roll drop.\n\n这两个特征将 dollar roll 与 MBS 回购交易区分开来。在 MBS 回购交易中，融出资金方必须归还相同的 MBS pool，并且原始所有者在回购期间会收取本金和利息。\n\n## 美元滚动交易的特殊性 (Dollar Roll Specialness)\n\n如果通过 dollar roll 融资时的隐含融资利率低于现行利率（例如 MBS 回购利率），就称这个 dollar roll 为“特殊 (on special)”。可以通过计算回购利率与隐含融资利率之间的差值衡量一个 dollar roll 的“特殊”程度 (specialness).\n\n- 因为不指定两次交易时需要同样的个券，所以当资金融入方回购 MBS 时，融出资金方可以选更便宜的券交付，通常更便宜的券对应更高的“提前偿付风险”。正的 specialness 是对卖方承担再交付风险的补偿。\n    \n- 持有稀缺的 MBS 可以在回购市场和证券借贷市场中融到更多的钱。如果不进入回购市场而是进行 dollar roll，卖方不仅放弃了利息和本金支付，而且放弃了与更便宜的融资利率和贷款费用。因此，dollar roll中的均衡隐含融资利率必然下降，从而导致更高的specialness. 特定类别 MBS 的稀缺性可能受到交易商和贷款发行人的做空和对冲以及新发行的 MBS 数量的推动。\n\n\n\n### Dollar Roll Specialness 的决定因素\n\n#### 再交付风险和逆向选择\n\n相对于回购融资，dollar roll 的一个关键特征是融出资金方（借出现金并接收 MBS）可以选择在滚动合约的远月交付基本相似但不同的 MBS. 所以由于逆向选择，buyer 会选择交付一个最差的 MBS. 因为 Agency MBS 不存在违约风险，所以更差的券一般意味着更大的提前偿还风险。所以可交付的 MBS 范围内，**提前偿还风险的分散度 (dispersion) 越大，specialness 越高。**\n\n\n除了类似于回购市场中供应量对融资利率的影响机制，dollar roll还有一个特殊之处：由于逆向选择的存在，市场参与人对于交付最差证券的行为具有充分的理性预期，**MBS 的流动将缩小到最便宜可交付券 (CTD, Cheapest-to-deliver)**。这进一步导致了可流动的 MBS 供应量的减少。**即使 MBS 总供应不变，更高的逆向选择可以缩小 MBS 的有效供应，使其 specialness 增加**。这种逆向选择和供应之间的内生反馈是 dollar roll 独有的。\n\n随着可交付 MBS 的分散度变大，卖家因为会想到买家一定会交付回更差的 MBS，所以一开始就不愿意在 dollar roll 中交易高质量的 MBS。所以高质量的 MBS 将在指定池市场 (specified pool market) 交易。因此，**提前偿还风险的分散度 (dispersion) 越大，specified pool market 交易应该越活跃**。 所以 **specialness 和 specified pool market 的交易量正相关**。\n\n#### MBS 所有权的交换 (Ownership Exchange)\n\n**杠杆率的影响：**\n\n- 基于 Dollar roll 的融资可以被看做表外业务，而通过回购融资更可能被看做表内业务。所以使用 dollar roll 融资（相对于回购）可以更节约表空间。所以 **specialness 与金融机构的杠杆负相关**。\n  \n**提前偿付风险的转移：**\n\n- 在融资期间，dollar roll 中MBS的利息和本金偿还均直接给到资金融出方，而回购中，抵押品的一切利息和本金收益均由资金融入方获得。因此，买方承担提前还款风险。如果持有的是 premium MBS，提前还款会造成损失，如果持有的是 discount MBS，提前还款会带来收益。所以如果提前还款风险比预期更高，则买方如果收到了 premium MBS，则期待更高的融资利率；如果收到了 discount MBS，则会期待更低的融资利率。**Specialness 正向（负向）依赖于premium（discount）MBS 抵押品在融资期间的提前还款速度**。\n\n\n### Dollar Roll Specialness 与 MBS 回报之间的关系\n\n**Dollar roll specialness 与预期 MBS 回报呈负相关。**\n\nMBS 回报率越高，dollar roll 相对于 MBS 回购放弃掉的回报率就越大，市场参与者会更青睐回购，回购利率上升，specialness 下降。Specialness 较高的 MBS 为其持有者在融资市场上提供了“便利收益 (convenience yield)”，所以这些持有者愿意接受较低的预期回报。\n\n\n## 实证研究\n\n### 再交付风险\n\n作者建立了如下的模型进行面板数据回归：\n\n$$\nSpecialness_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Disp_{it}^{CPR}+\\varepsilon_{i t}\n$$\n\n\n$Specialness_{it}$: dollar roll specialness, dollar roll financing rates 和一个月的 MBS 回购利率的差值。\n\n$D_{t}, D_{i}$分别是息票利率和时间的哑变量。\n\n$Disp_{it}^{CPR}$: 用提前偿还率的分散度作为 value dispersion 的代理变量。剔除至少具有以下特征之一的 MBS CUSIP：剩余本金余额低于 150,000 美元，再融资份额大于 75%，平均 LTV 比率高于 85%，平均 FICO 分数低于 680。这些特征使提前还款的可能性降低，因此不太可能成为 CTD. 基于可能交易的 MBS 的 SMM数据，根据SMM计算CPR，再计算CPR的范围，即相同息票$i$和时间$t$下，各个CUSIP的CPR从高到低排序，计算最高CPR与最低CPR的差。\n\n结论是$Disp_{it}^{CPR}$增加 1个标准差，dollar roll specialness 将提高约 41 个bp. \n\n另一种衡量 value dispersion 的方法是利用 specified pool 数据，计算$Payup_{it}$和$Trade^{SP}$. Specified pool 指定了可交割的 MBS，不存在再交付风险，因此对寻求融资优质MBS的市场参与者更具吸引力。因此$Payup_{it}$定义为 SP 和 TBA 的价格差异，也是 value dispersion 的代表。计算方法为相同息票$i$和时间$t$下按交易量加权平均的 SP 和 TBA 的价格差。$Trade^{SP}$是相同息票$i$和时间$t$下 SP 的交易量。回归后结论都是和 specialness 呈正相关。\n\n$$\nSpecialness_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Payup_{it}+\\varepsilon_{i t}\n$$\n\n$$\nSpecialness_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Trade_{it}^{SP}+\\varepsilon_{i t}\n$$\n\n\n\n\n\n### 所有权交换\n\n作者建立了以下模型研究杠杆率对 specialness 的影响：\n\n$$\nSpecialness_{it}=\\sum_{i} \\gamma_{i} D_{i}+\\beta Leverage_{t-1}+\\varepsilon_{i t}\n$$\n\n$Leveraget_{t-1}$: 上一期 primary dealer 的 asset/equity ratio 的平方和，用以衡量是否有出表的需求，越大说明资产比例越高，越不需要出表。\n\n结论是$Leverage$增加 1个标准差，dollar roll specialness 将降低约 11 个bp. \n\n作者定义$CPR^{Signed,Change}$为：如果是 premium MBS则是$\\Delta CPR$，如果是 discount MBS则是$-\\Delta CPR$，以便进行回归分析。作者建立下面的模型来观察提前偿还风险的变化（超出预期）是否会对买家对 MBS 的优劣产生影响进而对 specialness 有影响。\n\n$$\nSpecialness_{it}=\\sum_{i} \\gamma_{i} D_{i}+\\beta CPR^{Signed,Change}+\\varepsilon_{i t}\n$$\n\n结论是$CPR^{Signed,Change}$增加 1个标准差，dollar roll specialness 将降低约 21 个bp. \n\n\n### Dollar Roll Specialness 和 MBS 回报率\n\n作者建立了如下的模型进行面板数据回归：\n\n$$\nOAS_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Specialness_{i t}+\\varepsilon_{i t}\n$$\n\n$$\nRet_{i t}=\\sum_{t} \\alpha_{t} D_{t}+\\sum_{i} \\gamma_{i} D_{i}+\\beta Specialness_{i t}+\\varepsilon_{i t}\n$$\n\n其中 [OAS](OAS.md) 是基于利率 $r_{t}$ 上使得 MBS 预期现金流的现值等于该 MBS 的市场价格所需收益率价差。可以按以下方法倒解出 OAS：\n\n设$r_{t}, t=1, \\cdots, T$是利率曲线，给定$r_{j t}, t=1, \\cdots, T$是状态 $j=1, \\cdots, N$下的利率，每个状态下 MBS 的现金流可以$C_{j t}, t=1, \\cdots, T$确定，OAS被定义为：\n$$\nV_{M B S}=\\sum_{j=1}^{N} p_{j}\\left[\\sum_{t=1}^{T} \\frac{C_{j t}}{\\left(1+r_{j 1}+O A S\\right) \\times \\cdots\\left(1+r_{j t}+O A S\\right)}\\right]\n$$\n其中 $p_{j}$ 是状态 $j$的概率。\n\nRet是FNMA 30YR TBA 合约的月度回报率。可以避免使用OAS带来的内生性问题。\n\n**结论是 dollar roll specialness 和 MBS 回报率负相关。**\n\n\n\n\n## 美联储在量化宽松期间使用 dollar roll\n\n\n美联储在金融危机之中采用了量化宽松政策，大量购买了 Agency MBS 和 Treasury，以达成维持就业水平与稳定物价的双重目标。**这将推升近月合约的价格，造成 drop 数值高于合理值，借压低长期利率，支持抵押贷款市场，让资金状况更为宽松。**\n\n金融机构因此担忧大量的 MBS 购买是否会造成 MBS 的市场扭曲，新发行 MBS 的速度是否能美联储购买的速度。\n\n\n美联储可以通过 dollar roll 把交割日移到下个月, 等于推迟了 MBS 交割。为了研究美联储的 dollar roll sale 是否意在对市场 specialness 的关注，是否减轻了 MBS 市场的资金扭曲，作者比较了 specialness 在美联储 dollar roll sale 之后的变化。\n\n$$\n\\Delta Specialness_{it}=\\sum_{t}\\alpha_t D_t+ \\beta_1 d^{Roll}_{it}+ \\epsilon_{it}\n$$\n\n$d_{Roll}$是哑变量，判断美联储是否实行了 dollar roll sales. \n\n$\\beta_1$的估计结果为负值，意味着在美联储 dollar roll sales后，specialness 会下降。\n\n## 结论\n\nDollar roll 可以看做以 MBS 为抵押品的融资，但在以下方面又与 MBS 回购不同。\n  \n- 再交付风险：资金融出者可以选择在贷款到期时归还不同的 MBS 抵押品。\n\n- 所有权交换：MBS 的所有权在融资期间有所转移。\n  \n因此造成了通过 dollar roll 融资的成本比回购更低，也即 dollar roll specialness.\n\n美联储可以通过 dollar roll sale 推迟交割，缓解由量化宽松购买 MBS 造成的供应短缺。\n\n\n## Reference\n\nSong, Z., \u0026 Zhu, H. (2019). Mortgage Dollar Roll. _The Review of Financial Studies_, _32_(8), 2955–2996. [https://doi.org/10.1093/rfs/hhy117](https://doi.org/10.1093/rfs/hhy117)\n\n[美元滚动策略即dollar roll是什么，能直白的解释下吗？ - 知乎](https://www.zhihu.com/question/67960832/answer/2331550109)\n\n\n[李力，雕刻现金流：从证券化到项目融资，中信出版集团股份有限公司，2017](https://weread.qq.com/web/reader/78c32f805e10dc78c9981c5kc81322c012c81e728d9d180)\n\n[林华，中国资产证券化产品投资手册，中信出版集团股份有限公司，2017](https://weread.qq.com/web/reader/cab3224071ae93c6cabb193kc81322c012c81e728d9d180)\n\n",title:"Untitled Page"},"/templates/post":{content:'---\ntitle: "{{title}}"\n---\n',title:"{{title}}"},"/利率及利率衍生品":{content:"---\nArea: Finance\nSource: Book\nStatus: Done\nType: Notes\n---\n\n## 利率的种类\n\n### 国债收益率\n\n### LIBOR\n\n-   银行之间短期无抵押拆借利率\n\n### 联邦基金利率\n\n-   隔夜拆借利率被称为联邦基金利率（federal funds rate）\n-   借入和借出资金交易往往通过经纪商达成，由经纪商达成交易的利率加权平均（权重与交易规模有关）被称为有效联邦基金利率（effective federal funds rate）\n\n### 再回购利率\n\n-   是有抵押借贷利率\n-   拥有证券的金融机构同意将证券出售给合约的另一方，并在将来以稍高价格将证券买回\n    -   隔夜回购（overnight repo）\n    -   期限回购（term repo）\n\n### 零息利率\n\n-   $n$年的零息利率是指在今天投入资金并连续保持n年后所得的收益率\n-   也叫$n$年期的即期利率（spot rate），或者$n$年期零息率（zero rate）\n\n### 天数计量\n\n天数计算定义了一段时间内利息累积的方式\n\n-   三种报价方式：\n    -   实际天数/实际天数（期限内）\n    -   30/360\n    -   实际天数/360\n-   “实际天数/实际天数（期限内）”惯例适用于美国长期国债；“30/360”惯例适用于美国的企业及市政债券；“实际天数/360”惯例适用于美国短期国债及其他货币市场产品。\n\n## 债券定价\n\n### 债券收益率(YTM)\n\n### 平价收益率\n\n-   平价收益率（par yield）是使债券价格等于面值的券息率（coupon rate）\n-   $d$为债券到期时收到1美元的贴现值，$A$为年金现金流的当前价值（年金：annuity，在每个券息日支付1美元），$m$是每年券息支付的次数：\n\n$$100=A\\frac{c}{m}+100d$$\n\n### 确定国库券零息利率\n\n-   票息剥离方法（bootstrap method）\n-   Zero curve不是一条水平线的原因在于市场预期现在和1年后的1年期即期利率不一样\n\n### 久期和修正久期\n\n（麦考利）久期\n\n$$D=\\sum_{i=1}^{n} t_{i}\\left[\\frac{c_{i} \\mathrm{e}^{-y t_{i}}}{B}\\right] $$\n\n**YTM以连续复利计时**，麦考利久期乘以到期收益率的变动为债券价格变动的百分比\n\n$$ \\begin{aligned} \\Delta B\u0026=-\\Delta y \\sum_{i=1}^{n} c_{i} t_{i} \\mathrm{e}^{-yt_i}\\\\ \\frac{\\Delta B}{B}\u0026=-D\\Delta y \\end{aligned}\n\n$$\n\n修正久期\n\n修正了连续复利情况下的上述推导。\n\n$y$为一年$m$次复利的情形：\n\n$$\\begin{aligned}{\\Delta B=-\\frac{B D \\Delta y}{1+y / m}} \\\\ {D^{*}=-\\frac{D}{1+y / m}}\\end{aligned} $$\n\n美元久期：修正久期和债券价格的乘积\n\n### 债券组合的久期\n\n-   债券组合的久期可以被定义为构成债券的组合中每一个债券的久期的加权平均，其权重与相应债券价格成正比。\n\n### 凸性\n\n$$C=\\frac{1}{B} \\frac{\\mathrm{d}^{2} B}{\\mathrm{d} y^{2}}=\\frac{\\sum_{i=1}^{n} c_{i} t_{i}^{2} \\mathrm{e}^{-y t}}{B}$$\n\n$$\\begin{aligned}\\Delta B=\\frac{\\mathrm{d} B}{\\mathrm{d} y} \\Delta y+\\frac{1}{2} \\frac{\\mathrm{d}^{2} B}{\\mathrm{d} y^{2}} \\Delta y^{2} \\\\\\frac{\\Delta B}{B}=-D \\Delta y+\\frac{1}{2} C(\\Delta y)^{2}\\end{aligned}$$\n\n## 远期利率\n\n$$R_F=\\frac{R_2T_2-R_1T_1}{T_2-T_1}=R_2+(R_2-R_1)\\frac{T_1}{T_2-T_1}$$\n\n-   如果零息利率曲线向上倾斜，则在$T_2$结束的时间段上的远期利率大于期限为$T_2$的零息利率。反之亦然。\n\n$$R_F=R+T\\frac{\\partial R}{\\partial T}=-\\frac{\\partial}{\\partial T}lnP(0,T)$$\n\n-   瞬时远期利率$R_F$\n-   $P(0,T)$为$T$时刻到期的零息债券价格：\n\n$$P(0,T)=e^{-RT}$$\n\n-   远期利率代表了市场对即期利率的预期，如果投资者的看法与其不同，可以做收益率赌博\n\n### 远期利率合约（FRA）\n\n-   远期利率合约（FRA）是一种场外交易，目的是锁定在将来一段时间借入或借出一定数量资金时的利率，常常设为LIBOR.\n-   名义贷款，但不交割本金，只交割协议利率和参考利率的利差\n-   目的：规避未来利率风险或利用未来利率波动进行投机\n-   如果合约中约定的固定利率大于对应于同一时段的LIBOR利率，借入方要支付借出方固定利率和LIBOR利率的差乘以面值。\n-   如果合约中约定的固定利率小于对应于同一时段的LIBOR利率，借出方要支付借入方固定利率和LIBOR利率的差乘以面值。\n\n定义\n\nFRA 6×9意味着6个月对9个月，即从交易日$T_0$起6个月末T_1为起息日，而交易日后的9个月末为到期日$T_2$，协议利率的期限为3个月期。 在$T_0$时刻X同意在$T_1$和$T_2$之间将资金借给公司Y。则递延期限：$T_1-T_0$，协议期限：$T_2-T_1$.\n\n交割额是$T_1$时刻双方资金的转移。\n\n$R_K$：FRA中的约定利率\n\n$R_F$：由今天$T_0$时刻计算的介于时间$T_1$和$T_2$之间的LIBOR利率\n\n$R_M$：在时间$T_1$观察到的$T_1$和$T_2$之间的真正LIBOR利率\n\n$L$：合约的本金\n\n交割额的计算：\n\n-   取基准日的参考利率与协议利率之差，乘以协议金额，乘以协议期限，得到名义贷款的利息差\n-   以\u003cu\u003e参考利率\u003c/u\u003e作为贴现率，对上一步计算得到的利息差进行贴现，计算出利息差在交割日的现值，即交割额\n\n则对X，$T_1$时刻的收益为： $$ \\frac{L(R_K-R_M)(T_2-T_1)}{1+R_M(T_2-T_1)} $$ 对Y，$T_1$时刻的收益为： $$ \\frac{L(R_M-R_K)(T_2-T_1)}{1+R_M(T_2-T_1)} $$\n\n\u003e 注意：名义贷款在期初交割而不是期末，所以要贴现回来。交割额的贴现不采用连续复利的假设。贴现的利率是参考利率：例如当天的LIBOR，而不是无风险利率\n\n### 定价\n\nFRA的定价是今天$T_0$时刻FRA的价值。\n\n今天我们不知道$T_1$时真正的LIBOR利率会是多少，但我们可以用远期利率公式计算出$R_F$：由今天$T_0$时刻计算的介于时间$T_1$和$T_2$之间的LIBOR利率。\n\n定价过程：\n\n-   用远期利率代替实际利率计算收益\n-   将收益用\u003cu\u003e无风险利率\u003c/u\u003e贴现\n\n$$ V_{FRA}=L(R_F-R_K)(T_2-T_1)e^{-r_{f,T_2}T_2} $$\n\n## 短期利率期货\n\n### 欧洲美元期货\n\n-   以债务工具为标的，管理利率风险\n-   以芝加哥商品交易所(CME)交易的欧洲美元期货为例介绍短期利率期货，标的资产是在将来某三个月里按欧洲美元利率借款100万美元上所付的利息\n-   （多头）买入一份期货合约相当于承诺在未来以约定的利率水平存入100万美元（贷款）\n    -   如果担心利率下降导致在三个月内存款所获得的利息减少，应该进入多头，因为利率下降意味着报价上升\n-   （空头）卖出一份合约则相当于在未来以约定的利率水平借入100万美元（借款）\n    -   如果担心利率上升导致在三个月内贷款需要付出的利率增加，应该进入空头，因为利率上升意味着报价下降\n-   对一个持有欧洲美元期货的人来说，**利率下降时对多头有利，利率上升时对空头有利**\n-   欧洲美元期货相当于试图将未来某3个月的利率提前锁定在某个值\n-   但对冲不总是完美的，因为期货的结算在合约到期日，而利率支付在3个月之后\n\n### 欧洲美元期货的报价\n\n-   在合约的最后一个结算日之前，按通常的方式每天以市值定价，100-$R$\n-   其中，$R$为3个月每季度复利的欧洲美元利率\n-   无论3个月的实际天数是多少，名义存款的期限都规定为1/4年。\n-   标的利率变动0.01%=期货报价变动1个基点=25美元的收益或亏损\n\n### 远期利率和期货利率\n\n-   欧洲美元期货和FRA都能暂时锁定一段时间的利率，因为每日结算和到期日结算的不同，导致期货利率和远期利率有所不同\n-   从每天结算变为只在期末结算会降低事先约定的未来某一段时间的利率\n-   远期利率=期货利率-$\\frac{1}{2}\\sigma^2T_1T_2$\n-   $T_1$是期货的期限，$T_2$是期货的到期时间，$\\sigma^2$是短期利率一年的标准差\n\n## 中长期国债期货\n\n### 美国国债期货\n\n-   从交割月份的第1天算起，任何期限介于15年与25年之间的债券均可以用于交割。\n-   将整个投资收益人为分为利息收入和资本利得\n    -   便于税收管理\n    -   便于财务核算\n\n### 报价\n\n-   超级国债和长期国债期货合约均是以美元和美元的1/32为单位报出的。\n\n### 困难\n\n-   空头没有办法买入某种特定的现货交割\n-   解决办法：指定一种虚拟国债：10年期美国国债期货\n\n### 转换因子\n\n-   每交割100美元面值的债券所收入的现金价格为\u003cu\u003e（最新的期货报价×转换因子）+累计利息\u003c/u\u003e（发票价）\n-   在假定所有期限的利率均为每年6%（按半年复利）的前提下，转换因子等于\u003cu\u003e按交割月份第1天的债券报价所对应1美元面值的债券价格。\u003c/u\u003e\n-   对于息票利率大于6%的可交割国债来说，在其他条件相同的情况下，期限越长，转换因子越大；反之亦然。\n\n\u003e 20年的债券，coupon rate为10%，半年付息。转换因子： $$ CF=\\sum_{i=1}^{40}\\frac{100\\times5\\%}{(1+0.03)^i}+\\frac{100}{(1+0.03)^{40}} $$\n\n### 最便宜可交割债券\n\n-   设计转换因子体系的目的是减少采用不同期限、不同息票利率的可交割国债进行交割的差异，降低交割品种选择权的价值\n    -   由于债券价值与收益率、期限的关系是非线性的，而转换因子体系是线性的，所以转换因子体系不能完全消除交割品种选择权的价值\n    -   考虑到期货运作机制的要求，交易所规定把交割国债品种的选择权赋予卖方\n-   空头方收到的现金量为：\u003cu\u003e（期货的最新报价×转换因子）+累计利息\u003c/u\u003e\n-   买入债券费用为：\u003cu\u003e债券报价+累计利息\u003c/u\u003e\n-   最便宜交割债券是使得：\u003cu\u003e债券报价-（期货的最新报价×转换因子）\u003c/u\u003e达到最小的债券。\n-   空头提供债券，多头提供钱。\n-   在市场上有一些因素决定了最便宜可交割债券。\n    -   当市场收益率大于6%时，转换因子系统倾向于息票率较\u003cu\u003e低\u003c/u\u003e同时期限较\u003cu\u003e长\u003c/u\u003e的债券。\n    -   当市场收益率小于6%时，系统倾向于息票率较\u003cu\u003e高\u003c/u\u003e同时期限较\u003cu\u003e短\u003c/u\u003e的债券。\n    -   当收益率曲线为上坡形时，系统倾向于交割期限较\u003cu\u003e长\u003c/u\u003e的债券。\n    -   当收益率曲线为下坡形时，系统倾向于交割期限较\u003cu\u003e短\u003c/u\u003e的债券。\n\n### 确定期货价格\n\n如果假定已知最便宜可交割债券及交割日期，长期国债期货等价于一个为持有人提供中间收入的证券上期货合约。 $$ F_0=(S_0-I)e^{rT} $$ $I$为期货期限内券息的贴现值，$S_0$要加上累计利息；计算出的$F_0$要减去从计算到交割这段时间的累积利息，然后要根据转换因子折回报价。\n\n\u003e 假定对于某一国债期货已知最便宜可交割的债券的息票利率为12%，转换因子为1.6。假定期货交割日期为270天以后。券息的支付为每半年一次。上一次券息支付为60天以前，下一次券息支付为122天以后，再下一次券息支付为305天以后。利率期限结构为水平，利率为年率10%（连续复利）。假定债券的当前报价为115美元。债券的现金价格等于报价加上从上一次付息至今的累计利息。债券现金价格为： $$ 115+\\frac{60}{60+122} \\times 6=116.978 $$ 在122天（0.3342年）后，债券持有者将收到6美元的利息。该利息的贴现值为： $$ 6e^{-0.1×0.3342}=5.803 $$ 期货合约将持续270天（0.7397年）。如果期货合约是关于券息率为12%的债券，期货的现金价格为： $$ （116.978-5.803)e^{0.1\\times 0.7397}=119.711 $$ 在债券交割时，会产生148天的累计利息。如果期货合约是有关于券息率为12%的债券，期货的报价为： $$ 119.711-6 \\times \\frac{148}{148+35}=114.859 $$ 由转换因子定义得出，1.60倍的标准债券等价于一个12%的债券。因此，期货的报价应为： $$ \\frac{114.859}{1.60}=71.79 $$\n\n## 久期套期保值\n\n### 对于资产及负债组合的对冲\n\n-   久期匹配不能使得证券组合免疫于收益率曲线的非平行移动（即其价格不受平行移动的影响），这是该对冲策略的不足之处。\n-   在实践中，短期利率的变化幅度较大，并且与长期利率没有完美的相关性，有时甚至短期利率及长期利率会朝两个相反的方向变动。\n\n### 采用期货来实现基于久期的对冲\n\n$V_F$：利率期货合约的价格\n\n$D_F$：期货标的资产在期货到期日的久期值\n\n$P$：被对冲的债券组合在对冲到期日的远期价格\n\n$D_F$：被对冲的证券组合在对冲到期日的久期 $$ N^*=\\frac{PD_P}{V_FD_F} $$\n\n-   当采用国债期货来进行对冲时，对于交割某个特定的债券，对冲者一定以$D_F$为假设前提。$D_F$h和最便宜交割债券的久期相等。这意味着对冲者在实施对冲时，必须估计哪一个债券可能是最便宜可交割债券。如果利率环境发生了变化，以至于其他债券变为了最便宜可交割债券，对冲者必须将对冲头寸进行调节，因此对冲效果也许比预期的要差。\n-   利用利率期货来进行对冲时，对冲者应注意利率与期货价格呈相反方向变动。当利率上升时，利率期货价格下降；当利率下降时，利率期货价格上升。因此，在利率下降时会承受损失的公司应进入期货的多头头寸。类似地，在利率上升时会承受损失的公司应进入期货的空头头寸。\n\n---\n\n## 常见问题\n\n### 给出两支不同期限和票息的债券，计算某一时期的spot rate\n\n### 给出两支债券，在无套利的情况下为第三支定价\n\n分别待定系数，列二元一次方程，使得每一期的现金流都相等\n\n### 计算某个债券的dirty price和clean price\n\ndirty price: 其实就是现金流折现时下面用的系数不再是$(1+r)^t$，而是$(1+r)^{t-d}$，$d$意味着过去了多久。\n\nclean price\n\n=dirty price-accured interest\n\n=dirty price-coupon×days since last payment date/days between coupon payments\n\n### 远期利率的计算\n\n### 计算某方在FRA中的收入\n\n注意折现时使用的是由今天计算的远期LIBOR利率而不是约定的利率\n\n### FRA的定价和计算\n\n先由zero curve计算market implied forward rate，再用面值乘以利率差乘以时间长度，再用结束时的无风险利率贴现\n\n### 寻找某个债券是CTD\n\n计算cost=债券报价-期货settlement×CF，最小的那个\n\n### 投资人担心利率未来上涨，应该进入期货的多头还是空头\n\n担心利率上涨，进入空头，因为利率上涨时对空头有利\n\n### 根据曲率调整公式计算远期利率和期货利率之间的关系\n\n注意要把从欧洲美元期货报价中看到的利率转换成连续复利\n\n具体而言，欧洲美元期货报价是94，意味着3个月复利的年化利率是6%（实际天数/360），每90天的利率是1.5%\n\n按照连续复利，有$e^{r\\times 90/365}=1+1.5\\%,r=6.038\\%$.\n\n然后再用公式减去0.5×标准差的平方×期限×（期限+0.25）\n\n---\n\n首先针对每种金融产品相关的数字，应该想明白**哪些是交易出来的，哪些是合约中人为设定的**。所谓交易出来，就是这个数字是（理论上）由市场的供需决定的，而不是人为决定的。然后，捋清事物发展的脉络。\n\n由相对价值的想法，我们从市场上已有的债券价格入手，通过票息剥离法画出了zero curve；然后用曲线来（试图）计算其他产品的价格。这条曲线说明市场上所有的交易者对利率水平有一个自己的预期，而这些预期通过债券（和其他产品）的价格反映出来。\n\n当我们得到zero curve之后，很容易想到如何衡量交易者对市场未来利率的预期，因此我们定义了远期利率。\n\n如果投资者自己的认知和市场上反映出来的认知不同，那么他就有很多获利的机会。比如通过远期利率合约，交易者可以锁定自己未来一段时间的利率。\n\n短期利率期货如欧洲美元期货也可以锁定未来的某三个月存款利率，甚至可以到未来十年以后的三个月。远期利率合约中的约定利率$R_K$和欧洲美元期货的报价，都相当于在一定程度上反映着不同投资者对未来的预期。\n\n由于我们被要求学会很多计算（理论）定价的方法，这很容易让人以为债券或者其他衍生品的价格都是严格算出来的。倒不如说是市场上的交易者通过买卖各种证券的方式，将自己的看法price in至金融产品中。\n\n最后但最重要的是，思考每种金融产品的出现可能的原因和解决的问题，并且在解决问题的同时，又生发出哪些值得注意的问题。这或许能更好记忆每个条件存在的意义。",title:"Untitled Page"},"/数据结构与算法":{content:"---\nArea: Coding\nSource: Book\nStatus: Done\nType: Notes\n---\n\n## 绪论\n### 问题和算法\n- 算法（Algorithm）是问题求解过程的精确描述，具有如下性质：\n    - 有穷性（描述的有穷性）：由有限条“指令”或“语句”构成\n    - 能行性：指令（语句）含义简单明确，其过程可以完全机械地进行\n    - 确定性：作用于所求解问题的给定输入（要处理的问题实例的某种描述），将产生出唯一的确定的动作序列\n    - 终止性（行为的有穷性）：产生的动作序列有穷，它或终止并给出问题的解；或终止并指出对给定的输入本问题无解\n    - 输入/输出：有确定的输入和输出\n### 大O表示法\n- 定义：如果存在两个正常数c和n0，当实例的规模n≥n0后，某算法的时间（或者空间）代价T(n)≤c·f(n)（或S(n)≤c·f(n)），则说该算法的时间代价（或者空间代价）为O(f(n)) \n    - 朴素的解释：当实例的规模n充分大时，该算法所需时间（空间）不大于f(n)的某个常数倍\n    - 也说该算法的时间（或空间）代价的增长率为f(n)\n### 数据结构\n- 一种数据结构是采用一套特定方式建立起来的一种数据组织结构\n- 特征：\n    - 逻辑结构：数据元素之间有某种特定的逻辑关系\n        - 集合结构、线性结构、树形结构、图结构\n    - 物理结构：数据的逻辑结构在计算机存储器中的映射（或表示），又称存储结构，或数据结构的存储表示\n    - 行为特征：作用于数据结构上的各种运算。例如检索元素、插入元素、删除元素等一般性操作，还可能有一些特殊操作\n\n## 抽象数据类型和Python类\n\n## 数据结构的公共操作\n- 作用上看：\n    - 构造：构造出一个新实例\n    - 访问：从已有数据结构中提取某些信息，但不创建新结构，也不修改被操作的结构\n    - 变动：修改已有的结构\n- 支持操作类型：\n    - 不变\n    - 变动\n\n\n## 线性表\n- 一种元素集合，其中还记录着元素间的一种顺序关系。\n- 实现模型：顺序表和链接表\n### 顺序表\n- 元素顺序存放在一片足够大的连续存储区内，表中首元素存入存储区的开始位置，其余元素依次顺序存放\n- 地址计算公式：$Location(e_i)=Location(e_0)+ci$，其中c是一个元素的存储量\n#### 操作\n- 访问第i个元素：O(1)\n- 表空、表满：O(1)\n- 查找给定元素的位置：通过循环，和表内元素逐个比较\n- 尾端加入、删除：O(1)\n- 首端（定位）加入：不要求保序：O(1)；要求保序：O(n)\n- 加入操作平均移动次数：$\\sum_{i=0}^{n}(n-i) p_{i}$\n- 删除操作平均移动次数：$\\sum_{i=0}^{n-1}(n-i-1)p_i^{\\prime}$\n#### 优缺点\n- 优点：\n    - O(1) 时间（随机，直接）按位置存取元素\n    - 元素存储紧凑，除表元素存储外只需 O(1)空间存放辅助信息\n- 缺点：\n    - 需要连续的大块存储区存放表中的元素，可能有大量空闲单元\n    - 加入删除操作时通常要移动许多元素\n    - 需要考虑元素存储区的大小（有时事先很难估计）\n#### 顺序表的实现\n- 一体式实现\n- 分离式实现\n    - 优点：可以根据需要换一块元素存储，扩大容量\n    - 表满时：\n        - 申请一块更大的元素存储区\n        - 把表中已有的元素拷贝到新存储区\n        - 改变表对象的元素区链接\n        - 实际加入新元素\n    - 常量增长策略：O(n^2)\n    - 比例增长策略：O(n)\n#### Python中list的实现\n- append:O(1)\n- len:O(1)\n- 不是尾端加入、切片替换、切片删除、表拼接：O(n)\n### 链接表\n#### 优点与缺点\n- 优点：\n    - 表结构是通过一些链接起来的结点形成的，结构很容易调整修改\n    - 不修改结点里的数据元素，只通过修改链接，就能灵活地修改表的结构和内容。如加入/删除一个或多个元素，翻转整个表，重排元素的顺序，将一个表分解为两个或多个等\n    - 整个表由一些小存储块构成，较容易安排和管理\n- 缺点：\n    - 一些操作的开销大：基于位置找到表中元素需要线性时间\n    - 尾端操作需要线性时间（增加尾指针可以将尾端加入元素变为常量操作，但仍不能有效实现尾端删除）\n    - 找当前元素的前一元素需要从头扫描表元素（双链表可以解决这个问题，但每个结点要付出更多存储代价），应尽量避免\n#### 结点类及操作\n\n\n```python\nclass LNode:\n    def __init__(self,elem,next_=None):\n        self.elem=elem\n        self.next=next_\n\npnode=LNode(1)\nfor i in range(2,11):\n    pnode.next=LNode(i)\n    pnode=pnode.next\n    print(pnode.elem)\n```\n\n    2\n    3\n    4\n    5\n    6\n    7\n    8\n    9\n    10\n\n\n#### 单链表基本操作\n- 创建空链表：把表头变量设置为空链接（Python中设置为None）\n- 删除：Python里将表指针设置为None\n- 判断表是否为空：表头变量的值和空链接比较\n- 链接表不会满\n- 复杂性：\n    - 基本操作：\n        - 创建空表：O(1)\n        - 删除表：在 Python 里是 O(1)。当然存储管理也需要时间\n        - 判断空表：O(1)\n    - 加入元素（都需要加一个 T(分配) 的时间）：\n        - 首端加入元素：O(1)\n        - 尾端加入元素：O(n)，因为需要找到表的最后结点\n        - 定位加入元素：O(n)，平均情况和最坏情况\n    - 删除元素：\n        - 首端删除元素：O(1)；尾端删除：O(n)\n        - 定位删除元素：O(n)，平均情况和最坏情况\n        - 其它删除通常需要扫描整个表或其一部分，O(n)\n    - 其他：\n        - 求长度、遍历：O(n)\n\n\n```python\nclass LinkedListUnderflow(ValueError):\n    pass\nclass LList:\n    def __init__(self):\n        self._head=None\n    def is_empty(self):\n        return self._head is None\n    def prepend(self,elem):\n        self._head=LNode(elem,self._head)#LNode要标明链接\n    def append(self,elem):\n        if self._head is None:\n            self._head=LNode(elem)\n        p=self._head\n        while p.next is not None:\n            p=p.next\n        p.next=LNode(elem)#这一行不能放在while循环里\n    def popfirst(self):\n        if self._head is None:\n            raise LinkedListUnderflow('in popfirst')\n        else:\n            e=self._head.elem\n            self._head=self._head.next\n            return e\n    def poplast(self):\n        if self._head is None:\n            raise LinkedListUnderflow('in poplast')\n        else:\n            p=self._head\n            if self._head.next is None:#表中只有一个元素\n                e=self._head.elem\n                self._head=None\n                return e\n            while p.next.next is not None:#找到了倒数第二个\n                p=p.next\n            e=p.next.elem\n            p.next=None\n            return e\n    def printall(self):\n        p=self._head\n        while p is not None:#这里不能写成while p.next !=None，否则就不会输出最后一个结点\n            print(p.elem)\n            p=p.next\ntest=LList()\ntest.is_empty()\ntest.prepend(1)\ntest.append(10)\ntest.append(20)\ntest.popfirst()\ntest.poplast()\ntest.printall()\n```\n\n    10\n\n\n#### 链接表的变形\n##### 带尾节点引用的单链表\n- 头结点的next直接指向尾节点\n\n\n```python\nclass LList_tail(LList):\n    def __init__(self):\n        LList.__init__(self)\n        self.rear=None\n    def append(self,elem):\n        if self._head is None:\n            self._head=LNode(elem,self._head)\n            self.rear=self._head\n        else:\n            self.rear.next=LNode(elem)\n            self.rear=self.rear.next\ntest2=LList_tail()\ntest2.append(10)\ntest2.append(20)\ntest2.append(30)\ntest2.printall()\n```\n\n    10\n    20\n    30\n\n\n##### 循环单链表\n- 让表对象指向概念上的尾结点更有利\n\n\n```python\nclass LClist:\n    def __init__(self):\n        self._rear=None\n    def is_empty(self):\n        return self._rear is None\n    def prepend(self,elem):\n        p=LNode(elem)\n        if self._rear is None:\n            p.next=p\n            self._rear=p\n        else:\n            p.next=self._rear.next\n            self._rear.next=p\n    def append(self,elem):\n        p=LNode(elem)\n        if self._rear is None:\n            p.next=p\n            self._rear=p\n        else:\n            p.next=self._rear.next\n            self._rear.next=p\n            self._rear=self._rear.next\n    def pop(self):\n        if self._rear is None:\n            raise LinkedListUnderflow('in pop of CLList')\n        p=self._rear.next\n        if self._rear is p:\n            self._rear=None\n        else:\n            self._rear.next=p.next\n        return p.elem\n    def printall(self):\n        if self.is_empty():\n            return\n        else:\n            p=self._rear.next\n            while True:\n                print(p.elem)\n                if p is self._rear:\n                    break\n                p=p.next\nmlist=LClist()\nmlist.append(3)\nmlist.append(4)\nmlist.prepend(1)\nmlist.prepend(2)\nmlist.append(5)\nmlist.printall()\n```\n\n    2\n    1\n    3\n    4\n    5\n\n\n##### 双链表\n- 需要延伸结点类，增加指向前面的链接\n\n\n\n```python\nclass LDNode(LNode):\n    def __init__(self,elem,prev=None,next_=None):\n        LNode.__init__(self,elem,next_)\n        self.prev=prev\nclass LDList(LList_tail):\n    def __init__(self):\n        LList_tail.__init__(self)\n    def rev(self):\n        p=None\n        while self._head is not None:\n            q=self._head\n            self._head=q.next\n            q.next=p\n            p=q\n        self._head=p\nr=LDList()\nr.append(10)\nr.append(20)\nr.append(30)\nr.append(40)\nr.printall()\nr.rev()\nr.printall()\n```\n\n    10\n    20\n    30\n    40\n    40\n    30\n    20\n    10\n\n\n#### 总结\n- 单链表只有一个方向的链接，支持O(1)的前端插入和删除，定位操作或尾端操作都需要O(n)时间。\n- 增加了尾结点引用的单链表可很好支持首端/尾端插入和首端弹出，都是O(1)时间复杂度的操作，但不能支持高效的尾端删除\n- 循环单链表支持高效首端/尾端插入和首端弹出，扫描需注意结束判断\n- 双链表中结点有两个方向的链接，能高效找到前后结点。有尾结点引用时两端插入和删除都是O(1)时间操作。\n- 单链表的遍历和检索只能从表头开始，需O(n)时间。双链表的这些操作可从表头或表尾开始，复杂度不变。与它们对应的循环链表，遍历和检索可以从表中任何一个地方开始，但要注意结束条件\n\n#### 表的应用\n- 约瑟夫问题的顺序表算法和循环链表算法\n\n\n```python\nclass Josephus(LClist):\n    def turn(self,m):\n        for i in range(m):\n            self._rear=self._rear.next\n            #新方法，沿next方向移动m步\n    def __init__(self,n,k,m):\n        LClist.__init__(self)\n        for i in range(n):\n            self.append(i+1)\n        self.turn(k-1)\n        while not self.is_empty():\n            self.turn(m-1)\n            print(self.pop())\nJ=Josephus(10,3,2)\n```\n\n    4\n    6\n    8\n    10\n    2\n    5\n    9\n    3\n    1\n    7\n\n\n## 字符串\n### 概念\n- 字符串是特殊的线性表，表中元素选自选定字符集\n- 字符集是有穷的一组字符构成的集合\n- 称s1为s2的一个子串，如果存在两个串s和s'使下式成立:s2 = s + s1 + s'\n- 如果s1是s2的子串，也说s1在s2里出现，称s2里与s1相同的字符段的第一个字符的位置为：s1在s2里出现的位置\n### Python字符串\n- 一体式的连续形式\n### 字符串匹配\n- 模式串长小于目标串\n#### 朴素的串匹配算法\n- 时间复杂度：O(mn)\n- 效率低的原因：每次都看作完全独立的操作；回溯\n- 通配符(？，*)与正则表达式（顺序组合，选择组合|，星号）\n\n\n```python\ndef naivematch(pattern,target):\n    p=len(pattern)\n    t=len(target)\n    i=0#这里一定要先声明\n    j=0\n    while i\u003cp and j\u003ct:\n        if pattern[i]==target[j]:\n            i=i+1\n            j=j+1\n        else:\n            j=j-i+1\n            i=0\n    if i==p:#比较已经比较到了pattern的最后一位\n        return j-i#应该返回target串能匹配上的首下标，而不是最后一个刚刚比较完的下标\nnaivematch('abc','shdlabc')\n```\n\n\n\n\n    4\n\n\n\n## 栈\n- 可以看作只在一端插入和删除的表\n- LIFO\n- 采用顺序表方式实现，在后端插入删除都是O(1)操作\n- 采用链接表方式实现，在前端插入删除都是O(1)操作\n\n\n```python\nclass StackUnderflow(ValueError):\n    pass\nclass SStack:#顺序表实现\n    def __init__(self):\n        self._elems=[]\n    def is_empty(self):\n        return self._elems==[]\n    def top(self):\n        if self._elems==[]:\n            raise StackUnderflow('in top')\n        else:\n            return self._elems[-1]\n    def push(self,elem):\n        self._elems.append(elem)\n    def pop(self):\n        if self._elems==[]:\n            raise StackUnderflow('in pop')\n        else:\n            return self._elems.pop()\n        \nclass LStack:\n    def __init__(self):\n        self._top=None\n    def is_empty(self):\n        return self._top is None\n    def top(self):\n        if self._top is None:\n            raise StackUnderflow('in top')\n        else:\n            return self._top.elem\n    def push(self,elem):\n        self._top.next=LNode(elem)\n    def pop(self):\n        if self._top==None:\n            raise StackUnderflow('in pop')\n        else:\n            p=self._top\n            self._top=p.next\n            return p.elem\n\n```\n\n### 栈的应用\n#### 括号配对问题\n- 顺序检查字符串字符\n- 遇到开括号将其压入一个栈\n- 遇到闭括号弹出栈顶元素与其匹配\n\n\n```python\ndef paresmatch(text):\n    open_pares='([{'\n    close_pares=')]}'\n    pair={')':'(',']':'[','}':'{'}\n    st=SStack()\n    try:\n        for i in range(len(text)):\n            if text[i] in open_pares:\n                st.push(text[i])\n            elif text[i] in close_pares:\n                if st.pop()!=pair[text[i]]:\n                    print('Unmatch!')\n                    return False\n                else:\n                    print('Success!')\n                    return True\n    except:\n        print('Unmatch!')\n        return False\nprint(paresmatch('[abc]'))\nprint(paresmatch('([c)'))\n```\n\n    Success!\n    True\n    Unmatch!\n    False\n\n\n#### 表达式的表示、计算和变换\n##### 后缀表达式的计算\n- 不是运算符就压入栈\n- 是运算符就弹出最近的两个数\n- 计算之后再压入栈\n- 下面的程序没有考虑栈深和其他的错误\n\n\n```python\ndef cal(exp):\n    st=SStack()\n    oper='+-*/'\n    for i in range(len(exp)):\n        if not exp[i] in oper:\n            st.push(float(exp[i]))#这一步是必要的，否则就变成了字符串拼接\n        elif exp[i] in oper:\n            a=st.pop()\n            b=st.pop()\n            if exp[i] =='+':\n                c=a+b\n            elif exp[i]=='-':\n                c=a-b\n            elif exp[i]=='*':\n                c=a*b\n            elif exp[i]=='/':\n                c=a/b\n            st.push(c)\n    return st.pop()\ncal('12+4*')\n```\n\n\n\n\n    12.0\n\n\n\n##### 中缀表达式到后缀表达式的转换\n- 遇到运算对象应直接输出（因为运算符应该在它们的后面）\n- 需要考虑中缀运算符的优先级，适时输出 \n- 遇到运算符时不能直接输出，只有下一运算符的优先级不高于本运算符时，才应该做本运算符要求的计算\n### 栈与函数调用\n- 可以证明：任何递归定义的函数（程序），都可以通过引入一个栈保存中间结果，翻译为一个非递归的过程。与此对应，任何一个包含循环的程序都可翻译为一个不包含循环的递归程序。这两个翻译过程都可计算，可以写出完成这两种翻译的程序，把任何递归定义的函数翻译到完成同样工作的非递归的函数，或者把任何包含循环的程序翻译为不包含循环的递归程序\n\n\n```python\ndef knap(weight,wlist,n):\n    if weight==0:\n        return True\n    elif weight\u003c0 or (weight\u003e0 and n\u003c1):\n        return False\n    elif knap(weight-wlist[n-1],wlist,n-1):\n        print(n,wlist[n-1])\n        return True\n    elif knap(weight,wlist,n-1):\n        return True\n    else:\n        return False\nknap(10,[1,2,3,4,2],3)\n```\n\n\n\n\n    False\n\n\n\n## 队列\n- 可看作只在一端插入另一端访问和删除的表\n- FIFO\n### 队列的链接表实现\n- 只需用带尾结点的单链表\n### 队列的顺序表实现\n- 总会有入队/出队其中之一是O(n)\n- 记住队头，会导致前面有浪费的空余\n- 环形队列\n\n\n```python\nclass SQueue:\n    def __init__(self,init_len=8):\n        self._len=init_len\n        self._elems=[0]*init_len\n        self._head=0\n        self._num=0\n    def is_empty(self):\n        return self._num==0\n    def peek(self):\n        if self._num==0:\n            raise QueueUnderflow\n        return self._elems[self._head]\n    def dequeue(self):\n        if self._num==0:\n            raise QueueUnderflow\n        e=self._elems[self._head]\n        self._head=(self._head+1)%self._len\n        self._num=self._num-1\n        return e\n    def enqueue(self,elem):\n        if self._num==self._len:\n            self.__extend()\n        self._elems[(self._head+self._num)%self._len]=e\n        self._num=self._num+1\n    def __extend(self):\n        old_len=self._len\n        self._len=self._len*2\n        new_elems=[0]*self._len\n        for i in range(old_len):\n            new_elems[i]=self._elems[(self._head+i)%old_len]\n        self._elems=new_elems\n        self._head=0\n```\n\n\n\n## 二叉树与树\n### 概念\n- 有序树和无序树\n- 一个结点的子节点个数成为该结点的度数\n- 结点都有层数，根在0层，子结点的层数比其父结点大1\n- 二叉树：\n    - 结点的有限集合，集合或为空集，或由一个根节点和两棵不相交的二叉树组成\n    - 左子树和右子树\n    - 是与树不同的结构，不是特殊情况\n    - 满二叉树：树中每个分支结点都有两棵非空子树\n    - 完全二叉树：除最下两层外，其余结点度数都是2（显然都不是叶结点），如果最下一层的结点不满，则所有空位都在在右边，左边没有空位\n    - 扩充二叉树（由已有非空二叉树生成的一种二叉树）：原二叉树的最小结点扩充，使原树中所有结点的度数都变成2，扩充结点的个数比原树结点的个数多1\n### 性质\n- 二叉树性质：\n    - 性质1 非空二叉树第$i$层上至多有$ 2i $个结点\n    - 性质2 高度为$ k $的二叉树至多有$ 2k-1 $个结点\n    - 性质3 对任何非空二叉树，若其叶结点个数为$n_0$，度数为2的结点个数为$n_2$，则$n_0 = n_2 + 1$\n    - 性质4 $n$个结点的完全二叉树的高度$k = \\lceil log_2(n+1)\\rceil$\n    - 性质5 满二叉树里的叶结点比分支结点多一个\n    - 性质6 （完全二叉树）如果$ n $个结点的完全二叉树的结点按层次并从左到右的顺序从 0 开始编号，对任一结点$ i（0 ≤ i ≤ n-1) $都有：\n        - 序号 0 的结点是根\n        - 对于$ i \u003e 0$，其父结点是$\\lfloor (i - 1)/2\\rfloor$\n        - 若 $2i + 1 ≤ n$，其左子结点序号为$2  i + 1$；否则它无左子结点\n        - 若 $2  i + 2 ≤ n$，其右子结点序号为$2  i + 2$；否则它无右子结点\n\n### 二叉树的类实现\n- 如果知道一棵二叉树的中根序列，又知道先根/后根序列，就可以唯一确定这个二叉树\n- 先根序遍历的平均空间复杂性是O(logn),关键是栈中最大深度（遍历的二叉树高度）。\n- 时间复杂性是O(n)\n\n\n### 优先队列\n- 特点是存入优先队列的每项数据都有一个优先级，保证任何时候访问或弹出的总是当时所存元素中最优先的\n- 顺序表实现，总会在插入和取出元素的时候有一种是O(n)的复杂度\n#### 堆\n- 一个堆在结构上是一棵在结点里存储数据的完全二叉树\n- 去掉一个堆的最后元素，剩下的仍是堆\n- 一个堆去掉堆顶，其余元素形成两个堆\n- 给按上面方式得到的两个堆加一个元素作为根，得到一棵完全二叉树但未必是堆\n- 在一个堆的最后加上一个元素，整个结构是一棵完全二叉树，但未必是堆\n- 操作：加入一个元素，把加入后得到的完全二叉树转变为堆/弹出最小元素后，如何将剩下的元素重新做成堆：复杂度：O(n)\n##### 实现\n- 向上筛选：新加入的结点与其父结点比较，如果新加入的较小就交换\n- 向下筛选：用e与B、C的顶元素（根）比，最小者作为整个堆的顶。\n\n\n\n```python\nclass PrioQueue:\n    def __init__(self,elist=[]):\n        self.elems=list(elist)\n        if elist!=[]:\n            self.buildheap()\n    def is_empty(self):\n        return self.elem==[]\n    def peek(self):\n        if self.is_empty():\n            raise PrioQueueError('in top')\n        return self.elems[0]\n    def enqueue(self,e):\n        self.elems.append(None)\n        self.siftup(e,len(self.elems)-1)\n    def siftup(self,e,last):\n        elems=self.elems\n        i=last\n        j=(last-1)//2\n        while i\u003e0 and e\u003celems[j]:\n            elems[i]=elems[j]\n            i=j\n            j=(j-1)//2\n        elems[i]=e\n    def dequeue(self):\n        if self.is_empty():\n            raise PrioQueueError('in pop')\n        elems=self.elems\n        e0=elems[0]\n        e=elems.pop()\n        if len(elems)\u003e0:\n            self.siftdown(e,0,len(elems))\n        return e0\n    def siftdown(self,e,begin,end):\n        elems=self.elems\n        i=begin\n        j=begin*2+1\n        while j\u003cend:\n            if j+1\u003cend and elems[j+1]\u003celems[j]:\n                j=j+1\n            if e\u003celems[j]:\n                break\n            elems[i]=elems[j]\n            i=j\n            j=2*j+1\n        elems[i]=e\n    def buildheap(self):\n        end=len(self.elems)\n        for i in range(end//2,-1,-1):\n            self.siftdown(self.elems[i],i,end)#?\n```\n\n##### 堆排序\n- 时间复杂性是O(nlogn)，空间是O(1)\n\n\n\n```python\ndef heap_sort(elems):\n    end=len(elems)\n    for i in range(end//2,-1,-1):\n        siftdown(elems,elems[i],i,end)\n    for i in range((end-1),0,-1):\n        e=elems[i]\n        elems[i]=elems[0]\n        PrioQueue.siftdown(elems,e,0,i)#?\n```\n\n### 哈夫曼树\n- 重复以下步骤，直到只剩一棵树为止：\n    - 从F选取两棵权最小的树作为左右子树，构造一棵新二叉树，设置其根节点权值为两棵子树的根结点的权值之和\n    - 从F删除所选的两棵树，把新构造的二叉树加入F\n#### 哈夫曼编码\n- 构造一棵哈夫曼树，在得到的哈夫曼树中，给所有从一个结点到其左子结点的边标上二进制数字0；引向其右子结点的边标上1\n- 以从根结点到一个叶结点的路径上的二进制数字序列，作为这个叶结点的字符的编码。这就是哈夫曼编码\n\n### 树与树林\n- 从树、树林转换为二叉树的步骤： \n    - 对于相邻的兄弟结点，从左到右，从前一子结点和后一子结点连一条边（对树林，相邻树的根之间也同样连一条边）\n    - 对每个非叶结点，只保留从它到其最左子结点的边，删去它到它的其它子女的边\n- 从二叉树转换到树林：\n    - 如果某结点是其父结点的左子树，则将其向右的路径上的各个结点作为其父结点的顺序的各个子结点\n    - 去掉原二叉树中各结点到其右子结点的连线\n#### 表示\n- 子结点引用表示\n- 父结点引用表示\n- 子表表示\n\n## 图\n- 一个图是一个二元组G=(V,E)\n- 有向图用尖括号表示，无向图用圆括号表示\n- 两个限制：不考虑顶点到自身的边、顶点间没有重复出现的边\n- 完全图：任意两顶点间都有边的图\n- 度：与一个顶点邻接的边的条数。\n$$\ne=\\frac{1}{2}\\sum_{i=1}^n D(v_i)\n$$\n- 回路：起点和终点相同的路径。如果除起点和终点以外其他顶点均不相同，称为简单回路\n- 简单路径：内部不包含回路的路径\n- 有根图：如果在有向图G里存在一个顶点v，从v到图G中其他每个顶点均有路径，则称G为一个有根图。\n    - 包含n个顶点的最小有根图恰好包含n-1条边\n- 连通图：\n    - 无向图：G中任意两个不同顶点之间都连通。包含n个顶点的最小连通无向图恰有n-1条边\n    - 有向图：注意路径有方向\n- 带权的连通无向图称为网络\n### 表示方法\n#### 邻接矩阵表示法\n- 无向图的邻接矩阵表示是一个对称矩阵\n- 缺点：空间复杂性和结点数的平方成正比\n#### 邻接表表示法\n- 每个顶点的邻接边用一个（不一定等长的）list 表示，元素形式 为(vj,w)，vj是边的终点，w是边的信息（权或者1）\n\n\n```python\nclass Graph:\n    def __init__(self,mat,unconn=0):\n        vnum=len(mat)\n        for x in mat:\n            if len(x)!=vnum:\n                raise ValueError('Argument for Graph')\n        #self._mat=[mat[i][:] for i in range(vnum)]\n        self._unconn=unconn\n        self._vnum=vnum\n        self._mat=[]\n        for i in range(vnum):\n            edges=[]\n            for j in range(len(mat[i])):\n                if mat[i][j]!=unconn:\n                    edges.append((j,mat[i][j]))\n            self._mat.append(edges)\n            \n    def _invalid(self,v):\n        return 0\u003ev or v\u003e=self._vnum\n    def vertex_num(self):\n        return self._vnum\n    def add_vertex(self):\n        self._mat.append([])\n        self._vnum=self._vnum+1\n        return self._vnum-1\n    def add_edge(self,vi,vj,val=1):\n        if self._vnum==0:\n            raise GraphError('Cannot add edge to empty graph')\n        if self._invalid(vi) or self._invalid(vj):\n            raise GraphError(str(vi)+'or'+str(vj)+'is not valid vertex')\n        row=self._mat[vi]\n        i=0\n        while i\u003clen(row):\n            if row[i][0]==vj:\n                self._mat[vi][i]=(vj,val)\n                return\n            if row[i][0]\u003evj:\n                break\n            i=i+1\n        self._mat[vi].insert(i,(vj,val))\n    def get_edge(self,vi,vj):\n        if self._invalid(vi) or self._invalid(vj):\n            raise GraphError(str(vi)+'or'+str(vj)+'is not a valid vertex')\n        for i, val in self._mat[vi]:\n            if i==vj:\n                return val\n        return self._unconn\n    def out_edges(self,vi):\n        if self._invalid(vi):\n            raise GraphError(str(vi)+'is not a valid vertex')\n        return self._mat[vi]\nG=Graph([[0,1,1,0],[1,0,0,1],[1,0,0,0],[0,1,0,0]])\nprint(G.vertex_num())\nprint(G._mat)\nprint(G.get_edge(1,1))\nprint(G.out_edges(2))                  \n```\n\n    4\n    [[(1, 1), (2, 1)], [(0, 1), (3, 1)], [(0, 1)], [(1, 1)]]\n    0\n    [(0, 1)]\n\n\n### 基本图算法\n#### 遍历\n##### 深度优先遍历\n- 从指定顶点v出发，先访问v（并将其标记为已访问）\n- 从v的未访问过的邻接顶点出发进行深度优先搜索（邻接顶点可能排定一种顺序），直到与v连通的所有顶点都已访问（递归）\n- 如果图中还存在未访问顶点，则选出一个未访问顶点，由它出发重复前述过程，直到图中所有顶点都已访问为止\n###### 非递归算法\n\n\n```python\ndef DFS(graph,v0):\n    vnum=graph.vertex_num()\n    visited=[0]*vnum\n    seq=[v0]\n    visited[0]=1\n    st=SStack()\n    st.push((0,graph.out_edges(v0)))\n    while not st.is_empty():\n        i,edges=st.pop()\n        if i\u003clen(edges):\n            v,e=edges[i]\n            st.push((i+1,edges))\n            if not visited[v]:\n                seq.append(v)\n                visited[v]=1\n                st.push((0,graph.out_edges(v)))\n    return seq\nDFS(G,0)\n#Q\n```\n\n\n\n\n    [0, 1, 3, 2]\n\n\n\n###### 生成树概念\n- 从连通无向图或强连通有向图G的任一顶点v0出发，或从有根有向图的根v0出发，存在到图中其它各结点的路径\n###### 递归算法\n\n\n```python\ndef DFS_span_tree(graph):\n    vnum=graph.vertex_num()\n    span_forest=[None]*vnum\n    def dfs(graph,v):\n        for u,w in graph.out_edges(v):\n            if span_forest[u] is None:\n                span_forest[u]=(u,w)\n                dfs(graph,u)\n    for v in range(vnum):\n        if span_forest[v] is None:\n            span_forest[v]=(v,0)\n            dfs(graph,v)\n    return span_forest\nDFS_span_tree(G)#?\n```\n\n\n\n\n    [(0, 0), (1, 1), (2, 1), (3, 1)]\n\n\n\n##### 广度优先遍历\n- 从指定顶点v出发，先访问v并将其标记为已访问\n- 依次访问v的所有相邻顶点v1,v2,……,vm（可规定顺序），再依次访问与v1,v2,……,vm邻接的所有未访问顶点，直到访问完所有顶点\n- 如果图中还存在未访问顶点，则选择一个未访问顶点，由它出发进行广度优先搜索，直到所有顶点都已访问为止\n\n### 最小生成树\n- 网络 G（带权连通无向图）的每条边带有一个给定的权值，它的一棵生成树中各条边的权值之和称为该生成树的权\n- 网络 G 可能有多棵不同生成树，其权值可能不同。其中权值最小的生成树称为 G 的最小生成树\n#### MST性质\n- 设G=(V，E)是网络，U是V的任一真子集，e=(u,v)∈E且u∈U，v∈V-U，而且e在G中所有一个端点在U另一端点在V-U的边中权值最小，那么：G必有一棵包括边e的最小生成树\n- 证明：取G的一棵最小生成树T（必定存在），若e属于T得证。否则将e加入T得到T'，由于T连通T'中必定有环。设环中另一条一端在 U另一端在V-U的边为e'。去掉e'得到另一生成树。由于e的定义，新生成树的权不大于T，即为所需。\n#### Kruskal算法\n- 按权排序\n- 逐步加入最小权的边，观察是否能减少连通分量\n\n\n```python\ndef Kruskal(graph):\n    vnum=graph.vertex_num()\n    reps=[i for i in range(vnum)]\n    mst=[]\n    edges=[]\n    for vi in range(vnum):\n        for v,w in graph.out_edges(vi):\n            edges.append((w,(vi,v)))\n    edges.sort()\n    for w,e in edges:\n        if reps[e[0]]!=reps[e[1]]:\n            mst.append((e,w))\n            if len(mst)==vnum-1:\n                break\n            rep,orep=reps[e[0]],reps[e[1]]\n            for i in range(vnum):\n                if reps[i]==orep:\n                    reps[i]=rep\n    return mst\nKruskal(G)#？\n```\n\n\n\n\n    [((0, 1), 1), ((0, 2), 1), ((1, 3), 1)]\n\n\n\n#### Prim算法\n- 初始把(0，0，0)放入优先队列，表示从顶点0到自身的长0的边\n- 循环的第一次迭代把顶点0记入最小生成树顶点集U，方法是设 mst[0]=((0，0)，0)，同时把顶点0到其余顶点的边用权值作为优先数存入优先队列cands，表示待考察的候选边集合\n- 执行中反复选择cands里记录的最短边(u,v)。如果v是V-U的顶点（该边连接U中顶点与V-U中顶点），就把该边及其权记入mst[v]，并把顶点v的出边存入cands；否则直接丢掉\n- 结束时mst中是最小生成树的n条边，包括边(0,0)以方便实现\n\n\n```python\ndef Prim(graph):\n    vnum=graph.vertex_num()\n    mst=[None]*vnum\n    cands=PrioQueue([(0,0,0)])\n    count=0\n    while count\u003cvnum and not cands.is_empty():\n        w,u,v=cands.dequeue()\n        if mst[v]:\n            continue\n        mst[v]=((u,v),w)\n        count=count+1\n        for vi,w in graph.out_edges(v):\n            if not mst[vi]:\n                cands.enqueue((w,v,vi))\n    return mst\n```\n\n### 最短路径\n#### Dijkstra算法\n\n\n\n```python\ndef dijkstra(graph,v0):\n    vnum=graph.vertex_num()\n    assert 0\u003c=v0\u003cvnum\n    paths=[None]*vnum\n    count=0\n    cands=PrioQueue([(0,v0,v0)])\n    while count\u003cvnum and not cands.is_empty():\n        plen,u,vmin=cands.dequeue()\n        if paths[vmin]:\n            continue\n        paths[vmin]=(u,plen)\n        for v,w in graph.out_edges(vmin):\n            if not paths[v]:\n                cands.enqueue((plen+w,vmin,v))\n        count=count+1\n    return paths\n```\n\n## 字典\n- 静态字典和动态字典\n- 平均检索长度ASL：\n$$\nASL=\\sum_{i=0}^{n-1}p_ic_i\n$$\n### 关联\n\n\n```python\nclass Assoc:\n    def __init__(self,key,value):\n        self.key=key\n        self.value=value\n    def __lt__(self,other):\n        return self.key\u003cother.key\n    def __le__(self,other):\n        return self.key\u003cother.key or self.key==other.key\n    def __str__(self):\n        return 'Assoc({0},{1})'/format(self.key,self.value)\n    \n```\n\n### 字典的顺序表实现\n- 简单的顺序表缺点：平均检索长度大（删除依赖于检索）\n#### 有序顺序表和二分检索\n- 插入数据时需要保序：O(n)\n- 删除时可以用二分检索，但是实际删除时需要移动数据：O(n)\n- 检索时间：O(logn)\n- 平均检索长度：\n$$\n\\begin{aligned} A S L \u0026=\\frac{1}{n} *\\left(\\sum_{i=1}^{j} i * 2^{i-1}\\right) \\\\ \u0026=\\frac{1}{n} * \\sum_{i=1}^{j} \\sum_{m=i}^{j} 2^{m-1} \\\\ \u0026=\\frac{1}{n} * \\sum_{i=1}^{j}\\left(2^{j}-2^{i-1}\\right) \\\\ \u0026=\\frac{1}{n} *\\left(j * 2^{j}-2^{j}+1\\right) \\\\ \u0026=\\frac{n+1}{n} * \\log _{2}(n+1)-1 \\end{aligned}\n$$\n- 最大检索长度：$\\lceil log_2(n+1)\\rceil$\n\n\n```python\ndef bisearch(lst,key):\n    low=0\n    high=len(lst)-1\n    while low\u003c=high:\n        mid=(low+high)//2\n        if key==lst[mid].key:\n            return lst[mid].value\n        if key\u003clst[mid].key:\n            high=mid-1\n        else:\n            low=mid+1\n            \nbisearch([Assoc(1,2),Assoc(2,3),Assoc(3,4)],2)\n```\n\n\n\n\n    3\n\n\n\n### 散列\n- 关键码的映射\n- 负载因子=散列表中实际元素个数/基本存储区能容纳的元素个数\n- 除余法：整数关键码\n    - 以关键码除以一个不大于散列表长度m的整数p得到的余数（或者余数加1）作为散列地址，p可以取小于m的最大素数\n- 基数转换法：整数或字符串关键码\n- 冲突消解问题\n    - 内消解方法\n    - 外消解方法\n\n### 集合\n- 无序：求交集的复杂性是O(mn)\n- 按序排列，求交集/并集的复杂性为O(m+n)，但插入元素的复杂性变成了O(n)\n#### 集合的位向量实现\n- 如果所需要的集合对象有一个公共超集U\n- 假定U包含n个元素，给每个元素一个编号作为该元素的“下标”。\n- 对任何要考虑的集合S（注意 S⊆U），用一个n位的二进制序列 （位向量）vS表示S。对元素e∈U，如果e∈S，令vS里对应于 e（的编号，下标）的那个位取值1，否则令该位取值0\n### 二叉排序树与字典\n- 二叉排序树或者为空；或者是具有下列性质的二叉树：\n    - 其根结点保存着一个数据项（及其关键码）\n    - 如果其左子树不空，则其左子树中所有结点保存的（关键码）值均小于它的根结点保存的（关键码）值；\n    - 如果其右子树不空，则其右子树中所有结点保存的（关键码）值均大于它的根结点保存的（关键码）值；\n    - 左右子树（如果存在）也是二叉排序树\n- 检索操作的空间复杂度：O(1)，检索时间开销：O(logn)\n#### 插入\n#### 删除\n- q是叶结点，只需将其父结点p到q的引用置为None，删除完成\n- q无左子结点，只需把q的右子树直接改作p的左子树\n    - 删除之后，除了结点q已经不在，其余部分的顺序不变。 如果原来序列中的关键码递增，删除后也一样\n- q有左子树，找到q左子树的最右结点，设为r，显然它无右子树\n    - 用q的左子结点代替q作为p的左子结点 \n    - 将q的右子树作为r的右子树\n\n## 排序\n### 简单排序算法\n- 基本操作：\n    - 比较关键码，确定序关系\n    - 移动数据记录\n- 评价标准\n    - 执行时间\n    - 所需要的附加空间\n#### 插入排序\n- 空间复杂性：只需要记录的辅助空间\n- 时间复杂度：O(n^2)\n\n\n```python\ndef naivesort(list1):\n    for i in range(1,len(list1)):\n        j=i\n        while j\u003e0 and list1[j-1]\u003elist1[i]:\n            list1[j]=list1[j-1]\n            j=j-1\n        list1[j]=list1[i]\n    return list1\nnaivesort([1,2,5,6,2,5,3])#？\n```\n\n\n\n\n    [1, 2, 5, 6, 6, 6, 6]\n\n\n\n#### 选择排序\n- 用一个内层循环顺序比较，维护已发现的最小记录下标\n- 循环结束时，找到未排序段的最小记录，交换到已排序段之后\n- 未排序段剩下一个元素时就不必再选择（工作完成）\n- 记录复制：最好 0（增加判断i=k时不交换），最坏 2×(n-1)\n- 比较：n(n-1)/2\n- 总的时间复杂度：O(n^2)\n- 稳定性：不稳定\n    - 找到最小元素后的直接交换，是导致不稳定的根源\n    - 如果找到最小元素后，逐个后移k前面的尚未排序的元素，腾出未排序段最前位置后存入最小元素，得到的算法就是稳定的\n    - 直接选择排序没有适应性，对任何序列都需要 O(n2) 次比较\n\n\n```python\ndef select_sort(list2):\n    for i in range(len(list2)-1):\n        k=i\n        for j in range(i,len(list2)):\n            if list2[k]\u003elist2[j]:\n                k=j\n        if i!=k:\n            list2[i],list2[k]=list2[k],list2[i]\n    return list2\nselect_sort([1,2,6,4,7,2])\n```\n\n\n\n\n    [1, 2, 2, 4, 6, 7]\n\n\n\n#### 冒泡排序\n- 通过交换逆序对实现排序的方法\n- 比较相邻元素，遇到相邻的逆序对时交换它们\n- 改进算法：\n    - 用一个辅助变量，内循环开始时赋 False，遇到逆序赋True\n    - 内层循环结束后检查这个变量，值为 False 就结束排序 \n- 最坏时间复杂度为O(n^2)，平均时间复杂度也为O(n^2),辅助空间是 O(1)\n- 起泡排序算法具有稳定性，相等元素不交换\n\n\n```python\ndef bubble(list3):\n    for i in range(len(list3)):\n        for j in range(1,len(list3)-i):\n            if list3[j-1]\u003elist3[j]:#前后比较\n                list3[j-1],list3[j]=list3[j],list3[j-1]\n    return list3\nbubble([1,2,4,6,3,6])\n```\n\n\n\n\n    [1, 2, 3, 4, 6, 6]\n\n\n\n#### 快速排序\n- 把被排序序列按某种标准分为大小两组，确定了两个元素组的顺序\n- 而后采用同样方式递归地分别对两组记录排序\n- 划分到每个子部分最多包含一个记录时，整个序列的排序完成\n\n#### 归并排序\n- 初始时把待排序的 n 个记录看成 n 个有序子序列，长度均为 1\n- 把序列集合里的有序子序列两两归并，完成一遍，序列集合的规模减半，集合中的子序列长度加倍\n- 重复上面操作，最终得到一个长度为 n 的有序序列\n\n#### 分配排序\n\n",title:"Untitled Page"},"/计量经济学":{content:"---\nArea: Statistics\nSource: Book\nStatus: Todo\nType: Notes\n---\n\n## 简单回归模型\n\n$$\ny=\\beta_{0}+\\beta_{1} x+u\n$$\n\n**零条件均值**假定下：\n$$\n\\begin{array}{l}{\\mathrm{E}(u)=0} \\\\ {\\operatorname{Cov}(x, u)=\\mathrm{E}(x u)=0}\\end{array}\n$$\n矩估计：\n$$\n\\begin{array}{c}{\\frac{1}{n} \\sum_{i=1}^{n}\\left(y_{i}-\\hat{\\beta}_{0}-\\hat{\\beta}_{1} x_{i}\\right)=0} \\\\ {\\frac{1}{n} \\sum_{i=1}^{n} x_{i}\\left(y_{i}-\\hat{\\beta}_{0}-\\hat{\\beta}_{1} x_{i}\\right)=0}\\end{array}\n$$\n得到估计的斜率：\n$$\n\\hat{\\beta}_{1}=\\frac{\\sum_{i=1}^{n}\\left(x_{i}-\\overline{x}\\right)\\left(y_{i}-\\overline{y}\\right)}{\\sum_{i=1}^{n}\\left(x_{i}-\\overline{x}\\right)^{2}}\n$$\n定义总平方和（total sum of squares，SST）、解释平方和（explained sum of squares，SSE）、残差平方和（residual sum of squares，SSR）（也叫做剩余平方和）：\n$$\n\\begin{array}{l}{\\mathrm{SST} \\equiv \\sum_{i=1}^{n}\\left(y_{i}-\\overline{y}\\right)^{2}} \\\\ {\\mathrm{SSE} \\equiv \\sum_{i=1}^{n}\\left(\\hat{y}_{i}-\\overline{y}\\right)^{2}} \\\\ {\\mathrm{SSR} \\equiv \\sum_{i=1}^{n} \\hat u_{i}^{2}}\\\\ \\mathrm{SST}=\\mathrm{SSE}+\\mathrm{SSR}\\end{array}\n$$\n\n\u003e 解释平方和有时会被称为回归平方和（regression sum of squares），容易和residual sum of squares混淆。\n\n拟合优度：\n$$\nR^{2} \\equiv \\mathrm{SSE} / \\mathrm{SST}=1-\\mathrm{SSR} / \\mathrm{SST}\n$$\nOLS的相关假定：\n\n- 假定SLR.1: 线性于参数\n- 假定SLR.2: 随机抽样\n- 假定SLR.3: 解释变量的样本有波动\n- 假定SLR.4: 零条件均值\n- 假定SLR.5: 同方差性\n\n满足假定1-4，则$\\hat\\beta_1,\\hat\\beta_0$估计有无偏性\n$$\n\\begin{aligned} \\mathrm{E}\\left(\\hat{\\beta}_{1}\\right) \u0026=\\beta_{1}+\\mathrm{E}\\left[\\left(1 / \\mathrm{SST}_{x}\\right) \\sum_{i=1}^{n} d_{i} u_{i}\\right]=\\beta_{1}+\\left(1 / \\mathrm{SST}_{x}\\right) \\sum_{i=1}^{n} \\mathrm{E}\\left(d_i u_{i}\\right) \\\\ \u0026=\\beta_{1}+\\left(1 / \\mathrm{SST}_{x}\\right) \\sum_{i=1}^{n} d_{i} \\mathrm{E}\\left(u_{i}\\right)=\\beta_{1}+\\left(1 / \\mathrm{SST}_{x}\\right) \\sum_{i=1}^{n} d_{i} \\cdot 0=\\beta_{1}\\\\\n\\mathrm{E}\\left(\\hat{\\beta}_{0}\\right)\u0026=\\beta_{0}+\\mathrm{E}\\left[\\left(\\beta_{1}-\\hat{\\beta}_{1}\\right) \\overline{x}\\right]+\\mathrm{E}(\\overline{u})=\\beta_{0}+\\mathrm{E}\\left[\\left(\\beta_{1}-\\hat{\\beta}_{1}\\right)\\right] \\overline{x} =\\beta_0\\end{aligned}\n$$\n\n\n满足假定1-5，OLS统计量的抽样方差：\n$$\n\\begin{align}\n\\operatorname{Var}\\left(\\hat{\\beta}_{1}\\right)\u0026=\\left(1 / \\operatorname{SST}_{x}\\right)^{2} \\operatorname{Var}\\left(\\sum_{i=1}^{n} d_{i} u_{i}\\right)=\\left(1 / \\operatorname{SST}_{x}\\right)^{2}\\left(\\sum_{i=1}^{n} d_{i}^{2} \\operatorname{Var}\\left(u_{i}\\right)\\right)\\\\\u0026=\\left(1 / \\mathrm{SST}_{x}\\right)^{2}\\left(\\sum_{i=1}^{n} d_{i}^{2} \\sigma^{2}\\right)\\\\\u0026=\\sigma^{2}\\left(1 / \\operatorname{SST}_{x}\\right)^{2}\\left(\\sum_{i=1}^{n} d_{i}^{2}\\right)=\\sigma^{2}\\left(1 / \\mathrm{SST}_{x}\\right)^{2} \\mathrm{SST}_{x}=\\sigma^{2} / \\mathrm{SST}_{x}\\\\\n\\operatorname{Var}\\left(\\hat{\\beta}_{0}\\right)\u0026=\\frac{\\sigma^{2} n^{-1} \\sum_{i=1}^{n} x_{i}^{2}}{\\sum_{i=1}^{n}\\left(x_{i}-\\overline{x}\\right)^{2}}\n\\end{align}\n$$\n满足假定1-5，误差方差：\n$$\n\\begin{align}\n\\hat{\\sigma}^{2}=\\frac{1}{n-2} \\sum_{i=1}^{n} \\hat{u}_{i}^{2}=\\frac{\\mathrm{SSR}}{n-2},\\quad E\\left(\\hat{\\sigma}^{2}\\right)=\\sigma^{2}\\end{align}\n$$\n\n\n\n\n\n## 多元回归分析：估计\n\n$$\ny=\\beta_{0}+\\beta_{1} x_{1}+\\beta_{2} x_{2}+\\beta_{3} x_{3}+\\cdots+\\beta_{k} x_{k}+u\n$$\n\n\n\n$\\hat\\beta_i$意为排除了其他变量之后，$x_i$对$y$的影响。\n\n利用现有样本，以$x_i$为因变量，其他变量为自变量做回归，得到残差；再将$y$对OLS残差进行回归就能得到$\\hat\\beta_i$\n\n[Frisch–Waugh–Lovell theorem的一个简要解释](https://zhuanlan.zhihu.com/p/75716921)\n\n### 基本假定\n\n- 假定MLR.1: 线性于参数\n- 假定MLR.2: 随机抽样\n- 假定MLR.3: 无完全共线性\n- 假定MLR.4: 零条件均值\n- 假定MLR.5: 同方差性\n- 假定MLR.6: 正态性\n\n### OLS统计量的无偏性\n\n满足假定1-4，OLS估计值就是无偏的。\n\n#### 包含无关变量\n\n在回归模型中包含了无关变量，并不会影响到OLS估计量的无偏性，但会影响其方差。\n\n#### 遗漏变量偏误\n\n$$\n\\hat{\\beta}_{1}=\\hat{\\beta}_{1}+\\hat{\\beta}_{2} \\hat{\\delta}_{1}\n$$\n\n其中，$\\hat\\delta_1$是$x_{i2}$对$x_{i1}$进行简单回归的斜率系数。\n\n由于模型满足假定1-4，所以估计是无偏的，假如遗漏了变量$x_2$：\n$$\nE\\left(\\tilde{\\beta}_{1}\\right)=E\\left(\\hat{\\beta}_{1}+\\hat{\\beta}_{2} \\tilde{\\delta}_{1}\\right)=E\\left(\\hat{\\beta}_{1}\\right)+E\\left(\\hat{\\beta}_{2}\\right) \\tilde{\\delta}_{1}\n$$\n偏误为：\n$$\n\\operatorname{Bias}\\left(\\tilde{\\beta}_{1}\\right)=E\\left(\\tilde{\\beta}_{1}\\right)-\\beta_{1}=E\\left(\\hat{\\beta}_{1}\\right)+E\\left(\\hat{\\beta}_{2}\\right) \\tilde{\\delta}_{1}-\\beta_1=\\beta_1+\\beta_2\\tilde\\delta_1-\\beta_1=\\beta_{2} \\tilde{\\delta}_{1}\n$$\n\n### OLS估计量的方差\n\n在假定1-5下：\n$$\n\\operatorname{Var}\\left(\\beta_{j}\\right)=\\frac{\\sigma^{2}}{\\operatorname{SST}_{j}\\left(1-R_{j}^{2}\\right)}\n$$\n其中，$\\mathrm{SST}_{j}=\\sum_{i=1}^{n}\\left(x_{i j}-\\overline{x}_{j}\\right)^{2}$是$x_j$的总样本变异，而$R_j^2$则是将$x_j$对所有其他自变量（并包含一个截距项）进行回归所得到的$R^2$\n\n### 误差项的方差\n\n$$\n\\sigma^{2}=\\frac{\\sum_{i=1}^{n} \\hat{u}_{i}^{2}}{n-k-1}=\\frac{\\mathrm{SSR}}{n-k-1}\n$$\n\n在假定1-5下，$E\\left(\\sigma^{2}\\right)=\\sigma^{2}$.\n\n### 调整后的R方\n\n$$\nadj\\ R^2=1-\\frac{\\hat\\sigma^2}{\\text {SST}/n-1}=1-\\frac{(1-R^2)(n-1)}{n-k-1}\n$$\n\n### OLS的有效性：高斯马尔可夫定理\n\n在假定1-5下，$\\hat{\\beta}_{0}, \\hat{\\beta}_{1}, \\cdots, \\hat{\\beta}_{k}$分别是$\\beta_{0}, \\beta_{1}, \\cdots, \\beta_{k}$的最优线性无偏估计量。\n\n最优被定义为最小方差。\n\n### 经典线性模型（CLM）\n\nCLM估计量是最小方差无偏估计。\n\n误差项的正态性导致OLS估计量的正态抽样分布。\n\n## 多元回归分析：推断\n\n### 检验单个参数：t检验\n\n在假定1-6下：\n$$\n\\left(\\hat{\\beta}_{j}-\\beta_{j}\\right) / \\operatorname{sd}\\left(\\hat{\\beta}_{j}\\right) \\sim t_{n-k-1}\n$$\n\n### 检验多个参数：F检验\n\n$$\nF \\equiv \\frac{\\left(\\mathrm{SSR}_{r}-\\mathrm{SSR}_{u r}\\right) / q}{\\operatorname{SSR}_{u r} /(n-k-1)}\\sim F_{q, n-k-1}\n$$\n\n其中，$SSR_r$是受约束模型（变量多）的残差平方和，$SSR_{ur}$是不受约束模型（变量少）的残差平方和，$q$是两个模型的估计参数之差，分母是**不受约束模型**的方差的无偏估计量。\n\n#### 另一种F统计量\n\n$$\nF=\\frac{\\left(R_{ur}^{2}-R_{r}^{2}\\right) / q}{\\left(1-R_{u r}^{2}\\right) /(n-k-1)}=\\frac{\\left(R_{u r}^{2}-R_{r}^{2}\\right) / q}{\\left(1-R_{u r}^{2}\\right) / d f_{u r}}\n$$\n\n\n\n## 多元回归分析：OLS的渐近性\n\n不能找到无偏估计量时，找到一个一致估计量也是有用的。\n\n## 异方差性\n\n异方差对估计的无偏性和拟合优度没有影响。\n\n对统计检验有影响。\n\n### OLS估计后的异方差稳健推断\n\n#### 异方差稳健的标准误\n\n$$\n\\widehat{\\operatorname{Var}\\left(\\hat{\\beta}_{j}\\right)}=\\frac{\\sum_{i=1}^{n} \\hat{r}_{i j}^{2} \\hat{u}_{i}^{2}}{\\mathrm{SSR}_{j}^{2}}\n$$\n\n其中，$\\hat r_{ij}$表示将$x_j$对所有其他自变量做回归所得到的第$i$个残差，而$\\text {SSR}_j$则是这个回归的残差平方和。\n\n稳健的$t$统计量的分布在小样本容量的时候可能不是那么接近于$t$分布，从而使我们的推断可能犯错误。\n\n#### 异方差稳健的LM统计量\n\n1. 从约束模型中得到$\\tilde u$\n2. 将原假设中所排除的每个自变量分别对原假设包含的所有自变量进行回归，如果有$q$个被排除变量，就得到$q$个残差（$\\tilde{r}_{1}, \\tilde{r}_{2}, \\cdots \\tilde{r}_{q}$）构成的集合\n3. 求出每个$\\tilde r_j$和$\\tilde u$的积\n4. 在不包括截距的情况下将1对$\\tilde{r}_{1} \\tilde{u}, \\tilde{r}_{2} \\tilde{u}  \\cdots, \\tilde{r}_{q} \\tilde{u}$做回归，异方差稳健的LM统计量就是$n-\\text{SSR}_1$, LM统计量渐近服从$\\chi^{2}_q$分布。\n\n### 对异方差的检验\n\n#### 布罗施-帕甘检验\n\n1. 用OLS估计模型，得到残差平方（每次观测得到一个）\n\n2. 用残差平方对所有自变量回归：\n   $$\n   \\hat u^{2}=\\delta_{0}+\\delta_{1} x_{1}+\\delta_{2} x_{2}+\\cdots+\\delta_{k} x_{k}+v\n   $$\n   得到这个回归的$R_u^2$\n\n3. 计算F统计量，其服从$F_{k,n-k-1}$分布：\n   $$\n   F=\\frac{R_{u}^{2} / k}{\\left(1-R_{u^{2}}^{2}\\right) /(n-k-1)}\n   $$\n   或者LM统计量，渐近服从$\\chi^{2}_k$分布：\n   $$\n   LM=nR_{\\hat u^2}^2\n   $$\n   如果$p$值低于显著性水平，那么就拒绝同方差假设\n\n#### 怀特检验\n\n1. 用OLS估计模型，得到残差和拟合值，计算残差平方和拟合值的平方\n2. 做回归$\\hat u^2=\\delta_0+\\delta_1\\hat y+\\delta_2\\hat y^2+v$，得到$R_{\\hat u^2}^2$\n3. 按上述构造F或LM统计量\n\n### 加权最小二乘估计（WLS）\n\n$$\n\\begin{aligned} y_{i} / \\sqrt{h_{i}}=\u0026 \\beta_{0} / \\sqrt{h_{i}}+\\beta_{1}\\left(x_{i 1} / \\sqrt{h_{i}}\\right)+\\beta_{2}\\left(x_{i 2} / \\sqrt{h_{i}}\\right)+\\cdots+\\beta_{k}\\left(x_{k} / \\sqrt{h_{i}}\\right) \\\\ \u0026+\\left(u_{i} / \\sqrt{h_{i}}\\right) \\end{aligned}\n$$\n\n### 可行GLS（FGLS）\n\n1. 用OLS估计模型得到残差\n2. 将OLS残差平方后取对数得到$log(\\hat u^2)$\n3. $log(\\hat u^2)$对$x_{1}, x_{2}, \\cdots, x_{k}$回归，并得到拟合值$\\hat g$\n4. $\\hat{h}=\\exp (\\hat{g})$\n5. 以$1/\\hat h$为权，用WLS估计：在上面的方程里用$\\hat h_i$取代了$h_i$\n\n\n\n\n## 工具变量回归\n\n### 两阶段最小二乘法回归\n\n- 工具变量和解释变量有关，和干扰项无关\n- 先用$Z$对$X$回归，再将估计的$X$对$Y$回归\n- TSLS的估计：$\\beta^{TSLS}=\\frac{cov(Y,Z)}{cov(X,Z)}$\n\n### TSLS的统计推断\n\n- 大样本下TSLS估计是渐进服从正态分布的\n$$\n\\hat\\beta_1^{TSLS}\\sim N(\\beta_1,\\sigma^2)\n$$\n$$\n\\sigma=\\frac{1}{n}\\frac{var[(Z_i-\\mu_Z)u_i]}{[cov(Z_i,X_i)]^2}=\\frac{\\sigma^2}{n\\sigma_x^2\\rho_{x,z}^2}\n$$\n- $\\sigma^2$是干扰项的总体方差，$\\rho_{x,z}^2$是解释变量和工具变量的相关系数的平方。\n- 求工具变量标准误\n\n### 工具变量有效性的检验\n\n#### 检验相关性\n\n- 先用所有的工具变量和控制变量对$X$做回归\n- $F$检验：零假设所有工具变量前面的系数全为零\n- $F$统计量大于10，认为是一个弱的工具变量\n\nAnderson-Rubin置信区间\n\nMoreira’s Conditional Likelihood Ratio置信区间\n\n#### 检验外生性\n\n- 只有在过度识别的时候才能使用$J$检验\n- 用所有的真实的$X$对$Y$做回归，得到估计的$\\hat Y$\n- 计算残差\n- 用所有的工具变量和控制变量对残差做回归\n- $F$检验：零假设是所有工具变量前的系数都为零\n- $J=mF$，$m$是工具变量的个数，服从自由度是$m-k$的卡方分布，$k$是解释变量的个数\n- $J$检验的零假设是所有的工具变量都是外生的，$J$统计量大说明有工具变量是内生的",title:"Untitled Page"},"/货币金融学":{content:"[《货币金融学》米什金](https://book.douban.com/subject/5939751/)笔记\n\n---\n\n## 第一章 为什么研究货币、银行与金融市场\n\n### 为什么研究金融市场\n\n#### 债券市场与利率\n\n- 证券（金融工具）：对发行人未来收入与资产的索取权。\n- 债券：承诺在一个特定的时间段中进行定期支付。\n- 利率：借款的成本或为借入资金支付的价格。\n\n#### 股票市场\n\n- 普通股：代表持有者对公司的所有权。\n\n### 对总产出、总收入、物价水平和通货膨胀率的定义\n\n- 总产出与总收入\n- 实际量与名义量的区别\n- 物价总水平\n- 增长率与通货膨胀率\n\n\n\n##第二章 金融体系概览\n\n###金融市场的功能\n\n- 从那些由于支出少于收入而积蓄了盈余资金的家庭、公司和政府那里，将资金引导到那些由于支出超过收入而资金短缺的经济主体那里。金融市场有助于资本的合理配置。\n\n### 金融市场的结构\n\n#### 债务与股权市场\n\n#### 一级市场和二级市场\n\n- 一级市场：投资银行是一级市场上协助证券首次出售的重要的金融机构。投资银行的做法是证券承销（underwriting），确保公司证券能够按照某一价格销售出去，之后再向公众推销这些证券。\n- 二级市场：\n  - 经纪人（broker）负责匹配证券的买方和卖方；交易商（dealer）按照报价买卖证券。\n  - 功能：使得投资者可以更加容易出售金融工具，实现筹措资金的目的。决定了发行企业在一级市场上销售证券的价格。\n\n#### 交易所和场外市场\n\n- 二级市场的组织形态有两种：\n  - 交易所：证券的买卖双方在一个集中的场所进行交易的二级市场。（如纽约证券交易所）\n  - 场外市场（over-the-counter market）：分处各地的拥有证券存货的交易商随时向与其联系并愿意接受其报价的人在“柜台”上买卖证券的二级市场。（如美国政府债券市场）\n\n#### 货币市场和资本市场\n\n- 货币市场：交易短期债务工具（原始期限通常为一年以下）的金融市场。\n- 资本市场：交易长期债务工具（原始期限通常为一年或一年以上）的金融市场。\n\n### 金融市场工具\n\n#### 货币市场工具\n\n- 美国国库券\n- 可转让存单\n- 商业票据（commercial paper）\n- 回购协议（repos）\n- 联邦基金\n  - 通常是指银行在美联储的存款的隔夜贷款。联邦基金利率可以反映银行贷款市场与货币政策的松紧状况。如果联邦基金利率较高，说明银行资金头寸比较紧张；如果联邦基金利率较低，说明银行的信贷需求较少。\n\n#### 资本市场工具\n\n- 股票\n- 抵押贷款和抵押支持证券\n- 企业债券\n\n### 金融市场的国际化\n\n#### 国际债券市场、欧洲债券市场与欧洲货币市场\n\n- 外国债券：在国外发行并以发行国货币计价的债券。\n- 欧洲债券：在外国市场上发行，并非以发行国货币来计价的债券。\n- 欧洲货币：存放在货币发行国之外的银行的外国货币。由于短期存款同样可以赚取利息，因此他们就类似于短期欧洲债券。\n\n#### 世界股票市场\n\n![](https://static.notion-static.com/88e5786b-537e-49e9-8289-d60914b57db1/Untitled)\n\n### 金融中介机构的功能：间接融资\n\n- 1. Savings Function\n  2. Wealth Function\n  3. Liquidity Function\n  4. Credit Function\n  5. Payment Function\n  6. risk-sharing Function\n  7. Policy Function\n  8. Information Function\n- 交易成本\n- 风险分担\n- 信息不对称：逆向选择和道德风险\n- 范围经济和利益冲突\n\n### 金融中介机构的类型\n\n#### 存款机构\n\n- 商业银行\n- 储蓄与贷款协会和互助储蓄银行\n- 信用社\n\n#### 契约型储蓄机构\n\n- 人寿保险公司\n- 火灾和意外伤害保险公司\n- 养老基金和政府退休基金\n\n#### 投资中介机构\n\n- 财务公司\n- 共同基金\n- 货币市场共同基金\n- 对冲基金\n- 投资银行\n\n### 金融体系的监管\n\n##第三章 什么是货币\n\n###货币的含义\n\n- 货币：在产品和服务支付以及债务偿还中被普遍接受的东西。\n- 财富：用于价值储藏的各项财产总和。\n- 收入：单位时间段内收益的流量，而货币是存量概念。\n\n### 货币的功能\n\n#### 交易媒介\n\n- 货币的功能\n  - 大大缩短了产品和服务交易的时间\n  - 人们可以专门从事他们所擅长的工作\n- 怎样有效发挥货币的功能\n  - 易于标准化，可以方便地确定其价值\n  - 被普遍接受\n  - 易于分割\n  - 易于携带\n  - 不会很快腐化变质\n\n#### 记账单位\n\n- 经济社会中价值衡量的手段\n\n#### 价值储藏\n\n- 流动性：某一资产转化为交易媒介的便利程度和速度。\n\n### 支付体系的演进\n\n- 商品货币\n- 不兑现纸币\n- 支票\n- 电子支付\n  - 借记卡\n  - 智能卡\n  - 电子现金\n\n### 货币的计量\n\n- 联邦储备体系的货币总量\n- M1=通货+旅行者支票+活期存款+其他支票存款\n- M2=M1+小额定期存款+储蓄存款与货币市场存款账户+货币市场共同基金份额（零售）\n\n##第四章 理解利率\n\n### 利率的计量\n\n- 现值\n- 四种类型的信用市场工具\n  - 普通贷款\n  - 固定支付贷款（分期偿还贷款）\n  - 息票债券\n  - 贴现发行债券（零息债券）\n- 到期收益率\n  - 使债务工具所有未来回报的现值与其今天的价值相等的利率。\n    - 息票债券的特例：永续债券（perpetuity），没有到期日，不必偿还本金，只需要支付固定的息票利息\n      - P=C/i\n- 利率和回报率的区别\n  - 第一项是当期收益率i，第二项是资本利得率g\n\n  $$R=\\frac{C+P_{t+1}-P_t}{P_t}=\\frac{C}{P_t}+\\frac{P_{t+1}-P_t}{P_t}$$\n\n- 期限与债券回报率的波动：利率风险\n  - 长期债券的价格和回报率的波动性比短期债券大。\n  - 到期期限和持有期一样短的债券就不存在利率风险。\n\n### 实际利率与名义利率的区别\n\n\n\n## 第五章 利率行为\n\n### 资产需求的决定因素\n\n#### 财富\n\n- 个人拥有的全部资源。拥有的财富增加时，有了更多可以用于购买资产的资源。\n- 假定其他因素不变，财富的增长会增加对资产的需求数量。\n\n#### 预期回报率\n\n- 在其他因素不变的情况下，某一资产相对于其他替代性资产的预期回报率上升会增加对该资产的需求数量。\n\n#### 风险\n\n- 假定其他因素不变，如果一种资产相对于其他替代性资产的风险增大，则对该资产的需求数量会相应减少。\n\n#### 流动性\n\n- 该资产以较低成本转化为现金的速度。\n- 假定其他因素不变，一种资产相对于其他替代性资产的流动性越强，就越受到人们的青睐，对它的需求越多。\n\n### 均衡利率的变动\n\n- 债券需求曲线的位移\n\n![](https://static.notion-static.com/05895397-96aa-414b-a1c9-8d10c1bc1e53/Untitled)\n\n![](https://static.notion-static.com/780a3340-52c4-4a16-8f74-8300602765c2/Untitled)\n\n- 债券供给曲线的位移\n\n  ![](https://static.notion-static.com/7e90e238-5909-4e0c-b7d6-2b1da030e417/Untitled)\n\n  - 各种投资机会的预期盈利性\n  - 预期通货膨胀率\n    - **在给定的利率水平上**，随着预期通货膨胀率的上升，借款的真实成本就会下降，于是对应于给定债券价格水平的债券供给数量会相应增加。\n  - 政府预算赤字\n    - 美国财政部发行债券来弥补政府支出和收入之间的差额即政府赤字。\n    - 政府赤字非常大时，财政部就会出售更多的债券。\n  - 费雪效应\n    - 预期通货膨胀率上升：需求曲线左移（对实体资产更偏好），供给曲线右移（真实借款成本下降）\n    - 预期通货膨胀率的上升会引起利率的上升\n\n### 流动性偏好理论：货币市场的供给与需求\n\n![](https://static.notion-static.com/0195b2bc-6076-4c38-bad3-544b5e9e1c7a/Untitled)\n\n### 流动性偏好理论：均衡利率的变动\n\n- 货币需求曲线的位移\n  - 收入效应：收入水平上升导致任意利率水平上的货币需求增加，需求曲线右移。\n    - 随着经济的扩张和收入的增加，财富增长，人们愿意持有更多的货币储藏价值。\n    - 随着经济的扩张和收入的增加，人们愿意利用货币这一交易媒介进行更多的交易，希望持有更多的货币。\n  - 价格效应：物价水平的上升导致任意利率水平上的货币需求增加，需求曲线右移。\n    - 物价水平上升时，相同名义量的货币价值降低，所能购买的产品和服务数量减少，为了将实际货币持有量恢复到原先的水平，人们希望持有更多名义量的货币。\n- 货币供给曲线的位移\n- 收入变化\n  - 经济周期扩张阶段，假定其他经济变量不变，利率随着收入的增加而上升。\n\n  ![](https://static.notion-static.com/2203c4fb-e5a3-4a8c-847e-1fcf3ae53410/Untitled)\n\n- 物价水平的变动\n- 货币供给的变化\n\n### 货币与利率\n\n弗雷德曼认为货币供给增加无法保证“其他条件都不变”的假设，现实情况似乎反映了收入效应、价格效应、通货膨胀预期效应会超过流动性效应，因此提高货币增长速度会提高而非降低利率。\n\n- 收入效应：利率随收入水平的提高而上升。\n- 价格效应：利率随价格水平的上升而上升。\n- 通货膨胀预期效应：利率随预期通货膨胀率的上升而上升。\n\nb图比较符合实际情况。\n\n![](https://static.notion-static.com/9665bed8-6dc0-4986-b977-476677a5052d/Untitled)\n\n\n\n\n\n## 第六章 利率的风险结构与期限结构\n\n### 利率的风险结构\n\n#### 违约风险\n\n- 具有违约风险的债券的风险溢价总为正，且风险溢价随着违约风险的上升而增加。\n\n![](https://static.notion-static.com/09bced6f-e000-4f8a-8ae9-7b03629826dd/Untitled)\n\n#### 流动性\n\n- 企业债券流动性较差，出售债券的代价很高。国债的流动性较好。\n\n#### 所得税因素\n\n- 市政债券的风险高于国债，流动性低于国债，为什么利率低于国债呢？\n- 市政债券的利息支付可以免交联邦所得税。\n- 从税后回报率的角度和供求关系的角度分析。\n\n![](https://static.notion-static.com/5b101d69-6c49-4f6c-84a5-524e37aff52b/Untitled)\n\n### 利率的期限结构\n\n- 具有相同风险、流动性、税收的债券，由于距离到期日的时间不同，利率也会有所差异。将期限不同但风险、流动性、税收政策相同的债券收益率连接成一条曲线，即得到收益率曲线。\n- 经验事实\n  - 到期期限不同的债券的利率随时间一起波动。\n  - 短期利率较低，收益率曲线很可能向上倾斜；短期利率较高，收益率曲线很可能向下倾斜。\n  - 收益率曲线几乎总是向上倾斜的。\n\n  #### 预期理论\n\n  - 长期债券的利率等于在其有效期内人们所预期的短期利率的平均值。\n  - 收益率曲线向上倾斜说明市场预期未来的短期利率将上升。\n  - n阶段债券的利率满足：\n\n  $$i_m=\\frac{i_t+i^e_{t+1}+i^e_{t+2}+...+i^e_{t+(n-1)}}{n}$$\n\n  #### 分割市场理论\n\n  - 将到期期限不同的债券市场看作完全独立和相互分割的。到期期限不同的每种债券的利率取决于该债券的供给与需求，具有其他到期期限的债券的预期回报率对此毫无影响。\n  - 风险厌恶投资者的意愿持有期较短，愿意持有利率风险较小的短期债券，可以说明典型的收益率曲线是向上倾斜的。\n\n  #### 流动性溢价理论与期限优先理论\n\n  - 长期债券的利率应当等于两项之和，第一项是长期债券到期之前预期短期利率的平均值，第二项是随债券供求状况变动而变动的流动性溢价。\n  - 流动性溢价理论，lm为n阶段债券在时间t的流动性（期限）溢价，总是为正，并随到期期限n的延长而上升。\n\n  $$i_m=\\frac{i_t+i^e_{t+1}+i^e_{t+2}+...+i^e_{t+(n-1)}}{n}+l_m$$\n\n  - 仅通过观察收益率曲线的斜度，就可以判断市场对未来短期利率的预测。\n\n  ![](https://static.notion-static.com/89c6abc9-f368-4b5a-a9ec-03f49e0fbfba/Untitled)\n\n\n\n##第七章 股票市场、理性预期理论与有效市场假说\n\n### 计算普通股价格\n\n#### 单阶段估值模型\n\n#### 推广的股利估值模型\n\n- Pn在很远的将来，对P0就几乎没有影响，股票现在的价值可以被简化为所有未来股利流的现值。\n\n#### 戈登增长模型\n\n- 假定股利永远按照不变的比率增长。\n- 假定股利增长率低于股票投资的要求回报率k。\n\n### 市场如何确定股票价格\n\n- 价格是由愿意支付最高价格的买主确定的。\n- 市场价格是由最能有效利用该资产的买主确定的。\n- 关于资产的更为全面准确的信息能够通过降低它的风险提高其价值。\n\n### 理性预期理论\n\n- 预期应与利用所有可得信息作出的最优预测（即对将来的最好估计）相一致。\n- 如果某一变量的运动方式发生变化，那么对该变量预期形成的方式也要随之改变。\n- 预期的预测误差平均为零，且事先无法预知。\n\n### 有效市场假说：金融市场中的理性预期\n\n### 行为金融\n\n- 损失厌恶：缺乏足够的卖空交易，无法推动股票价格回归其基础价格。\n- 过分自信：交易往往基于自己的信条，而非纯粹的事实。\n- 社会传染：媒体报道所创造的氛围，使得越来越多的投资者对股票价格上升充满信心。\n\n\n\n## 第八章 金融结构的经济学分析\n\n### 世界各国金融结构的基本事实\n\n- 股票不是企业最主要的外部融资来源。\n- 发行可流通的债务和股权证券不是企业为其经营活动筹资的主要方式。\n- 与直接融资相比，间接融资的重要性大出数倍。\n- 金融中介，特别是银行，是企业外部资金最重要的来源。\n- 金融体系是经济体中受到最严格监管的部门。\n- 只有信誉卓著的大公司才能进入金融市场为其经营活动筹资。\n- 抵押品是居民个人和企业债务合约的普遍特征。\n- 典型的债务合约是对借款人行为设置了无数限制条件的、极为复杂的法律文本。\n\n### 交易成本\n\n- 交易成本如何影响金融结构\n- 金融中介如何降低交易成本\n  - 规模经济\n  - 专门技术\n\n### 信息不对称：逆向选择和道德风险\n\n### 次品车问题：逆向选择如何影响金融结构\n\n### 道德风险如何影响债务合约和股权合约的选择\n\n- 股权合约：委托代理问题\n- 解决委托代理问题的方法\n  - 信息生产：监督\n  - 旨在增加信息的政府监管\n  - 金融中介（VC）\n  - 债务合约\n\n道德风险如何影响债权市场的金融结构\n- 债务合约要求借款人支付固定的金额，除此之外的收入则为借款人的利润，借款人有动机参与风险程度超过贷款人意愿的投资项目。\n- 解决债务合约中道德风险问题的办法\n  - 净值与抵押品：实现了债务合约的激励相容，将借款人和贷款人的动机统一起来\n  - 限制性条款的监督和执行\n    - 限制违背贷款人意愿的行为的条款\n    - 鼓励符合贷款人意愿的行为的条款\n    - 保持抵押品价值的条款\n\n## 第九章 银行业与金融机构的管理（TODO）\n\n## 第十章 金融监管的经济学分析\n\n### 信息不对称是金融监管存在的原因\n\n#### 政府安全网\n\n- 银行业恐慌以及对存款保险的需求\n  - 如果经济遭受不利冲击，一部分银行会破产；储户不知道自己的银行是否会破产，所以有提前取款的动机：银行挤兑。\n  - 存款保险制度\n    - 偿付法\n    - 收购与接管法\n- 其他安全网\n  - 中央银行向陷入困境的机构房贷\n  - 政府接管（国有化）陷入困境的机构\n- 政府安全网的缺陷\n  - 道德风险\n    - 银行可能会冒更大的风险：“正面，我赚；反面，纳税人赔。”\n  - 逆向选择\n    - 收到政府安全网保护的储户和债权人没有动机对银行进行市场约束\n  - 太大不能倒闭（too big to fail problem）\n    - 强化了大银行的道德风险动机\n- 金融并购与政府安全网\n  - 金融并购导致金融机构规模扩张，加剧了“太大不能倒闭”问题。\n  - 银行与其他金融服务企业的并购意味着政府安全网需要扩展到证券承销、保险、不动产等新的业务领域，加大了过度冒险的可能。\n\n### 金融监管的类型\n\n#### 对资产持有的限制\n\n- 对银行持有的资产予以限制，减少道德风险问题，不得持有普通股等风险资产\n- 鼓励银行提高多元化程度，通过限制特定种类贷款或者像单个借款人贷款的规模来降低风险\n\n#### 资本金要求\n\n- 基于杠杆比率：\n  - 资本与银行总资产的比率必须超过5%\n- 基于风险：\n  - 表外业务增加了银行风险\n  - 《巴塞尔协议》要求银行持有的资本至少占其风险加权资产的8%。\n  - 资产被分为四个类别：\n    - 风险权重为零：准备金、经济合作与发展组织（OECD）成员国的政府证券\n    - 风险权重为20%：OECD成员国的银行债权\n    - 风险权重为50%：市政债券、住房抵押贷款\n    - 风险权重为100%：消费者贷款、企业贷款\n  - 通过规定一个信用风险换算系数，将表外业务转化为表内项目\n  - 监管套利：保留风险权重相同但风险较高的资产\n\n#### 即时整改行动\n\n- 资本金规模下降到一个很低的水平：银行资本缓冲减少，破产的可能性加大；金融机构的资本金越少，在赌博中可能遭受的损失就越小，更有可能出现过度冒险的行为。\n- 根据银行资本，银行可分为五个类别：\n  - 资本充裕型：可承销某些证券\n  - 资本充足型：满足最低资本金要求\n  - 资本不充足型：没有满足资本金要求\n  - 资本相当不充足型、资本严重不充足型：不得支付高于平均水平的存款利率\n\n#### 注册与检查\n\n#### 风险管理评估\n\n- 压力测试\n- 在险价值\n\n#### 信息披露要求\n\n#### 消费者保护和对竞争的限制\n\n\n\n## 第十一章 银行业：结构与竞争（TODO）\n\n\n\n## 第十二章 金融危机\n\n### 什么是金融危机\n\n金融脆弱性加剧时，金融市场无法有效地将资金从储蓄者融通给具有生产性投资机会的居民和企业，进而导致经济活动的收缩。\n\n### 金融危机的发展过程\n\n#### 阶段一：金融危机的爆发\n\n信贷繁荣和破灭\n\n- 金融自由化是要取消对金融市场和金融机构的管制，在短期内推动金融机构大规模房贷，通常被称为信贷繁荣。\n- 存款保险制度等政府安全网弱化了市场约束，增加了银行过度冒险的道德风险\n- 最终贷款损失开始累积，贷款相对于负债的价值减少，从而拉低银行和其他金融机构的净值资本水平。\n- 资本减少后，银行就会削减向借款支出者的放款，这一过程被称为去杠杆化。\n- 资本减少后，银行和其他金融机构风险增加，贷款-储蓄者就会抽逃资金。\n- 资金外流后，生产性投资得到的贷款融资减少，即信贷冻结；信用繁荣转化为贷款暴跌。\n\n资产价格繁荣和破灭\n\n- 股票和房地产等资产价格在投资者心理的作用下可以远远超过其基础经济价值，被称为资产价格泡沫。\n- 泡沫崩溃，资产价格回归其基础经济价值，自有资产减少，更倾向于进行高风险投资。（道德风险）\n\n不确定性增加\n\n#### 阶段二：银行业危机\n\n- 储户挤提，银行紧急抛售，资不抵债，传染行为使多家银行破产\n\n#### 阶段三：债务萎缩\n\n- 经济倒退使得价格急剧下降，复苏过程受阻，债务萎缩\n- 价格意料之外的下跌会增加负债的实际价值，但资产的实际价值没有改变，净值减少\n- 加剧了逆向选择和道德风险问题\n\n### 全球金融危机：2007-2009年\n\n#### 2007-2009年金融危机的起因\n\n抵押市场上的金融创新：担保债务权益（CDO）\n\n抵押市场上的代理问题\n\n信息不对称和信用评级机构\n\n#### 2007-2009年金融危机的影响\n\n居民住宅市场：泡沫积聚和崩溃\n\n金融机构的资产负债表恶化\n\n影子银行体系挤提\n\n全球金融市场\n\n知名公司破产\n\n#### 2007-2009年金融危机的顶点\n\n#### 政府干预与经济复苏\n\n实施问题资产援助计划\n\n实施旨在提振经济的财政政策\n\n### 金融监管的反应\n\n#### 宏观审慎监管和微观审慎监管\n\n#### 《多德-弗兰克华尔街改革和消费者保护法案》\n\n消费者保护\n\n清算权力\n\n系统性风险监管\n\n沃尔克法则\n\n衍生品\n\n### “太大不能倒闭”和未来的金融监管\n\n#### 应对\n\n- 分拆具有系统重要性的大型金融机构\n- 提高资本金要求\n- 交给弗兰克法案\n\n#### 其它问题\n\n- 金融服务业的薪酬\n- 政府发起的企业\n- 信用评级机构\n- 过度监管的风险\n\n##第十三章 中央银行与联邦储备体系（TODO）\n\n## 第十四章 货币供给过程（TODO）\n\n\n\n## 第十五章 货币政策工具（TODO）\n\n\n\n## 第十六章 货币政策操作（TODO）\n\n\n\n## 第十七章 外汇市场（TODO）\n\n\n\n##第十八章 国际金融体系（TODO）\n\n\n\n## 第十九章 货币数量论、通货膨胀与货币需求\n\n### 货币数量论\n\n#### 货币流通速度和交易方程式\n\n- 流通速度$V=\\frac{P*Y}{M}$,(Irving Fisher)\n\n#### 数量论与通货膨胀\n\n- 通货膨胀的数量论表明通货膨胀率等于货币供给的增长率减去总产出的增长率。\n\n### 预算赤字与通货膨胀\n\n#### 政府的预算约束\n\n- 政府的三种支付选择：通过征税来增加收入，发行政府债券来借款，创造货币来支付产品和服务。\n- 政府预算赤字等于政府支出和税收收入之差，等于基础货币变化量和公众持有的政府债券变化量的和。\n- $DEF=G-T=\\triangle{MB}+\\triangle{B}$\n- 政府可以用增发的货币来支付超过其税收收入的购买行为。如果不具有发行钞票的权力，政府会通过向公众发行债券的方式来弥补预算赤字。\n- 由于政府债券最终不是由公众持有，中央银行事实公开市场购买而买入债券：债务货币化（monetizing the debt）\n- 长时间通过货币创造的方式弥补预算赤字会导致持续的通货膨胀。\n\n### 凯恩斯的货币需求理论\n\n#### 交易动机\n\n#### 预防动机\n\n#### 投机动机\n\n#### 综合三种动机\n\n- 实际货币余额的需求被称为流动性偏好函数：\n- $$\\frac{M^d}{P}=L(i,Y)$$\n- 与名义利率负相关，与实际收入正相关。\n- 重要结论：流通速度不是常量，而是会随着利率的变动而变动。\n\n### 货币需求的组合理论\n\n#### 组合选择理论与凯恩斯流动性偏好理论\n\n#### 其他影响货币需求的因素\n\n- 财富\n- 风险\n- 通胀对冲资产：通货膨胀保值证券（TIPS）、黄金、不动产\n- 其他资产的流动性\n\n#### 总结\n\n![1528010478641](C:\\Users\\Ada\\Desktop\\1528010478641.png)\n\n### 货币需求的实证分析\n\n\n\n\n\n## 第二十章 IS曲线\n\n### 总需求\n\n$$\nY^{ad}=C+I+G+NX\\\\C=\\bar{C}+mpc×Y_D=\\bar{C}+mpc×(Y-T)\\\\I=\\bar{I}-dr_i\\\\r_i=r+\\bar{f}\\\\NX=\\bar{NX}-xr\\\\G=\\bar{G}\\\\T=\\bar{T}\\\\Y=Y^{ad}\n$$\n\n$\\bar{C}$代表自主性消费支出，外生变量。$mpc$代表边际消费倾向。\n\n$d$是反映投资对实际利率响应程度的参数。$r_i$是实际利率，不仅反映安全的短期债务工具的利率$r$，还反映金融脆弱性（$f$，由阻碍金融市场有效发挥作用的壁垒所引致的额外的借款成本）。\n\n$x$是反映净出口对实际利率响应程度的参数。\n\n\n\n## 第二十一章 货币政策与总需求曲线\n\n### 美联储与货币政策\n\n- 美联储通过调节提供给银行体系的准备金数量来控制联邦基金利率。如果美联储将准备金抽离银行体系，银行可以用于贷放的资金就会较少，流动性短缺造成联邦基金利率上升。\n\n### 货币政策曲线\n\n- 反映了中央银行设置的实际利率与通货膨胀率之间的联系。\n- $$r=\\bar{r}+\\lambda\\pi$$\n- $\\bar{r}$代表中央银行设置的实际利率中的自主性（外生性）部分，与当前的通货膨胀率水平以及模型中的其他变量都无关。$\\lambda$代表实际利率对通货膨胀率的敏感性。\n- 泰勒定理：货币政策曲线向上倾斜。\n\n#### 货币政策曲线的位移\n\n- 美联储提高实际利率：“紧缩的”货币政策。\n- 美联储降低实际利率：“宽松的”货币政策。\n- 沿着货币政策曲线的移动：2004-2006年联邦基金利率指标的上调\n- 货币政策曲线的位移：全球金融危机爆发阶段的**自主性宽松货币政策**\n\n### 总需求曲线\n\n- 总需求曲线反映了任意通货膨胀率水平对应的均衡总产出，总需求曲线向下倾斜，和IS曲线同向位移。\n\n\n\n## 第二十二章 总需求-总供给分析（TODO）\n\n\n\n## 第二十三章 货币政策理论\n\n### 货币政策对冲击的反应\n\n- 中央银行通过实施旨在缩小通货膨胀率和通货膨胀指标之间差距的货币政策，达到物价稳定的目标。\n- 中央银行希望产出缺口最小化。\n\n####面向总需求冲击的反应\n\n##### 无政策反应\n\n- 通货膨胀率下降\n\n##### 短期内稳定经济活动和通货膨胀的政策\n\n- 实施自主性宽松货币政策，降低任意通货膨胀率对应的实际利率水平，刺激投资支出，增加总需求。\n- 在总需求冲击的情况下，不需要在物价稳定和经济活动稳定这两个目标间进行权衡。\n\n#### 面对持续性供给冲击的反应\n\n##### 无政策反应\n\n- 通货膨胀率上升\n\n##### 稳定通货膨胀的政策\n\n- 通过减少总需求，可以实现通货膨胀稳定。\n- 实施自主性紧缩货币政策，提高任意通货膨胀率对应的实际利率，从而导致投资支出减少。\n- 不需要在物价稳定和经济活动稳定这两个目标间进行权衡。\n\n#### 面对暂时性供给冲击的反应\n\n##### 无政策反应\n\n- 不进行任何调整，随着时间的推移，通货膨胀和经济活动会趋于稳定。但在较长的周期内，经济会承受低产出和高失业的痛苦。\n\n##### 短期内稳定通货膨胀的政策\n\n##### 短期内稳定经济活动的政策\n\n- 面对暂时性供给冲击时，稳定经济活动的政策不能稳定通货膨胀。\n\n### 通货膨胀型货币政策的起因\n\n#### 高就业率目标与通货膨胀\n\n- 成本推进型通货膨胀\n  - 暂时性负面攻击冲击，或者工人要求的工资增长幅度超过了产出增长率。\n- 需求拉动型通货膨胀\n  - 政府实施增加总需求的政策。\n\n### 零利率下限的货币政策\n\n- 零利率下限情况下，MP曲线向下倾斜，总需求曲线是向上倾斜的。\n- 零利率下限情况下自我纠错机制失效。经济进入螺旋式下降。\n- $Y\u003cY^P\\Rightarrow \\pi\\downarrow\\Rightarrow r\\uparrow\\Rightarrow Y\\downarrow \\Rightarrow Y\u003c\u003cY^P\\Rightarrow\\pi\\downarrow\\Rightarrow r\\uparrow\\Rightarrow Y\\downarrow$\n- 货币当局为促进产出和提高通货膨胀率，不得不求助于三种类型的非常规货币政策：提供流动性、购买资产（量化宽松）、预期管理。\n\n## 第二十四章  理性预期对于货币政策的意义（TODO）\n\n\n\n## 第二十五章 货币政策的传导机制\n\n### 货币政策传导机制\n\n#### 传统的利率传导途径\n\n- 认为宽松性货币政策导致了实际利率水平的下降，这会降低筹资成本，进而引起投资支出（也包括对住宅和耐用消费品的支出）的增加，最终导致总需求的上升。\n- 强调影响消费者和企业决策的是实际利率而非名义利率。\n- 当名义利率触及零下限时，承诺实施扩张性货币政策，会提高预期通货膨胀率，降低实际利率，刺激支出。\n\n#### 其他资产价格途径\n\n- 传统理论的缺点在于，仅仅关注利率一种资产价格形式，忽略了其他众多资产的价格。\n\n##### 汇率水平对于净出口的作用\n\n- $r\\downarrow\\Rightarrow E\\downarrow\\Rightarrow NX\\uparrow\\Rightarrow Y^{ad}\\uparrow$\n- $E$是美元，国内实际利率水平的下降降低了国内美元资产相对于外币资产的吸引力。美元贬值，净出口增加，总需求增加。\n\n##### 托宾q理论\n\n- 托宾将$q$定义为企业的市场价值与资本重置成本之比。$q$值高，说明企业的市场价值相对于其资本重置成本较高，新的厂房和设备相对于企业的市价就会更便宜，公司就会发行股票。由于企业发行少量的股票就可以购买到大量的资本品，因此企业的投资支出将会增加。\n- 债券的实际利率下降，股票更具吸引力，价格升高。\n- $r\\downarrow\\Rightarrow P_s\\uparrow\\Rightarrow q\\uparrow\\Rightarrow I\\uparrow\\Rightarrow Y^{ad}\\uparrow$\n\n##### 财富效应\n\n- $r\\downarrow\\Rightarrow P_s\\uparrow\\Rightarrow wealth\\uparrow\\Rightarrow consumption\\uparrow\\Rightarrow Y^{ad}\\uparrow$\n\n#### 信用途径观点\n\n认为信用市场的金融脆弱性问题会导致两类货币政策传导途径，一类是通过影响银行的放贷行为发挥作用，另一类通过影响企业和消费者的资产负债表发挥作用。\n\n##### 银行贷款途径\n\n- 扩张性货币政策使银行准备金增加，银行存款增加，银行贷款增加，投资和总需求增加。\n\n##### 资产负债表途径\n\n- 宽松性货币政策导致股价升高，企业净值上升，由于逆向选择和道德风险问题得以缓解，投资和总需求增加。\n\n##### 现金流途径\n\n- 宽松性货币政策使名义利率下降，现金流增加，逆向选择和道德风险下降，贷款增加，投资和总需求增加。\n\n##### 意料之外的物价水平途径\n\n##### 对家庭流动性的影响\n\n##### 信用途径的重要性\n\n- 信用市场的金融脆弱性会影响企业雇用员工以及支出等方面的决策。\n- 小规模的企业比大企业更容易受到货币紧缩政策的影响。\n- 信用途径的核心是信息不对称造成的金融脆弱性。\n\n### 对货币政策的启示\n\n- 把货币政策的松紧简单同短期名义利率水平的升降联系起来通常是十分危险的。\n- 短期债务工具等其他资产价格中包含着货币政策动向的重要信息。\n- 即使短期利率水平几乎为零，货币政策也可以对疲软的经济产生有效的刺激作用。\n- 保持物价水平稳定应当是货币政策的首要长期目标。",title:"Untitled Page"},"/金融市场与金融机构":{content:"[金融市场与金融机构(第2版)/曹凤岐、贾春新](https://book.douban.com/subject/26046346/)读书笔记\n\n---\n\n## 第一章 导论\n\n### 第一节 为什么要研究金融市场与金融机构\n\n### 第二节 金融资产\n\n#### 一、资产与金融资产\n\n- \u003cu\u003e有形资产\u003c/u\u003e：土地、房屋\n  - 可再生\u0026不可再生\n- \u003cu\u003e无形资产\u003c/u\u003e：对某种未来收益的合法要求权\n  - 金融资产是无形资产的一种，是由\u003cu\u003e货币的贷放\u003c/u\u003e而产生的，通常以\u003cu\u003e凭证、收据或者其他法律文件\u003c/u\u003e来表示\n\n#### 二、金融资产的估价\n\n- 估计现金流并贴现\n- 如果市场是有效的，金融资产的价格应该已经反映了所有的相关信息\n\n#### 三、金融资产的性质\n\n- \u003cu\u003e货币性\u003c/u\u003e\n  - 货币：现金、支票存款等\n  - 准货币：国库券、储蓄存款、定期存款\n- \u003cu\u003e可分性\u003c/u\u003e\n- \u003cu\u003e可逆性\u003c/u\u003e：指投资者在购买金融资产后将其转手换回现金\n  - 又称为返回成本（round-trip cost）。\n  - 对银行存款而言，这一成本很低；对二级市场交易的金融资产，在存在做市商制度的情况下，其返回成本包括买卖价差（bid-ask spread）、佣金、税收以及皮鞋成本等。\n- \u003cu\u003e到期期限\u003c/u\u003e\n- \u003cu\u003e流动性\u003c/u\u003e\n- \u003cu\u003e可转换性\u003c/u\u003e\n- \u003cu\u003e币种\u003c/u\u003e\n- \u003cu\u003e现金流入和收益的可预测性\u003c/u\u003e\n- \u003cu\u003e复合性\u003c/u\u003e\n- \u003cu\u003e税务状况\u003c/u\u003e\n\n#### 四、金融资产的作用\n\n- \u003cu\u003e调配资源\u003c/u\u003e\n- \u003cu\u003e转移或减少风险\u003c/u\u003e\n- \u003cu\u003e国家宏观经济调控\u003c/u\u003e的工具\n\n### 第三节 金融市场\n\n#### 一、金融市场的分类\n\n- 按交易工具分：\n  - 债权市场\u0026股票市场\n  - 交易债务工具和优先股的市场统称为固定收入市场，不包括优先股的市场称为普通股市场\n- 按期限划分：\n  - \u003cu\u003e一年和一年以下的短期金融市场\u003c/u\u003e称为货币市场\n  - 一年以上的长期金融市场称为资本市场\n- 按照金融资产进入市场的时间划分：\n  - 发行金融资产的市场称为一级市场\n  - 在投资者之间进行交易的市场称为二级市场\n- 按交易方式：\n  - 场内交易市场和场外交易市场\n    - 中国现在的\u003cu\u003e场内股权交易市场\u003c/u\u003e是上海证券交易所市场和深圳证券交易所市场\n    - \u003cu\u003e银行间债券市场\u003c/u\u003e是中国目前最大的场外交易市场\n- 按交易对象：\n  - 主板市场：属于针对大型成熟公司的股票市场\n  - 二板市场：面向中小公司的市场\n\n#### 二、金融市场的功能\n\n- \u003cu\u003e创造与交易金融资产\u003c/u\u003e\n- \u003cu\u003e价格发现\u003c/u\u003e\n- \u003cu\u003e降低搜寻成本和信息成本\u003c/u\u003e\n- \u003cu\u003e储蓄\u003c/u\u003e功能\n- \u003cu\u003e财富\u003c/u\u003e功能\n- \u003cu\u003e信贷\u003c/u\u003e功能\n- \u003cu\u003e支付\u003c/u\u003e功能\n- \u003cu\u003e风险\u003c/u\u003e功能\n- \u003cu\u003e政策\u003c/u\u003e功能\n\n#### 三、盈余与赤字\n\n$R-E=\\triangle FA-\\triangle D$\n\n$R$代表当前收入，$E$代表当前支出，$\\triangle FA$代表持有的金融资产的变化，$D$代表未付债务与股权的变化。\n\n- 赤字预算单位：企业和政府部门一般属于这类\n- 盈余预算单位：居民家庭部门一般属于这类\n- 平衡预算单位\n\n#### 四、金融交易的发展\n\n- 直接融资：资金从贷出者直接流向借入者\n  - 例如企业直接面向投资者发行股票、债券，居民之间相互借贷，立字为证（IOU）\n  - 缺点：\n    - \u003cu\u003e要求借贷双方在金融交易的数量上必须一致\u003c/u\u003e\n    - 借款人风险很大，期限长又\u003cu\u003e缺乏流动性\u003c/u\u003e\n    - 在寻找对方时必须付出较高的\u003cu\u003e交易成本\u003c/u\u003e\n  - 直接融资中的金融要求权被称为初级证券\n- 半直接融资：通过\u003cu\u003e经纪人和交易商\u003c/u\u003e进行\n  - 经纪人负责提供买卖的信息，交易商以自己的资金买卖证券\n- 间接融资：以金融机构为媒介，实现资金从贷出者向借入者转移的融资方式\n  - \u003cu\u003e金融中介机构将资金提供给最终借款人\u003c/u\u003e：创造初级证券；\u003cu\u003e金融机构还创造出了对自己的金融要求权\u003c/u\u003e：创造次级证券\n  - 银行以吸收存款的方式获得资金，再以发放贷款的方式提供资金给企业\n  - 间接融资由于同时创造了初级与次级证券，所以创造出的金融资产的数量是直接融资时的\u003cu\u003e二倍\u003c/u\u003e\n\n#### 五、脱媒\n\n- 脱媒（金融的非中介化、市场中介化）：资金融通由间接融资走向直接融资\n  - 西方于20世纪70年代脱媒：因为市场利率的上升和金融中介受到的利率管制。垃圾债券、商业票据市场的发展使得借款人减少了对银行的依赖\n    - \u003cu\u003eRegulation Q\u003c/u\u003e：美国商业银行的活期存款利率为0，实行定期存款的利率最高限\n    - 50年代后，美国的\u003cu\u003e通货膨胀\u003c/u\u003e逐渐严重。名义利率由于条例要求不能改变，通货膨胀不断上升后，实际利率就逐渐变为负利率。\n    - 投资人将银行存款取出，直接去购买其他债券\n  - 近年来，资产证券化过程中，一些金融机构主动出售了他们的贷款，一些企业通过证券化而不是银行筹措资金。\n    - 窗口指导：是指央行通过劝告和建议来影响商业银行信贷行为，属于温和的、非强制性的货币政策工具。是一种劝谕式监管手段，指监管机构向金融机构解释说明相关政策意图，提出指导性意见，或者根据监管信息向金融机构提示风险。\n    - 我国严格的金融管制导致金融脱媒（银行的贷款不能超过存款的75%）。\n    - 表外业务受到的管制比较小，于是银行将表内业务移动到表外，产生各种银行理财产品\n    - 我国政府态度：反对——默许——公开鼓励（“增加直接融资比例，降低间接融资比例”）\n\n#### 六、金融市场的全球化\n\n原因：\n\n- 世界范围内的\u003cu\u003e金融自由化浪潮\u003c/u\u003e：对金融市场的管制不断放松\n- \u003cu\u003e信息技术的进步\u003c/u\u003e：使得金融企业和其他投资者能够更加迅速地获得信息，有效处理信息和远距离调动资金\n- \u003cu\u003e金融市场的机构化（institutionalization）\u003c/u\u003e：从散户（retail investor）到机构投资者（institutional investor）的过渡\n\n金融市场的分类：\n\n- \u003cu\u003e内部市场（本国市场）\u003c/u\u003e：\n  - 国内市场：本国发行人发行的证券\n  - 外国市场：外国发行人在本国发行的证券\n- \u003cu\u003e外部市场（国际市场、离岸市场、欧洲市场）\u003c/u\u003e：同时在许多国家发行而且不受任何一国法令制约的市场\n\n### 第四节 金融机构与金融监管\n\n#### 一、金融市场的参加者\n\n\u003cu\u003e政府部门\u003c/u\u003e\n\n\u003cu\u003e国际机构\u003c/u\u003e：世界银行、亚洲开发银行\n\n\u003cu\u003e居民家庭\u003c/u\u003e\n\n\u003cu\u003e非金融企业\u003c/u\u003e\n\n\u003cu\u003e金融机构\u003c/u\u003e\n\n- \u003cu\u003e资产转换\u003c/u\u003e：将最终借款者的债务转换成更容易为投资者所接受的资产，形成自己的负债\n- \u003cu\u003e代理业务\u003c/u\u003e，代客户买卖金融资产\n- \u003cu\u003e自营业务\u003c/u\u003e，为自己的账户买卖金融资产\n- \u003cu\u003e发行业务\u003c/u\u003e，协助发行人创造金融资产并销售\n- 为客户提供\u003cu\u003e投资咨询\u003c/u\u003e\n- \u003cu\u003e管理其他市场参与者的投资组合\u003c/u\u003e\n\n#### 二、金融机构\n\n##### 金融机构的功能和作用\n\n- \u003cu\u003e提供期限中介\u003c/u\u003e\n- \u003cu\u003e分散和降低风险\u003c/u\u003e\n- \u003cu\u003e降低订立合同和处理信息的成本\u003c/u\u003e：防止逆向选择和道德风险（规模经济）\n- \u003cu\u003e提供支付机制\u003c/u\u003e：信用卡等\n\n##### 存款性金融机构\n\n- 商业银行\n- 储蓄机构\n- 信用合作社\n\n##### 非存款性金融机构\n\n- 保险公司\n- 养老基金\n- 投资基金\n- 投资银行\n\n#### 三、金融机构的资产和负债\n\n##### 金融机构的负债\n\n- 负债是指必须在一定时间支出的满足债务合同条款的现金\n  - 现金支付的时间和数量都是确定的：银行存款\n  - 数量确定时间不确定：人寿保单\n  - 时间确定数量不确定：银行发行的可变利率存单\n  - 数量和时间均不确定：财产保险公司的家庭财产保单\n\n##### 金融机构的资产\n\n![1551666826387](C:\\Users\\Ada\\AppData\\Roaming\\Typora\\typora-user-images\\1551666826387.png)\n\n#### 四、金融市场监管\n\n- \u003cu\u003e信息披露\u003c/u\u003e监管：委托代理问题；美国的1933年证券法和1934年证券交易法\n- \u003cu\u003e金融活动\u003c/u\u003e监管：管理者、从业人员可能拥有更多的信息，对他们的交易活动必须加以限制\n- \u003cu\u003e金融机构\u003c/u\u003e监管：对金融机构的资产、负债业务以及资本金进行限制\n- \u003cu\u003e对外国参与者的管理\u003c/u\u003e：A股和B股划分、QFII制度\n\n## 第二章 存款性金融机构\n\n### 第一节 存款性金融机构概述\n\n#### 一、存款性金融机构的特征\n\n- 存款性金融机构是以存款为重要基金来源的金融机构\n- 收入来自于：\u003cu\u003e贷款、投资、收取费用\u003c/u\u003e\n- \u003cu\u003e赚取资产收入和资金成本的差额，称为差额收入（spread income）或利差（margin）\u003c/u\u003e\n- \u003cu\u003e中间业务收入\u003c/u\u003e\n- 风险：\n  - \u003cu\u003e违约风险\u003c/u\u003e\n  - \u003cu\u003e监管风险\u003c/u\u003e\n  - 融资风险（利率风险）\n  - \u003cu\u003e操作风险\u003c/u\u003e\n  - \u003cu\u003e流动性风险\u003c/u\u003e\n  - \u003cu\u003e市场风险\u003c/u\u003e\n\n#### 二、储蓄贷款协会\n\n#### 三、互助储蓄银行\n\n#### 四、信用合作社\n\n### 第二节 商业银行的主要业务\n\n#### 一、商业银行的基本业务\n\n- 银行通过出售一种具有一定流动性、风险和回报特点的资产，再购买另一种具有一定流动性、风险和回报特点的资产，并获得利润的过程称为资产转换\n\n#### 二、商业银行的负债业务\n\n##### 1.存款\n\n- \u003cu\u003e支票存款（活期存款）\u003c/u\u003e\n  - 百分之百流动性\n  - 持有者持有金融资产后，有权向第三方签发支票，用于购买商品劳务和支付债务\n  - NOW（negotiable order of withdrawal）账户：含有利率、流动性百分之百\n  - 中国在2003年9月才把个人结算账户和活期储蓄区别开来\n- \u003cu\u003e定期存款和储蓄存款\u003c/u\u003e\n  - 定期储蓄是中国居民家庭和非营利组织存入的定期存款\n  - 定期存款的概念则专门指\u003cu\u003e企业\u003c/u\u003e的定期存款\n    - 公款私存：一些储蓄存款是企业以个人名义存入的，目的是逃避财务监督和赚取利息收入中饱私囊\n    - 私款公存：1999年11月开始征收利息所得税，由于对公存款不征收利息税，所以逃避税收储蓄存款开始以企业的名义存入\n  - 美国的定期存款概念对应的是中国的定期存款和定期储蓄两者的总和\n  - ATS（automatic transfer service）account：作为传统活期存款账户基础上诞生的一种新型账户，可以使客户兼得活期账户和储蓄账户的双重优点，即一方面可以利用活期账户开支票对外支付；另一方面又可以利用储蓄账户获取利息收入。\n- \u003cu\u003e货币市场存款账户（MMDA）\u003c/u\u003e\n  - 没有到期日，投资者有有限的开出支票的权利，类似于货币市场共同基金，为了应对Q条例才被创造出来\n- 同业存单\n  - 利率市场化\n\n##### 2.借款\n\n- \u003cu\u003e中央银行借款\u003c/u\u003e\n  - \u003cu\u003e再贴现\u003c/u\u003e：商业银行把各种合格证券卖给中央银行\n    - 美国银行较少使用再贴现窗口：不愿意美联储对其进行调查和监管\n  - \u003cu\u003e再贷款\u003c/u\u003e：信用放款/有抵押的放款\n- \u003cu\u003e同业拆借\u003c/u\u003e\n  - 星期三：Federal Funds Rate\n- \u003cu\u003e证券回购协议\u003c/u\u003e\n  - 银行向其他机构的借款\n- \u003cu\u003e商业票据发行\u003c/u\u003e\n  - 短期融资券：直接融资方式，将银行和市场联系起来，银行依赖短期融资工具可能使得银行非常脆弱\n- 国际金融市场借款\n- 结算过程中的资金占用\n  - 从汇款汇出到收款人收款，会有一个时间间隔\n  - 在这一过程中，资金既不属于付款人，也不属于收款人，从而成为银行的资金来源\n- 发行金融债券（可以作为长期资金来源）\n\n##### 3.银行的自有资本\n\n- 银行的净值，等于资产总额与负债总额之差\n- 贷款损失准备金：由银行根据预计的资产损失从收入中提前提取\n  - 尽早处理坏账、减少税款缴纳\n\n#### 三、商业银行的资产业务\n\n##### 1.现金类资产\n\n- 准备金\n  - 法定存款准备率+超额准备率=准备率\n- 应收现金\n- 同业存款\n\n##### 2.贷款\n\n- \u003cu\u003e交易型贷款\u003c/u\u003e\n  - 基于银行相对容易取得的“硬”信息，例如企业的财务状况、抵押资产的价值，这些信息便于书面表述和传递，而不是基于通过长期银企关系才能取得的“软”信息。\n- \u003cu\u003e关系型贷款（小企业）\u003c/u\u003e\n  - 基于中小企业的“软信息”，例如企业主的个人品德和员工的工作满意度等，这些信息难以通过书面文字表达，企业与贷款者建立一种稳定关系，并倾向于与贷款者进行较长期的合作\n\n- 按有无抵押分：\n  - \u003cu\u003e抵押贷款\u003c/u\u003e\n  - \u003cu\u003e信用贷款\u003c/u\u003e\n- 按贷款对象分：\n  - 工商贷款\n  - 农业贷款\n  - 消费者贷款\n  - 不动产贷款\n  - 同业放款\n- 按还款方式：\n  - 一次偿还\n  - 分期偿还\n    - 消费者贷款\n    - 不动产贷款\n\n##### 3.证券投资\n\n- 商业银行通过购买并持有证券也可以获得利息收入，除了可以增加收益外，也可以增加流动性：\u003cu\u003e国库券等流动性强的金融工具\u003c/u\u003e可以在支付不足时迅速转化为现金，被称为二线准备金\n\n- 在中国法律规定禁止银行持有股票\n\n##### 4.其他资产\n\n- 银行的房地产、设备等\n\n#### 四、商业银行的中间业务\n\n- 中间业务：\u003cu\u003e影响商业银行的利润，但并不反映在银行的资产负债表上的业务\u003c/u\u003e\n- 转账结算：对商品、劳务交换所产生的债权债务进行清偿\n- 承兑业务：票据承兑\n- 信用证业务：银行的一种付款承诺\n- 银行保函：作为担保人向受益人开出的书面保证文件\n- 代理业务\n- 经济信息咨询业务\n- 租赁业务\n- 贷款承诺\n  - 信贷额度\n  - 循环贷款承诺\n  - 票据发行便利\n- 贷款销售\n- 衍生产品服务\n- 信托服务\n\n#### 五、中国商业银行的不良资产问题\n\n- 标准普尔2003年对内地银行体系的不良资产比例估值为45%\n- 拨备覆盖率=贷款损失减值准备金余额/不良贷款余额\n- 历史上不良资产的处置：\n  - 资产管理公司\n  - \u003cu\u003e债转股、拍卖、ABS\u003c/u\u003e\n    - 银行将债券卖给资产管理公司，使资产管理公司成为暂时的债权人，再由暂时的债权人变成企业的所有人\n  - \u003cu\u003e政府注资，提取贷款损失准备金\u003c/u\u003e\n  - 银行内部处置\n  - 加大贷款总量、扩大分母、进行稀释\n\n### 第三节 商业银行的发展与结构\n\n#### 一、西方国家商业银行的产生与发展\n\n- 1580年成立的威尼斯银行是第一家以银行命名的金融机构\n- 现代银行的产生：\n  - 新组建股份制银行的方式\n  - 由旧的高利贷性质的银行转变为现代银行\n\n#### 二、中国商业银行的产生与发展\n\n- 1845年，英资银行丽如银行：第一家新式银行\n- 1897年，中国通商银行：第一家中资银行\n- 1949年建国后：\n  - 没收、改造、合并、新建：建立了银行体系\n- 1956-1978：\n  - 只有中国人民银行，大一统的金融体制\n  - 按照行政区划设置，禁止其他金融机构的活动与商业信用\n  - 既负责金融管理，又办理具体的金融业务\n  - 中国人民银行负责对企业的开户、结算、现金出纳进行监督\n  - 内部实行严格的计划管理\n- 1979年后：\n  - 中国人民银行的国外业务部独立出来，组成中国银行，也称为外汇管理局；后来外汇管理局又并入中国人民银行，中国银行成为专业的外汇外贸银行\n  - 分设出中国农业银行\n  - 设立了中国人民建设银行\n- 1986年后：\n  - 交通银行的建立，开了组建新的股份制银行的先河\n- 2000年：\n  - 银行上市\n\n#### 三、商业银行的结构\n\n- 总分行制\n  - 优点：规模效应、分散风险\n  - 缺点：垄断、周转不灵、难以监管、利润也可能会受到外地经济状况的影响\n- 单一银行制\n  - 优点：为客户提供个性化服务\n  - 银行建立持股公司以持有多家银行的股权、电子银行设施的发展\n- 向总分行制发展的原因：\n  - 客户从城市向郊区的流动\n  - 银行的倒闭与收购\n  - 企业贷款需求的成长、小银行无法满足\n\n#### 四、银行合并现象\n\n- \u003cu\u003e规模经济\u003c/u\u003e\n- \u003cu\u003e资产多元化与分散风险\u003c/u\u003e\n- \u003cu\u003e高层经营者的利益\u003c/u\u003e\n- \u003cu\u003e垄断价格\u003c/u\u003e\n\n银行业务国际化\n\n- 一些国家国外银行数目剧增\n- 一些国家商业银行跨国经营机构越来越多\n- 一些国家的外国银行资产占所在国银行总资产的比重不断上升\n- 国际融资由银行贷款向证券发行方向转化\n- 商业银行已经成为国际债券的重要发行者和持有者\n\n#### 五、金融创新\n\n- 金融工具多样化\n- 金融机构业务交叉\n- 促进了金融机构和组织的发展\n- 推动金融制度的进一步放宽\n\n## 第三章非存款性金融机构\n\n### 第一节非存款性金融机构概述\n\n#### 一、非存款性金融机构的性质及种类\n\n- 主要不以吸收存款为资金来源，而从事投资和其他金融服务的金融机构。\n- \u003cu\u003e契约性机构\u003c/u\u003e：这类机构主要是\u003cu\u003e保险公司和养老保险机构\u003c/u\u003e等。它们根据合同来收取一定的费用或资金，用于金融服务和投资。 \n- \u003cu\u003e投资中介机构\u003c/u\u003e：这类机构主要以\u003cu\u003e收取佣金和手续费为收入来源，也通过投资的方式获得收入\u003c/u\u003e，包括投资银行(证券公司)、财务公司、投资公司、信托公司、租赁公司、金融公司等。\n\n#### 二、保险公司\n\n- 防范逆向选择\n  - \u003cu\u003e筛选\u003c/u\u003e\n  - \u003cu\u003e根据风险确定保险费\u003c/u\u003e\n- 防止道德风险\n  - \u003cu\u003e限制性条款\u003c/u\u003e\n  - \u003cu\u003e注销保险\u003c/u\u003e\n  - \u003cu\u003e免赔额与联合保险。\u003c/u\u003e在保险契约中应该规定，如果损失发生了，保险公司并不会负责承担全部损失，而是只负责其中的一部分，另一部分要由投保人自己承担。这可以从利益角度限制保险金额\n- 保险公司的收入包括\u003cu\u003e保费收入和投资收入\u003c/u\u003e，支出包括\u003cu\u003e对保单的理赔支出和保险公司的运营费用\u003c/u\u003e。两者的差额就是保险公司的利润。\n\n#### 三、养老保险机构\n\n- 是商业保险和社会保障相结合的体制\n\n#### 四、金融公司（财务公司）\n\n##### 1.销售金融公司\n\n- 销售金融公司(sales finance companies)为消费者在特定的销售者那里购货进行融资。这种金融公司使得消费者可以在购货地得到便捷的信贷服务。\n- 优点在于，它可以\u003cu\u003e把制造与零售活动和融资活动分离开来。\u003c/u\u003e\n- 与商业银行不同，金融公司没有法定准备要求。\n\n##### 2.消费者金融公司\n\n- 消费者金融公司(consumer finance companies)：为消费者提供贷款，为消费者\u003cu\u003e购买家具、装修住房、偿付债务融通资金\u003c/u\u003e。这类公司有些是独立的，有些是附属于银行的，贷款规模一般小于销售金融公司。\n\n##### 3.工商金融公司\n\n- 工商金融公司(commercial finance companies)是直接向\u003cu\u003e工商企业\u003c/u\u003e提供融资服务的金融公司。融资方式可能是贷款，也可能是代理收款、设备租赁等。\n\n#####风险\n\n- 流动性风险利率风险和信用风险\n- 由于金融公司的资产大部分是各种贷款，因此信用风险较为严重。\n\n#### 五、政策性银行\n\n- 政策性银行一般是由政府投资创办的金融机构，要按照政府的意图与计划从事信贷活动。政策性银行与财政不同，它发放的贷款是必须偿还的，银行经营要坚持保本微利的原则。\n- 实现专业银行的商业化经营，割断政策性业务与基础货币的联系\n- \u003cu\u003e国家开发银行\u003c/u\u003e负责承接中国建设银行原来的政策性业务，筹集和引导社会资金用于国家重点建设项目和基础产业。\n- \u003cu\u003e中国进出口银行\u003c/u\u003e负责承担中国银行原来的政策性业务，为进出口提供政策性金融支持。\n- \u003cu\u003e中国农业发展银行\u003c/u\u003e负责中国农业银行原来的政策性业务，为农业基建、重点工程、农副产品流通提供政策性金融服务。 \n- 政策性银行的资金来源主要有三方面：\u003cu\u003e财政拨付、中央银行再贷款、发行金融债券筹集资金。\u003c/u\u003e\n\n### 第二节 投资基金\n\n#### 一、投资基金的形式\n\n##### 1.开放式基金\n\n- 基金发起设立后，可以随时向公众卖出基金股份，并承诺投资者可以随时将基金售回给公司。\n- 申购价格为\u003cu\u003e基金的每股净资产值加上买入佣金\u003c/u\u003e\n\n##### 2.封闭式基金\n\n- 封闭式基金的发行数额是固定的，这种基金并不给投资者\u003cu\u003e赎回基金\u003c/u\u003e的权利。\n- 基金的流动性体现在二级市场的交易上，投资者可以在二级市场上买卖封闭式基金，但基金公司本身不参加交易。\n- 折价交易的原因：\n  - \u003cu\u003e可能与投资者情绪有关。\u003c/u\u003e\n  - \u003cu\u003eNAV没有经过税收调整\u003c/u\u003e\n  - \u003cu\u003e封闭式基金的规模是固定的，所以基金设立后，一般不需要大量做广告宣传\u003c/u\u003e\n  - \u003cu\u003e证券难以估价，因而会导致基金的折价交易\u003c/u\u003e\n  - 封闭式基金由于额度固定，需要依赖于融资。\n  - 基金的杠杆率和风险也是决定折价率的重要因素。\n- 因为存在折价交易的问题，封闭式基金的流动性比开放式基金差。\n- 封闭式基金一般是溢价发行，溢价部分也就是发行成本，是由最初的购买者承担的。\n- 开放式基金的缺点：\n  - 为了应付客户赎回，开放式基金必须\u003cu\u003e保存更多的现金资产\u003c/u\u003e，因而成本较高\n  - 封闭式基金在二级市场买卖，手续费较低。\n\n##### 3.单位信托\n\n- 在美国，单位信托只发行固定数目的份额，称为单位凭证，这一点和封闭式基金相同。但它们是由发行公司负责投资者的申购和赎回，这点又和开放式基金一样。\n\n#### 二、基金的结构和收支\n\n#### 三、基金的投资策略\n\n- 成长型基金注重投资于有增值潜力的股票，相应的风险较大。基金追求的是发现被错误定价的股票。\n- 收入型基金注重当前收入，往往投资于高红利的股票和高利息的债券。\n- 股票基金专门投资于股权，债券基金专门投资于债券。\n\n#### 四、交易所交易基金\n\n- 开放式基金的交易存在明显缺点。\n  - \u003cu\u003e基金的申购和赎回都要依赖于基金净资产，而净资产的确定依赖于基金持有资产的收盘价。这样，基金每天只能有一个价格，而没有不同交易时点的变化。\u003c/u\u003e\n  - \u003cu\u003e如果投资者赎回基金，基金由于卖出资产，实现资本利得，必须缴纳资本利得税。\u003c/u\u003e\n- 封闭式基金交易价格可能与基金净资产不同，形成折价或溢价交易。 \n\n#### 五、投资基金的监管 \n\n### 第三节中国的投资基金\n\n#### 一、投资基金的折价交易\n\n- \u003cu\u003e中国的证券市场不规范，投机气氛很浓，投资者热衷于短线操作。\u003c/u\u003e\n- \u003cu\u003e投资基金规模不断扩大，各家基金的市场定位趋同，投资组合雷同，不像西方有多种不同的基金种类，使得市场供给相对偏多。\u003c/u\u003e\n- \u003cu\u003e我国的投资基金往往重仓持有许多股票，成为市场上的庄家，这就形成了流动性风险。因为基金如果抛售这些证券，必然会付出大量的市场执行成本。因而基金的净资产中含有一定的泡沫。\u003c/u\u003e\n\n####  二、货币市场共同基金问题\n\n- 银行纷纷推出类似货币市场基金的信托产品。2005年，商业银行终于获准组建基金公司。\n\n#### 三、开放式基金\n\n#### 四、契约型基金\n\n- 委托人、信托人和受益人三方共同组成。\n- \u003cu\u003e委托人即基金的管理人，受托人在中国由商业银行担任，负责信托财产的保管。受益人即基金的持有者\u003c/u\u003e\n- 契约型基金与公司型基金的差别主要有： \n  - \u003cu\u003e法人资格不同\u003c/u\u003e。公司型基金具有法人资格，而契约型基金没有法人资格。相应地，在信托财产的运用上，公司型基金的依据是公司章程，契约型基金的依据是信托契约。\n  - \u003cu\u003e发行的融资工具不同\u003c/u\u003e。公司型基金可以发行股票、债券、认股权证等，契约型基金只能发行受益凭证。\n  - \u003cu\u003e投资者的地位不同\u003c/u\u003e。公司型基金的投资者是股东，享有公司法赋予的权利。契约型基金的投资者仅仅是基金的受益人。 \n\n#### 五、指数基金和ETF\n\n#### 六、机构投资者的发展\n\n- 基金业的价格操纵问题\n- 基金业的内幕交易\n-  “老鼠仓”问题\n- 利用优势，基金还可以选择投机\n- 中国的上市公司一股独大现象严重，基金难以进行有效的监督。\n\n#### 七、基金法的修订\n\n### 第四节投资银行\n\n#### 一、投资银行的主要业务\n\n##### 1.发行业务\n\n- 在承销中，投资银行挣得买入与卖出证券的价格差，称为利差(gross spread)或承销折扣(underwriting discount)。由于承销存在很大的风险，所以投资银行往往组织承销团进行承销\n\n#####  2.证券交易\n\n- 做市活动的收入包括证券的买卖价差与持有证券的资本利得。\n\n##### 3.证券私募\n\n- 投资银行在私募市场上为发行人和潜在投资者设计新的证券并为之定价，再努力将证券销售出去。在证券私募(private placement of securities)过程中，投资银行往往会担任顾问的角色。\n\n##### 4.资产证券化\n\n##### 5.收购与兼并\n\n- 投资银行为收购公司提供资金支持时，有不同的方法。一是向收购方提供过桥贷款，二是为收购方承销股票或债券，三是直接持有目标公司的股权。\n\n##### 6.商人银行业务\n\n- 投资银行运用自有资金对公司进行股权或债权投资\n- 股权投资是希望获得资本利得；债权投资主要是指为客户提供过桥贷款\n\n##### 7.衍生工具业务\n\n##### 8.资金管理\n\n#### 二、投资银行业的监管\n\n#### 三、投资银行业的风险\n\n- \u003cu\u003e市场风险\u003c/u\u003e\n  - 投资银行的许多业务收入与市场状况密切相关。当股市向好时，投资银行的自营、经纪和并购等业务都会增加收入；反之，股市低迷时，投资银行的许多收入都会下降。\n- \u003cu\u003e利率\u003c/u\u003e\n  - 风险利率的波动会影响投资银行持有的股票特别是债券的价格。利率的波动，也会引起投资者资产选择的变化，从而影响投资银行经纪业务的收入。 \n- \u003cu\u003e信用风险投资\u003c/u\u003e\n  - 银行的过桥贷款等业务存在较强的信用风险。\n- \u003cu\u003e流动性风险\u003c/u\u003e\n  - 当投资银行大量依赖短期商业票据融资时，这一风险尤为严重。\n\n#### 四、投资银行业的结构\n\n- 大额认购公司(bulge bracket firms)是在规模、声誉、客户基础等方面最好的投资银行。\n- 主要认购公司(major bracket firms)的地位仅次于前者，但也提供全面的投资银行服务。\n- 次级认购公司(submajor bracket firms)为特殊的投资者群体和小公司服务。\n- 专营公司(boutiques)专营某一项主要的投资银行业务。如区域公司主要是为本地区的地方政府和公司服务。研究公司专门提供研究服务。商人银行进行并购与融资业务。有些公司专门负责高科技企业的证券发行等。\n\n### 第五节中国的投资银行\n\n#### 一、中国证券经营机构的组成\n\n- 券商，即证券公司。根据《证券法》的规定，券商分为综合类券商和经纪类券商。\n- 中外合资的投资银行\n- 国债一级自营商\n- 企业集团财务公司\n\n#### 二、中国证券经营机构的业务现状\n\n- 业务品种与结构单一、雷同\n- 在业务结构上，证券发行、自营和经纪业务是中国券商的三项主要业务。\n\n#### 三、中国券商的融资问题\n\n- 中国券商的融资渠道主要有：银行同业拆借与国债回购、股票质押贷款等。\n- 由于融资狭窄，券商不得不采取各种变相、非规范的融资渠道，实际生活中经常出现的方式有：挪用客户保证金、变相吸收个人和公司的存款、绕过中央银行变相和私下违规发行金融债券、以各种违规方式利用银行信贷资金等。\n\n\n\n## 第四章 中央银行\n\n### 第一节 中央银行的职能与类型\n\n#### 一、中央银行的产生\n\n#### 二、中央银行的职能\n\n##### 1.中央银行是发行银行\n\n由于每一家商业银行的信誉都是有限的，因此也限制了银行券的广泛流通。由中央银行垄断货币发行权，就可以解决这样的问题，为经济发展提供一个稳定的货币环境。\n\n##### 2.中央银行是银行的银行\n\n- \u003cu\u003e中央银行集中商业银行的存款准备\u003c/u\u003e\n- \u003cu\u003e作为商业银行的最后贷款人\u003c/u\u003e\n- \u003cu\u003e票据结算中心\u003c/u\u003e\n  - 各家商业银行一般都在中央银行开立存款账户\n  - 需要将A银行在中央银行的存款账户上的资金划转到B银行的户头上。这可以看作是中央银行的一种中间业务。\n\n##### 3.中央银行是政府的银行\n\n- \u003cu\u003e代理国库\u003c/u\u003e。在现代社会，政府的各级财政部门都会在中央银行开立存款账户，财政支出则委托中央银行无偿办理\n- \u003cu\u003e代理财政馈券的发行。\u003c/u\u003e\n- \u003cu\u003e为政府提供资金支持。\u003c/u\u003e\n- \u003cu\u003e保存、管理、经营黄金和外汇储备。\u003c/u\u003e\n- \u003cu\u003e金融监管\u003c/u\u003e\n\n#### 三、中国中央银行的产生与发展\n\n- 1983年9月，中国政府决定建立中央银行制度，将当时的人民银行一分为二。\n- 最初，中央银行按照行政区划设立分支机构。这种方式的缺点是，中央银行的金融管理容易受到地方政府的干预。\n\n#### 四、中央银行的资产负债表\n\n##### 1.中央银行的负债\n\n- \u003cu\u003e流通中货币\u003c/u\u003e。现金是社会公众所持有的金融资产，同时也就是中央银行对社会公众的负债。现代社会的货币发行一般是由中央银行垄断的。\n- \u003cu\u003e金融机构存款\u003c/u\u003e。金融机构需要向中央银行存人准备金，包括法定存款准备金和超额准备金。\n- \u003cu\u003e政府及公共机构存款\u003c/u\u003e。中央银行有代理财政金库的职能。所以，政府部门在中央银行拥有存款账户。\n- \u003cu\u003e资本项目\u003c/u\u003e。\n  - 中央银行的资本金来源，主要包括以下几方面\n    - 一是中央政府出资。中央银行是政府所有的。因而，在大多数国家，这是中央银行资本金的唯一来源。中国的情况就是如此。\n    - 二是地方政府或者国有的机构，如国有企业、一些公共部门等出资。\n    - 三是私人部门出资。\n\n##### 2.中央银行的资产\n\n- \u003cu\u003e对存款货币银行债权\u003c/u\u003e。这是中央银行对存款机构的债权，包括贴现和放款等。\n- \u003cu\u003e对中央政府债权\u003c/u\u003e。这包括中央银行持有的政府债券和财政借款。\n- \u003cu\u003e金银、外汇占款\u003c/u\u003e。这是中央银行作为政府的银行持有的黄金外汇储备。\n- 其他资产。包括应收现金、自有资产等。\n\n#### 五、中央银行的类型\n\n##### 1.单一型中央银行制度\n\n- \u003cu\u003e一元式中央银行\u003c/u\u003e\n  - 这是指一个国家设立专门的中央银行，一般是在首都设立总行，采取总分行制，在各地设立不同级别的分支机构。中国等大部分国家就是采用这种制度。 \n- \u003cu\u003e二元式中央银行\u003c/u\u003e\n  - 这是指政府在中央和地方分别设立相对独立的中央银行机构。地方银行接受中央级机构的领导，但不属于后者的分支机构，因而存在比较大的独立性。德国曾经实行过这种制度。\n- \u003cu\u003e多元式中央银行\u003c/u\u003e\n  - 这是指一个国家内设立许多平行的中央银行机构。\n\n##### 2.复合型中央银行制度\n\n- 这是指一个国家没有专门的中央银行，而是由一家大商业银行同时行使中央银行的职能。中国以前实行的就是这种体制。这种制度很不规范，不能适应现代经济制度的需要。\n\n##### 3.跨国型中央银行制度\n\n- 这是指参加某一货币联盟的国家共同组成的中央银行制度。 \n\n##### 4.准中央银行制度\n\n- 这是指政府设立某种类似中央银行的机构，或者授权某些商业银行行使部分中央银行的权力。\n\n#### 六、中央银行的独立性\n\n- 主张中央银行应该具有更大独立性：\n  - 可以减少其承受的政治压力，而政治压力往往会导致通货膨胀。\n  - 政府如果能够控制中央银行，很容易就会使中央银行成为弥补财政赤字的工具，诱发通货膨胀。\n  - 政治家不是经济专家，不具有决定货币政策的能力。独立的中央银行制定政策时，也可以顶住公众的压力，从而实施符合公众长远利益的政策。比如，如果紧缩是必要的，则不管失业者如何反对，紧缩政策都必须坚持。\n- 反对中央银行独立性的观点：\n  - 把中央银行的货币政策决策权交给少数几个精英人物，与民主原则相冲突。因为没有理由认定这几个人的决策一定是正确的。\n  - 中央银行的独立性过大，可能会使它更多地追求自身的利益。\n  - 财政政策与货币政策的配合可能也难以进行。\n\n### 第二节 中央银行与货币供给\n\n#### 一、派生存款创造\n\n- 前提\n  - 银行实行\u003cu\u003e部分准备制\u003c/u\u003e\n  - 经济中的\u003cu\u003e非现金结算制度\u003c/u\u003e\n\n##### 1.派生存款的创造过程\n\n##### 2.派生存款的紧缩过程\n\n##### 3.模型的缺陷\n\n- 商业银行是否会持有超额准备金\n\n##### 4.中国银行的货币创造 \n\n##### 5.存贷款关系\n\n- 对于整个银行体系来说，两者的关系是贷款决定存款，因为贷款能够创造出新的存款。但是，对于单个银行来讲，还是先有存款后有贷款。单个银行是不能创造存款的，必须首先吸收存款，然后才能发放贷款。所以，各家银行都会非常重视吸收存款。\n\n#### 二、完整的货币供给模型\n\n##### 1.基础货币\n\n$B=C+R$\n\n##### 2.货币乘数\n\n$$\nB=RR+ER+C=r_dD+r_tt'D+e'D+c'D\n$$\n\n$$\nMoney\\ supply=D+C=D+c'D\n$$\n\n$RR$：法定存款准备金\n\n$ER$：超额准备金\n\n$D$：活期存款\n\n$t'$：定期存款/活期存款\n\n$e'$：超额准备金/活期存款\n\n$c'$：通货/活期存款\n\n$r_d$：活期存款的法定存款准备率\n\n$r_t$：定期存款的法定存款准备率\n\n#### 三、决定货币供给的四方面因素分析 \n\n##### 1.中央银行与货币供给\n\n- \u003cu\u003e公开市场业务\u003c/u\u003e\n- \u003cu\u003e贴现政策\u003c/u\u003e\n- \u003cu\u003e调整法定存款准备率\u003c/u\u003e\n- 基础货币中，中央银行能够控制的只是基础货币减去贴现放款的部分，即非借入货币基础（nonborrowed monetary base）\n\n##### 2.存款者与货币供给\n\n- \u003cu\u003e财富\u003c/u\u003e。存款者的财富越多，其持有现金的比率往往越低。一般而言，低收入者倾向于使用现金，高收入者倾向于使用支票。所以，现金可以看作是一种必需品。 \n- \u003cu\u003e资产的预期报酬率\u003c/u\u003e。 \n- \u003cu\u003e风险。\u003c/u\u003e在出现金融危机时，人们会明显增加对现金的持有。 \n- \u003cu\u003e流动性与交易成本。\u003c/u\u003e \n- \u003cu\u003e非法经济活动。\u003c/u\u003e地下经济越发达，通货一活期存款比率越高。因为毒品交易、高利货、赌博等地下交易更倾向于使用现金而不是支票。逃税与现金的使用也有一定的关系。税率越高，在交易中人们就越愿意接受现金。\n\n##### 3.借款者与货币供给\n\n- 如果借款需求旺盛，商业银行资金不足，就会向中央银行融资。\n\n##### 4.商业银行与货币供给\n\n- \u003cu\u003e超额准备金占活期存款的比率\u003c/u\u003e\n  - 市场利率：负相关，持有超额准备金的机会成本变高\n  - 准备金利率：正相关\n  - 预期存款流出及其不确定性：正相关\n- \u003cu\u003e向中央银行借款\u003c/u\u003e\n  - 市场利率：如果市场利率上升，发放贷款更加有利可图，商业银行就会增加向中央银行的借款\n  - 贴现率：如果贴现率上升，向中央银行借款的成本上升，商业银行就会减少这种借款。\n\n### 第三节 货币政策的目标与工具\n\n#### 一、货币政策的主要目标\n\n- \u003cu\u003e充分就业\u003c/u\u003e\n  - 中央银行应该追求的起使失业率符合自然失业率的水平。自然失业率是指在不刺激通货膨胀的情况下，可以维持的最低失业率。\n\n- \u003cu\u003e物价稳定\u003c/u\u003e\n\n- \u003cu\u003e经济增长\u003c/u\u003e\n- \u003cu\u003e外汇市场稳定\u003c/u\u003e\n- 1995年，《中央银行法》颁布，将中国的货币政策目标表述为“保持货币币值的稳定，并以此促进经济的增长。”\n\n#### 二、货币政策的工具\n\n##### (一) 一般性政策工具\n\n###### 1.调整法定存款准备率\n\n- 优点：\n  - 是一项强有力的工具，会立即产生效力，而且对所有的银行一视同仁\n- 缺点：\n  - \u003cu\u003e效果太猛烈\u003c/u\u003e\n  - \u003cu\u003e容易影响银行的经营，提高银行的管理成本\u003c/u\u003e\n\n###### 2.贴现政策\n\n- \u003cu\u003e用于调整货币供应量\u003c/u\u003e\n- \u003cu\u003e防止出现银行恐慌\u003c/u\u003e\n- \u003cu\u003e告示效应(announcement effect)。\u003c/u\u003e中央银行调高贴现率时， 就是在传递中央银行实行紧缩货币政策的信息。公众因而会预期未来利率将上升，经济增长将放慢，并据此调整自己的经济决策。由于贴现率是货币市场上的重要基准利率，因此贴现率的变动往往会立刻引起市场短期利率的同步变动\n- 缺点：\n  - \u003cu\u003e中央银行在实行贴现攻策时只能调整贴现率\u003c/u\u003e，而不能直接决定贴现放款额，后者归根结底是由商业银行决定的。所以，即使中央银行提高贴现率，贴现放款也未必会按照中央银行所希望的程度减少。\n  - \u003cu\u003e信息传递过程中可能会出现失真的问题\u003c/u\u003e。比如，当市场利率上升后，如果中央银行不调整贴现率，贴现放款会增加，货币供应量就会扩大。如果中央银行选择调高贴现率，虽然这种调高是适应市场利率变动的被动行为，但可能会被公众误认为其正在实行紧缩性的货币\n\n###### 3.公开市场业务\n\n- 动态的(dynamic)公开市场业务，目的在于使基础货币与货币供应量发生意愿的变化\n- 防卫性的(defensive)公开市场业务，目的在于抵消基础货币的非意愿变化。\n- 公开市场业务作为货币政策工具之一，具有以下优点\n  - \u003cu\u003e在实行公开市场操作时，中央银行处于主动地位。\u003c/u\u003e\n  - \u003cu\u003e在开展公开市场操作时，中央银行可以进行微调。如果只需要货币供应量较小的变动，中央银行也可以很容易通过公开操作做到。\u003c/u\u003e\n  - \u003cu\u003e及时迅速，易于进行反向操作。中央银行可以经常性、连续性地进行公开市场操作\u003c/u\u003e \n\n##### (二) 选择性货币政策工具\n\n- \u003cu\u003e不动产信用控制\u003c/u\u003e\n- \u003cu\u003e消费者信用控制\u003c/u\u003e\n- \u003cu\u003e证券市场信用控制\u003c/u\u003e\n\n##### (三) 直接信用控制\n\n- 这是指以行政命令或其他方式直接干预金融活动\n\n##### (四) 道义劝导\n\n- 这是指中央银行以发出通告、指示或面谈的方式劝告商业银行遵守政府政策。道义劝导既可以用于总量调节，也可以用于结构调节。政策的效力以中央银行的权威为前提。\n\n### 第四节 货币政策的传导机制与中介目标\n\n#### 一、凯恩斯主义的货币政策传导机制\n\n$M→r→I→E→Y​$\n\n#### 二、货币学派的货币政策传导机制\n\n- 货币供给的增加不一定会引起利率的下降\n- 货币供给的变化会影响名义收入的变化（黑箱理论）\n\n#### 三、货币政策的中介目标\n\n- \u003cu\u003e相关性、可计量性、可控性、抗干扰性\u003c/u\u003e\n- 利率和货币供应量是最经常采用的货币政策中介目标。\n  - 从相关性看，货币供给的变化对名义收入的变化会有重要的影响。利率会影响投资与消费支出，所以也会对名义收入产生重要影响。\n  - 从可计量性看，利率和货币供应量都有迅速及时的统计数据，但要区分名义利率和实际利率。\n  - 从可控性看，中央银行可以对货币供应量施加影响，但中央银行不能完全控制货币供应量。中央银行可以制定贴现率，可以通过公开市场业务影响债券的价格和收益率，但是，由于预期的原因，中央银行不能制定实际贴现率。\n  - 从抗干扰性看，比较而言，利率的抗干扰性比较差。\n\n#### 四、货币政策的时滞\n\n- \u003cu\u003e内部时滞\u003c/u\u003e，是指从经济形势发生变化到货币当局采取行动的时间。\n  - \u003cu\u003e认知时滞\u003c/u\u003e：从形势发生变化需要采取行动到中央银行意识到需要采取行动的时间。\n    - 存在认知时滞的原因：\n      - 可能在于统计上存在一定的滞后\n      - 可能在于中央银行的认识能力不足。\n  - \u003cu\u003e行动时滞\u003c/u\u003e：指从中央银行认识到需要采取行动到实际采取行动的时间。长短取决于中央银行的工作效率、政策手段以及法律因素等。\n- \u003cu\u003e外部时滞\u003c/u\u003e，是指从中央银行采取行动到对最终目标产生结果的时间。\n  - \u003cu\u003e财政政策\u003c/u\u003e由于能直接改变总支出，所以外部时滞较短。货币政策的外部时滞相对较长。 \n\n### 第五节 银行监管\n\n#### 一、注册和检查\n\n#### 二、对银行持有资产的限制\n\n#### 三、银行资本要求\n\n- 一是进一步扩展、完善了最低资本充足率的内容与要求，并就资本充足率计算中的各种风险测算进行了较为深入的探讨\n- 二是转变监管部门监督检査的方式与重点，监管当局的监督检査既要监督银行的资本金与其风险数量相匹配，也要监督银行的资本金与其风险管理水平相匹配，以鼓励银行开发和采用更好的风险管理技术来监测、管理它们的风险，对银行的全面风险进行行业监管，等等。 \n- 三是对银行的公开信息披露提出了一整套强制规定要求和建议，对银行全面风险进行社会监管。在信息不够透明的情况下，银行将进行更为谨慎的管理。\n\n#### 四、存款保险\n\n- 存款保险制度也不可避免地会带来逆向选择和道德风险问题。\n- 为了解决逆向选择的问题，美国在1991年开始实行差额保险金制度，风险高的银行要缴纳更多的保险金。\n- 太大而不能倒( too big to fail)的问题。\n  - 一是使大储户缺乏监督银行的动力；二是妨碍公平，因为这既是对储户的不公平对待，也是对银行的不公平对待。\n\n#### 五、对银行业务活动范围的管理——分业经营与混业经营\n\n- 混业经营的优点\n  - 由于银行提供的是全方位的金融服务，因此有利于银行\u003cu\u003e吸引客户\u003c/u\u003e。\n  - 混业经营有利于\u003cu\u003e银行掌握更多的有关客户的信息\u003c/u\u003e。银行不仅可以了解客户的存贷款状况，还可以了解客户的证券投资、信托资金信息，\u003cu\u003e减少逆向选择与道德风险\u003c/u\u003e。 而且，由于证券与银行等业务可以利用同样的信息，因此有利于\u003cu\u003e减少成本\u003c/u\u003e。\n  - \u003cu\u003e有利于增加竞争\u003c/u\u003e。所有的机构都从事各种金融业务，可以使银行与证券等业务都有更充分的竞争， 从而有利于客户。\n- 分业经营的优点\n  - \u003cu\u003e有利于防范金融风险\u003c/u\u003e\n  - \u003cu\u003e认为混业经营有可能侵犯客户的利益。\u003c/u\u003e\n\n### 第六节 2008年金融危机及其影响\n\n#### 一、危机的缘起：次级抵押市场\n\n- 真实票据论：存款是商业银行资金的主要来源，为应付存款突然提现，就需要保持资金的流动性。因此，商业银行的放款应是短期的和商业性的，因为短期的和商业性的贷款带有自动清偿性。即是说，只有以真实票据作担保抵押的银行券发行和贷款才是实在的、才不会过剩。\n\n- 次级贷款\n\n  - FICO score\u003c660：\u003cu\u003e高风险\u003c/u\u003e；违约率至少是正常贷款的7倍\n  - \u003cu\u003e高成本\u003c/u\u003e：贷款的申请费和服务费比较高\n  - 主要是汽车和抵押贷款\n  - 往往被称为故事贷款\n  - 次级抵押市场1980年代初出现\n  - 发展的原因：\n    - \u003cu\u003e法律的放松\u003c/u\u003e：利率管制和税收政策的放松\n    - \u003cu\u003e利率\u003c/u\u003e的变化\n    - \u003cu\u003e证券化\u003c/u\u003e的发展\n\n- 危机的直接原因\n\n  - \u003cu\u003e2006年后美国住宅价格增速减缓\u003c/u\u003e\n\n  - 部分次级抵押贷款结束了\u003cu\u003e初始利率优惠期\u003c/u\u003e\n\n  - 2004年6月后美联储\u003cu\u003e多次提高利率\u003c/u\u003e\n\n    \u003e 中国：量化宽松，希望减息促进经济增长；但无法保持汇率的稳定——中央银行给商业银行发放贷款\n\n#### 二、危机的进一步发展\n\n- 商业银行：SIV\n- 投资银行\n- 衍生产品市场：CDS\n- 保险公司：AIG\n- 股票市场\n- 对手风险\n- 评级公司\n  - SEC建立了NRSRO制度，圈定认可的评级组织，并依据他们的评级确定金融机构的资本要求\n- 适当性\n- 监管与货币政策\n- LTCM和道德风险\n  - 太大不能倒：大公司倾向于冒险\n\n#### 四、金融危机与实体经济\n\n- 各国政府的救助：为创造流动性，用7000亿美金购买问题金融机构的优先股\n- 金融发展与经济增长\n- 金融危机影响经济增长\n  - 信贷紧缩和流动性缺乏\n  - 消费下降\n\n#### 五、对中国金融与经济的影响\n\n- 直接冲击：\n  - 商业银行：国际化程度低，所以冲击的程度有限\n  - 投资银行：国际化程度更低\n  - 保险公司\n  - 中央银行和主权基金\n    - 中投公司\n    - 中央银行不能在一级银行买入国债：避免货币政策成为财政政策的附庸\n    - 通过农业银行作为通道购买国债\n- 金融市场\n\n#### 六、金融危机后金融监管的变化\n\n- 2010: Dodd-Frank\n- 通过增进金融体系的责任和透明度终结太大不能倒\n- 保护纳税人、保护消费者不受欺诈\n\n\n\n## 第五章 市场组织与结构 \n\n### 第一节 一级市场 \n\n#### 一、公募方式 \n\n##### 1.证券发行的注册 \n\n- 首先由发行人提交注册说明书\n- 证交会的公司融资部负责审查注册说明书\n- 等待期：红鲱鱼（red herring）\n\n##### 2.415规则\n\n- 在1982年以前，每次发行证券都要经过上述程序，这对需要连续发行证券的发行人极为不利。因为当发行人根据当时的金融形势决定发行证券后，并不能立刻进行实际的发行。而等到发行最终实施时，金融市场可能已发生很大变化。\n- 1982年，SEC通过了415规则：\u003cu\u003e允许发行人在未来两年内一次或多次发行一定数量的某种证券。\u003c/u\u003e\n\n##### 3.持续报告要求\n\n- 公开发行证券的公司为报告公司，必须持续向SEC和市场提供财务报告。\n\n##### 4.投资银行的承销\n\n- 提供的服务包括发行条件的确定、协助注册登记等\n- 为发行人提供咨询，设计适合发行的证券或证券组合\n- 一般组成承销团承销证券以分散风险\n- 企业和承销团的路演\n- 公开发行：\n  - 包销（firm commitment）：由投资银行承担证券发行的全部风险\n  - 代销（best effort selling）：由投资银行代理发行证券，发行风险由发行人承担\n  - 备用包销（standby underwriting）：投资银行按照备用协议负责接收被拒绝购买的证券\n\n- 投资者担心赢者诅咒，可能不会在二级市场购买股票。 \n- 管理者可能希望股权结构更加分散。\n- 投资银行在二级市场维护股价，吸引没有信息的投资者介人。方法：\n  - 由承销团卖空(syndicate short)。就是说，牵头承销商预计分配给承销团成员的股份数可能大于实际分配的股份数。比如A投资银行预计分得200万股，并已经全部售出，但最终却只分得了180万股，形成卖空，它就必须在二级市场买入不足的20万股。在预期股票的需求较弱时，投资银行就会采取这种方法。 \n  - 绿鞋技术(green shoe technique)。由发行人给予承销商超额配售的权利，一般不超过发行数(正股数)的15%。最早采用这种方式的为绿鞋公司。如果二级市场股价偏低，承销商就从二级市场买入股票。如果二级市场股价正常，承销商则请求发行人追加股票发行，也可以综合利用两种方法。与承销团卖空相比，这种方法多了一种期权安排。 \n  - 二级市场购入。投资银行直接入市购买股票，稳定股价。这种方法在市场上非常少见。 \n  - 对一上市就抛出股票的投资者进行处罚，包括拒绝他们的下次参与，以及处罚把股票卖给他们的承销团成员。如果不能最终稳定股价，承销团再决定是否放弃。\n\n- 大型的投资银行有很好的声誉，其声誉就有利于在二级市场维护估价。较小的投资银行则没有这种优势。 \n  - 一般而言，大型投资银行倾向于采用\u003cu\u003e包销\u003c/u\u003e方式介入股票发行，小的投资银行倾向于采用\u003cu\u003e代销\u003c/u\u003e方式。\n\n#### 二、私募方式\n\n##### 1.私募与公募的差异\n\n- 美国的SEC在1982年的D条例， 规定免于注册的证券必须销售给有经验的投资者，如有能力评估风险、净资产达到100万美元等。 \n- 中国，界定是否私募的一般标准是投资者是否达到200人。这个市场一度非常混乱。 \n- 私募发行的成本较低，相应地，流动性也比较差。由于私募只针对少数投资者，因此其发行价格一般较低。 \n- 投资银行往往是私募证券的设计者，并为私募提供咨询甚至承销服务。 \n\n##### 2.144A规则\n\n- 证交会的144A规则取消了私募两年内不能自由买卖的限制。\n- 提高了私募证券的流动性，吸引了许多大机构投资者购买私募证券。\n- 由于私募的信息披露要求较低，也吸引了更多的外国发行者在美发行债券。 \n\n#### 三、发行价格的确定\n\n- 抑价指的是新股发行上市后，二级市场的首日交易价格常常会大于一级市场的发行价格。\n  - 衡量方法是\u003cu\u003e用新股上市第一天的收盘价减去发行价格再除以发行价格，结果称为初始回报或首日收益(initial return)。\u003c/u\u003e\n- 信息不对称：\n  - \u003cu\u003e发行人拥有比投资者更多的信息。\u003c/u\u003e为了向投资者传递关于股票质量的信息，高质量的公司可以将IPO的价格定低，将来公司按照较高的二级市场价格增发新股时，可以筹得更多的资金。 而低质量的公司由于很可能无法通过未来的二级市场增发收回IPO低定价所付出的成本，因此很难模仿高质量公司的这种做法。\n  - \u003cu\u003e投资银行(承销商)比发行人拥有更多的信息。\u003c/u\u003e由于监督投资银行是需要成本的，因此为了调动投资银行的发行积极性，发行人有必要容忍一定的抑价。 \n    - 问题：抑价本身对投资银行也是不利的，因为投资银行发行挣得的毛利差与发行定价直接相关。投资银行的这种损失，有可能从增加的佣金中获得补偿。抑价以后，投资银行会把更多的股票分配给自己的关系客户，后者会选择这家投资银行作为经纪人并可能支付更高的佣金。\n  - \u003cu\u003e投资者之间拥有的信息不对称。\u003c/u\u003e投资者可以分为有信息的投资者和无信息的投资者。有信息的投资者只申购定价低(于股票价值)的股票，从而得到较高的投资回报。无信息的投资者不了解IPO股票的实际价值，他们只能对所有IPO的股票进行申购。无信息的投资者投资IPO股票的回报率偏低。为了吸引无信息的的投资者，所以抑价发行。\n  - \u003cu\u003e机构投资者比投资银行拥有更多信息。\u003c/u\u003e在西方国家，新股发行多采用询价(book building)方法，较少采用拍卖法。 投资银行首先给出一个初始价格区间(initial range)，再通过路演收集潜在投资者的需求信息，最后确定发行价格。作为拥有信息的投资者，如果他们将真实信息告知投资银行，投资银行据此确定的发行价格将对他们不利。\n  - \u003cu\u003e发行公司决策者与其他股东之间信息不对称。\u003c/u\u003e委托代理关系中的利益冲突的角度进行分析，对于承销商的选择主要是由发行公司的管理层和创业投资公司(如果有的话)的一般合伙人做出的，而发行前就存在的其他股东(包括创业投资公司的有限合伙人和其他股东)则影响有限，这就存在利益冲突问题了。\n\n- 价格定低，目的是降低诉讼的可能性。 \n  - 如果新股价格较高，上市后一段时间价格下滑，很容易跌到发行价格以下。如果新股价格定得较低，上市价格就不容易跌到发行价格以下。\n  - 一级市场投资者获得的损失补偿为卖出价格或诉讼时的市场价格(如果还没有卖出)减去发行价格，二级市场投资者获得的损失补偿取决于买入价格和发行价格中较低的那个。所以，把发行价格定得较低，投资者要发起诉讼，获得的赔偿数量可能就较少。\n\n- 就已发行证券的新发售而言，新股权的发行往往会同时引起二级市场般价的下跌。\n  -  一个可能的原因是，公司管理层往往会选择股票价格偏高时发行股票，投资者对股票的评估因而会发生变化。\n\n#### 四、新的证券承销方式\n\n##### 1.大额承销\n\n- 大额承销是由投资银行与潜在发行人在很短的时间内迅速完成交易，然后再把这些证券分销给其他的投资银行和自己的客户，特别是那些机构投资者。 \n- 在415规则下，大额承销使得从发行人决定发行证券到实际发行证券的时间间隔大大缩短，相应地要求证券承销的及时性。 \n- 组建承销团的目的是分散风险。大额承销使整个投资银行的风险加大。于是，开展这种承销业务的投资银行需要利用衍生产品来降低风险。\n\n##### 2.拍卖法\n\n- 数量的确定。一般情况下，单个投资者愿意购买的数量比发行数量少得多，这样出价最好(报出收益率最低)的承销者可以首先成交，然后是出价次优的投资者。如此递延下去，直到全部债券数量出清。 这种拍卖方法的一个问题是，最后一个投资者的出价虽能被满足，但报出的数量不一定能满足。\n- 价格的确定。\n  - \u003cu\u003e单一价格拍卖\u003c/u\u003e(single-price auction)，此时，所有中标者统一支付最高的收益率。\n  - \u003cu\u003e多重价格拍卖\u003c/u\u003e(multiple-price auction)，中标人各自支付自己的投标价格，这在一定程度上对发行人有利，对投标人不利。\n\n#### 五、境外发行的原因\n\n\u003cu\u003e1.本国市场不发达\u003c/u\u003e\n\n\u003cu\u003e2.降低筹资成本\u003c/u\u003e\n\n\u003cu\u003e3.改变公司的资金来源结构\u003c/u\u003e\n\n\u003cu\u003e4.减少汇率风险\u003c/u\u003e\n\n### 第二节 二级市场\n\n#### 一、二级市场\n\n##### 1.二级市场的作用\n\n- \u003cu\u003e提供流动性。\u003c/u\u003e\n\n- \u003cu\u003e价格发现。\u003c/u\u003e由于存在大量的买者和大量的卖者，二级市场上的价格往往趋向于均衡价格。二级市场的价格，代表着市场对发行人资金运用行为的评价，使得发行者借此可以了解再次进入一级市场的成本。\n\n- \u003cu\u003e降低成本。\u003c/u\u003e对于投资者而言，发达的二级市场为其提供了统一的价格和充分竞争的市场，降低了其搜寻成本和交易成本。\n\n##### 2.连续型和叫卖型市场\n\n- \u003cu\u003e连续型市场\u003c/u\u003e的价格确定是随着买方和卖方的下单(submit orders)而连续进行的。下单者的买卖价格和数量决定了该时刻证券的价格。这样，证券的价格波动可能与总的供求状况无关。\n- \u003cu\u003e叫卖型市场\u003c/u\u003e上，证券的价格不是瞬时变化的，而是取决于集中撮合的次数。每次撮合时，集中起来的买卖委托按照同一价格同时得到执行，拍卖可以口头形式进行，也可通过书面形式。叫卖型市场制度可能会降低证券价格的波动性。 \n- 如果证券市场同时具有上述两种特征，则称为混合型市场。 \n\n#### 二、二级市场委托单的类别\n\n- 市价委托单\n- 限价委托单：买入：限价低于市价；卖出：限价高于市价\n- 停止委托单：买入：限价高于市价；卖出：限价低于市价\n- 限价停止委托单 \n- 指定价格委托单 \n\n#### 三、委托单的时间限制\n\n- 当日委托(day orders)是指委托必须在交易日的当天执行。如果到交易日结束时委托并未执行，则自动作废。 \n- 定时委托(time specific orders)是指只在交易的某个特定时间段(如开市、闭市)执行的命令。 \n- 开放式委托单(open order)，也叫撤销前有效委托单(good-till-canceled)，或GTC，在成交或被取消前一直有效，但需要投资者的定期确认(confirm)。 \n- 执行或取消委托单(fill-or-kill orders)，或称FOK，要么立刻被执行，要么立刻作废。 \n\n#### 四、委托单的数量\n\n- 投资者可以以整数、零数或整零混合的方式交易。 \n\n#### 五、保证金交易\n\n1.初始保证金要求 \n\n2.实际保证金 \n\n3.维持保证金要求 \n\n#### 六、卖空 \n\n##### 1.卖空的操作\n\n- \u003cu\u003e证券的卖空交易数量占近期总交易量平均值\u003c/u\u003e的比率称为卖空比率。 \n\n##### 2.卖空的作用与管理\n\n- 卖空机制使得金融资产的价格能够更充分地反映市场参与者的判断，提高\u003cu\u003e价格发现功能。\u003c/u\u003e \n  - 由于卖空受到制度限制，当交易者观点不同时，悲观者可能不会选择卖空。于是，股票价格还是会只反映最乐观投资者的判断。所以，当金融资产价格偏离价值时，卖空机制只可以在一定程度上校正泡沫现象。\n  - \u003cu\u003e升幅交易\u003c/u\u003e（uptick trade）\n    - 中国：融券卖出的申报价格不得低于该证券的最新成交价；当天没有成交的，申报价格不得低于前收盘价。（升幅交易）\n  - \u003cu\u003e零涨幅交易\u003c/u\u003e（zero plus uptick）\n    - 2007年美国取消了升幅交易和零涨幅交易的规则\n- 卖空为什么不能校正泡沫：一致行动风险\n\n##### 3.卖空行为的保证金要求\n\n- 保证金比例=保证金/（融券卖出数量×融券卖出价格）\n\n#### 七、证券交易所的会员及其作用 \n\n##### 1.佣金经纪人\n\n- 佣金经纪人(commission brokers)负责为投资者办理代理买卖证券的业务，并借此收取一定的佣金。 \n\n##### 2.场内经纪人\n\n- 当佣金经纪人在交易指令蜂拥而入难以及时处理的时候，场内经纪人(floor brokers)将为其分担一部分工作量，并相应地分享一部分佣金。 \n\n##### 3.场内自营商\n\n- 稳定价格\n  - 交易商可以看作是交易的即时性(immediacy)，即迅速完成交易的能力的提供者。 \n- 提供更好的价格信息。 \n  - 自营商比普通投资者拥有更多的市场指令信息，其买卖活动也就是传递这些信息的过程。\n\n##### 4.专营商\n\n- 负责不能立即执行的限价交易委托、止损和限价止损交易委托，把这些指令存入自己的专营商(specialist)簿中保存，待将来执行时分享一部分佣金。\n- 作为自营商专门负责维持一只或几只股票的供求平衡。 \n\n#### 八、市场效率\n\n##### 1.运行效率\n\n- 衡量的是资本市场上投资者支付的交易成本的大小。 \n- 显性交易成本。\n  - \u003cu\u003e佣金\u003c/u\u003e和交易商的买卖价差(bid ask spread)。\n    - soft dollars：经纪人可能会向投资者免费提供研究报告等服务。\n  - \u003cu\u003e手续费\u003c/u\u003e。是指为保管投资者的证券和过户等所收取的费用等。\n  - \u003cu\u003e税收\u003c/u\u003e。\n\n- 隐性成本\n  - \u003cu\u003e执行成本\u003c/u\u003e：证券买卖委托执行与否一般会使证券价格发生一定的变化。\n    - 改变了市场的供求情况。\n\n##### 2.定价效率\n\n- 指资本市场上证券价格反映所有相关信息的能力。\n  - 有效率的市场上，相关信息能够迅速反映在证券价值上，证券价值等于投资价值。\n\n### 第三节 中国的发行与交易市场\n\n#### 一、证券发行的审批与核准\n\n- 审批制：\n  - 一是使得上市公司普遍偏小因为各地方政府在获得固定额度后，为了使更多的企业发行上市，会把额度分给尽可能多的企业。 \n  - 二是许多企业的股本往往先缩后增。由于法规规定社会公众股不得低于拟发行股本总额的25%，这样，一家企业要想成为上市公司，其总股本至多只能是其所获得发行额度的4倍。因而，虽然特大企业难以上市，但如果企业稍大一些，则必须尽量缩股。\n- 1997年，“总量控制，限报家数”。采用这样的做法后，各地上市公司家数受到控制，地方政府与上市公司为了多等集资金，尽量扩大公司股本规模，市场上大盘股的数量逐渐增多。  \n  - 在审批制下，股票的发行数量由政府决定，其供给曲线是垂直的，而股票价格取决于供求曲线的交点。所以，当需求曲线移动时，为保持价格基本稳定，政府不得不随时调整供给曲线。\n- 在核准制下，股票不再由行政部门负责推荐，股票发行审核委员会独立负责审核，看其是否符合《公司法》和《证券法》等规定的条件。\n  - 审批制：行政部门审批；核准制：发行审核委员会审核\n- 券商的通道制：\n  - 拥有主承销业务资格的券商，按照其规模实力大小不同，获得数量不同的推荐企业发行上市的通道。\n  - 券商每推荐家企业发行上市，就要占用一个通道。只有当这家企业被核准发行上市，空出通道后，券商才能推荐另一家企业发行上市。\n  - 目的在于，促使券商重视承销公司的质量，加快通道周转速度，推荐更多质量好的公司。\n- 2004年2月起，中国股票市场开始实行保荐人制度，让券商和责任人对其承销发行的股票，负有一定的持续性连带担保责任。\n  - 由于保荐制度和通道制的目的是相同的，2005年1月1日，通道制被废止。 \n  - 美国没有保荐制度：声誉资本来约束已经足够了\n\n#### 二、中国的股票发行方式(投资人选择)\n\n##### 1.认购表抽签 \n\n##### 2.存单抽签\n\n- 类似权证\n- 一级半市场：买卖中签号码\n\n##### 3.上网发行\n\n- 分网上定价发行和网上竞价发行。 \n\n##### 4.网下发行与网上发行\n\n#### 三、新股发行价格的确定\n\n#### 四、二级市场的组织\n\n##### 1.竞价交易方式\n\n- 价格优先、时间优先的顺序原则执行。\n\n- 集合竞价是指由计算机交易系统对所有有效的买进卖出委托按上述优先原则进行排序。对买进委托，排列顺序由高到低。卖出委托则相反，是由低到高。系统将自动确定一个能使成交量最大的交易价格，并以此形成开盘价。\n\n- 连续竞价是指开盘以后，对于每一个新的委托，比如一个新的买人委托，如果其限价大于等于卖出委托排列的最低价格，则可以按顺序与卖出委托成交，成交价格为卖方叫价。如果限价小于卖出委托的最低价格，则无法成交。 \n\n##### 2.成交与不成交\n\n##### 3.证券的清算、交割与过户\n\n- 清算是证券交易成交之后，交易有关各方计算应收应付证券与资金净额的程序。\n- 交割是指证券买卖双方价款与证券的转移。它包括投资者与券商的交割和券商之间的交割两个方面。交割与清算是一个共同的过程，因为它必须依赖清算的结果。\n\n## 第九章 股权市场\n\n### 第一节 普通股股票市场 \n\n公司为什么要上市？\n\n- 公司有投资机会，所以发行新股筹资\n  - 募集资金投向变更\n- IPO会导致公司价值的提升\n  - 股权分散后悔使得投资者对公司股价高估，对企业家（创业者）更有利\n  - 公司上市后会受到更多的外部监督，这会提高公司的价值\n  - 流动性提高，公司股票的价值也会提高\n- 改善公司治理\n- 风险投资的退出\n- 做大做强\n- 吸引眼球\n- 缺点：信息披露\n\n#### 一、二级市场 \n\n##### 1.股票交易所\n\n- 股票交易所属于有组织的交易场所，由SEC审批，并接受SEC的监管。它拥有多家会员。只有会员才可以利用交易所的设备交易股票。非会员则只能依靠会员代理交易。\n\n##### 2.场外交易市场\n\n- 在场外市场，由于没有集中的交易场所，不能实行公开竞价，所以必须有做市商制度，以保证价格的公平和交易的效率。\n- 在场内市场交易的股票，称为上市(listed)股票。在场外市场交易的股票，称为未上市(unlisted)股票。 \n\n##### 3.第三市场\n\n- 指的是在证券交易所之外交易上市股票的市场。\n- 当年，由于交易所要求其会员实行固定佣金制度，所以，为逃避固定最低佣金的规定，第三市场(third market)发展了起来。\n\n##### 4.第四市场\n\n- 投资者\u003cu\u003e不通过经纪人而直接进行交易\u003c/u\u003e的市场称为第四市场(fourth market)。这一市场也是因固定佣金制度而产生的。目前，计算机系统极大地促进了这一市场的发展。 \n\n##### 5.场内与场外交易商的比较\n\n- 在场内市场，大量的交易委批集中于一起撮合成交，有利于形成更好的价格。\n- 场外市场有多个报价，成交价是最好的报价。在场内市场，只有一种报价，但成交价一般在专营商报价之内。而且，在场内市场，专营商并非绝对处于垄断地位。\n\n#### 二、股权市场结构\n\n- 分割的市场可能无法有效地实现价格发现功能。这意味着投资者不能得到最有利的价格。 \n\n#### 三、大宗交易与程序交易\n\n##### 1.大宗交易\n\n- 大宗交易(block trades)指的是交易大量的同种股票 \n\n##### 2.程序交易\n\n- 程序交易(program trades)指的是\u003cu\u003e机构投资者同时买卖大量的不同种类的股票\u003c/u\u003e。NYSE的定义是购买或出售至少15种股票，或者总价值达到100万美元的一揽子交易。 机构投资者可能因为调整投资组合，或进行指数化投资等原因而进行程序交易。\n\n#### 四、股票市场指标\n\n##### 1.按照指数编制方法的不同对指标进行分类\n\n- 样本股票\n- 相对权重\n- 平均方法\n\n##### 2.按编制者的不同对指标进行分类\n\n- 由交易所编制，以所内全部股票为基础的指标。如NYSE综合指数、 NASDAQ综合指数就属于这一类。\n- 由一些机构主观地选择一些股票而编制的指标。比如道・琼斯工业平均数( Dow Jones Industrial Average，DJIA)、S\u0026P500指数、价值线综合平均数(VLCA)等。\n- 由一些机构按照客观的标准选择一些股票而编制的指标。比如威尔士指数\n\n##### 3.广义股票价格指数与狭义股票价格指数？\n\n- 广义股票价格指数：\n  - 股票价格平均数：在平均股票价格的基础上，对一些不可比因素进行修正后形成的股票价格指标\n  - 狭义股票价格指数：根据不同时期股票价格平均数对比所得的动态相对数，报告期股价平均数与基期股价平均数的比值，基期指数一般取100、50、10或1000点\n- 拆股：新除数=旧除数×计入调整事项的新股价之和/不计入调整事项的旧股价之和\n\n##### 4.几种著名的股价指数\n\n$$\nDJIA=\\sum_{i=1}^{30}\\frac{p_i}{D}\n$$\n\n$$\nNYSE=\\frac{\\sum_{i=1}^nN_iP_i}{OV}\\times50\n$$\n\n#### 五、定价效率的检验\n\n检验市场是否有定价效率，也就是检验市场能否产生异常收益\n\n##### 1.弱有效的检验\n\n- 历史上的价格波动无法预测未来。\n\n##### 2.半强有效的检验\n\n- \u003cu\u003e小公司效应\u003c/u\u003e。一些研究发现，投资于市值较小的公司的投资组合的业绩要超过整体市场的表现。 \n- \u003cu\u003e低市盈率效应\u003c/u\u003e。有的研究发现，由市盈率比较低(low price-earnings ratio)的股票组成的投资组合与高市盈率的股票组成的投资组合相比，前者的表现要强于后者。 \n- \u003cu\u003e被忽视公司效应\u003c/u\u003e。有研究发现，投资于受证券分析师关注的公司的股票，其业绩要劣于投资于不受关注的股票。因而，根据证券投资分析师是否关注来进行投资能获得异常收益。 \n- \u003cu\u003e日历效应\u003c/u\u003e。在特定的时间执行投资战略可能会获得异常收益。比如，在一月、节日、一年中的某一月或者一星期中的某一天等。此外，定价无效率还可能表现为证券的定价是非理性的。市场作为整体可能被非理性地错误定价。\n\n##### 3.强有效的检验\n\n- 有的研究分析了内幕人士(insiders)的活动，发现他们的投资业绩一般会强于大市。\n\n#### 六、普通股投资的方法\n\n### 第二节 中国的股权市场\n\n#### 一、B股市场\n\n- 以人民币标明面值，以外币认购交易，在境内上市\n- 市场分割，境外投资者投资理念不同，上市公司往往缺乏投资价值\n\n#### 二、H股与红筹股市场\n\n- 对中国具有重要的意义。\n  - \u003cu\u003e有利于改善香港的上市公司结构\u003c/u\u003e。H股和红筹股多为工业及综合类上市公司，这对香港的产业结构调整意义深远。\n  - \u003cu\u003e有利于维护香港的国际金融中心地位\u003c/u\u003e。红筹股和H股的上市，使得大量的资金经由香港联交所投向上市公司。在一部分外资撤走的同时，香港仍能成为重要的金融交易中心。这有利于香港经济的繁荣和稳定。\n  - \u003cu\u003e可以为内地筹集资金\u003c/u\u003e。\n\n#### 三、国家股、法人股、社会公众股\n\n##### 1.股权市场分割的原因\n\n- 国家、法人和社会公众持股在任何股市都是正常的。说中国股权分割的特性明显是因为这些股份同股不同权，\u003cu\u003e国家股不可以上市流通，法人股可以在法人之间协议转让。\u003c/u\u003e\n- \u003cu\u003e意识形态考虑\u003c/u\u003e：政府强调国家必须对股份制企业拥有控制\n- \u003cu\u003e股市承受力的考虑\u003c/u\u003e：当时人们担心，如果允许公有股上市流通，过量的供给会使股市很难承受。\n- \u003cu\u003e额度管理\u003c/u\u003e：由于部门都想把尽可能多的企业推向股票市场，于是，每家企业的社会公众股的占比就偏低。\n\n##### 2.国家股、法人股的来源与变化\n\n##### 3.国家股、法人股不能上市对二级市场的影响\n\n- \u003cu\u003e二级市场并购难\u003c/u\u003e。由于可流通股部分只占上市公司总股份的30%，因此在二级市场开展并购活动几乎不可能。 \n- \u003cu\u003e股市回报率低\u003c/u\u003e。只有一部分股票流通时，由于公司是按面值分红的，所以，虽然国家股、法人股股东分红比率不低，但是多倍溢价的社会公众股股东的分红就显得少而又少。 \n- \u003cu\u003e投机严重\u003c/u\u003e。由于只有30%的可流通股，所以，有效的公司治理结构很难建立，投资者永远也无法对企业的行为进行约束，使之趋于合理。社会公众股东只有用脚投票的机会，而缺乏用手投票的殊荣。所以，二级市场只能是一个投机市。加上在不可能依靠分红获得回报的情况下，投资者只能寄希望于资本增值。\n\n#### 四、中国的政策市问题\n\n- 中国股市经常大起大落，其波动与经济形势基本无关。就是说，多数情况下，这种波动既与宏观经济的总体趋势无关，也与上市公司的总体业绩无关。除政策市问题外，另一个原因则是投机过度。当然，许多时候，政策的干预也是在投机过度的情况下不得已而采取的措施。\n\n#### 五、中国上市公司的舞弊问题\n\n- \u003cu\u003e法治不健全。\u003c/u\u003e\n- \u003cu\u003e上市公司有为获得IPO、配股权利以及避免被ST而舞弊的动机。\u003c/u\u003e\n- \u003cu\u003e上市公司参与舞弊，往往还与大股东的行为有关。\u003c/u\u003e国有股东一股独大。\n\n#### 六、中国概念股风波\n\n### 第三节 二板市场与做市商制度\n\n#### 一、海外的二板市场\n\n- 二板是相对于主板(main board)而言的。\n- 许多国家是在交易所内设立一个上市标准较低的新的交易板块，称为二板市场。\n- 也有的国家是在交易所之外另外设立二板市场。\n- 美国的成功可能有几个原因：\n  - \u003cu\u003e上市费用低， NASDAQ市场比NYSE的上市费用低很多。\u003c/u\u003e\n  - \u003cu\u003e交易系统先进\u003c/u\u003e， NASDAQ投入大量资金用于交易系统建设与改进。\n  - 高科技企业的成功。\n- 欧洲的失败可能有多个原因：\n  - 许多企业在二板上市后就转向了主板市场，使二板市场空壳化。 \n  - 主板市场与二板市场的差异相对较小，使二板市场与主板市场相比的竞争力不足。\n\n#### 二、二板市场的价格形成机制\n\n- 证券市场的价格形成机制主要有两种方式\n  - 做市商(market maker)制度\n    - 在证券的二级市场上，有一些实力较强、有良好信誉的交易商连续不断地为每一种证券提供双向报价，并根据报价用自己的资金与投资者成交。通过这种方式，做市商既使证券市场增加了流动性，又可以为自己挣得证券买卖的价差。\n    - \u003cu\u003e稳定价格。提供更准确的价格信息。\u003c/u\u003e\n  - 竞价(auction)交易制度\n    - 竞价制度则是将买卖双方的委托都交给经纪人，由经纪人传输到市场上，再由市场对双方的买卖委托进行撮合成交。\n\n#### 三、 NASDAQ市场的价格形成机制\n\n##### 1.起源与发展\n\n##### 2.做市商及其种类\n\n- 批发商。这类做市商往往为3000只以上的股票做市。\n- 批零兼营的公司。这类做市商做市的股票一般为500-1000只。\n- 机构经纪商。这类做市商主要为机构投资者服务，做市的股票一般低于500只。机构投资者的多数委托不要求立即执行，以追求较低的交易成本。\n- 地区性经纪公司。这类做市商规模较小，不属于华尔街，往往为支持承销和零售而做市。\n- 非挂牌交易特权做市商。在芝加哥证券交易所，专营商以这种方式为在 NASDAQ上市的股票做市。\n\n##### 3.做市商的报价规则\n\n- 固定报价。在这种报价方式下，做市商必须保证按照报出的价格与下单的投资者成交。\n- 协商报价。这种报价没有做市商的承诺，在与投资者协商后，交易才能正式达成。 \n- 询价报价。做市商对于交易活跃的股票或者大宗交易，要征求其他做市商或持有人的意见。\n\n##### 4.做市商的价格操纵行为\n\n- 在报价时相互协调，做市商为了与客户成交，会要求其他做市商调整报价。如果有做市商拒绝合作，其他做市商就会联合起来，拒绝与之交易。做市商内部称合作的做市商为友好竟争者。\n- 不及时准确地公布交易信息。这样做的目的是利用信息为自己谋利。同时，客户也无法知道自己成交的价格是否为最优价格。\n- 拒绝报价承诺。\n- 政策：\n  - \u003cu\u003e要求做市商在市场上报出最好的委托价格。\u003c/u\u003e\n  - \u003cu\u003e取消交易商内部市场与公开市场的价差。\u003c/u\u003e\n\n#### 四、做市商制度与竞价交易制度的比较\n\n##### 1.流动性方面\n\n##### 2.投资者的交易成本\n\n- 在做市商市场上，投资者要向做市商支付买卖价差。做市商收取的买卖价差也可以看作是为证券市场服务所收取的价格。\n  - \u003cu\u003e做市商进行交易的成本\u003c/u\u003e，如设备成本、管理与操作费用等。\n  - \u003cu\u003e风险补贴\u003c/u\u003e\n    - 证券价格波动的风险\n    - 由于市场的厚度(交易量的大小)决定的平仓的顺利程度的风险。\n\n##### 3.透明度与内部操纵\n\n- \u003cu\u003e做市商拥有比投资者更多的市场交易信息\u003c/u\u003e\n- 做市商可以合法地在中长期内持有股票，如果他们合谋勾结，就有可能形成对市场的操纵。在竞价市场上，因为交易前的委托和交易后的报告信息都可以迅速传递，市场的透明度较高。\n\n##### 4.价格稳定性\n\n- 竞价市场上透明度较高，有利于信息迅速地传递并反映到价格上，使价格反映投资价值。相对来讲较不容易出现价格大幅度偏离价值的情况。而且， 由于价格确定是连续进行的，因此，价格上升和下降都会比较平稳地进行。\n- 在做市商市场上，由于做市商在平抑价格波动，因此，当价格背离价值累积到一定程度后，有可能出现价格更迅速的上升和下降。这种突然的、大幅度的波动容易引起市场进一步的迅速波动。\n\n#### 五、多家做市商制度与一家专营商制度的比较\n\n- \u003cu\u003e流动性\u003c/u\u003e：多家做市商流动性强\n- \u003cu\u003e价格稳定性\u003c/u\u003e：专营商负有维持股票价格稳定的义务，市场价格更稳定\n- \u003cu\u003e垄断与交易成本\u003c/u\u003e：专营商垄断内幕信息\n- \u003cu\u003e价格与速度\u003c/u\u003e\n  - NASDAQ是交易商市场，交易商会提供即时性，所以委托可以得到更快的执行。与分散的做市商制度不同，NYSE实行竞价制度，专营商可以为投资者实现更好的交易价格，但是需要更长的时间。\n\n## 第十章货币市场\n\n### 第一节 美国的货币市场\n\n#### 一、国库券市场\n\n- \u003cu\u003e为了应付财政先支后收的短期资金需要\u003c/u\u003e\n- \u003cu\u003e在需要长期资金时，为了等待更有利的筹集资金的时机\u003c/u\u003e\n- \u003cu\u003e出于中央银行公开市场操作的考虑。\u003c/u\u003e \n\n##### 1.买卖报价\n\n按收益率报价\n$$\ni_{db}=\\frac{F-P_d}{F}\\times\\frac{360}{t}\n$$\n$i_{db}$：国库券的收益率\n\n$F$：面值\n\n$P_d$：国库券的美元价格\n\n$t$：到期期限\n\n##### 2.国库券的拍卖市场\n\n- 国库券的拍卖既可以采用竞争性报价方式，由投资者报出收益率和认购数量，也可以采取非竞争性报价方式，投资者不报出收益率，只报出认购数量。前者一般适用于机构投资者，后者一般适合小额投资人。所以前者占比大而后者占比小。 \n\n#### 二、商业票据\n\n- 商业票据(commercial paper)是公司在公开市场发行的短期无担保本票\n\n##### 1.商业票据的发行者与投资者\n\n- 信用担保支持的商业票据\n- 原来只有大公司能发，结果现在中等公司也能参与发行，原因：银行在面对商业票据等金融工具对其负债业务的竞争时，变被动为主动，开展中间业务挣得收入的重要方式。以这种方式发行的商业票据称为LOC票据。另一种是资产担保支持的商业票据。它以一揽子应收账款作抵押，来发行商业票据。\n- 原因：\n  - \u003cu\u003e因为一些短期的资金需求\u003c/u\u003e\n  - \u003cu\u003e出于桥式融资(bridge financing)的考虑\u003c/u\u003e\n\n##### 2.一级市场与二级市场\n\n- 商业票据按发行方式的不同可分为两种：\n  - 直接发行票据(direct paper)，这是由发行公司直接卖给投资者的票据。采用这种方式的公司多为金融公司。对这些公司而言，商业票据是重要的资金来源，需要经常发行，因而直接发行的成本较低。\n  - 交易商票据(dealer-placed paper)，即不是由公司直接发行，而是由交易商代销(best efforts)。\n- 影响：\n  - \u003cu\u003e影响银行资金来源，因为在投资者看来，商业票据是银行存款的重要替代品。\u003c/u\u003e\n  - \u003cu\u003e影响资金运用，因为在发行公司看来，商业票据是银行贷款的替代品。\u003c/u\u003e\n\n##### 3.商业票据的期限与收益\n\n- 商业票据的额度较大。最低交易额一般为10万美元。\n- 商业票据的期限最短为3天，最长一般少于270天，多数为30-50天。\n- 商业票据的收益一般高于同期限的国库券。这是因为：\n  - \u003cu\u003e商业票据有违约风险\u003c/u\u003e，而国库券是无风险债券，所以商业票据要有风险补贴。\n  - \u003cu\u003e国库券有免税的优点\u003c/u\u003e，即免征州和地方政府所得税。为使税后利率一致，商业票据的利率也要高些。\n  - 流动性原因，如前所述，商业票据的流动性较差。 \n\n##### 4.违约风险与信用评级\n\n- 投资级和非投资级\n\n##### 5.非美国商业票据市场\n\n#### 三、银行承兑汇票\n\n- 在国际贸易中，进口商与出口商的交易活动，创造了银行承兑票据。银行承诺进口商的货款一定支付。此时，一般会伴随融资活动，称为承兑融资。 \n\n#### 四、大额可转让存单\n\n##### 1.存单的发行者与投资者\n\n- 本国银行发行的存单。\n- 在美国之外发行的以美元标值的存单，称为欧洲美元存单(Eurodollar CDS)，由美、日、加等国主要在伦教发行。\n- 外国银行的美国分支机构发行的以美元标值的存单，称为扬基存单。\n- 储蓄银行和储蓄贷款协会发行的储蓄存单。\n- 存单的期限多数短于1年。超过1年的称为定期存单\n\n##### 2.存单的收益\n\n- 信用风险稍高和流动性稍差，所以存单的利率要高一些。\n\n#### 五、回购协议\n\n- 回购协议(repurchase agreements)是一种证券购买协议，协议中同时规定卖方将在未来特定时间以特定价格将证券买回。这种协议实际上是一种以证券为抵押的贷款\n\n##### 1.回购利率\n\n- 不同回购协议的利率是不同的，这主要取决于：\n  - \u003cu\u003e抵押品的质量\u003c/u\u003e。高质量的抵押品利率低。 \n  - \u003cu\u003e回购期限\u003c/u\u003e。不同期限的债券回购利率一般不同\n  - \u003cu\u003e交割要求\u003c/u\u003e。交割的交易成本越高，利率越低。 \n  - \u003cu\u003e抵押品的易得性\u003c/u\u003e。难以获得的抵押品对买方有一定的吸引力，所以买方可以要求一个较低的利率。 \n\n##### 2.信用风险\n\n- 为了保证买方利益，现在，回购协议的贷款额一般小于抵押品价值，两者的差额就是保证金(margin)。在回购期间，要定期钉住证券市场。如果市价下跌，那么，要么由卖方追加保证金，要么是给回购协议重新定价，即卖方将部分资金退还买方。 \n\n##### 3.市场主体\n\n- \u003cu\u003eMMMF、市政机构等部门\u003c/u\u003e一般通过回购协议进行投资，\u003cu\u003e商业银行和储蓄银行\u003c/u\u003e则往往通过回购协议筹集资金。\n- 许多交易商不仅利用回购市场(repo market)为其头寸融资，而且同时\u003cu\u003e进行相同期限的回购和逆回购\u003c/u\u003e，以赚取两者之间的利差。 \n\n#### 六、通知贷款\n\n- 通知贷款是一种短期放款，借贷双方都有权提前一天通知对方结束贷款。这种贷款由银行提供给证券的经纪人或交易商。贷款要求证券作为抵押。保证金账户上的证券经常充当这种抵押。 \n\n#### 七、联邦基金市场\n\n- 银行同业间拆出拆入准备的市场即为联邦基金市场。\n- 联邦基金利率与回购协议利率密切相关，因为他们同是商业银行筹集资金的方式。 \n- 一般而言，回购利率较联邦基金利率低。这主要是因为有无担保的差异。 \n\n### 第二节 中国的货币市场 \n\n#### 一、货币市场的发育状况\n\n#### 二、同业拆借市场\n\n- 这一同业拆借市场有两级网络\n  - 一级网络的参加者为商业银行的总行和来自35个城市的35家融资中心。\n  - 二级网络则是在这35家融资中心内，由各家商业银行的分行以及其他非银行金融机构在本地进行交易。\n  - 最初几个月，拆借市场的利率有一个最高限额。当年6月，利率最高限被取消。同业拆借利率可以看作实行了完全的市场化\n- Shibor和过去的 Chibor有明显的不同。\n  - 从形成方式看， Chibor是实盘交易形成的利率，而 Shibor是报价行报出的利率。\n  - 过去，实际上由于市场主体的参与意愿较弱，拆借市场流动性弱，交易规模小，相应的波动幅度也较大，而且容易受到操纵。\n  -  Shibor由交易活跃的银行参与报价，报价期限从隔夜到1年共16个，每天准时报价，为市场提供一个统一、完整和有效的短期利率曲线。\n\n#### 三、债券回购市场\n\n- 回购主要是国债回购。回购既可以在机构间进行，也可以在中央银行与金融机构间进行。\n- 我国的国债回购最早出现在1991年，是由中国证券市场研究设计中心(联办)所建立STAQ系统开办的。\n- 推出国债回购的目的，是提高国债的流动性，便利国债的发行。 \n- 买断式回购与封闭式回购：\n  - 现有的国债封闭式回购实际上是一种质押式回购，回购成交后，相应国债所有权并没有发生转移，因此，封闭式回购仅具有融资功能。\n  - 相对而言，国债买断式回购是一种“实券过户”的交易，回购成交后，相应国债从融资方账户过户至融券方账户，融券方在回购期间拥有相应国债的所有权和使用权，因此，买断式回购不仅是一种融资的工具，同时也可以作为融券的工具。\n  - 此外，封闭式回购实行“标准券”质押制度，买断式回购的标的券种为指定的单只国债。\n  - 买断式回购利率反而比封闭式回购利率高\n  - 大银行质押式融出资金，中小银行质押式融入，买断式融出\n\n#### 四、票据市场\n\n- 中国票据市场中的金融工具主要是银行承兑汇票。商业票据和本票都比较少。\n- 中国的商业票据主要是企业、商业银行和中央银行参与，比较单调，资金只有这样一条线，而且只有以商品交易为基础的票据。\n\n\n\n## 第十一章 财政证券市场\n\n### 第一节 西方国家的财政证券市场\n\n- 2/3为个人或私人机构，机构主要是商业银行等金融机构。地方政府与外国投资者也是重要的持有人。\n- 约有1/3的财政证券由联邦政府机构和联邦储备体系持有，这一点被许多人认为是不正常的。 \n\n#### 一、美国财政证券的类型\n\n- 贴现证券\n- 付息证券\n- 可交易证券在到期前可以被多次交易。它包括国库券、财政票据和财政债券。\n- 不可交易证券包括以下几类：\n  - 一类是由财政部对各种政府机构和信托基金发行的政府账户系列债券。当这些机构资金充裕时，就借款给财政部，以减少公开市场上的财政借款。\n  - 二是出售给公众的储蓄债券(savings bonds)。\n  - 三是对外国投资者和政府发行的非交易美元证券和以外币标值的证券(外国投资者持有的债券也包括可交易证券，因为在美国之外的伦敦、东京等地也有比较发达的美国国债二级市场)。\n  - 四是对州和地方政府发行的特种国债，这可以为后者筹集的资金提供一个短期投资渠道。 \n\n#### 二、美国财政证券的一级市场\n\n- 国债发行量巨大，所以必须定期分批拍卖，让市场消化。\n- 投标者包括竞争性投标者和非竞争性投标者。\n  - 竞争性投标者包括货币中心银行和证券公司等，大约占每次拍卖数的75%-85%。\n  - 非竞争性投标者主要是小的金融机构和个人。\n- 中央银行一般不在一级市场购买国债。因为这可能会影响到中央银行的独立性，使货币政策成为财政政策的附庸。\n- 在拍卖市场上，必须防止一级自营商垄断市场。\n- 财政部对拍卖市场进行了改革，允许非一级自营商在不缴纳保证金的情况下替客户投标，允许小交易商进行投标(投标者越多，勾结的可能性越小)，推动投标由书面投标向自动化投标转变等。\n- 公开拍卖与密封拍卖比较\n  - 公开拍卖更容易使投资者之间进行勾结。因为在公开拍卖中，投标者在共谋后，能够比较容易地监督对方的背叛行为。而在密封拍卖时，即使投标者达成了协议，也很容易出现背叛行为，所以就不容易出现共谋。\n  - 传统上，美国财政证券的拍卖多数采用多重价格拍卖方式，而且是密封进行的，称为第一价格密封拍卖(first-price sealed auction)方式。\n  - 多重价格拍卖\n    - 有利：发行者的发行收入，也使投标者之间有充分的竞争，\n    - 不利：\n      - 投标者如果出价偏低，就不大可能中标。如果出价偏高，虽然中标的概率较高，但也可能面临债券转手的损失，形成“赢者的损失”。\n      - 投标人不会愿意向财政部暴露自己的判断。\n      - 保密的方式使得交易商容易大量投标垄断市场。\n  - 单一价格拍卖\n    - 有利：不存在赢家的损失问题。投标者更有积极性。大量投标人的参加(需求增加)可能会提高发行价格。\n    - 不利：这种方法又使得财政部必须对所有中标者支付相同的最低价格。\n  - 增加价格拍卖(ascending price auction)：由财政部报出多个价格，投标者报出在每一个价格下的投标数量，寻找能使全部证券售出的价格，并以此价格发行。这种方式不再使用密封投标，交易者可以知道其他交易商的信息。其缺点是在多个价格下投标的交易成本较高。\n  - 招标：\n    - 缴款期招标。此时，国债发行的票面利率和发行价格都已确定。承销机构的中标与否取决于其缴款的时间顺序。\n    - 价格招标。在附息国债中，如果投标价格高于面值，就是国债的收益率低于票面利率；如果投标价格低于面值，就是国债的收益率高于票面利率；如果投标价格等于面值， 就是国债的收益率等于票面利率。\n    - 收益率招标。在进行价格或收益率招标的情况下，票面利率可能事先确定，但般是用所有中标收益率的加权平均来计算票面利率。\n\n#### 三、美国财政证券的二级市场\n\n##### 1.二级市场的流动性\n\n- 二级市场主要存在于场外。原因：\n  - 一是债券特别是财政债券的价格波动较小，投机性较弱，不一定需要交易所的价格发现。\n  - 二是债券主要由机构投资者持有。如果在交易所集中竞价，容易因为大宗交易影响价格。\n  - 三是债券的种类较多，发行条件各不相同，经常会有上市、下市的情况，业务处理较为复杂，在交易所交易的成本比较高。这类批发业务比较适合采用一对一的询价方式。\n\n##### 2.报价方式\n\n##### 3.交易中的利息补偿\n\n##### 4.市场的交易方式\n\n- 国债经纪商既可以代客买卖，也可以为自己的账户买卖。\n- 财政证券交易商持有的证券头寸往往是其资本的几十倍，因而其资产组合95%以上由短期贷款支持。这些短期贷款包括银行的通知放款与回购协议。\n\n#### 四、分拆的财政证券\n\n#### 五、联邦机构证券\n\n##### 1. 政府资助的企业证券\n\n- 政府资助的企业(CSEs)是由国会创建、公众经营但是由私人拥有的实体，目的是为某些特定部门的融资提供便利。\n- 对这些部门，如农场主、家庭住房所有者和学生等，政府有支持的义务。但是政府如果直接支持，则既不公平，又不一定有效率。\n- 例子：房利美和房地美\n\n##### 2.联邦有关机构证券市场\n\n- 联邦有关机构是政府的助手，如政府国民抵押协会、美国进出口银行、小企业管理局、海上管理局。\n\n- 联邦机构证券也是在场外交易的，往往是由国债交易商交易，其流动性比较差，所以买卖差价也比较大。\n\n#### 六、其他西方国家的政府证券市场\n\n- 有些国家的证券并不仅仅支付固定收益率。考虑到通货膨胀的因素，许多国家发行的一些政府债券收益率与物价指数挂钩。\n- 英国使用的主要是特别拍卖系统(ad hoc auction system)，即不是定期拍卖，而是在市场条件有利时再拍卖。这种方法比较灵活，而且不会引起市场的定期波动。\n- 还有随卖(tap system)方式，是政府对已发行证券的追加发行。 \n- 主权债务(sovereign debt)是一国中央政府的债务。S\u0026P、穆迪和惠誉都对主权债务进行评级。\n  - 评级分为两种：本币债务评级( local currency debt rating)与外币债务评级(foreign currency debt rating)。\n  - 之所以做这种划分，是因为二者的违约风险是不一样的。对于本币债务，政府可以通过调整货币政策和财政政策偿还，而外币债务需要用外汇偿还。\n\n### 第二节中国的国债市场\n\n- 1994年起国债发行数量迅速增长的原因，主要是财政赤字不能再向中央银行融资，而必须通过发行国债的方式弥补。\n- 1996年以后，启动经济的需要成为更重要的原因\n- 立法机关不具体限定中央政府当年国债发行额度，而是通过限定一个年末不得突破的国债余额上限来达到科学管理国债规模的方式。\n\n#### 一、中国国债市场的主要特征\n\n##### 1.中国国债发行的品种\n\n- 普通型国债包括：\n  - 无记名(实物)国债。这是一种实物债券，以实物券的形式记录债权，不记名\n  - 记账式国债。这种国债以电脑记账形式记录债权，通过无纸化方式在交易所和银行间债券市场发行和交易，后来又扩展到银行柜台发行，可以记名、挂失。\n  - 凭证式国债。这是一种储蓄债券，可以记名、挂失，以“凭证式国债收款凭证”记录债权，可提前兑付，不能上市流通，从购买之日起计息。\n  - 电子式储蓄国债\n- 特殊型国债包括：\n  - 定向债券。这是由财政部主要向养老保险基金待业保险基金(简称“两金”)及其他社会保险基金定向募集的债券，称为特种定向债券，简称定向债券。这种债券以收款凭证记录债权。\n  - 特别国债。1998年8月，筹集的资金全部用于补充国有独资商业银行资本金。2007年，用于购买2000亿美元外汇\n  - 专项国债。专项用于国民经济和社会发展急需的基础设施投入。此外，中国还发行过重点建设债券、保值公债等形式的国债。\n\n##### 2.中国国债的发行期限与利率\n\n- 1981年最初发行时，国债的期限为10年。1985年改为5年，后来又改为3年\n- 1994 年，中国第一次发行半年期国债，1996年发行了3个月期的国债。\n- 2001年以前，中国国内发行的国债以3-5年的中期国债为主，较长和较短期限的国债都比较少\n- 2001年6月，中国在全国银行间债券市场首次发行了长期国债\n- 从利息情况看，中国发行的国债最初都是到期一次性还本付息。\n  - 开始阶段，与美国的情况相反，中国的国债利率一般高于同期限银行款利率。\n  - 中国的国债市场利率逐步正常化。\n    - 目前，在银行间债券市场上，记账式国债交易的利率明显低于同期银行存款利率水平。\n    - 凭证式国偾的利率水平般高于或等于同期限银行存款利率水平。 \n\n#### 二、中国的一级市场\n\n- 1981-1990年采用的是行政推派的办法\n- 1991-1994年，中国主要实行承购包销方式。承购包销方式即为传统的组织承销团进行承销的方式。\n  - 按照国际惯例，先由承销团将国债买下，再由各成员向市场推销。\n  - 这种方式有利于政府及时获得资金，控制局面。但在中国，发行条件主要都是由政府确定的。这样，承购包销并不是真正的市场行为。以行政方法定价，如果国债定价过低，则会提高政府的融资成本；如果定价过高，就有可能发行失败。\n- 1994年起，柜台销售方式开始盛行。主要是利用银行的销售网点销售凭证式国债。 \n- 1995年起开始实行记账式国馈招标方式，即拍卖方式。\n- 1996年开始放开国债发行利率。 \n- 目前，国债一级市场基本上是银行间债券市场、柜台市场、交易所并存的局面\n- 招标方式\n\n#### 三、中国的国债二级市场\n\n- 中国的国债二级市场也由银行间债券市场、柜台交易市场和两个交易所组成\n- 中国的银行间债券市场实行做市商制度。\n\n## 第十二章公司债券市场\n\n### 第一节西方国家的公司债券市场\n\n- 发公司债的原因：\n  - 不会削弱现有股东的控制权力\n  - 可以降低交易成本\n\n#### 一、公司债券的期限\n\n- 公司债券的发行面额一般为100美元。\n- 大多数公司债券是定期债券\n- 小于10年的债务称为票据。20世纪初，公司债券甚至会超过100年。50-60年代，公司债务主要采用20-30年期限的债券形式。70-80年代，由于通货膨胀的影响，加上金融衍生产品能有效地防范短期利率风险，债券期限大大缩短了。90年代后，通货膨胀率下降， 100年期限的债券又重新出现了。\n\n#### 二、债券的担保\n\n##### 1.抵押债券\n\n##### 2.担保信托债券\n\n- 用自己持有的各种有价证券作为担保。\n\n##### 3.设备信托凭证\n\n- 设备信托凭证(equipment trust certificates)不是抵押债券，而是采取信托方式，但实际是以设备为抵押发行的，它使得公司可以以最低的公司债券市场利率筹资。\n\n##### 4.信用债券\n\n- 信用债券(debenture bonds)是没有特定财产担保的。但是，如果发行人不能履约，投资者仍然对其财产和收人有要求权。\n\n##### 5.次等级信用债券\n\n- 次等级信用债券(subordinated debenture bonds)是对发行人资产和收人的求偿权排位更靠后的债券。不仅位于信用债券之后，也位于其他一些债权人之后。 \n\n##### 6.担保债券\n\n- 担保债券(guaranteed bonds)需由另一实体作为担保。\n\n##### 7.收入债券\n\n- 收入债券是公司在重组或面临其他财务困难时发行的债券。与股票类似，只有在公司盈利时债券才有利息，但其对公司利润的求偿权优先于股东。\n\n#### 三、有关债券清偿的条款\n\n##### 1. 早赎和再融资条款\n\n- 由于利率会不断变化，所以公司债券的利息成本可能会变得偏高。当市场利率变得明显低于债券的息票利率时，公司如果赎回债券并发行新的低利息债券，就可以降低成本\n- 投资者的这种风险称为赎回风险。\n\n##### 2.偿债基金条款\n\n- 债券契约有时注明发行人有义务定期赎回一定比例的债券，这样做的目的是降低信用风险。\n\n#### 四、一级市场\n\n- 公司债券的公开发行一般要由几个由投资银行组成的承销团进行投标。\n- 公开发行公司债券一般要向SEC注册。法律对一些债券的发行和交易给予了免于注册的优惠。财政证券、市政证券是不需要注册的。\n\n#### 五、垃圾债券市场\n\n- 如果一种债券在初次发行时就被评为非投资级债券，那么，这种债券就称为初次发行高收益债券。\n- 除了初次发行高收益债券外，其他的高收益债券都是由投资级债券降级而形成的。降级的原因，可能是杠杆收购或者资本重组。如果不是因为杠杆收购或者资本重组，而是由于其他原因使投资级债券降级为非投资债券，这种垃圾债券就称为堕落天使。\n- 垃圾债券市场的发展，使得许多依赖银行贷款的公司，现在转而通过发行债券融资\n- 垃圾债券市场的成功确实有其积极意义：\n  - 第一，许多公司通过垃圾债券市场融资，而不是像以前那样依赖于银行贷款，这意味着最终风险承担者的转变。如果公司通过银行融资，那么风险最终可能是由FDIC的主办者——政府，并进而由全体选民承担的。这些人可能并不愿意承担风险。而通过垃圾债券市场融资，风险的承担者就是那些愿意承担风险的投资者了。\n  - 第二，垃圾债券的期限一般会长于从银行贷款的期限，公司因而可以得到更长期的资金支持。\n  - 第三，由于比较高的违约风险，许多公司是不可能从银行贷款的。垃圾债券市场使得那些被银行拒之门外的公司现在也拥有了融资机会。\n- 垃圾债券的收益率水平一般比同期限的国债高3%一7%，也高于投资级公司债券但低于普通股的收益率。在经济衰退时，垃圾债券的风险溢价会更高。\n\n#### 六、二级市场\n\n公司债券的流动性较差。 \n\n#### 七、欧洲债券市场\n\n欧洲债券(Eurobond)一般是由银行组成的承销团发行的短期无担保债券。\n\n### 第二节 中国的企业债券与公司债券市场\n\n#### 一、中国企业债券市场的发展\n\n- 1984年起，中国开始出现企业债券。当时，债券发行主要是一些企业自发进行的，内部职工是重要的投资者。这时发行的企业债券往往很不规范，甚至并不采取企业债券形式。\n- 1987年3月，国家开始对企业债券进行统一管理\n- 1993年起，整顿金融秩序，打击各种乱集资行为\n- 中国纯粹的企业债券的发债主体主要是国有企业进行固定资产投资。\n- 浮动利率债券发行逐渐增加，2007年开始，企业债券的发行开始尝试以Shibor为基准利率。企业债券的发行方式也在逐步市场化。\n\n- 滞后的原因：\n  - 政府方面：\n    - 长期以来，中国的企业融资先是依靠财政，后是依靠银行。政府集中精力培育股票市场。无需偿还，融资能力强。\n    - 在审批制下，企业很难及时发行企业债券。=\u003e后来改成了条件核准制\n    - 强调企业债券发行必须有固定的项目，企业的发债能力受到很大的限制。\n  - 利率方面：\n    - 按照1993年的规定，中国企业债券的发行利率不得高于同期银行储蓄存款利率的40%。\n    - 与管制银行利率一样，管制企业债券利率的目的也是防范金融风险。但是，管制企业债券利率的结果与管制银行利率截然不同。\n    - 由于银行在中国金融领域具有垄断地位，而且银行存款几乎是无违约风险的，所以无须担心银行的资金来源。但企业债券是有风险的，而且这一市场本来就很不发达，所以，管制本身就可能使得企业债券市场难以为继。\n\n#### 二、公司债券市场的发展\n\n#### 三、金融债券市场的发展\n\n- 中国金融债券的发行始于1985年。\n- 1998年，国家开发银行率先在银行间债券市场成功进行了金融债券的市场化发债。\n- 债券发行得到了人民银行的扶植。\n- 目前的金融债券主要包括：\n  - 政策性金融债券，由政策性银行在银行间市场发行。\n  - 商业银行债券。2004年后，商业银行为了满足资本充足率的要求，纷纷发行债券特别是次级债券和混合资本债券。混合资本债券属于商业银行的附属资本，求偿权位于次级债务之后、股权资本之前。\n  - 证券公司债券，包括短期融资券和次级债务等。\n  - 保险公司次级债。 \n  - 财务公司债务。\n\n ",title:"Untitled Page"}};for(const[a,b]of Object.entries(scrapedContent))contentIndex.add(a,b.content);const stopwords=['i','me','my','myself','we','our','ours','ourselves','you','your','yours','yourself','yourselves','he','him','his','himself','she','her','hers','herself','it','its','itself','they','them','their','theirs','themselves','what','which','who','whom','this','that','these','those','am','is','are','was','were','be','been','being','have','has','had','having','do','does','did','doing','a','an','the','and','but','if','or','because','as','until','while','of','at','by','for','with','about','against','between','into','through','during','before','after','above','below','to','from','up','down','in','out','on','off','over','under','again','further','then','once','here','there','when','where','why','how','all','any','both','each','few','more','most','other','some','such','no','nor','not','only','own','same','so','than','too','very','s','t','can','will','just','don','should','now'],highlight=(i,j)=>{const a=15,k=j.split(/\s+/).filter(a=>a!==""),b=i.split(/\s+/).filter(a=>a!==""),f=a=>k.some(b=>a.toLowerCase().includes(b.toLowerCase())),d=b.map(f);let e=0,g=0;for(let b=0;b<Math.max(d.length-a,0);b++){const f=d.slice(b,b+a),c=f.reduce((a,b)=>a+b,0);c>e&&(e=c,g=b)}const c=Math.max(g-a,0),h=Math.min(c+2*a,b.length),l=b.slice(c,h).map(a=>{return f(a)?`<span class="search-highlight">${a}</span>`:a}).join(" ").replaceAll('</span> <span class="search-highlight">'," ");return`${c===0?"":"..."}${l}${h===b.length?"":"..."}`},resultToHTML=({url:b,title:c,content:d,term:a})=>{const e=d.split("---")[2],f=removeMarkdown(e),g=highlight(c,a),h=highlight(f,a);return`<div class="result-card" id="${b}">
        <h3>${g}</h3>
        <p>${h}</p>
    </div>`},source=document.getElementById('search-bar'),results=document.getElementById("results-container");source.addEventListener('input',b=>{const a=b.target.value;contentIndex.search(a,{limit:5,depth:3,suggest:!0}).then(c=>{const d=[...new Set(c)],b=d.map(a=>({url:a,title:scrapedContent[a].title,content:scrapedContent[a].content}));if(b.length===0)results.innerHTML=`<div class="result-card">
            <p>No results.</p>
        </div>`;else{results.innerHTML=b.map(b=>resultToHTML({...b,term:a})).join("\n");const c=document.getElementsByClassName("result-card");[...c].forEach(b=>{b.onclick=()=>{window.location.href=`${b.id}#:~:text=${encodeURIComponent(a)}`}})}})});const searchContainer=document.getElementById("search-container");function openSearch(){searchContainer.style.display==="none"||searchContainer.style.display===""?(source.value="",results.innerHTML="",searchContainer.style.display="block",source.focus()):searchContainer.style.display="none"}function closeSearch(){searchContainer.style.display="none"}document.addEventListener('keydown',a=>{a.key==="/"&&(a.preventDefault(),openSearch()),a.key==="Escape"&&(a.preventDefault(),closeSearch())}),window.addEventListener('DOMContentLoaded',()=>{const a=document.getElementById("search-icon");a.addEventListener('click',a=>{openSearch()}),a.addEventListener('keydown',a=>{openSearch()})})</script><div class=singlePage><header><svg tabindex="0" id="search-icon" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg><div class=spacer></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><aside class=mainTOC><h3>Table of Contents</h3><nav id=TableOfContents><ol><li><a href=#mbs的内嵌期权>MBS的内嵌期权</a></li><li><a href=#oas的计算方法>OAS的计算方法</a></li><li><a href=#oas与z-spread>OAS与Z-Spread</a></li><li><a href=#reference>Reference</a></li></ol></nav></aside><h2 id=mbs的内嵌期权>MBS的内嵌期权</h2><p>当贷款发放之后，借款人存在
<a href=../MBS-Modelling.md#%e6%97%a9%e5%81%bf%e6%83%85%e5%86%b5%e7%9a%84%e5%88%86%e6%9e%90 rel=noopener>提前偿还的权利</a>
，可以灵活地根据利率水平选择是否提前偿还。</p><p>如果利率变低，借款人可以选择再融资，以更低的价格获得同样的贷款。拥有看涨期权 (call option) 意味着可以通过较低的价格来获得标的资产，所以抵押贷款的借款人相当于拥有一个看涨期权；类似地，MBS的投资者则相当于卖出一个看涨期权 (short a call option). 同样，借款人也有选择违约并将抵押物（住房）还给银行的权利，相当于拥有一个看跌期权（房价跌到比贷款的价值还低）；类似地，MBS的投资者则相当于卖出一个看跌期权 (short a put option).</p><p>因此，MBS可以看做<strong>内嵌期权</strong>的固定收益产品，可以用<strong>Option-Adjusted Spread</strong>来衡量期权因素对价格的影响。</p><h2 id=oas的计算方法>OAS的计算方法</h2><p>OAS是基于不同状态下的利率$r_{t}$使得MBS预期现金流的现值等于该MBS的市场价格所需收益率价差。可以按以下方法倒解出OAS：</p><p>设$r_{t}, t=1, \cdots, T$是利率曲线，给定$r_{j t}, t=1, \cdots, T$是状态 $j=1, \cdots, N$下的利率，每个状态下MBS的现金流可以由$C_{j t}, t=1, \cdots, T$确定，OAS被定义为：
$$
V_{M B S}=\sum_{j=1}^{N} p_{j}\left[\sum_{t=1}^{T} \frac{C_{j t}}{\left(1+r_{j 1}+O A S\right) \times \cdots\left(1+r_{j t}+O A S\right)}\right]
$$
其中 $p_{j}$ 是状态 $j$的概率。</p><p>常见的利率模型有以下几种：</p><p><strong>Vasicek Model</strong>
$$
dR_t=a(b-R_t)dt+\sigma dW_t
$$
<strong>CIR Model</strong>
$$
dR_t=a(b-R_t)dt+\sigma \sqrt R_t dW_t
$$
<strong>Hull-White Model</strong>
$$
dR_t=a(b_t-R_t)dt+\sigma dW_t
$$</p><p>通过<strong>蒙特卡洛</strong>模拟不同的利率曲线随机变化的情况，可以计算出OAS.</p><h2 id=oas与z-spread>OAS与Z-Spread</h2><p>Z-Spread是基于目前的即期利率曲线 (spot curve) 计算出的使现金流的现值等于市场价格的价差。</p><p>$$
P=\sum_{t=1}^{T} \frac{C_{t}}{\left(1+r_{t}+Z\right) ^t}
$$</p><p>其中$r_t$是目前$t$年期的即期利率。</p><p>例如，某三年期债券目前的价格为104.90，coupon rate为5%，每年付息一次。相应的一年、两年和三年期零息国债利率（每半年复利一次）分别为2.5%、2.7%和3%。计算Z-Spread的方法为：</p><p>$$
104.9 = \frac{5}{(1+\frac{0.025+Z}{2})^2}+\frac{5}{(1+\frac{0.027+Z}{2})^4}+\frac{105}{(1+\frac{0.03+Z}{2})^6}
$$</p><p>Z-Spread和OAS的差值可以衡量投资者由于short an option导致的收益率变化：</p><p>$$
Z-Spread = OAS+Option\ Cost
$$</p><p>例如，如果现在以下两个MBS的Z-Spread和OAS如下所示：</p><table><thead><tr><th></th><th>MBS 4.00%</th><th>MBS 5.50%</th></tr></thead><tbody><tr><td>Zero Volatility Spread</td><td>1.22%</td><td>2.09%</td></tr><tr><td>Option-Adjusted Spread</td><td>0.49%</td><td>0.19%</td></tr></tbody></table><p>则MBS 4.00%的short option value为0.73%，MBS 5.50%的short option value为1.90%. OAS说明了投资者卖出期权的价值，在这个例子中MBS 5.50%的short option value更高，所以MBS 5.50%的YTM更高。</p><p>与静态现金流分析相比，OAS可以更清晰地让投资者理解MBS的模型价格。通过选取不同的利率模型，投资者可以观察不同收益率曲线形状的影响，并对<strong>未来的利率进行了模拟</strong>，研究利率对MBS收益率的影响。但OAS分析受限于利率模型和提前还款模型的选取，不同的模型构建方法会影响OAS的分析结果。</p><h2 id=reference>Reference</h2><p>Glenn M. Schultz: Investing in Mortgage-Backed and Asset-Backed Securities, Wiley Finance, 2015</p></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=../MBS-Duration>/MBS Duration</a></li><li><a href=../MOC>/MOC</a></li><li><a href=../Published/MBS-Duration>/Published/MBS Duration</a></li><li><a href=../Published/TBA-Market-and-Dollar-Roll>/Published/TBA Market and Dollar Roll</a></li><li><a href=../TBA-Market-and-Dollar-Roll>/TBA Market and Dollar Roll</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script>const index={backlinks:{"/Data%20Preprocessing%20and%20EDA":[{source:"/MOC",target:"/Data%20Preprocessing%20and%20EDA",text:"Data Preprocessing and EDA"}],"/Futures":[{source:"/MOC",target:"/Futures",text:"Futures"}],"/MBS%20Duration":[{source:"/MOC",target:"/MBS%20Duration",text:"MBS Duration"}],"/MBS%20Modelling":[{source:"/MOC",target:"/MBS%20Modelling",text:"MBS Modelling"}],"/MBS%20Modelling.md":[{source:"/MBS Duration",target:"/MBS%20Modelling.md",text:"提前偿还风险"},{source:"/OAS",target:"/MBS%20Modelling.md",text:"提前偿还的权利"},{source:"/Published/MBS Duration",target:"/MBS%20Modelling.md",text:"提前偿还风险"},{source:"/Published/OAS",target:"/MBS%20Modelling.md",text:"提前偿还的权利"}],"/OAS":[{source:"/MBS Duration",target:"/OAS",text:"OAS"},{source:"/MOC",target:"/OAS",text:"OAS"},{source:"/Published/MBS Duration",target:"/OAS",text:"OAS"},{source:"/Published/TBA Market and Dollar Roll",target:"/OAS",text:"OAS"},{source:"/TBA Market and Dollar Roll",target:"/OAS",text:"OAS"}],"/Options":[{source:"/MOC",target:"/Options",text:"Options"}],"/Palladium%20Options":[{source:"/Published/Dispersion Trading",target:"/Palladium%20Options",text:"Palladium Options"}],"/Probability%20and%20Random%20Process":[{source:"/MOC",target:"/Probability%20and%20Random%20Process",text:"Probability and Random Process"}],"/Published/Futures":[{source:"/Published/MOC",target:"/Published/Futures",text:"Futures"}],"/Published/MBS%20Duration":[{source:"/Published/MOC",target:"/Published/MBS%20Duration",text:"MBS Duration"}],"/Published/MBS%20Modelling":[{source:"/Published/MOC",target:"/Published/MBS%20Modelling",text:"MBS Modelling"}],"/Published/MOC":[{source:"/",target:"/Published/MOC",text:"MOC"}],"/Published/Notes/Data%20Preprocessing%20and%20EDA":[{source:"/Published/MOC",target:"/Published/Notes/Data%20Preprocessing%20and%20EDA",text:"Data Preprocessing and EDA"}],"/Published/OAS":[{source:"/Published/MOC",target:"/Published/OAS",text:"OAS"}],"/Published/Options":[{source:"/Published/MOC",target:"/Published/Options",text:"Options"}],"/Published/Probability%20and%20Random%20Process":[{source:"/Published/MOC",target:"/Published/Probability%20and%20Random%20Process",text:"Probability and Random Process"}],"/Published/Regression%20Analysis":[{source:"/Published/MOC",target:"/Published/Regression%20Analysis",text:"Regression Analysis"}],"/Published/Statistical%20Inference":[{source:"/Published/MOC",target:"/Published/Statistical%20Inference",text:"Statistical Inference"}],"/Published/Swap":[{source:"/Published/MOC",target:"/Published/Swap",text:"Swaps"}],"/Published/TBA%20Market%20and%20Dollar%20Roll":[{source:"/Published/MOC",target:"/Published/TBA%20Market%20and%20Dollar%20Roll",text:"Dollar Roll"}],"/Published/利率及利率衍生品":[{source:"/Published/MOC",target:"/Published/利率及利率衍生品",text:"Rates"}],"/Published/计量经济学":[{source:"/Published/MOC",target:"/Published/计量经济学",text:"Econometrics"}],"/Published/货币金融学":[{source:"/Published/MOC",target:"/Published/货币金融学",text:"Money and Banking"}],"/Published/金融市场与金融机构":[{source:"/Published/MOC",target:"/Published/金融市场与金融机构",text:"Financial Market"}],"/Regression%20Analysis":[{source:"/MOC",target:"/Regression%20Analysis",text:"Regression Analysis"}],"/Statistical%20Inference":[{source:"/MOC",target:"/Statistical%20Inference",text:"Statistical Inference"}],"/Swap":[{source:"/MOC",target:"/Swap",text:"Swaps"}],"/TBA%20Market%20and%20Dollar%20Roll":[{source:"/MOC",target:"/TBA%20Market%20and%20Dollar%20Roll",text:"Dollar Roll"}],"/t":[{source:"/Options",target:"/t",text:"S, S"},{source:"/Published/Options",target:"/t",text:"S, S"}],"/利率及利率衍生品":[{source:"/MBS Duration",target:"/利率及利率衍生品",text:"久期和修正久期"},{source:"/MOC",target:"/利率及利率衍生品",text:"Rates"},{source:"/Published/MBS Duration",target:"/利率及利率衍生品",text:"久期和修正久期"}],"/计量经济学":[{source:"/MOC",target:"/计量经济学",text:"Econometrics"}],"/货币金融学":[{source:"/MOC",target:"/货币金融学",text:"Money and Banking"}],"/金融市场与金融机构":[{source:"/MOC",target:"/金融市场与金融机构",text:"Financial Market"}]},links:{"/":[{source:"/",target:"/Published/MOC",text:"MOC"}],"/MBS Duration":[{source:"/MBS Duration",target:"/利率及利率衍生品",text:"久期和修正久期"},{source:"/MBS Duration",target:"/OAS",text:"OAS"},{source:"/MBS Duration",target:"/MBS%20Modelling.md",text:"提前偿还风险"}],"/MOC":[{source:"/MOC",target:"/Futures",text:"Futures"},{source:"/MOC",target:"/利率及利率衍生品",text:"Rates"},{source:"/MOC",target:"/Probability%20and%20Random%20Process",text:"Probability and Random Process"},{source:"/MOC",target:"/Swap",text:"Swaps"},{source:"/MOC",target:"/MBS%20Duration",text:"MBS Duration"},{source:"/MOC",target:"/Statistical%20Inference",text:"Statistical Inference"},{source:"/MOC",target:"/Regression%20Analysis",text:"Regression Analysis"},{source:"/MOC",target:"/OAS",text:"OAS"},{source:"/MOC",target:"/货币金融学",text:"Money and Banking"},{source:"/MOC",target:"/TBA%20Market%20and%20Dollar%20Roll",text:"Dollar Roll"},{source:"/MOC",target:"/计量经济学",text:"Econometrics"},{source:"/MOC",target:"/Options",text:"Options"},{source:"/MOC",target:"/MBS%20Modelling",text:"MBS Modelling"},{source:"/MOC",target:"/金融市场与金融机构",text:"Financial Market"},{source:"/MOC",target:"/Data%20Preprocessing%20and%20EDA",text:"Data Preprocessing and EDA"}],"/OAS":[{source:"/OAS",target:"/MBS%20Modelling.md",text:"提前偿还的权利"}],"/Options":[{source:"/Options",target:"/t",text:"S, S"}],"/Published/Dispersion Trading":[{source:"/Published/Dispersion Trading",target:"/Palladium%20Options",text:"Palladium Options"}],"/Published/MBS Duration":[{source:"/Published/MBS Duration",target:"/利率及利率衍生品",text:"久期和修正久期"},{source:"/Published/MBS Duration",target:"/OAS",text:"OAS"},{source:"/Published/MBS Duration",target:"/MBS%20Modelling.md",text:"提前偿还风险"}],"/Published/MOC":[{source:"/Published/MOC",target:"/Published/货币金融学",text:"Money and Banking"},{source:"/Published/MOC",target:"/Published/TBA%20Market%20and%20Dollar%20Roll",text:"Dollar Roll"},{source:"/Published/MOC",target:"/Published/Probability%20and%20Random%20Process",text:"Probability and Random Process"},{source:"/Published/MOC",target:"/Published/计量经济学",text:"Econometrics"},{source:"/Published/MOC",target:"/Published/Futures",text:"Futures"},{source:"/Published/MOC",target:"/Published/Swap",text:"Swaps"},{source:"/Published/MOC",target:"/Published/MBS%20Modelling",text:"MBS Modelling"},{source:"/Published/MOC",target:"/Published/OAS",text:"OAS"},{source:"/Published/MOC",target:"/Published/Statistical%20Inference",text:"Statistical Inference"},{source:"/Published/MOC",target:"/Published/MBS%20Duration",text:"MBS Duration"},{source:"/Published/MOC",target:"/Published/金融市场与金融机构",text:"Financial Market"},{source:"/Published/MOC",target:"/Published/Regression%20Analysis",text:"Regression Analysis"},{source:"/Published/MOC",target:"/Published/Options",text:"Options"},{source:"/Published/MOC",target:"/Published/利率及利率衍生品",text:"Rates"},{source:"/Published/MOC",target:"/Published/Notes/Data%20Preprocessing%20and%20EDA",text:"Data Preprocessing and EDA"}],"/Published/OAS":[{source:"/Published/OAS",target:"/MBS%20Modelling.md",text:"提前偿还的权利"}],"/Published/Options":[{source:"/Published/Options",target:"/t",text:"S, S"}],"/Published/TBA Market and Dollar Roll":[{source:"/Published/TBA Market and Dollar Roll",target:"/OAS",text:"OAS"}],"/TBA Market and Dollar Roll":[{source:"/TBA Market and Dollar Roll",target:"/OAS",text:"OAS"}]}},links=[{source:"/MBS Duration",target:"/利率及利率衍生品",text:"久期和修正久期"},{source:"/MBS Duration",target:"/OAS",text:"OAS"},{source:"/MBS Duration",target:"/MBS%20Modelling.md",text:"提前偿还风险"},{source:"/MOC",target:"/Futures",text:"Futures"},{source:"/MOC",target:"/利率及利率衍生品",text:"Rates"},{source:"/MOC",target:"/Probability%20and%20Random%20Process",text:"Probability and Random Process"},{source:"/MOC",target:"/Swap",text:"Swaps"},{source:"/MOC",target:"/MBS%20Duration",text:"MBS Duration"},{source:"/MOC",target:"/Statistical%20Inference",text:"Statistical Inference"},{source:"/MOC",target:"/Regression%20Analysis",text:"Regression Analysis"},{source:"/MOC",target:"/OAS",text:"OAS"},{source:"/MOC",target:"/货币金融学",text:"Money and Banking"},{source:"/MOC",target:"/TBA%20Market%20and%20Dollar%20Roll",text:"Dollar Roll"},{source:"/MOC",target:"/计量经济学",text:"Econometrics"},{source:"/MOC",target:"/Options",text:"Options"},{source:"/MOC",target:"/MBS%20Modelling",text:"MBS Modelling"},{source:"/MOC",target:"/金融市场与金融机构",text:"Financial Market"},{source:"/MOC",target:"/Data%20Preprocessing%20and%20EDA",text:"Data Preprocessing and EDA"},{source:"/OAS",target:"/MBS%20Modelling.md",text:"提前偿还的权利"},{source:"/Options",target:"/t",text:"S, S"},{source:"/Published/Dispersion Trading",target:"/Palladium%20Options",text:"Palladium Options"},{source:"/Published/MBS Duration",target:"/利率及利率衍生品",text:"久期和修正久期"},{source:"/Published/MBS Duration",target:"/OAS",text:"OAS"},{source:"/Published/MBS Duration",target:"/MBS%20Modelling.md",text:"提前偿还风险"},{source:"/Published/MOC",target:"/Published/货币金融学",text:"Money and Banking"},{source:"/Published/MOC",target:"/Published/TBA%20Market%20and%20Dollar%20Roll",text:"Dollar Roll"},{source:"/Published/MOC",target:"/Published/Probability%20and%20Random%20Process",text:"Probability and Random Process"},{source:"/Published/MOC",target:"/Published/计量经济学",text:"Econometrics"},{source:"/Published/MOC",target:"/Published/Futures",text:"Futures"},{source:"/Published/MOC",target:"/Published/Swap",text:"Swaps"},{source:"/Published/MOC",target:"/Published/MBS%20Modelling",text:"MBS Modelling"},{source:"/Published/MOC",target:"/Published/OAS",text:"OAS"},{source:"/Published/MOC",target:"/Published/Statistical%20Inference",text:"Statistical Inference"},{source:"/Published/MOC",target:"/Published/MBS%20Duration",text:"MBS Duration"},{source:"/Published/MOC",target:"/Published/金融市场与金融机构",text:"Financial Market"},{source:"/Published/MOC",target:"/Published/Regression%20Analysis",text:"Regression Analysis"},{source:"/Published/MOC",target:"/Published/Options",text:"Options"},{source:"/Published/MOC",target:"/Published/利率及利率衍生品",text:"Rates"},{source:"/Published/MOC",target:"/Published/Notes/Data%20Preprocessing%20and%20EDA",text:"Data Preprocessing and EDA"},{source:"/Published/OAS",target:"/MBS%20Modelling.md",text:"提前偿还的权利"},{source:"/Published/Options",target:"/t",text:"S, S"},{source:"/Published/TBA Market and Dollar Roll",target:"/OAS",text:"OAS"},{source:"/TBA Market and Dollar Roll",target:"/OAS",text:"OAS"},{source:"/",target:"/Published/MOC",text:"MOC"}],curPage="/OAS",pathColors=[{"/moc":"#4388cc"}],parseIdsFromLinks=a=>[...new Set(a.flatMap(a=>[a.source,a.target]))],data={nodes:parseIdsFromLinks(links).map(a=>({id:a})),links},color=a=>{if(a.id===curPage||a.id==="/"&&curPage==="")return"var(--g-node-active)";for(const b of pathColors){const c=Object.keys(b)[0],d=b[c];if(a.id.startsWith(c))return d}return"var(--g-node)"},drag=c=>{function d(b,a){b.active||c.alphaTarget(1).restart(),a.fx=a.x,a.fy=a.y}function e(a,b){b.fx=a.x,b.fy=a.y}function f(b,a){b.active||c.alphaTarget(0),a.fx=null,a.fy=null}const a=!0,b=()=>{};return d3.drag().on("start",a?d:b).on("drag",a?e:b).on("end",a?f:b)},height=250,width=document.getElementById("graph-container").offsetWidth,simulation=d3.forceSimulation(data.nodes).force("charge",d3.forceManyBody().strength(-20)).force("link",d3.forceLink(data.links).id(a=>a.id)).force("center",d3.forceCenter()),svg=d3.select('#graph-container').append('svg').attr('width',width).attr('height',height).attr("viewBox",[-width/2,-height/2,width,height]),enableLegend=!1;if(enableLegend){const a=[{Current:"var(--g-node-active)"},{Note:"var(--g-node)"},...pathColors];a.forEach((a,b)=>{const c=Object.keys(a)[0],d=a[c];svg.append("circle").attr("cx",-width/2+20).attr("cy",height/2-30*(b+1)).attr("r",6).style("fill",d),svg.append("text").attr("x",-width/2+40).attr("y",height/2-30*(b+1)).text(c).style("font-size","15px").attr("alignment-baseline","middle")})}const link=svg.append("g").selectAll("line").data(data.links).join("line").attr("class","link").attr("stroke","var(--g-link)").attr("stroke-width",2).attr("data-source",a=>a.source.id).attr("data-target",a=>a.target.id),graphNode=svg.append("g").selectAll("g").data(data.nodes).enter().append("g"),node=graphNode.append("circle").attr("class","node").attr("id",a=>a.id).attr("r",a=>{const b=index.links[a.id]?.length||0,c=index.backlinks[a.id]?.length||0;return 3+(b+c)/4}).attr("fill",color).style("cursor","pointer").on("click",(b,a)=>{window.location.href="https://maeve-l.github.io/"+a.id.replace(" ","-").replace("%20","-")}).on("mouseover",function(f,a){d3.selectAll(".node").transition().duration(100).attr("fill","var(--g-node-inactive)");const c=parseIdsFromLinks([...index.links[a.id]||[],...index.backlinks[a.id]||[]]),d=d3.selectAll(".node").filter(a=>c.includes(a.id)),b=a.id,e=d3.selectAll(".link").filter(a=>a.source.id===b||a.target.id===b);d.transition().duration(200).attr("fill",color),e.transition().duration(200).attr("stroke","var(--g-link-active)"),d3.select(this.parentNode).select("text").raise().transition().duration(200).style("opacity",1)}).on("mouseleave",function(d,b){d3.selectAll(".node").transition().duration(200).attr("fill",color);const a=b.id,c=d3.selectAll(".link").filter(b=>b.source.id===a||b.target.id===a);c.transition().duration(200).attr("stroke","var(--g-link)"),d3.select(this.parentNode).select("text").transition().duration(200).style("opacity",0)}).call(drag(simulation)),labels=graphNode.append("text").attr("dx",12).attr("dy",".35em").text(a=>encodeURI(a.id)).style("opacity",0).style("pointer-events","none").call(drag(simulation)),enableZoom=!0;enableZoom&&svg.call(d3.zoom().extent([[0,0],[width,height]]).scaleExtent([.25,4]).on("zoom",({transform:a})=>{link.attr("transform",a),node.attr("transform",a),labels.attr("transform",a)})),simulation.on("tick",()=>{link.attr("x1",a=>a.source.x).attr("y1",a=>a.source.y).attr("x2",a=>a.target.x).attr("y2",a=>a.target.y),node.attr("cx",a=>a.x).attr("cy",a=>a.y),labels.attr("x",a=>a.x).attr("y",a=>a.y)})</script></div></div><div id=contact_buttons><footer><p>Made by Maeve Liu using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2022</p><a href=../>Home</a></footer></div></div></body></html>